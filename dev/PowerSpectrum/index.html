<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Power Spectrum Multipoles · GaPSE.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">GaPSE.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Introduction</a></li><li><span class="tocitem">The basic structure</span><ul><li><a class="tocitem" href="../BackgroundData/">Background Data</a></li><li><a class="tocitem" href="../CosmoParams/">Cosmology Parameters</a></li><li><a class="tocitem" href="../Cosmology/">Cosmology Struct</a></li></ul></li><li><a class="tocitem" href="../WindowF/">The F window function</a></li><li><span class="tocitem">GR effect TPCFs</span><ul><li><a class="tocitem" href="../AutoCorrelations/">Auto Correlations</a></li><li><a class="tocitem" href="../CrossCorrelations/">CrossCorrelations</a></li></ul></li><li><span class="tocitem">Calculating TPCFs and PSs</span><ul><li><a class="tocitem" href="../XiMultipoles/">Xi Multipoles</a></li><li><a class="tocitem" href="../SumXiMultipoles/">Sum Xi Multipoles</a></li><li class="is-active"><a class="tocitem" href>Power Spectrum Multipoles</a></li></ul></li><li><span class="tocitem">Utilities</span><ul><li><a class="tocitem" href="../Dicts/">Dictionaries and names</a></li><li><a class="tocitem" href="../MathUtils/">Mathematical Utilities</a></li><li><a class="tocitem" href="../CosmoUtils/">Cosmology Utilities</a></li><li><a class="tocitem" href="../IPSTools/">Input Power Spectrum Tools</a></li><li><a class="tocitem" href="../OtherUtils/">Other Utilities</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Calculating TPCFs and PSs</a></li><li class="is-active"><a href>Power Spectrum Multipoles</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Power Spectrum Multipoles</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/cosmofico97/GaPSE/blob/main/docs/src/PowerSpectrum.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="The-Power-Spectrum-multipole-computation"><a class="docs-heading-anchor" href="#The-Power-Spectrum-multipole-computation">The Power Spectrum multipole computation</a><a id="The-Power-Spectrum-multipole-computation-1"></a><a class="docs-heading-anchor-permalink" href="#The-Power-Spectrum-multipole-computation" title="Permalink"></a></h1><article class="docstring"><header><a class="docstring-binding" id="GaPSE.PS_multipole" href="#GaPSE.PS_multipole"><code>GaPSE.PS_multipole</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs"> PS_multipole(input::String; kwargs...
      ) ::Tuple{Vector{Float64}, Vector{Float64}}

 PS_multipole(ss, fs;
      int_s_min::Float64=1e-1, int_s_max::Float64=1e3,
      epl::Bool=true,
      N_left::Int=12, N_right::Int=12,
      p0_left=[-2.0, 1.0], p0_right=[-2.0, 1.0],
      kwargs...)

 PS_multipole(f_in;
      int_s_min::Float64=1e-1, int_s_max::Float64=1e3,
      L::Int=0, pr::Bool=true, N::Int = 1024,
      k0::Union{Nothing,Float64}=nothing,
      right::Union{Float64,Nothing}=nothing)</code></pre><p>Return the <code>L</code>-order PS multipole through the following Fast Fourier Transform and the effective redshift approximation:</p><p class="math-container">\[P_L(k) = \frac{2 L + 1}{A^{&#39;}} (-i)^L \, \phi(s_\mathrm{eff}) \int_0^\infty 
        \mathrm{d} s \; s^2 \, j_L(ks) \, f_\mathrm{in}(s) \; ,
        \quad \; A^{&#39;} = \frac{1}{4\,\pi}\]</p><p>The former method takes the name of the file where the TPCF multipole in exam is saved in, opens that file and pass the <code>xs</code> and  <code>ys</code> vector of values to the second method. All the keyword- arguments given to the first method are directly transferred to the second one.</p><p>In the second method, you have to pass the <code>xs</code> and <code>ys</code> values of the TPCF you want to exam. Internally, if <code>epl==true</code> the data are fitted with two power laws at the edges, creating a <code>EPLs</code> struct that is passed to the third method. The great advantage is that the integration can be extended over the limits imposed by the vector themself, increasing by far the precision of the PS computation.</p><p>In the last method, you have to give its function/spline <code>f_in</code>.</p><p>It&#39;s recommended to use either the first or the second method.</p><p>The analytical expression previously showed can be easily obtained from the  standard one:</p><p class="math-container">\[\begin{split}
    P_L(k) = &amp;\frac{2 L + 1}{A} (-i)^L \, 
        \int_0^\infty \mathrm{d} s_1 \; s_1^2 
        \int_0^\infty \mathrm{d} s \; s^2 
        \int_{-1}^{+1} \mathrm{d} \mu \;
        j_L(ks) \, \xi(s_1, s, \mu) \, \phi(s_1) \, \phi(s_2) \,
        \mathcal{L}_L(\mu) F\left(\frac{s}{s_1}, \mu \right) \\
        &amp;\mathrm{with} \; \;s_2 = s_2(s_1, s, μ) = \sqrt{s_1^2 + s^2 + 2s_1s\mu}
        \; 
        , \quad A(s_\mathrm{max}, s_\mathrm{min}, \theta_\mathrm{max}) 
        \frac{
          V(s_\mathrm{max}, s_\mathrm{min}, \theta_\mathrm{max})
          }{4 \, \pi^2}
\end{split}\]</p><p>with the definition</p><p class="math-container">\[f_\mathrm{in}(s_1, s) =  \int_{-1}^{+1} \mathrm{d} \mu \;
        \xi(s_1, s, \mu) \, \phi(s_2) \,
        \mathcal{L}_L(\mu) \, F\left(\frac{s}{s_1}, \mu \right)\]</p><p>and the application of the effective redshift approximation.</p><p>The computation is made through the <code>xicalc</code> function of the  <a href="https://github.com/hsgg/TwoFAST.jl">TwoFAST</a> Julia package. Note that in the computation the integration range <span>$0\leq s \leq \infty$</span>  is reduced to <code>int_s_min ≤ s ≤ int_s_max</code>`</p><p><strong>Optional arguments</strong></p><ul><li><p><code>int_s_min::Float64 = 1e-1</code> and <code>int_s_max::Float64 = 1e3</code> : extremes of integration. Do not worry if the input TPCF is not defined in all the  integration range: it will be fitted with two power laws at its extremes,  thanks to the function <code>EPLs</code></p></li><li><p><code>N_left::Int = 12</code> and <code>N_right::Int = 12</code> : number of points from left right edges to be used for the power law fitting in <code>EPLs</code>. They matters only if in the given input file ξ is not defined until the extremes of integration <code>int_s_min</code> and <code>int_s_max</code></p></li><li><p><code>L::Int = 0</code>: order of the Legendre polynomial to be used; note that  the multipole order <code>L</code> must be the same of the input TPCF in exam!  Otherwise, the results would have no sense at all!</p></li><li><p><code>pr::Bool = true</code> : do you want the progress bar showed on screen, in order to  check the time needed for the computation? (<code>true</code> recommended)</p></li><li><p><code>N::Int = 1024</code> : number of points to be returned by <code>xicalc</code></p></li></ul><p><strong>Returns</strong></p><p>A <code>Tuple{Vector{Float64}, Vector{Float64}}</code> with:</p><ul><li>the <code>k</code> values vector as first element;</li><li>the correspoding PS <code>pk</code> values vector as second one.</li></ul><p>See also: <a href="../CosmoUtils/#GaPSE.V_survey"><code>V_survey</code></a>, <a href="../CosmoUtils/#GaPSE.A"><code>A</code></a>, <a href="../CosmoUtils/#GaPSE.A_prime"><code>A_prime</code></a>, <a href="../MathUtils/#GaPSE.EPLs"><code>EPLs</code></a>,  <a href="#GaPSE.print_PS_multipole"><code>print_PS_multipole</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cosmofico97/GaPSE/blob/fa8036e68719471491ede91c91a05ca8ae6c21ae/src/PowerSpectrum.jl#L50-L153">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="GaPSE.print_PS_multipole" href="#GaPSE.print_PS_multipole"><code>GaPSE.print_PS_multipole</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs"> print_PS_multipole(input::String, out::String;
      L::Int = 0, N::Int = 1024,
      pr::Bool = true, kwargs...)</code></pre><p>Takes in input a filename <code>input</code> where is stored a TPCF multipole, calculate the <code>L</code>-order PS multipole through the following Fast Fourier Transform and the effective redshift approximation</p><p class="math-container">\[P_L(k) = \frac{2 L + 1}{A^{&#39;}} (-i)^L \, \phi(s_\mathrm{eff}) \int_0^\infty 
        \mathrm{d} s \; s^2 \, j_L(ks) \, f_\mathrm{in}(s) \; ,
        \quad \; A^{&#39;} = \frac{1}{4\,\pi}\]</p><p>and save it in the file <code>out</code>, together with the options used for the computation.</p><p><strong>Optional arguments</strong></p><ul><li><p><code>L::Int = 0</code>: order of the Legendre polynomial to be used; note that  the multipole order <code>L</code> must be the same of the input TPCF in exam!  Otherwise, the results would have no sense at all!</p></li><li><p><code>pr::Bool = true</code> : do you want the progress bar showed on screen, in order to  check the time needed for the computation? (<code>true</code> recommended)</p></li><li><p><code>N::Int = 1024</code> : number of points to be returned by <code>xicalc</code></p></li><li><p><code>kwargs...</code> : other keyword arguments that will be passed to <code>PS_multipole</code></p></li></ul><p>See also: <a href="../CosmoUtils/#GaPSE.V_survey"><code>V_survey</code></a>, <a href="../CosmoUtils/#GaPSE.A"><code>A</code></a>, <a href="../CosmoUtils/#GaPSE.A_prime"><code>A_prime</code></a>, <a href="../MathUtils/#GaPSE.EPLs"><code>EPLs</code></a>, <a href="#GaPSE.PS_multipole"><code>PS_multipole</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cosmofico97/GaPSE/blob/fa8036e68719471491ede91c91a05ca8ae6c21ae/src/PowerSpectrum.jl#L244-L276">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../SumXiMultipoles/">« Sum Xi Multipoles</a><a class="docs-footer-nextpage" href="../Dicts/">Dictionaries and names »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.23 on <span class="colophon-date" title="Friday 9 December 2022 15:51">Friday 9 December 2022</span>. Using Julia version 1.7.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
