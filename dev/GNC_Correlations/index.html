<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>GNC · GaPSE.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">GaPSE.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Introduction</a></li><li><span class="tocitem">The basic structure</span><ul><li><a class="tocitem" href="../BackgroundData/">Background Data</a></li><li><a class="tocitem" href="../CosmoParams/">Cosmology Parameters</a></li><li><a class="tocitem" href="../Cosmology/">Cosmology Struct</a></li></ul></li><li><span class="tocitem">The window function F and its integration</span><ul><li><a class="tocitem" href="../WindowF/">Window F</a></li><li><a class="tocitem" href="../WindowFIntegrated/">Integrated Window F</a></li></ul></li><li><span class="tocitem">Calculating TPCFs multipoles</span><ul><li class="is-active"><a class="tocitem" href>GNC</a><ul class="internal"><li class="toplevel"><a class="tocitem" href="#Two-Point-Cross-Correlation-Functions"><span>Two-Point Cross-Correlation Functions</span></a></li><li class="toplevel"><a class="tocitem" href="#Two-Point-Cross-Correlation-Function-multipoles"><span>Two-Point Cross-Correlation Function multipoles</span></a></li><li class="toplevel"><a class="tocitem" href="#Two-Point-Cross-Correlation-Function-Sum-multipoles"><span>Two-Point Cross-Correlation Function Sum multipoles</span></a></li></ul></li><li><a class="tocitem" href="../LD_Correlations/">LD</a></li><li><a class="tocitem" href="../GNCxLD_Correlations/">GNCxLD</a></li><li><a class="tocitem" href="../GNCxLD_Correlations/">LDxGNC</a></li></ul></li><li><a class="tocitem" href="../PlaneParallelApprox/">Calculating TPCFs with the PP Approximation</a></li><li><a class="tocitem" href="../PowerSpectrum/">Calculating Power Spectra</a></li><li><a class="tocitem" href="../PNG/">implication on PNG</a></li><li><span class="tocitem">Utilities</span><ul><li><a class="tocitem" href="../Dicts/">Dictionaries and names</a></li><li><a class="tocitem" href="../MathUtils/">Mathematical Utilities</a></li><li><a class="tocitem" href="../CosmoUtils/">Cosmology Utilities</a></li><li><a class="tocitem" href="../IPSTools/">Input Power Spectrum Tools</a></li><li><a class="tocitem" href="../OtherUtils/">Other Utilities</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Calculating TPCFs multipoles</a></li><li class="is-active"><a href>GNC</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>GNC</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/cosmofico97/GaPSE/blob/main/docs/src/GNC_Correlations.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Two-Point-Auto-Correlation-Functions"><a class="docs-heading-anchor" href="#Two-Point-Auto-Correlation-Functions">Two-Point Auto-Correlation Functions</a><a id="Two-Point-Auto-Correlation-Functions-1"></a><a class="docs-heading-anchor-permalink" href="#Two-Point-Auto-Correlation-Functions" title="Permalink"></a></h1><article class="docstring"><header><a class="docstring-binding" id="GaPSE.ξ_GNC_Newtonian" href="#GaPSE.ξ_GNC_Newtonian"><code>GaPSE.ξ_GNC_Newtonian</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs"> ξ_GNC_Newtonian(P1::Point, P2::Point, y, cosmo::Cosmology; 
      obs::Union{Bool, Symbol} = :noobsvel) ::Float64

 ξ_GNC_Newtonian(s1, s2, y, cosmo::Cosmology; 
      kwargs...) ::Float64</code></pre><p>Return the Two-Point Correlation Function (TPCF) of the Newtonian auto-correlation effect arising from the Galaxy Number Counts (GNC).</p><p>In the first method, you should pass the two <code>Point</code> (<code>P1</code> and <code>P2</code>) where to  evaluate the function, while in the second method (that internally recalls the first)  you must provide the two corresponding comoving distances <code>s1</code> and <code>s2</code>. We remember that all the distances are measured in <span>$h_0^{-1}\mathrm{Mpc}$</span>.</p><p>The analytical expression of this term is the following:</p><p class="math-container">\[\begin{split}
    \xi^{\delta\delta} ( s_1 , s_2 , y )  = D_1 D_2 
    \left[ 
    J_{00}^{\delta\delta} I_0^0 (s) + 
    J_{02}^{\delta\delta} I_2^0 (s) + 
    J_{04}^{\delta\delta} I_4^0 (s) 
    \right] \, , 
\end{split}\]</p><p>where</p><p class="math-container">\[\begin{split}
    J_{00}^{\delta\delta}  &amp;= \frac{1}{15}  
    \left[
        15 b_1 b_2 + 5 b_1 f_2 + 5 b_2 f_1  +
        (2 y^2 + 1) f_1 f_2
    \right]
    \, , \\
    %%%%%%%%%%%%%%%%%%
    J_{02}^{\delta\delta}  &amp;= - \frac{1}{21 s^2}
    \left\{
        s_1^2 \left[
            14 b_2 f_1 + 
            7 b_1 f_2 (3 y^2 - 1) + 
            (11 y^2 + 1) f_1 f_2 
            \right]  \right.  \\
        &amp;\left.\qquad \qquad  
        + s_2^2 \left[
            14 b_1 f_2 + 
            7 b_2 f_1 (3 y^2 - 1) + 
            (11 y^2 + 1) f_1 f_2 
            \right]  \right. \\
        &amp;\left. \qquad \qquad   
        - 4 y s_1 s_2 \left[
            7 b_2 f_1 + 7 b_1 f_2 +
            (y^2 + 5) f_1 f_2
            \right]
    \right\}
    \, , \\
    %%%%%%%%%%%%%%%%%%
    J_{04}^{\delta\delta}  &amp;= \frac{f_1 f_2}{35 s^4}
    \left[
        4 (3 y^2 - 1) (s_1^4 + s_2^4) +
        3 (3 + y^2)^2 s_1^2 s_2^2 - 
        8 y s_1 s_2 (s_1^2 + s_2^2) (3 + y^2)
    \right]
    \, .
\end{split}\]</p><p>where:</p><ul><li><p><span>$s_1$</span> and <span>$s_2$</span> are comoving distances;</p></li><li><p><span>$D_1 = D(s_1)$</span>, ... is the linear growth factor (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$a_1 = a(s_1)$</span>, ... is the scale factor (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$f_1 = f(s_1)$</span>, ... is the linear growth rate (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$\mathcal{H}_1 = \mathcal{H}(s_1)$</span>, ... is the comoving  Hubble distances (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$y = \cos{\theta} = \hat{\mathbf{s}}_1 \cdot \hat{\mathbf{s}}_2$</span>;</p></li><li><p><span>$\mathcal{R}_1 = \mathcal{R}(s_1)$</span>, ... is  computed by <code>func_ℛ_GNC</code> in <code>cosmo::Cosmology</code> (and evaluated in <span>$s_1$</span> ); the definition of <span>$\mathcal{R}(s)$</span> is the following:</p><p class="math-container">\[\mathcal{R}(s) = 5 s_{\mathrm{b}}(s) + \frac{2 - 5 s_{\mathrm{b}}(s)}{\mathcal{H}(s) \, s} +  
\frac{\dot{\mathcal{H}}(s)}{\mathcal{H}(s)^2} - \mathit{f}_{\mathrm{evo}} \quad ;\]</p></li><li><p><span>$b_1 = b(s_1)$</span>, <span>$s_{\mathrm{b}, 1} = s_{\mathrm{b}}(s_1)$</span>, <span>$\mathit{f}_{\mathrm{evo}}$</span>, ... :  galaxy bias, magnification bias (i.e. the slope of the luminosity function at the luminosity threshold),  and evolution bias (the first two evaluated in <span>$s_1$</span>); they are all stored in <code>cosmo</code>;</p></li><li><p><span>$\Omega_{\mathrm{M}0} = \Omega_{\mathrm{cdm}} + \Omega_{\mathrm{b}}$</span> is the sum of  cold-dark-matter and barionic density parameters (again, stored in <code>cosmo</code>);</p></li><li><p><span>$I_\ell^n$</span> and <span>$\sigma_i$</span> are defined as</p><p class="math-container">\[I_\ell^n(s) = \int_0^{+\infty} \frac{\mathrm{d}q}{2\pi^2} 
\, q^2 \, P(q) \, \frac{j_\ell(qs)}{(qs)^n} \quad , 
\quad \sigma_i = \int_0^{+\infty} \frac{\mathrm{d}q}{2\pi^2} 
\, q^{2-i} \, P(q)\]</p><p>with <span>$P(q)$</span> as the matter Power Spectrum at <span>$z=0$</span> (stored in <code>cosmo</code>)  and <span>$j_\ell$</span> as spherical Bessel function of order <span>$\ell$</span>;</p></li><li><p><span>$\tilde{I}_0^4$</span> is defined as</p><p class="math-container">\[\tilde{I}_0^4 = \int_0^{+\infty} \frac{\mathrm{d}q}{2\pi^2} 
\, q^2 \, P(q) \, \frac{j_0(qs) - 1}{(qs)^4}\]</p><p>with <span>$P(q)$</span> as the matter Power Spectrum at <span>$z=0$</span> (stored in <code>cosmo</code>)  and <span>$j_\ell$</span> as spherical Bessel function of order <span>$\ell$</span>;</p></li><li><p><span>$\mathcal{H}_0$</span>, <span>$f_0$</span> and so on are evaluated at the observer position (i.e. at present day);</p></li><li><p><span>$\Delta\chi_1 := \sqrt{\chi_1^2 + s_2^2-2\,\chi_1\,s_2\,y}$</span> and  <span>$\Delta\chi_2 := \sqrt{s_1^2 + \chi_2^2-2\,s_1\,\chi_2\,y}$</span>;</p></li><li><p><span>$s=\sqrt{s_1^2 + s_2^2 - 2 \, s_1 \, s_2 \, y}$</span> and  <span>$\Delta\chi := \sqrt{\chi_1^2 + \chi_2^2-2\,\chi_1\,\chi_2\,y}$</span>.</p></li></ul><p>In this TPCF there are no observer terms. The <code>obs</code> keyword is inserted only for compatibility with  the other GNC TPCFs.</p><p><strong>Inputs</strong></p><ul><li><p><code>P1::Point</code> and <code>P2::Point</code>, or <code>s1</code> and <code>s2</code>: <code>Point</code>/comoving distances where the  TPCF has to be calculated; they contain all the  data of interest needed for this calculus (comoving distance, growth factor and so on).</p></li><li><p><code>y</code>: the cosine of the angle between the two points <code>P1</code> and <code>P2</code> wrt the observer</p></li><li><p><code>cosmo::Cosmology</code>: cosmology to be used in this computation; it contains all the splines used for the conversion <code>s</code> -&gt; <code>Point</code>, and all the cosmological parameters <span>$b$</span>, ...</p></li></ul><p><strong>Keyword Arguments</strong></p><ul><li><code>obs::Union{Bool,Symbol} = :noobsvel</code> : do you want to consider the observer terms in the computation of the  chosen GNC TPCF effect?<ul><li><code>:yes</code> or <code>true</code> -&gt; all the observer effects will be considered</li><li><code>:no</code> or <code>false</code> -&gt; no observer term will be taken into account</li><li><code>:noobsvel</code> -&gt; the observer terms related to the observer velocity (that you can find in the CF concerning Doppler) will be neglected, the other ones will be taken into account</li></ul></li></ul><p>See also: <a href="../Cosmology/#GaPSE.Point"><code>Point</code></a>, <a href="../Cosmology/#GaPSE.Cosmology"><code>Cosmology</code></a>, <a href="#GaPSE.ξ_GNC_multipole"><code>ξ_GNC_multipole</code></a>,  <a href="#GaPSE.map_ξ_GNC_multipole"><code>map_ξ_GNC_multipole</code></a>, <a href="#GaPSE.print_map_ξ_GNC_multipole"><code>print_map_ξ_GNC_multipole</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cosmofico97/GaPSE/blob/5f3347ff3b074f172d8e3ff7fa715eea30fd3aad/src/GNC_AutoCorrelations/GNC_AutoNewtonian.jl#L59-L212">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="GaPSE.ξ_GNC_Doppler" href="#GaPSE.ξ_GNC_Doppler"><code>GaPSE.ξ_GNC_Doppler</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs"> ξ_GNC_Doppler(P1::Point, P2::Point, y, cosmo::Cosmology; 
    obs::Union{Bool, Symbol} = :noobsvel) ::Float64

 ξ_GNC_Doppler(s1, s2, y, cosmo::Cosmology; 
    kwargs...) ::Float64</code></pre><p>Return the Two-Point Correlation Function (TPCF) of the Doppler auto-correlation effect arising from the Galaxy Number Counts (GNC).</p><p>In the first method, you should pass the two <code>Point</code> (<code>P1</code> and <code>P2</code>) where to  evaluate the function, while in the second method (that internally recalls the first)  you must provide the two corresponding comoving distances <code>s1</code> and <code>s2</code>. We remember that all the distances are measured in <span>$h_0^{-1}\mathrm{Mpc}$</span>.</p><p>The analytical expression of this term is the following:</p><p class="math-container">\[\begin{split}
    \xi^{v_{\parallel} v_{\parallel}}( s_1, s_2 , y ) &amp;=
    D_1 D_2 J_{\alpha}^{v_{\parallel} v_{\parallel}}
    \left[  
        J_{\beta}^{v_{\parallel} v_{\parallel}}
        \left( 
            \frac{1}{45} I_0^0(s) +
            \frac{2}{63} I_2^0 (s) + 
            \frac{1}{105} I_4^0(s)
        \right) +
        J^{v_{\parallel} v_{\parallel}}_{20} I_0^2 (s)
    \right] 
     \\
    &amp; + D_1 \left[ 
        J^{v_{\parallel} v_{\parallel}}_{31} ( s_1 , s_2) I_1^3 (s_1) +   
        J^{v_{\parallel} v_{\parallel}}_{11} ( s_1 , s_2) I_1^1 (s_1) + 
        J^{v_{\parallel} v_{\parallel}}_{13} ( s_1 ,s_2) I_3^1 (s_1) 
    \right] 
     \\
    &amp; + D_2 \left[
        J^{v_{\parallel} v_{\parallel}}_{31} ( s_2 , s_1) I_1^3 (s_2) +  
        J^{v_{\parallel} v_{\parallel}}_{11} ( s_2 , s_1) I_1^1 (s_2) +
        J^{v_{\parallel} v_{\parallel}}_{13} ( s_2 , s_1) I_3^1 (s_2) 
    \right]
     \\
    &amp; + J^{v_{\parallel} v_{\parallel}}_{\sigma2} \sigma_2 \, ,
\end{split}\]</p><p>with</p><p class="math-container">\[\begin{split}
    J_{\alpha}^{v_{\parallel} v_{\parallel}} &amp;= 
    f_1 f_2\mathcal{H}_1 \mathcal{H}_2 \mathcal{R}_1 \mathcal{R}_2
    \, , \\
    %%%%%%%%%%%%%%
    J_{\beta}^{v_{\parallel} v_{\parallel}} &amp;= 
    y^2 s_1 s_2 - 2 y (s_1^2 + s_2^2) + 3 s_1 s_2
    \, , \\
    %%%%%%%%%%%%%%
    J_{20}^{v_{\parallel} v_{\parallel}}  &amp;=
    \frac{1}{3} y s^2
    \, , \\
    %%%%%%%%%%%%%%
    J_{31}^{v_{\parallel} v_{\parallel}} (s_1, s_2)  &amp;=
    -y f_0 \mathcal{H}_0 s_1^2 f_1 \mathcal{R}_1 (\mathcal{R}_2 - 5 s_{\mathrm{b}, 2} + 2)
    \, , \\
    %%%%%%%%%%%%%%
    J_{11}^{v_{\parallel} v_{\parallel}} (s_1, s_2)  &amp;=
    \frac{1}{5} y f_0 \mathcal{H}_0 s_1^2 f_1 \mathcal{H}_1 \mathcal{R}_1 
    (\mathcal{R}_2 - 5 s_{\mathrm{b}, 2} + 2)
    \, , \\
    %%%%%%%%%%%%%%
    J_{13}^{v_{\parallel} v_{\parallel}} (s_1, s_2)  &amp;=
    \frac{1}{5} y f_0 \mathcal{H}_0 s_1^2 f_1 \mathcal{H}_1 \mathcal{R}_1 
    (\mathcal{R}_2 - 5 s_{\mathrm{b}, 2} + 2)
    \, , \\
    %%%%%%%%%%%%%%
    J_{\sigma2}^{v_{\parallel} v_{\parallel}} &amp;=
    \frac{1}{3} y f_0^2 \mathcal{H}_0^2 (\mathcal{R}_1 - 5 s_{\mathrm{b}, 1} + 2) 
    (\mathcal{R}_2 - 5 s_{\mathrm{b}, 2} + 2) 
    \, .
\end{split}\]</p><p>where:</p><ul><li><p><span>$s_1$</span> and <span>$s_2$</span> are comoving distances;</p></li><li><p><span>$D_1 = D(s_1)$</span>, ... is the linear growth factor (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$a_1 = a(s_1)$</span>, ... is the scale factor (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$f_1 = f(s_1)$</span>, ... is the linear growth rate (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$\mathcal{H}_1 = \mathcal{H}(s_1)$</span>, ... is the comoving  Hubble distances (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$y = \cos{\theta} = \hat{\mathbf{s}}_1 \cdot \hat{\mathbf{s}}_2$</span>;</p></li><li><p><span>$\mathcal{R}_1 = \mathcal{R}(s_1)$</span>, ... is  computed by <code>func_ℛ_GNC</code> in <code>cosmo::Cosmology</code> (and evaluated in <span>$s_1$</span> ); the definition of <span>$\mathcal{R}(s)$</span> is the following:</p><p class="math-container">\[\mathcal{R}(s) = 5 s_{\mathrm{b}}(s) + \frac{2 - 5 s_{\mathrm{b}}(s)}{\mathcal{H}(s) \, s} +  
\frac{\dot{\mathcal{H}}(s)}{\mathcal{H}(s)^2} - \mathit{f}_{\mathrm{evo}} \quad ;\]</p></li><li><p><span>$b_1 = b(s_1)$</span>, <span>$s_{\mathrm{b}, 1} = s_{\mathrm{b}}(s_1)$</span>, <span>$\mathit{f}_{\mathrm{evo}}$</span>, ... :  galaxy bias, magnification bias (i.e. the slope of the luminosity function at the luminosity threshold),  and evolution bias (the first two evaluated in <span>$s_1$</span>); they are all stored in <code>cosmo</code>;</p></li><li><p><span>$\Omega_{\mathrm{M}0} = \Omega_{\mathrm{cdm}} + \Omega_{\mathrm{b}}$</span> is the sum of  cold-dark-matter and barionic density parameters (again, stored in <code>cosmo</code>);</p></li><li><p><span>$I_\ell^n$</span> and <span>$\sigma_i$</span> are defined as</p><p class="math-container">\[I_\ell^n(s) = \int_0^{+\infty} \frac{\mathrm{d}q}{2\pi^2} 
\, q^2 \, P(q) \, \frac{j_\ell(qs)}{(qs)^n} \quad , 
\quad \sigma_i = \int_0^{+\infty} \frac{\mathrm{d}q}{2\pi^2} 
\, q^{2-i} \, P(q)\]</p><p>with <span>$P(q)$</span> as the matter Power Spectrum at <span>$z=0$</span> (stored in <code>cosmo</code>)  and <span>$j_\ell$</span> as spherical Bessel function of order <span>$\ell$</span>;</p></li><li><p><span>$\tilde{I}_0^4$</span> is defined as</p><p class="math-container">\[\tilde{I}_0^4 = \int_0^{+\infty} \frac{\mathrm{d}q}{2\pi^2} 
\, q^2 \, P(q) \, \frac{j_0(qs) - 1}{(qs)^4}\]</p><p>with <span>$P(q)$</span> as the matter Power Spectrum at <span>$z=0$</span> (stored in <code>cosmo</code>)  and <span>$j_\ell$</span> as spherical Bessel function of order <span>$\ell$</span>;</p></li><li><p><span>$\mathcal{H}_0$</span>, <span>$f_0$</span> and so on are evaluated at the observer position (i.e. at present day);</p></li><li><p><span>$\Delta\chi_1 := \sqrt{\chi_1^2 + s_2^2-2\,\chi_1\,s_2\,y}$</span> and  <span>$\Delta\chi_2 := \sqrt{s_1^2 + \chi_2^2-2\,s_1\,\chi_2\,y}$</span>;</p></li><li><p><span>$s=\sqrt{s_1^2 + s_2^2 - 2 \, s_1 \, s_2 \, y}$</span> and  <span>$\Delta\chi := \sqrt{\chi_1^2 + \chi_2^2-2\,\chi_1\,\chi_2\,y}$</span>.</p></li></ul><p>In this TPCF, the only non-observer term is the first one (i.e. the bracket proportional to  <span>$D(s_1) \, D(s_2)$</span>). The other three ones are all observer terms related to the observer velocity, so if you set <code>obs = :no</code>, <code>obs = false</code> or even <code>obs = :noobsvel</code> they will not be computed.</p><p><strong>Inputs</strong></p><ul><li><p><code>P1::Point</code> and <code>P2::Point</code>, or <code>s1</code> and <code>s2</code>: <code>Point</code>/comoving distances where the  TPCF has to be calculated; they contain all the  data of interest needed for this calculus (comoving distance, growth factor and so on).</p></li><li><p><code>y</code>: the cosine of the angle between the two points <code>P1</code> and <code>P2</code> wrt the observer</p></li><li><p><code>cosmo::Cosmology</code>: cosmology to be used in this computation; it contains all the splines used for the conversion <code>s</code> -&gt; <code>Point</code>, and all the cosmological parameters <span>$b$</span>, ...</p></li></ul><p><strong>Keyword Arguments</strong></p><ul><li><code>obs::Union{Bool,Symbol} = :noobsvel</code> : do you want to consider the observer terms in the computation of the  chosen GNC TPCF effect?<ul><li><code>:yes</code> or <code>true</code> -&gt; all the observer effects will be considered</li><li><code>:no</code> or <code>false</code> -&gt; no observer term will be taken into account</li><li><code>:noobsvel</code> -&gt; the observer terms related to the observer velocity (that you can find in the CF concerning Doppler) will be neglected, the other ones will be taken into account</li></ul></li></ul><p>See also: <a href="../Cosmology/#GaPSE.Point"><code>Point</code></a>, <a href="../Cosmology/#GaPSE.Cosmology"><code>Cosmology</code></a>, <a href="#GaPSE.ξ_GNC_multipole"><code>ξ_GNC_multipole</code></a>,  <a href="#GaPSE.map_ξ_GNC_multipole"><code>map_ξ_GNC_multipole</code></a>, <a href="#GaPSE.print_map_ξ_GNC_multipole"><code>print_map_ξ_GNC_multipole</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cosmofico97/GaPSE/blob/5f3347ff3b074f172d8e3ff7fa715eea30fd3aad/src/GNC_AutoCorrelations/GNC_AutoDoppler.jl#L78-L244">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="GaPSE.ξ_GNC_Lensing" href="#GaPSE.ξ_GNC_Lensing"><code>GaPSE.ξ_GNC_Lensing</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs"> ξ_GNC_Lensing(P1::Point, P2::Point, y, cosmo::Cosmology;
      obs::Union{Bool, Symbol} = :noobsvel,
      en::Float64 = 1e6, Δχ_min::Float64 = 1e-1,
      N_χs_2::Int = 100) ::Float64

 ξ_GNC_Lensing(s1, s2, y, cosmo::Cosmology; 
      kwargs...) ::Float64</code></pre><p>Return the Two-Point Correlation Function (TPCF) of the Lensing auto-correlation effect arising from the Galaxy Number Counts (GNC).</p><p>In the first method, you should pass the two <code>Point</code> (<code>P1</code> and <code>P2</code>) where to  evaluate the function, while in the second method (that internally recalls the first)  you must provide the two corresponding comoving distances <code>s1</code> and <code>s2</code>. We remember that all the distances are measured in <span>$h_0^{-1}\mathrm{Mpc}$</span>.</p><p>The analytical expression of this term is the following:</p><p class="math-container">\[\begin{split}
    \xi^{\kappa\kappa} (s_1, s_2, y) = 
    \int_0^{s_1} \mathrm{d}\chi_1 \int_0^{s_2} \mathrm{d}\chi_2\;  
    J^{\kappa\kappa}_{\alpha}
    &amp;\left[
        J^{\kappa\kappa}_{00} I_0^0(\Delta\chi) + 
        J^{\kappa\kappa}_{02} I_2^0(\Delta\chi) +
        \right.\\
        &amp;\left.
        J^{\kappa\kappa}_{31} I_1^3(\Delta\chi) +
        J^{\kappa\kappa}_{22} I_2^2(\Delta\chi)
    \right]  \, , 
\end{split}\]</p><p>where</p><p class="math-container">\[\begin{split}
    J^{\kappa\kappa}_{\alpha} &amp; = 
    \frac{
        \mathcal{H}_0^4 \Omega_{\mathrm{M}0}^2 D(\chi_1) D(\chi_2) 
    }{
        s_1 s_2 a(\chi_1) a(\chi_2)}
    (\chi_1 - s_1)(\chi_2 - s_2)
    (5 s_{\mathrm{b}, 1} - 2)(5 s_{\mathrm{b}, 2} - 2) 
    \, , \\
    %%%%&amp;%%%%%%%%%%%%%
    J^{\kappa\kappa}_{00} &amp; = 
    -\frac{ 3 \chi_1^2 \chi_2^2}{4 \Delta\chi^4} (y^2 - 1)
    \left[
        8 y (\chi_1^2 + \chi_2^2) - 9\chi_1\chi_2y^2 - 
        7\chi_1\chi_2
    \right] 
    \, , \\
    %%%%&amp;%%%%%%%%%%%%%
    J^{\kappa\kappa}_{02} &amp; = 
    -\frac{ 3 \chi_1^2 \chi_2^2}{2 \Delta\chi^4}(y^2 - 1)
    \left[
        4 y (\chi_1^2 + \chi_2^2) - 3 \chi_1 \chi_2 y^2 -
        5 \chi_1 \chi_2
    \right] 
    \, , \\
    %%%%%%%%%%%%%%%%%%
    J^{\kappa\kappa}_{31} &amp; = 9 y \Delta\chi^2 
    \, , \\
    %%%%%%%%%%%%%%%%%%
    J^{\kappa\kappa}_{22} &amp; = 
    \frac{9 \chi_1 \chi_2}{4 \Delta\chi^4}
    \left[
        2(\chi_1^4 + \chi_2^4)(7 y^2 - 3) - 
        16 y \chi_1 \chi_2 (\chi_1^2 + \chi_2^2)(y^2 + 1) + 
        \right.\\
        &amp;\left.\qquad\qquad\qquad
        \chi_1^2 \chi_2^2 (11y^4 + 14y^2 + 23) 
    \right] 
    \, .
\end{split}\]</p><p>where:</p><ul><li><p><span>$s_1$</span> and <span>$s_2$</span> are comoving distances;</p></li><li><p><span>$D_1 = D(s_1)$</span>, ... is the linear growth factor (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$a_1 = a(s_1)$</span>, ... is the scale factor (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$f_1 = f(s_1)$</span>, ... is the linear growth rate (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$\mathcal{H}_1 = \mathcal{H}(s_1)$</span>, ... is the comoving  Hubble distances (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$y = \cos{\theta} = \hat{\mathbf{s}}_1 \cdot \hat{\mathbf{s}}_2$</span>;</p></li><li><p><span>$\mathcal{R}_1 = \mathcal{R}(s_1)$</span>, ... is  computed by <code>func_ℛ_GNC</code> in <code>cosmo::Cosmology</code> (and evaluated in <span>$s_1$</span> ); the definition of <span>$\mathcal{R}(s)$</span> is the following:</p><p class="math-container">\[\mathcal{R}(s) = 5 s_{\mathrm{b}}(s) + \frac{2 - 5 s_{\mathrm{b}}(s)}{\mathcal{H}(s) \, s} +  
\frac{\dot{\mathcal{H}}(s)}{\mathcal{H}(s)^2} - \mathit{f}_{\mathrm{evo}} \quad ;\]</p></li><li><p><span>$b_1 = b(s_1)$</span>, <span>$s_{\mathrm{b}, 1} = s_{\mathrm{b}}(s_1)$</span>, <span>$\mathit{f}_{\mathrm{evo}}$</span>, ... :  galaxy bias, magnification bias (i.e. the slope of the luminosity function at the luminosity threshold),  and evolution bias (the first two evaluated in <span>$s_1$</span>); they are all stored in <code>cosmo</code>;</p></li><li><p><span>$\Omega_{\mathrm{M}0} = \Omega_{\mathrm{cdm}} + \Omega_{\mathrm{b}}$</span> is the sum of  cold-dark-matter and barionic density parameters (again, stored in <code>cosmo</code>);</p></li><li><p><span>$I_\ell^n$</span> and <span>$\sigma_i$</span> are defined as</p><p class="math-container">\[I_\ell^n(s) = \int_0^{+\infty} \frac{\mathrm{d}q}{2\pi^2} 
\, q^2 \, P(q) \, \frac{j_\ell(qs)}{(qs)^n} \quad , 
\quad \sigma_i = \int_0^{+\infty} \frac{\mathrm{d}q}{2\pi^2} 
\, q^{2-i} \, P(q)\]</p><p>with <span>$P(q)$</span> as the matter Power Spectrum at <span>$z=0$</span> (stored in <code>cosmo</code>)  and <span>$j_\ell$</span> as spherical Bessel function of order <span>$\ell$</span>;</p></li><li><p><span>$\mathcal{H}_0$</span>, <span>$f_0$</span> and so on are evaluated at the observer position (i.e. at present day);</p></li><li><p><span>$\Delta\chi_1 := \sqrt{\chi_1^2 + s_2^2-2\,\chi_1\,s_2\,y}$</span> and  <span>$\Delta\chi_2 := \sqrt{s_1^2 + \chi_2^2-2\,s_1\,\chi_2\,y}$</span>;</p></li><li><p><span>$s=\sqrt{s_1^2 + s_2^2 - 2 \, s_1 \, s_2 \, y}$</span> and  <span>$\Delta\chi := \sqrt{\chi_1^2 + \chi_2^2-2\,\chi_1\,\chi_2\,y}$</span>.</p></li></ul><p>In this TPCF there are no observer terms. The <code>obs</code> keyword is inserted only for compatibility with  the other GNC TPCFs.</p><p>This function is computed integrating <code>integrand_ξ_GNC_Lensing</code> with <a href="@ref"><code>trapz</code></a> from the  <a href="https://github.com/francescoalemanno/Trapz.jl">Trapz</a> Julia package.</p><p><strong>Inputs</strong></p><ul><li><p><code>P1::Point</code> and <code>P2::Point</code>, or <code>s1</code> and <code>s2</code>: <code>Point</code>/comoving distances where the  TPCF has to be calculated; they contain all the  data of interest needed for this calculus (comoving distance, growth factor and so on).</p></li><li><p><code>y</code>: the cosine of the angle between the two points <code>P1</code> and <code>P2</code> wrt the observer</p></li><li><p><code>cosmo::Cosmology</code>: cosmology to be used in this computation; it contains all the splines used for the conversion <code>s</code> -&gt; <code>Point</code>, and all the cosmological parameters <span>$b$</span>, ...</p></li></ul><p><strong>Keyword Arguments</strong></p><ul><li><p><code>obs::Union{Bool,Symbol} = :noobsvel</code> : do you want to consider the observer terms in the computation of the  chosen GNC TPCF effect?</p><ul><li><code>:yes</code> or <code>true</code> -&gt; all the observer effects will be considered</li><li><code>:no</code> or <code>false</code> -&gt; no observer term will be taken into account</li><li><code>:noobsvel</code> -&gt; the observer terms related to the observer velocity (that you can find in the CF concerning Doppler) will be neglected, the other ones will be taken into account</li></ul></li><li><p><code>en::Float64 = 1e6</code>: just a float number used in order to deal better  with small numbers;</p></li><li><p><code>Δχ_min::Float64 = 1e-4</code> : when  <span>$\Delta\chi = \sqrt{\chi_1^2 + \chi_2^2 - 2 \, \chi_1 \chi_2 y} \to 0^{+}$</span>, some <span>$I_\ell^n$</span> term diverges, but the overall parenthesis has a known limit:</p><p class="math-container">\[    \lim_{\Delta\chi \to 0^{+}} \left(
        J_{00}^{\kappa\kappa} \, I^0_0(\Delta\chi) + 
        J_{02}^{\kappa\kappa} \, I^0_2(\Delta\chi) + 
        J_{31}^{\kappa\kappa} \, I^3_1(\Delta\chi) + 
        J_{22}^{\kappa\kappa} \, I^2_2(\Delta\chi)
    \right) = 
        3 \, \sigma_2 + \frac{6}{5} \, \chi_2^2 \, \sigma_0\]</p><p>So, when it happens that <span>$\Delta\chi &lt; \Delta\chi_\mathrm{min}$</span>, the function considers this limit as the result of the parenthesis instead of calculating it in the normal way; it prevents computational divergences.</p></li><li><p><code>N_χs_2::Int = 100</code>: number of points to be used for sampling the integral along the ranges <code>(0, s1)</code> (for <code>χ1</code>) and <code>(0, s2)</code> (for <code>χ2</code>); it has been checked that with <code>N_χs_2 ≥ 50</code> the result is stable.</p></li></ul><p>See also: <a href="../Cosmology/#GaPSE.Point"><code>Point</code></a>, <a href="../Cosmology/#GaPSE.Cosmology"><code>Cosmology</code></a>, <a href="#GaPSE.ξ_GNC_multipole"><code>ξ_GNC_multipole</code></a>,  <a href="#GaPSE.map_ξ_GNC_multipole"><code>map_ξ_GNC_multipole</code></a>, <a href="#GaPSE.print_map_ξ_GNC_multipole"><code>print_map_ξ_GNC_multipole</code></a>, <a href="#GaPSE.integrand_ξ_GNC_Lensing"><code>integrand_ξ_GNC_Lensing</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cosmofico97/GaPSE/blob/5f3347ff3b074f172d8e3ff7fa715eea30fd3aad/src/GNC_AutoCorrelations/GNC_AutoLensing.jl#L309-L493">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="GaPSE.ξ_GNC_LocalGP" href="#GaPSE.ξ_GNC_LocalGP"><code>GaPSE.ξ_GNC_LocalGP</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs"> ξ_GNC_LocalGP(P1::Point, P2::Point, y, cosmo::Cosmology; 
      obs::Union{Bool, Symbol} = :noobsvel) ::Float64

 ξ_GNC_LocalGP(s1, s2, y, cosmo::Cosmology; 
      kwargs...) ::Float64</code></pre><p>Return the Two-Point Correlation Function (TPCF) of the Local Gravitational Potential (GP) auto-correlation effect arising from the Galaxy Number Counts (GNC).</p><p>In the first method, you should pass the two <code>Point</code> (<code>P1</code> and <code>P2</code>) where to  evaluate the function, while in the second method (that internally recalls the first)  you must provide the two corresponding comoving distances <code>s1</code> and <code>s2</code>. We remember that all the distances are measured in <span>$h_0^{-1}\mathrm{Mpc}$</span>.</p><p>The analytical expression of this term is the following:</p><p class="math-container">\[\begin{split}
    \xi^{\phi\phi}( s_1 , s_2, y ) &amp;= 
    D_1 D_2 J_{40}^{\phi\phi}( s_1, s_2 ) \tilde{I}_0^4 (s) 
    +  D_2 J_{40}^{\phi_0 \phi}(s_1,s_2)  \tilde{I}_0^4 (s_2)
     \\
    &amp;+  D_1 J_{40}^{\phi_0 \phi}(s_2,s_1) \tilde{I}_0^4 (s_1)
     + J_{\sigma4}^{\phi\phi} (s_1, s_2) \sigma_4  \, ,
\end{split}\]</p><p>where</p><p class="math-container">\[\begin{split}
    J_{40}^{\phi\phi} (s_1, s_2)  &amp;= 
    \frac{s^4}{4 a_1 a_2}
    \left[
        2 a_2 f_2 (\mathit{f}_{\mathrm{evo}, 2} - 3) \mathcal{H}_2^2 + 
        3 \mathcal{H}_0^2 \Omega_{\mathrm{M}0} (f_2 + \mathcal{R}_2 + 5 s_{\mathrm{b}, 2} - 2)
    \right] \times
     \\
    &amp;\qquad\qquad
    \left[
        2 a_1 f_1(\mathit{f}_{\mathrm{evo}, 1}-3) \mathcal{H}_1^2 + 
        3 \mathcal{H}_0^2 \Omega_{\mathrm{M}0} (f_1 + \mathcal{R}_1 + 5 s_{\mathrm{b}, 1} - 2)
    \right] 
    \, ,\\
%%%%%%%%%%%%%%%%%
    J_{40}^{\phi_0 \phi}(s_1, s_2) &amp;= 
    \frac{\mathcal{H}_0 s_2^4}{4 s_1 a_2} 
    \left[
        \mathcal{H}_0 s_1 (2 f_0-3 \Omega_{\mathrm{M}0}) \mathcal{R}_1 + 
        2 f_0 (5 s_{\mathrm{b}, 1}-2) 
    \right] \times
     \\
    &amp;\qquad\qquad\left[
        2 a_2 f_2 (\mathit{f}_{\mathrm{evo}, 2} - 3) \mathcal{H}_2^2 + 
        3 \mathcal{H}_0^2 \Omega_{\mathrm{M}0} (f_2 + \mathcal{R}_2 + 5 s_{\mathrm{b}, 2} - 2)
    \right]
    \, , \\
%%%%%%%%%%%%%%%%%%%%
    J_{\sigma 4}(s_1, s_2)&amp;= 
    \frac{\mathcal{H}_0^2 }{4 s_1 s_2}
    \left[
        \mathcal{H}_0 s_1 (2 f_0-3 \Omega_{\mathrm{M}0}) \mathcal{R}_1 + 
        2 f_0(5 s_{\mathrm{b}, 1}-2)
    \right] \times
     \\
    &amp;\qquad\qquad\left[
        3 \Omega_{\mathrm{M}0} \mathcal{H}_0 s_2 \mathcal{R}_2 + 
        2 f_0 (\mathcal{H}_0 s_2 \mathcal{R}_2 + 5 s_{\mathrm{b}, 2} - 2)
    \right]
    \, .
\end{split}\]</p><p>where:</p><ul><li><p><span>$s_1$</span> and <span>$s_2$</span> are comoving distances;</p></li><li><p><span>$D_1 = D(s_1)$</span>, ... is the linear growth factor (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$a_1 = a(s_1)$</span>, ... is the scale factor (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$f_1 = f(s_1)$</span>, ... is the linear growth rate (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$\mathcal{H}_1 = \mathcal{H}(s_1)$</span>, ... is the comoving  Hubble distances (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$y = \cos{\theta} = \hat{\mathbf{s}}_1 \cdot \hat{\mathbf{s}}_2$</span>;</p></li><li><p><span>$\mathcal{R}_1 = \mathcal{R}(s_1)$</span>, ... is  computed by <code>func_ℛ_GNC</code> in <code>cosmo::Cosmology</code> (and evaluated in <span>$s_1$</span> ); the definition of <span>$\mathcal{R}(s)$</span> is the following:</p><p class="math-container">\[\mathcal{R}(s) = 5 s_{\mathrm{b}}(s) + \frac{2 - 5 s_{\mathrm{b}}(s)}{\mathcal{H}(s) \, s} +  
\frac{\dot{\mathcal{H}}(s)}{\mathcal{H}(s)^2} - \mathit{f}_{\mathrm{evo}} \quad ;\]</p></li><li><p><span>$b_1 = b(s_1)$</span>, <span>$s_{\mathrm{b}, 1} = s_{\mathrm{b}}(s_1)$</span>, <span>$\mathit{f}_{\mathrm{evo}}$</span>, ... :  galaxy bias, magnification bias (i.e. the slope of the luminosity function at the luminosity threshold),  and evolution bias (the first two evaluated in <span>$s_1$</span>); they are all stored in <code>cosmo</code>;</p></li><li><p><span>$\Omega_{\mathrm{M}0} = \Omega_{\mathrm{cdm}} + \Omega_{\mathrm{b}}$</span> is the sum of  cold-dark-matter and barionic density parameters (again, stored in <code>cosmo</code>);</p></li><li><p><span>$I_\ell^n$</span> and <span>$\sigma_i$</span> are defined as</p><p class="math-container">\[I_\ell^n(s) = \int_0^{+\infty} \frac{\mathrm{d}q}{2\pi^2} 
\, q^2 \, P(q) \, \frac{j_\ell(qs)}{(qs)^n} \quad , 
\quad \sigma_i = \int_0^{+\infty} \frac{\mathrm{d}q}{2\pi^2} 
\, q^{2-i} \, P(q)\]</p><p>with <span>$P(q)$</span> as the matter Power Spectrum at <span>$z=0$</span> (stored in <code>cosmo</code>)  and <span>$j_\ell$</span> as spherical Bessel function of order <span>$\ell$</span>;</p></li><li><p><span>$\tilde{I}_0^4$</span> is defined as</p><p class="math-container">\[\tilde{I}_0^4 = \int_0^{+\infty} \frac{\mathrm{d}q}{2\pi^2} 
\, q^2 \, P(q) \, \frac{j_0(qs) - 1}{(qs)^4}\]</p><p>with <span>$P(q)$</span> as the matter Power Spectrum at <span>$z=0$</span> (stored in <code>cosmo</code>)  and <span>$j_\ell$</span> as spherical Bessel function of order <span>$\ell$</span>;</p></li><li><p><span>$\mathcal{H}_0$</span>, <span>$f_0$</span> and so on are evaluated at the observer position (i.e. at present day);</p></li><li><p><span>$\Delta\chi_1 := \sqrt{\chi_1^2 + s_2^2-2\,\chi_1\,s_2\,y}$</span> and  <span>$\Delta\chi_2 := \sqrt{s_1^2 + \chi_2^2-2\,s_1\,\chi_2\,y}$</span>;</p></li><li><p><span>$s=\sqrt{s_1^2 + s_2^2 - 2 \, s_1 \, s_2 \, y}$</span> and  <span>$\Delta\chi := \sqrt{\chi_1^2 + \chi_2^2-2\,\chi_1\,\chi_2\,y}$</span>.</p></li></ul><p>In this TPCF, the only non-observer term is the first one (i.e. the bracket proportional to  <span>$D(s_1) \, D(s_2)$</span>), so if you set <code>obs = :no</code> or <code>obs = false</code> that is the only one computed. The other three terms are all observer terms, but not related to the observer velocity, so if you set <code>obs = :noobsvel</code> they will still be computed.</p><p><strong>Inputs</strong></p><ul><li><p><code>P1::Point</code> and <code>P2::Point</code>, or <code>s1</code> and <code>s2</code>: <code>Point</code>/comoving distances where the  TPCF has to be calculated; they contain all the  data of interest needed for this calculus (comoving distance, growth factor and so on).</p></li><li><p><code>y</code>: the cosine of the angle between the two points <code>P1</code> and <code>P2</code> wrt the observer</p></li><li><p><code>cosmo::Cosmology</code>: cosmology to be used in this computation; it contains all the splines used for the conversion <code>s</code> -&gt; <code>Point</code>, and all the cosmological parameters <span>$b$</span>, ...</p></li></ul><p><strong>Keyword Arguments</strong></p><ul><li><code>obs::Union{Bool,Symbol} = :noobsvel</code> : do you want to consider the observer terms in the computation of the  chosen GNC TPCF effect?<ul><li><code>:yes</code> or <code>true</code> -&gt; all the observer effects will be considered</li><li><code>:no</code> or <code>false</code> -&gt; no observer term will be taken into account</li><li><code>:noobsvel</code> -&gt; the observer terms related to the observer velocity (that you can find in the CF concerning Doppler) will be neglected, the other ones will be taken into account</li></ul></li></ul><p>See also: <a href="../Cosmology/#GaPSE.Point"><code>Point</code></a>, <a href="../Cosmology/#GaPSE.Cosmology"><code>Cosmology</code></a>, <a href="#GaPSE.ξ_GNC_multipole"><code>ξ_GNC_multipole</code></a>,  <a href="#GaPSE.map_ξ_GNC_multipole"><code>map_ξ_GNC_multipole</code></a>, <a href="#GaPSE.print_map_ξ_GNC_multipole"><code>print_map_ξ_GNC_multipole</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cosmofico97/GaPSE/blob/5f3347ff3b074f172d8e3ff7fa715eea30fd3aad/src/GNC_AutoCorrelations/GNC_AutoLocalGP.jl#L81-L239">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="GaPSE.ξ_GNC_IntegratedGP" href="#GaPSE.ξ_GNC_IntegratedGP"><code>GaPSE.ξ_GNC_IntegratedGP</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs"> ξ_GNC_IntegratedGP(
      P1::Point, P2::Point, y, cosmo::Cosmology;
      en::Float64=1e10, N_χs_2::Int=100, 
      obs::Union{Bool,Symbol}=:noobsvel
      ) ::Float64

 ξ_GNC_IntegratedGP(s1, s2, y, cosmo::Cosmology; 
      kwargs...) ::Float64</code></pre><p>Return the Two-Point Correlation Function (TPCF) of the Integrated Gravitational Potential (GP) auto-correlation effect arising from the Galaxy Number Counts (GNC).</p><p>In the first method, you should pass the two <code>Point</code> (<code>P1</code> and <code>P2</code>) where to  evaluate the function, while in the second method (that internally recalls the first)  you must provide the two corresponding comoving distances <code>s1</code> and <code>s2</code>. We remember that all the distances are measured in <span>$h_0^{-1}\mathrm{Mpc}$</span>.</p><p>The analytical expression of this term is the following:</p><p class="math-container">\[\begin{split}
    \xi^{\int\!\phi \int \!\phi }( s_1 , s_2, y ) = 
    \int_0^{s_1}\mathrm{d} \chi_1  \int_0^{s_2}\mathrm{d} \chi_2 \;  
    J^{\int \!\phi \int \!\phi}_{40} 
    \tilde{I}_0^4 ( \Delta\chi) \, , 
\end{split}\]</p><p>where</p><p class="math-container">\[\begin{split}
    J^{\int \!\phi\int \!\phi}_{40} =
    \frac{
        9 \Delta\chi ^4 \mathcal{H}_0^4 \Omega_{\mathrm{M},  0}^2 D(\chi_1) D(\chi_2)
    }{
        a(\chi_1) a(\chi_2) s_1 s_2
    }
    &amp;\left[
        s_1 (f(\chi_1) - 1) \mathcal{H}(\chi_1) \mathcal{R}_1 - 5 s_{\mathrm{b},  1} + 2
    \right] \times
    \nonumber \\
    &amp;\left[
        s_2 (f(\chi_2) - 1) \mathcal{H}(\chi_2) \mathcal{R}_2 - 5 s_{\mathrm{b},  2} + 2
    \right]
    \, .
\end{split}\]</p><p>where:</p><ul><li><p><span>$s_1$</span> and <span>$s_2$</span> are comoving distances;</p></li><li><p><span>$D_1 = D(s_1)$</span>, ... is the linear growth factor (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$a_1 = a(s_1)$</span>, ... is the scale factor (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$f_1 = f(s_1)$</span>, ... is the linear growth rate (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$\mathcal{H}_1 = \mathcal{H}(s_1)$</span>, ... is the comoving  Hubble distances (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$y = \cos{\theta} = \hat{\mathbf{s}}_1 \cdot \hat{\mathbf{s}}_2$</span>;</p></li><li><p><span>$\mathcal{R}_1 = \mathcal{R}(s_1)$</span>, ... is  computed by <code>func_ℛ_GNC</code> in <code>cosmo::Cosmology</code> (and evaluated in <span>$s_1$</span> ); the definition of <span>$\mathcal{R}(s)$</span> is the following:</p><p class="math-container">\[\mathcal{R}(s) = 5 s_{\mathrm{b}}(s) + \frac{2 - 5 s_{\mathrm{b}}(s)}{\mathcal{H}(s) \, s} +  
\frac{\dot{\mathcal{H}}(s)}{\mathcal{H}(s)^2} - \mathit{f}_{\mathrm{evo}} \quad ;\]</p></li><li><p><span>$b_1 = b(s_1)$</span>, <span>$s_{\mathrm{b}, 1} = s_{\mathrm{b}}(s_1)$</span>, <span>$\mathit{f}_{\mathrm{evo}}$</span>, ... :  galaxy bias, magnification bias (i.e. the slope of the luminosity function at the luminosity threshold),  and evolution bias (the first two evaluated in <span>$s_1$</span>); they are all stored in <code>cosmo</code>;</p></li><li><p><span>$\Omega_{\mathrm{M}0} = \Omega_{\mathrm{cdm}} + \Omega_{\mathrm{b}}$</span> is the sum of  cold-dark-matter and barionic density parameters (again, stored in <code>cosmo</code>);</p></li><li><p><span>$I_\ell^n$</span> and <span>$\sigma_i$</span> are defined as</p><p class="math-container">\[I_\ell^n(s) = \int_0^{+\infty} \frac{\mathrm{d}q}{2\pi^2} 
\, q^2 \, P(q) \, \frac{j_\ell(qs)}{(qs)^n} \quad , 
\quad \sigma_i = \int_0^{+\infty} \frac{\mathrm{d}q}{2\pi^2} 
\, q^{2-i} \, P(q)\]</p><p>with <span>$P(q)$</span> as the matter Power Spectrum at <span>$z=0$</span> (stored in <code>cosmo</code>)  and <span>$j_\ell$</span> as spherical Bessel function of order <span>$\ell$</span>;</p></li><li><p><span>$\mathcal{H}_0$</span>, <span>$f_0$</span> and so on are evaluated at the observer position (i.e. at present day);</p></li><li><p><span>$\Delta\chi_1 := \sqrt{\chi_1^2 + s_2^2-2\,\chi_1\,s_2\,y}$</span> and  <span>$\Delta\chi_2 := \sqrt{s_1^2 + \chi_2^2-2\,s_1\,\chi_2\,y}$</span>;</p></li><li><p><span>$s=\sqrt{s_1^2 + s_2^2 - 2 \, s_1 \, s_2 \, y}$</span> and  <span>$\Delta\chi := \sqrt{\chi_1^2 + \chi_2^2-2\,\chi_1\,\chi_2\,y}$</span>.</p></li></ul><p>In this TPCF there are no observer terms. The <code>obs</code> keyword is inserted only for compatibility with  the other GNC TPCFs.</p><p>This function is computed integrating <code>integrand_ξ_GNC_IntegratedGP</code> with <a href="@ref"><code>trapz</code></a> from the  <a href="https://github.com/francescoalemanno/Trapz.jl">Trapz</a> Julia package.</p><p><strong>Inputs</strong></p><ul><li><p><code>P1::Point</code> and <code>P2::Point</code>, or <code>s1</code> and <code>s2</code>: <code>Point</code>/comoving distances where the  TPCF has to be calculated; they contain all the  data of interest needed for this calculus (comoving distance, growth factor and so on).</p></li><li><p><code>y</code>: the cosine of the angle between the two points <code>P1</code> and <code>P2</code> wrt the observer</p></li><li><p><code>cosmo::Cosmology</code>: cosmology to be used in this computation; it contains all the splines used for the conversion <code>s</code> -&gt; <code>Point</code>, and all the cosmological parameters <span>$b$</span>, ...</p></li></ul><p><strong>Keyword Arguments</strong></p><ul><li><p><code>obs::Union{Bool,Symbol} = :noobsvel</code> : do you want to consider the observer terms in the computation of the  chosen GNC TPCF effect?</p><ul><li><code>:yes</code> or <code>true</code> -&gt; all the observer effects will be considered</li><li><code>:no</code> or <code>false</code> -&gt; no observer term will be taken into account</li><li><code>:noobsvel</code> -&gt; the observer terms related to the observer velocity (that you can find in the CF concerning Doppler) will be neglected, the other ones will be taken into account</li></ul></li><li><p><code>en::Float64 = 1e6</code>: just a float number used in order to deal better  with small numbers;</p></li><li><p><code>N_χs_2::Int = 100</code>: number of points to be used for sampling the integral along the ranges <code>(0, s1)</code> (for <code>χ1</code>) and <code>(0, s2)</code> (for <code>χ2</code>); it has been checked that with <code>N_χs_2 ≥ 50</code> the result is stable.</p></li></ul><p>See also: <a href="../Cosmology/#GaPSE.Point"><code>Point</code></a>, <a href="../Cosmology/#GaPSE.Cosmology"><code>Cosmology</code></a>, <a href="#GaPSE.ξ_GNC_multipole"><code>ξ_GNC_multipole</code></a>,  <a href="#GaPSE.map_ξ_GNC_multipole"><code>map_ξ_GNC_multipole</code></a>, <a href="#GaPSE.print_map_ξ_GNC_multipole"><code>print_map_ξ_GNC_multipole</code></a>, <a href="#GaPSE.integrand_ξ_GNC_IntegratedGP"><code>integrand_ξ_GNC_IntegratedGP</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cosmofico97/GaPSE/blob/5f3347ff3b074f172d8e3ff7fa715eea30fd3aad/src/GNC_AutoCorrelations/GNC_AutoIntegratedGP.jl#L260-L397">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="GaPSE.integrand_ξ_GNC_Lensing" href="#GaPSE.integrand_ξ_GNC_Lensing"><code>GaPSE.integrand_ξ_GNC_Lensing</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs"> integrand_ξ_GNC_Lensing(
       IP1::Point, IP2::Point,
       P1::Point, P2::Point,
       y, cosmo::Cosmology;
       Δχ_min::Float64=1e-1, 
       obs::Union{Bool,Symbol}=:noobsvel
       ) ::Float64

 integrand_ξ_GNC_Lensing(
       χ1::Float64, χ2::Float64,
       s1::Float64, s2::Float64,
       y, cosmo::Cosmology;
       kwargs... )::Float64</code></pre><p>Return the integrand of the Two-Point Correlation Function (TPCF) of the  Lensing auto-correlation effect arising from the Galaxy Number Counts (GNC).</p><p>In the first method, you should pass the two extreme <code>Point</code>s (<code>P1</code> and <code>P2</code>) and the two  intermediate integrand <code>Point</code>s (<code>IP1</code> and <code>IP2</code>) where to  evaluate the function. In the second method (that internally recalls the first), you must provide the four corresponding comoving distances <code>s1</code>, <code>s2</code>, <code>χ1</code>, <code>χ2</code>. We remember that all the distances are measured in <span>$h_0^{-1}\mathrm{Mpc}$</span>.</p><p>The analytical expression of this integrand is the following:</p><p class="math-container">\[\begin{equation}
    f^{\kappa\kappa} (\chi_1, \chi_2, s_1, s_2, y) = 
    J^{\kappa\kappa}_{\alpha}
    \left[
        J^{\kappa\kappa}_{00} I_0^0(\Delta\chi) + 
        J^{\kappa\kappa}_{02} I_2^0(\Delta\chi) +
        J^{\kappa\kappa}_{31} I_1^3(\Delta\chi) +
        J^{\kappa\kappa}_{22} I_2^2(\Delta\chi)
    \right]  \, , 
\end{equation}\]</p><p>where</p><p class="math-container">\[\begin{split}
    J^{\kappa\kappa}_{\alpha} &amp; = 
    \frac{
        \mathcal{H}_0^4 \Omega_{\mathrm{M}0}^2 D(\chi_1) D(\chi_2) 
    }{
        s_1 s_2 a(\chi_1) a(\chi_2)}
    (\chi_1 - s_1)(\chi_2 - s_2)
    (5 s_{\mathrm{b}, 1} - 2)(5 s_{\mathrm{b}, 2} - 2) 
    \, , \\
    %%%%&amp;%%%%%%%%%%%%%
    J^{\kappa\kappa}_{00} &amp; = 
    -\frac{ 3 \chi_1^2 \chi_2^2}{4 \Delta\chi^4} (y^2 - 1)
    \left[
        8 y (\chi_1^2 + \chi_2^2) - 9\chi_1\chi_2y^2 - 
        7\chi_1\chi_2
    \right] 
    \, , \\
    %%%%&amp;%%%%%%%%%%%%%
    J^{\kappa\kappa}_{02} &amp; = 
    -\frac{ 3 \chi_1^2 \chi_2^2}{2 \Delta\chi^4}(y^2 - 1)
    \left[
        4 y (\chi_1^2 + \chi_2^2) - 3 \chi_1 \chi_2 y^2 -
        5 \chi_1 \chi_2
    \right] 
    \, , \\
    %%%%%%%%%%%%%%%%%%
    J^{\kappa\kappa}_{31} &amp; = 9 y \Delta\chi^2 
    \, , \\
    %%%%%%%%%%%%%%%%%%
    J^{\kappa\kappa}_{22} &amp; = 
    \frac{9 \chi_1 \chi_2}{4 \Delta\chi^4}
    \left[
        2(\chi_1^4 + \chi_2^4)(7 y^2 - 3) - 
        16 y \chi_1 \chi_2 (\chi_1^2 + \chi_2^2)(y^2 + 1) + 
        \right.\\
        &amp;\left.\qquad\qquad\qquad
        \chi_1^2 \chi_2^2 (11y^4 + 14y^2 + 23) 
    \right] 
    \, .
\end{split}\]</p><p>where:</p><ul><li><p><span>$s_1$</span> and <span>$s_2$</span> are comoving distances;</p></li><li><p><span>$D_1 = D(s_1)$</span>, ... is the linear growth factor (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$a_1 = a(s_1)$</span>, ... is the scale factor (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$f_1 = f(s_1)$</span>, ... is the linear growth rate (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$\mathcal{H}_1 = \mathcal{H}(s_1)$</span>, ... is the comoving  Hubble distances (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$y = \cos{\theta} = \hat{\mathbf{s}}_1 \cdot \hat{\mathbf{s}}_2$</span>;</p></li><li><p><span>$\mathcal{R}_1 = \mathcal{R}(s_1)$</span>, ... is  computed by <code>func_ℛ_GNC</code> in <code>cosmo::Cosmology</code> (and evaluated in <span>$s_1$</span> ); the definition of <span>$\mathcal{R}(s)$</span> is the following:</p><p class="math-container">\[\mathcal{R}(s) = 5 s_{\mathrm{b}}(s) + \frac{2 - 5 s_{\mathrm{b}}(s)}{\mathcal{H}(s) \, s} +  
\frac{\dot{\mathcal{H}}(s)}{\mathcal{H}(s)^2} - \mathit{f}_{\mathrm{evo}} \quad ;\]</p></li><li><p><span>$b_1 = b(s_1)$</span>, <span>$s_{\mathrm{b}, 1} = s_{\mathrm{b}}(s_1)$</span>, <span>$\mathit{f}_{\mathrm{evo}}$</span>, ... :  galaxy bias, magnification bias (i.e. the slope of the luminosity function at the luminosity threshold),  and evolution bias (the first two evaluated in <span>$s_1$</span>); they are all stored in <code>cosmo</code>;</p></li><li><p><span>$\Omega_{\mathrm{M}0} = \Omega_{\mathrm{cdm}} + \Omega_{\mathrm{b}}$</span> is the sum of  cold-dark-matter and barionic density parameters (again, stored in <code>cosmo</code>);</p></li><li><p><span>$I_\ell^n$</span> and <span>$\sigma_i$</span> are defined as</p><p class="math-container">\[I_\ell^n(s) = \int_0^{+\infty} \frac{\mathrm{d}q}{2\pi^2} 
\, q^2 \, P(q) \, \frac{j_\ell(qs)}{(qs)^n} \quad , 
\quad \sigma_i = \int_0^{+\infty} \frac{\mathrm{d}q}{2\pi^2} 
\, q^{2-i} \, P(q)\]</p><p>with <span>$P(q)$</span> as the matter Power Spectrum at <span>$z=0$</span> (stored in <code>cosmo</code>)  and <span>$j_\ell$</span> as spherical Bessel function of order <span>$\ell$</span>;</p></li><li><p><span>$\tilde{I}_0^4$</span> is defined as</p><p class="math-container">\[\tilde{I}_0^4 = \int_0^{+\infty} \frac{\mathrm{d}q}{2\pi^2} 
\, q^2 \, P(q) \, \frac{j_0(qs) - 1}{(qs)^4}\]</p><p>with <span>$P(q)$</span> as the matter Power Spectrum at <span>$z=0$</span> (stored in <code>cosmo</code>)  and <span>$j_\ell$</span> as spherical Bessel function of order <span>$\ell$</span>;</p></li><li><p><span>$\mathcal{H}_0$</span>, <span>$f_0$</span> and so on are evaluated at the observer position (i.e. at present day);</p></li><li><p><span>$\Delta\chi_1 := \sqrt{\chi_1^2 + s_2^2-2\,\chi_1\,s_2\,y}$</span> and  <span>$\Delta\chi_2 := \sqrt{s_1^2 + \chi_2^2-2\,s_1\,\chi_2\,y}$</span>;</p></li><li><p><span>$s=\sqrt{s_1^2 + s_2^2 - 2 \, s_1 \, s_2 \, y}$</span> and  <span>$\Delta\chi := \sqrt{\chi_1^2 + \chi_2^2-2\,\chi_1\,\chi_2\,y}$</span>.</p></li></ul><p>In this TPCF there are no observer terms. The <code>obs</code> keyword is inserted only for compatibility with  the other GNC TPCFs.</p><p>This function is used inside <code>ξ_GNC_Lensing</code> with <a href="@ref"><code>trapz</code></a> from the  <a href="https://github.com/francescoalemanno/Trapz.jl">Trapz</a> Julia package.</p><p><strong>Inputs</strong></p><ul><li><p><code>IP1::Point</code>, <code>IP2::Point</code>, <code>P1::Point</code>, <code>P2::Point</code> or <code>χ1</code>, <code>χ2</code>, <code>s1</code>, <code>s2</code>: <code>Point</code>/comoving  distances where the TPCF has to be calculated; they contain all the  data of interest needed for this calculus (comoving distance, growth factor and so on).</p></li><li><p><code>y</code>: the cosine of the angle between the two points <code>P1</code> and <code>P2</code> wrt the observer</p></li><li><p><code>cosmo::Cosmology</code>: cosmology to be used in this computation; it contains all the splines used for the conversion <code>s</code> -&gt; <code>Point</code>, and all the cosmological parameters <span>$b$</span>, ...</p></li></ul><p><strong>Keyword Arguments</strong></p><ul><li><p><code>obs::Union{Bool,Symbol} = :noobsvel</code> : do you want to consider the observer terms in the computation of the  chosen GNC TPCF effect?</p><ul><li><code>:yes</code> or <code>true</code> -&gt; all the observer effects will be considered</li><li><code>:no</code> or <code>false</code> -&gt; no observer term will be taken into account</li><li><code>:noobsvel</code> -&gt; the observer terms related to the observer velocity (that you can find in the CF concerning Doppler) will be neglected, the other ones will be taken into account</li></ul></li><li><p><code>Δχ_min::Float64 = 1e-4</code> : when  <span>$\Delta\chi = \sqrt{\chi_1^2 + \chi_2^2 - 2 \, \chi_1 \chi_2 y} \to 0^{+}$</span>, some <span>$I_\ell^n$</span> term diverges, but the overall parenthesis has a known limit:</p><p class="math-container">\[    \lim_{\Delta\chi \to 0^{+}} \left(
        J_{00}^{\kappa\kappa} \, I^0_0(\Delta\chi) + 
        J_{02}^{\kappa\kappa} \, I^0_2(\Delta\chi) + 
        J_{31}^{\kappa\kappa} \, I^3_1(\Delta\chi) + 
        J_{22}^{\kappa\kappa} \, I^2_2(\Delta\chi)
    \right) = 
        3 \, \sigma_2 + \frac{6}{5} \, \chi_2^2 \, \sigma_0\]</p><p>So, when it happens that <span>$\Delta\chi &lt; \Delta\chi_\mathrm{min}$</span>, the function considers this limit as the result of the parenthesis instead of calculating it in the normal way; it prevents computational divergences.</p></li></ul><p>See also: <a href="../Cosmology/#GaPSE.Point"><code>Point</code></a>, <a href="../Cosmology/#GaPSE.Cosmology"><code>Cosmology</code></a>, <a href="#GaPSE.ξ_GNC_multipole"><code>ξ_GNC_multipole</code></a>,  <a href="#GaPSE.map_ξ_GNC_multipole"><code>map_ξ_GNC_multipole</code></a>, <a href="#GaPSE.print_map_ξ_GNC_multipole"><code>print_map_ξ_GNC_multipole</code></a>, <a href="#GaPSE.ξ_GNC_Lensing"><code>ξ_GNC_Lensing</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cosmofico97/GaPSE/blob/5f3347ff3b074f172d8e3ff7fa715eea30fd3aad/src/GNC_AutoCorrelations/GNC_AutoLensing.jl#L84-L273">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="GaPSE.integrand_ξ_GNC_IntegratedGP" href="#GaPSE.integrand_ξ_GNC_IntegratedGP"><code>GaPSE.integrand_ξ_GNC_IntegratedGP</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs"> integrand_ξ_GNC_IntegratedGP(
      IP1::Point, IP2::Point,
      P1::Point, P2::Point,
      y, cosmo::Cosmology; 
      obs::Union{Bool,Symbol}=:noobsvel
      ) ::Float64

 integrand_ξ_GNC_IntegratedGP(
      χ1::Float64, χ2::Float64,
      s1::Float64, s2::Float64,
      y, cosmo::Cosmology;
      kwargs...) ::Float64</code></pre><p>Return the integrand of the Two-Point Correlation Function (TPCF) of the  Integrated Gravitational Potential (GP) auto-correlation effect  arising from the Galaxy Number Counts (GNC).</p><p>In the first method, you should pass the two extreme <code>Point</code>s (<code>P1</code> and <code>P2</code>) and the two  intermediate integrand <code>Point</code>s (<code>IP1</code> and <code>IP2</code>) where to  evaluate the function. In the second method (that internally recalls the first), you must provide the four corresponding comoving distances <code>s1</code>, <code>s2</code>, <code>χ1</code>, <code>χ2</code>. We remember that all the distances are measured in <span>$h_0^{-1}\mathrm{Mpc}$</span>.</p><p>The analytical expression of this integrand is the following:</p><p class="math-container">\[\begin{equation}
    f^{\int \!\phi\int \!\phi} (\chi_1, \chi_2, s_1, s_2, y) = 
    J^{\int \!\phi \int \!\phi}_{40} 
    \tilde{I}_0^4 ( \Delta\chi) \, , 
\end{equation}\]</p><p>where</p><p class="math-container">\[\begin{split}
    J^{\int \!\phi\int \!\phi}_{40} =
    \frac{
        9 \Delta\chi ^4 \mathcal{H}_0^4 \Omega_{\mathrm{M}0}^2 D(\chi_1) D(\chi_2)
    }{
        a(\chi_1) a(\chi_2) s_1 s_2
    }
    &amp;\left[
        s_1 (f(\chi_1) - 1) \mathcal{H}(\chi_1) \mathcal{R}_1 - 5 s_{\mathrm{b}, 1} + 2
    \right] \times
    \nonumber \\
    &amp;\left[
        s_2 (f(\chi_2) - 1) \mathcal{H}(\chi_2) \mathcal{R}_2 - 5 s_{\mathrm{b}, 2} + 2
    \right]
    \, .
\end{split}\]</p><p>where:</p><ul><li><p><span>$s_1$</span> and <span>$s_2$</span> are comoving distances;</p></li><li><p><span>$D_1 = D(s_1)$</span>, ... is the linear growth factor (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$a_1 = a(s_1)$</span>, ... is the scale factor (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$f_1 = f(s_1)$</span>, ... is the linear growth rate (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$\mathcal{H}_1 = \mathcal{H}(s_1)$</span>, ... is the comoving  Hubble distances (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$y = \cos{\theta} = \hat{\mathbf{s}}_1 \cdot \hat{\mathbf{s}}_2$</span>;</p></li><li><p><span>$\mathcal{R}_1 = \mathcal{R}(s_1)$</span>, ... is  computed by <code>func_ℛ_GNC</code> in <code>cosmo::Cosmology</code> (and evaluated in <span>$s_1$</span> ); the definition of <span>$\mathcal{R}(s)$</span> is the following:</p><p class="math-container">\[\mathcal{R}(s) = 5 s_{\mathrm{b}}(s) + \frac{2 - 5 s_{\mathrm{b}}(s)}{\mathcal{H}(s) \, s} +  
\frac{\dot{\mathcal{H}}(s)}{\mathcal{H}(s)^2} - \mathit{f}_{\mathrm{evo}} \quad ;\]</p></li><li><p><span>$b_1 = b(s_1)$</span>, <span>$s_{\mathrm{b}, 1} = s_{\mathrm{b}}(s_1)$</span>, <span>$\mathit{f}_{\mathrm{evo}}$</span>, ... :  galaxy bias, magnification bias (i.e. the slope of the luminosity function at the luminosity threshold),  and evolution bias (the first two evaluated in <span>$s_1$</span>); they are all stored in <code>cosmo</code>;</p></li><li><p><span>$\Omega_{\mathrm{M}0} = \Omega_{\mathrm{cdm}} + \Omega_{\mathrm{b}}$</span> is the sum of  cold-dark-matter and barionic density parameters (again, stored in <code>cosmo</code>);</p></li><li><p><span>$I_\ell^n$</span> and <span>$\sigma_i$</span> are defined as</p><p class="math-container">\[I_\ell^n(s) = \int_0^{+\infty} \frac{\mathrm{d}q}{2\pi^2} 
\, q^2 \, P(q) \, \frac{j_\ell(qs)}{(qs)^n} \quad , 
\quad \sigma_i = \int_0^{+\infty} \frac{\mathrm{d}q}{2\pi^2} 
\, q^{2-i} \, P(q)\]</p><p>with <span>$P(q)$</span> as the matter Power Spectrum at <span>$z=0$</span> (stored in <code>cosmo</code>)  and <span>$j_\ell$</span> as spherical Bessel function of order <span>$\ell$</span>;</p></li><li><p><span>$\tilde{I}_0^4$</span> is defined as</p><p class="math-container">\[\tilde{I}_0^4 = \int_0^{+\infty} \frac{\mathrm{d}q}{2\pi^2} 
\, q^2 \, P(q) \, \frac{j_0(qs) - 1}{(qs)^4}\]</p><p>with <span>$P(q)$</span> as the matter Power Spectrum at <span>$z=0$</span> (stored in <code>cosmo</code>)  and <span>$j_\ell$</span> as spherical Bessel function of order <span>$\ell$</span>;</p></li><li><p><span>$\mathcal{H}_0$</span>, <span>$f_0$</span> and so on are evaluated at the observer position (i.e. at present day);</p></li><li><p><span>$\Delta\chi_1 := \sqrt{\chi_1^2 + s_2^2-2\,\chi_1\,s_2\,y}$</span> and  <span>$\Delta\chi_2 := \sqrt{s_1^2 + \chi_2^2-2\,s_1\,\chi_2\,y}$</span>;</p></li><li><p><span>$s=\sqrt{s_1^2 + s_2^2 - 2 \, s_1 \, s_2 \, y}$</span> and  <span>$\Delta\chi := \sqrt{\chi_1^2 + \chi_2^2-2\,\chi_1\,\chi_2\,y}$</span>.</p></li></ul><p>In this TPCF there are no observer terms. The <code>obs</code> keyword is inserted only for compatibility with  the other GNC TPCFs.</p><p>This function is used inside <code>ξ_GNC_IntegratedGP</code> with <a href="@ref"><code>trapz</code></a> from the  <a href="https://github.com/francescoalemanno/Trapz.jl">Trapz</a> Julia package.</p><p><strong>Inputs</strong></p><ul><li><p><code>IP1::Point</code>, <code>IP2::Point</code>, <code>P1::Point</code>, <code>P2::Point</code> or <code>χ1</code>, <code>χ2</code>, <code>s1</code>, <code>s2</code>: <code>Point</code>/comoving  distances where the TPCF has to be calculated; they contain all the  data of interest needed for this calculus (comoving distance, growth factor and so on).</p></li><li><p><code>y</code>: the cosine of the angle between the two points <code>P1</code> and <code>P2</code> wrt the observer</p></li><li><p><code>cosmo::Cosmology</code>: cosmology to be used in this computation; it contains all the splines used for the conversion <code>s</code> -&gt; <code>Point</code>, and all the cosmological parameters <span>$b$</span>, ...</p></li></ul><p><strong>Keyword Arguments</strong></p><ul><li><code>obs::Union{Bool,Symbol} = :noobsvel</code> : do you want to consider the observer terms in the computation of the  chosen GNC TPCF effect?<ul><li><code>:yes</code> or <code>true</code> -&gt; all the observer effects will be considered</li><li><code>:no</code> or <code>false</code> -&gt; no observer term will be taken into account</li><li><code>:noobsvel</code> -&gt; the observer terms related to the observer velocity (that you can find in the CF concerning Doppler) will be neglected, the other ones will be taken into account</li></ul></li></ul><p>See also: <a href="../Cosmology/#GaPSE.Point"><code>Point</code></a>, <a href="../Cosmology/#GaPSE.Cosmology"><code>Cosmology</code></a>, <a href="#GaPSE.ξ_GNC_multipole"><code>ξ_GNC_multipole</code></a>,  <a href="#GaPSE.map_ξ_GNC_multipole"><code>map_ξ_GNC_multipole</code></a>, <a href="#GaPSE.print_map_ξ_GNC_multipole"><code>print_map_ξ_GNC_multipole</code></a>, <a href="#GaPSE.ξ_GNC_IntegratedGP"><code>ξ_GNC_IntegratedGP</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cosmofico97/GaPSE/blob/5f3347ff3b074f172d8e3ff7fa715eea30fd3aad/src/GNC_AutoCorrelations/GNC_AutoIntegratedGP.jl#L57-L200">source</a></section></article><h1 id="Two-Point-Cross-Correlation-Functions"><a class="docs-heading-anchor" href="#Two-Point-Cross-Correlation-Functions">Two-Point Cross-Correlation Functions</a><a id="Two-Point-Cross-Correlation-Functions-1"></a><a class="docs-heading-anchor-permalink" href="#Two-Point-Cross-Correlation-Functions" title="Permalink"></a></h1><article class="docstring"><header><a class="docstring-binding" id="GaPSE.ξ_GNC_Newtonian_Doppler" href="#GaPSE.ξ_GNC_Newtonian_Doppler"><code>GaPSE.ξ_GNC_Newtonian_Doppler</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs"> ξ_GNC_Newtonian_Doppler(
      P1::Point, P2::Point, y, cosmo::Cosmology; 
      obs::Union{Bool, Symbol} = :noobsvel
      ) ::Float64

 ξ_GNC_Newtonian_Doppler(s1, s2, y, cosmo::Cosmology;
      kwargs...) ::Float64</code></pre><p>Return the Two-Point Correlation Function (TPCF) given by the cross correlation between the  Newtonian and the Doppler effects arising from the Galaxy Number Counts (GNC).</p><p>In the first method, you should pass the two <code>Point</code> (<code>P1</code> and <code>P2</code>) where to  evaluate the function, while in the second method (that internally recalls the first)  you must provide the two corresponding comoving distances <code>s1</code> and <code>s2</code>. We remember that all the distances are measured in <span>$h_0^{-1}\mathrm{Mpc}$</span>.</p><p>The analytical expression of this term is the following:</p><p class="math-container">\[\begin{split}
    \xi^{\delta v_{\parallel}}( s_1 , s_2, y ) &amp;= 
    D_1 D_2 J^{\delta v_{\parallel}}_{\alpha} \left[ 
        J^{\delta v_{\parallel}}_{00} I^0_{0} (s) + 
        J^{\delta v_{\parallel}}_{02} I^0_2 (s) +
        J^{\delta v_{\parallel}}_{04} I^0_4 (s) 
        \right]\nonumber \\
    &amp;+ D_1 J^{\delta v_{\parallel}}_{\beta} \left[ 
        J^{\delta v_{\parallel}}_{11} I^1_{1} (s_1) + 
        J^{\delta v_{\parallel}}_{13} I^1_{3} (s_1) 
    \right]
\end{split}\]</p><p>where</p><p class="math-container">\[\begin{split}
    J^{\delta v_{\parallel}}_{\alpha} &amp;= f_2 \mathcal{H}_2 \mathcal{R}_2
    \, , \\
    %%%%%%%%%%%%%%%%%%%%%
    J^{\delta v_{\parallel}}_{\beta} &amp;= 
    y f_0 \mathcal{H}_0 s_1 (\mathcal{R}_2 - 5s_{\mathrm{b}, 2}  + 2)
    \, , \\
    %%%%%%%%%%%%%%%%%%%%%
    J^{\delta v_{\parallel}}_{00} &amp;=
    \frac{1}{15} \left\{
        s_2 \left[ 5 b_1 + (2 y^2 + 1) f_1 \right] -
        y s_1 \left[ 3 f_1 + 5 b_1 \right]
    \right\} 
    \, , \\
    %%%%%%%%%%%%%%%%%%%%%
    J^{\delta v_{\parallel}}_{02} &amp;=
    \frac{1}{21 s^2} 
    \left\{ 
        \left[
            (y^2 + 1) f_1 + 7 b_1
        \right] s_2^3 -
        y \left[
            21 b_1 + (5 y^2 + 4) f_1 
        \right] s_1 s_2^2 +
        \right.\nonumber \\
        &amp;\left. \qquad \qquad
        \left[
            7 (2 y^2 + 1) b_1 + (10 y^2 - 1) f_1
        \right] s_1^2 s_2 -
        y \left[
            7 b_1 + 3 f_1
        \right] s_1^3
    \right\}
    \, , \\
    %%%%%%%%%%%%%%%%%%%%%
    J^{\delta v_{\parallel}}_{04} &amp;=
    \frac{f_1}{35 s^2} 
    \left[
        2 y s_1 ^3
        - 2 (y^2 + 2) s_1 ^2 s_2 +
        y (y^2 + 5) s_1 s_2^2 +
        (1 - 3 y^2) s_2 ^3
    \right] 
    \, , \\
    %%%%%%%%%%%%%%%%%%%%%
    J^{\delta v_{\parallel}}_{11} &amp;= \frac{1}{5} (5b_1+3 f_1 )  
    \, , \\
    %%%%%%%%%%%%%%%%%%%%%
    J^{\delta v_{\parallel}}_{13} &amp;= -\frac{2}{5} f_1 
    \, .
\end{split}\]</p><p>where:</p><ul><li><p><span>$s_1$</span> and <span>$s_2$</span> are comoving distances;</p></li><li><p><span>$D_1 = D(s_1)$</span>, ... is the linear growth factor (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$a_1 = a(s_1)$</span>, ... is the scale factor (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$f_1 = f(s_1)$</span>, ... is the linear growth rate (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$\mathcal{H}_1 = \mathcal{H}(s_1)$</span>, ... is the comoving  Hubble distances (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$y = \cos{\theta} = \hat{\mathbf{s}}_1 \cdot \hat{\mathbf{s}}_2$</span>;</p></li><li><p><span>$\mathcal{R}_1 = \mathcal{R}(s_1)$</span>, ... is  computed by <code>func_ℛ_GNC</code> in <code>cosmo::Cosmology</code> (and evaluated in <span>$s_1$</span> ); the definition of <span>$\mathcal{R}(s)$</span> is the following:</p><p class="math-container">\[\mathcal{R}(s) = 5 s_{\mathrm{b}}(s) + \frac{2 - 5 s_{\mathrm{b}}(s)}{\mathcal{H}(s) \, s} +  
\frac{\dot{\mathcal{H}}(s)}{\mathcal{H}(s)^2} - \mathit{f}_{\mathrm{evo}} \quad ;\]</p></li><li><p><span>$b_1 = b(s_1)$</span>, <span>$s_{\mathrm{b}, 1} = s_{\mathrm{b}}(s_1)$</span>, <span>$\mathit{f}_{\mathrm{evo}}$</span>, ... :  galaxy bias, magnification bias (i.e. the slope of the luminosity function at the luminosity threshold),  and evolution bias (the first two evaluated in <span>$s_1$</span>); they are all stored in <code>cosmo</code>;</p></li><li><p><span>$\Omega_{\mathrm{M}0} = \Omega_{\mathrm{cdm}} + \Omega_{\mathrm{b}}$</span> is the sum of  cold-dark-matter and barionic density parameters (again, stored in <code>cosmo</code>);</p></li><li><p><span>$I_\ell^n$</span> and <span>$\sigma_i$</span> are defined as</p><p class="math-container">\[I_\ell^n(s) = \int_0^{+\infty} \frac{\mathrm{d}q}{2\pi^2} 
\, q^2 \, P(q) \, \frac{j_\ell(qs)}{(qs)^n} \quad , 
\quad \sigma_i = \int_0^{+\infty} \frac{\mathrm{d}q}{2\pi^2} 
\, q^{2-i} \, P(q)\]</p><p>with <span>$P(q)$</span> as the matter Power Spectrum at <span>$z=0$</span> (stored in <code>cosmo</code>)  and <span>$j_\ell$</span> as spherical Bessel function of order <span>$\ell$</span>;</p></li><li><p><span>$\tilde{I}_0^4$</span> is defined as</p><p class="math-container">\[\tilde{I}_0^4 = \int_0^{+\infty} \frac{\mathrm{d}q}{2\pi^2} 
\, q^2 \, P(q) \, \frac{j_0(qs) - 1}{(qs)^4}\]</p><p>with <span>$P(q)$</span> as the matter Power Spectrum at <span>$z=0$</span> (stored in <code>cosmo</code>)  and <span>$j_\ell$</span> as spherical Bessel function of order <span>$\ell$</span>;</p></li><li><p><span>$\mathcal{H}_0$</span>, <span>$f_0$</span> and so on are evaluated at the observer position (i.e. at present day);</p></li><li><p><span>$\Delta\chi_1 := \sqrt{\chi_1^2 + s_2^2-2\,\chi_1\,s_2\,y}$</span> and  <span>$\Delta\chi_2 := \sqrt{s_1^2 + \chi_2^2-2\,s_1\,\chi_2\,y}$</span>;</p></li><li><p><span>$s=\sqrt{s_1^2 + s_2^2 - 2 \, s_1 \, s_2 \, y}$</span> and  <span>$\Delta\chi := \sqrt{\chi_1^2 + \chi_2^2-2\,\chi_1\,\chi_2\,y}$</span>.</p></li></ul><p>In this TPCF, the term proportional to only<span>$D(s_1)$</span> is an observer term  (while the term proportional to <span>$D(s_1) \, D(s_2)$</span> is not) and it does depend  on the observer velocity. Consequently, if you set <code>obs = :yes</code> or <code>obs = true</code> both of them will computed, while for <code>obs = :no</code>, <code>obs = false</code> or even <code>obs = :noobsvel</code> only the first one will be taken into account.</p><p><strong>Inputs</strong></p><ul><li><p><code>P1::Point</code> and <code>P2::Point</code>, or <code>s1</code> and <code>s2</code>: <code>Point</code>/comoving distances where the  TPCF has to be calculated; they contain all the  data of interest needed for this calculus (comoving distance, growth factor and so on).</p></li><li><p><code>y</code>: the cosine of the angle between the two points <code>P1</code> and <code>P2</code> wrt the observer</p></li><li><p><code>cosmo::Cosmology</code>: cosmology to be used in this computation; it contains all the splines used for the conversion <code>s</code> -&gt; <code>Point</code>, and all the cosmological parameters <span>$b$</span>, ...</p></li></ul><p><strong>Keyword Arguments</strong></p><ul><li><code>obs::Union{Bool,Symbol} = :noobsvel</code> : do you want to consider the observer terms in the computation of the  chosen GNC TPCF effect?<ul><li><code>:yes</code> or <code>true</code> -&gt; all the observer effects will be considered</li><li><code>:no</code> or <code>false</code> -&gt; no observer term will be taken into account</li><li><code>:noobsvel</code> -&gt; the observer terms related to the observer velocity (that you can find in the CF concerning Doppler) will be neglected, the other ones will be taken into account</li></ul></li></ul><p>See also: <a href="../Cosmology/#GaPSE.Point"><code>Point</code></a>, <a href="../Cosmology/#GaPSE.Cosmology"><code>Cosmology</code></a>, <a href="#GaPSE.ξ_GNC_multipole"><code>ξ_GNC_multipole</code></a>,  <a href="#GaPSE.map_ξ_GNC_multipole"><code>map_ξ_GNC_multipole</code></a>, <a href="#GaPSE.print_map_ξ_GNC_multipole"><code>print_map_ξ_GNC_multipole</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cosmofico97/GaPSE/blob/5f3347ff3b074f172d8e3ff7fa715eea30fd3aad/src/GNC_CrossCorrelations/GNC_NewtonianDoppler.jl#L84-L260">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="GaPSE.ξ_GNC_Doppler_Newtonian" href="#GaPSE.ξ_GNC_Doppler_Newtonian"><code>GaPSE.ξ_GNC_Doppler_Newtonian</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs"> ξ_GNC_Doppler_Newtonian(s1, s2, y, cosmo::Cosmology; kwargs...) = 
      ξ_GNC_Newtonian_Doppler(s2, s1, y, cosmo; kwargs...)</code></pre><p>Return the Two-Point Correlation Function (TPCF) given by the cross correlation between the  Doppler and the Newtonian effects arising from the Galaxy Number Counts (GNC).</p><p>It&#39;s computed through the symmetric function <code>ξ_GNC_Newtonian_Doppler</code>; check its documentation for more details about the analytical expression and the keyword arguments. We remember that all the distances are measured in <span>$h_0^{-1}\mathrm{Mpc}$</span>.</p><p><strong>Inputs</strong></p><ul><li><p><code>s1</code> and <code>s2</code>: comoving distances where the TPCF has to be calculated;</p></li><li><p><code>y</code>: the cosine of the angle between the two points <code>P1</code> and <code>P2</code> wrt the observer</p></li><li><p><code>cosmo::Cosmology</code>: cosmology to be used in this computation; it contains all the splines used for the conversion <code>s</code> -&gt; <code>Point</code>, and all the cosmological parameters <span>$b$</span>, ...</p></li></ul><p><strong>Keyword Arguments</strong></p><ul><li><code>kwargs...</code> : Keyword arguments to be passed to the symmetric TPCF</li></ul><p>See also: <a href="../Cosmology/#GaPSE.Point"><code>Point</code></a>, <a href="../Cosmology/#GaPSE.Cosmology"><code>Cosmology</code></a>, <a href="#GaPSE.ξ_GNC_multipole"><code>ξ_GNC_multipole</code></a>,  <a href="#GaPSE.map_ξ_GNC_multipole"><code>map_ξ_GNC_multipole</code></a>, <a href="#GaPSE.print_map_ξ_GNC_multipole"><code>print_map_ξ_GNC_multipole</code></a>, <a href="#GaPSE.ξ_GNC_Newtonian_Doppler"><code>ξ_GNC_Newtonian_Doppler</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cosmofico97/GaPSE/blob/5f3347ff3b074f172d8e3ff7fa715eea30fd3aad/src/GNC_CrossCorrelations/GNC_NewtonianDoppler.jl#L270-L298">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="GaPSE.ξ_GNC_Newtonian_Lensing" href="#GaPSE.ξ_GNC_Newtonian_Lensing"><code>GaPSE.ξ_GNC_Newtonian_Lensing</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs"> ξ_GNC_Newtonian_Lensing(s1, s2, y, cosmo::Cosmology;
      en::Float64=1e6, N_χs::Int=100, Δχ_min::Float64=1e-1,
      obs::Union{Bool,Symbol}=:noobsvel, suit_sampling::Bool = true)</code></pre><p>Return the Two-Point Correlation Function (TPCF) given by the cross correlation between the  Newtonian and the Lensing effects arising from the Galaxy Number Counts (GNC).</p><p>You must provide the two comoving distances <code>s1</code> and <code>s2</code> where to  evaluate the function. We remember that all the distances are measured in <span>$h_0^{-1}\mathrm{Mpc}$</span>.</p><p>The analytical expression of this term is the following:</p><p class="math-container">\[\begin{equation}
    \xi^{\delta \kappa} ( s_1 , s_2, y ) =
    D_1  \int_0^{s_2}\mathrm{d} \chi_2
    J^{\delta \kappa}_{\alpha}
    \left[ 
        J^{\delta \kappa}_{00} I_0^0 ( \Delta\chi_2 ) + 
        J^{\delta \kappa}_{02} I_2^0 ( \Delta \chi_2 ) + 
        J^{\delta \kappa}_{04} I_4^0 ( \Delta \chi_2 ) 
    \right] \, ,
\end{equation}\]</p><p>where</p><p class="math-container">\[\begin{split}
    J^{\delta \kappa}_{\alpha} &amp;=
    \frac{
        \mathcal{H}_0 ^2 \Omega_{\mathrm{M}0} D (\chi_2)
    }{
        a(\chi_2 ) s_2
    } 
    (\chi_2 - s_2 ) (5s_{\mathrm{b}, 2} - 2) 
    \, , \\
    %%%%%%%%%%%%%%%%%%%%%%%%
    J^{\delta \kappa}_{00} &amp;=
        \frac{1}{5}
        \left[
            (3 y^2 - 1) \chi_2 f_1 - y s_1(3 f_1 + 5 b_1) 
        \right] 
    \, , \\
    %%%%%%%%%%%%%%%%%%%%%%%%
    J^{\delta \kappa}_{02} &amp;=
        \frac{1}{14 \Delta\chi_2^2} 
        \left\{
            4 f_1 (3 y^2 - 1) \chi_2^3 - 
            2 y 
            \left[
                (3 y^2 + 8) f_1 + 7 b_1
            \right] s_1 \chi_2^2 +
            \right. \nonumber \\
            &amp;\left.\qquad \qquad\qquad
            \left[
                (9 y^2 + 11) f_1 - 7 (y^2 + 3) b_1
            \right] s_1^2 \chi_2 -
            2 y \left[7 b_1 + 3 f_1 \right] s_1^3
        \right\} 
    \, , \\
    %%%%%%%%%%%%%%%%%%%%%%%%
    J^{\delta \kappa}_{04} &amp;=
    \frac{f_1}{70 \Delta\chi_2^4 }
    \left\{
        (6 y^2 - 2) \chi_2^5 +
        6 y (y^2 - 3) s_1 \chi_2^4 -
        (y^4 + 12 y^2 - 21) s_1^2 \chi_2^3 +
        \right.\nonumber \\
        &amp;\left.\qquad\qquad\qquad
        2 y (y^2 + 3) s_1^3 \chi_2^2 -
        12 \chi_2 s_1^4 + 
        4 y s_1 ^5
    \right\} 
    \, .
\end{split}\]</p><p>where:</p><ul><li><p><span>$s_1$</span> and <span>$s_2$</span> are comoving distances;</p></li><li><p><span>$D_1 = D(s_1)$</span>, ... is the linear growth factor (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$a_1 = a(s_1)$</span>, ... is the scale factor (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$f_1 = f(s_1)$</span>, ... is the linear growth rate (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$\mathcal{H}_1 = \mathcal{H}(s_1)$</span>, ... is the comoving  Hubble distances (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$y = \cos{\theta} = \hat{\mathbf{s}}_1 \cdot \hat{\mathbf{s}}_2$</span>;</p></li><li><p><span>$\mathcal{R}_1 = \mathcal{R}(s_1)$</span>, ... is  computed by <code>func_ℛ_GNC</code> in <code>cosmo::Cosmology</code> (and evaluated in <span>$s_1$</span> ); the definition of <span>$\mathcal{R}(s)$</span> is the following:</p><p class="math-container">\[\mathcal{R}(s) = 5 s_{\mathrm{b}}(s) + \frac{2 - 5 s_{\mathrm{b}}(s)}{\mathcal{H}(s) \, s} +  
\frac{\dot{\mathcal{H}}(s)}{\mathcal{H}(s)^2} - \mathit{f}_{\mathrm{evo}} \quad ;\]</p></li><li><p><span>$b_1 = b(s_1)$</span>, <span>$s_{\mathrm{b}, 1} = s_{\mathrm{b}}(s_1)$</span>, <span>$\mathit{f}_{\mathrm{evo}}$</span>, ... :  galaxy bias, magnification bias (i.e. the slope of the luminosity function at the luminosity threshold),  and evolution bias (the first two evaluated in <span>$s_1$</span>); they are all stored in <code>cosmo</code>;</p></li><li><p><span>$\Omega_{\mathrm{M}0} = \Omega_{\mathrm{cdm}} + \Omega_{\mathrm{b}}$</span> is the sum of  cold-dark-matter and barionic density parameters (again, stored in <code>cosmo</code>);</p></li><li><p><span>$I_\ell^n$</span> and <span>$\sigma_i$</span> are defined as</p><p class="math-container">\[I_\ell^n(s) = \int_0^{+\infty} \frac{\mathrm{d}q}{2\pi^2} 
\, q^2 \, P(q) \, \frac{j_\ell(qs)}{(qs)^n} \quad , 
\quad \sigma_i = \int_0^{+\infty} \frac{\mathrm{d}q}{2\pi^2} 
\, q^{2-i} \, P(q)\]</p><p>with <span>$P(q)$</span> as the matter Power Spectrum at <span>$z=0$</span> (stored in <code>cosmo</code>)  and <span>$j_\ell$</span> as spherical Bessel function of order <span>$\ell$</span>;</p></li><li><p><span>$\tilde{I}_0^4$</span> is defined as</p><p class="math-container">\[\tilde{I}_0^4 = \int_0^{+\infty} \frac{\mathrm{d}q}{2\pi^2} 
\, q^2 \, P(q) \, \frac{j_0(qs) - 1}{(qs)^4}\]</p><p>with <span>$P(q)$</span> as the matter Power Spectrum at <span>$z=0$</span> (stored in <code>cosmo</code>)  and <span>$j_\ell$</span> as spherical Bessel function of order <span>$\ell$</span>;</p></li><li><p><span>$\mathcal{H}_0$</span>, <span>$f_0$</span> and so on are evaluated at the observer position (i.e. at present day);</p></li><li><p><span>$\Delta\chi_1 := \sqrt{\chi_1^2 + s_2^2-2\,\chi_1\,s_2\,y}$</span> and  <span>$\Delta\chi_2 := \sqrt{s_1^2 + \chi_2^2-2\,s_1\,\chi_2\,y}$</span>;</p></li><li><p><span>$s=\sqrt{s_1^2 + s_2^2 - 2 \, s_1 \, s_2 \, y}$</span> and  <span>$\Delta\chi := \sqrt{\chi_1^2 + \chi_2^2-2\,\chi_1\,\chi_2\,y}$</span>.</p></li></ul><p>In this TPCF there are no observer terms. The <code>obs</code> keyword is inserted only for compatibility with  the other GNC TPCFs.</p><p>This function is computed integrating <code>integrand_ξ_GNC_Newtonian_Lensing</code> with <a href="@ref"><code>trapz</code></a> from the  <a href="https://github.com/francescoalemanno/Trapz.jl">Trapz</a> Julia package.</p><p><strong>Inputs</strong></p><ul><li><p><code>s1</code> and <code>s2</code>: comoving distances where the TPCF has to be calculated.</p></li><li><p><code>y</code>: the cosine of the angle between the two points <code>P1</code> and <code>P2</code> wrt the observer</p></li><li><p><code>cosmo::Cosmology</code>: cosmology to be used in this computation; it contains all the splines used for the conversion <code>s</code> -&gt; <code>Point</code>, and all the cosmological parameters <span>$b$</span>, ...</p></li></ul><p><strong>Keyword Arguments</strong></p><ul><li><p><code>en::Float64 = 1e6</code>: just a float number used in order to deal better  with small numbers;</p></li><li><p><code>Δχ_min::Float64 = 1e-4</code> : when <span>$\Delta\chi_2 = \sqrt{s_1^2 + \chi_2^2 - 2 \, s_1 \chi_2 y} \to 0^{+}$</span>, some <span>$I_\ell^n$</span> term diverges, but the overall parenthesis has a known limit:</p><p class="math-container">\[    \lim_{\Delta \chi_2 \to 0^{+}} 
    \left(
        J_{00}^{\delta \kappa} \, I^0_0(\Delta \chi_2 ) + 
        J_{02}^{\delta \kappa} \, I^0_2(\Delta \chi_2 ) + 
        J_{04}^{\delta \kappa} \, I^4_0(\Delta \chi_2 ) 
    \right) = 
    - \frac{1}{5} \, s_1 \left(f_1 + 5 b_1\right) \, \sigma_0\]</p><p>So, when it happens that <span>$\Delta \chi_2 &lt; \Delta\chi_\mathrm{min}$</span>, the function considers this limit as the result of the parenthesis instead of calculating it in the normal way; it prevents computational divergences.</p></li><li><p><code>N_χs::Int = 100</code>: number of points to be used for sampling the integral along the range <code>(0, s2)</code> (for <code>χ2</code>); it has been checked that with <code>N_χs ≥ 100</code> the result is stable.</p></li><li><p><code>suit_sampling::Bool = true</code> : </p></li></ul><p>See also: <a href="../Cosmology/#GaPSE.Point"><code>Point</code></a>, <a href="../Cosmology/#GaPSE.Cosmology"><code>Cosmology</code></a>, <a href="#GaPSE.ξ_GNC_multipole"><code>ξ_GNC_multipole</code></a>,  <a href="#GaPSE.map_ξ_GNC_multipole"><code>map_ξ_GNC_multipole</code></a>, <a href="#GaPSE.print_map_ξ_GNC_multipole"><code>print_map_ξ_GNC_multipole</code></a>, <a href="#GaPSE.integrand_ξ_GNC_Newtonian_Lensing"><code>integrand_ξ_GNC_Newtonian_Lensing</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cosmofico97/GaPSE/blob/5f3347ff3b074f172d8e3ff7fa715eea30fd3aad/src/GNC_CrossCorrelations/GNC_NewtonianLensing.jl#L327-L510">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="GaPSE.ξ_GNC_Lensing_Newtonian" href="#GaPSE.ξ_GNC_Lensing_Newtonian"><code>GaPSE.ξ_GNC_Lensing_Newtonian</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs"> ξ_GNC_Lensing_Newtonian(s1, s2, y, cosmo::Cosmology; kwargs...) = 
      ξ_GNC_Newtonian_Lensing(s2, s1, y, cosmo; kwargs...)</code></pre><p>Return the Two-Point Correlation Function (TPCF) given by the cross correlation between the  Lensing and the Newtonian effects arising from the Galaxy Number Counts (GNC).</p><p>It&#39;s computed through the symmetric function <code>ξ_GNC_Newtonian_Lensing</code>; check its documentation for more details about the analytical expression and the keyword arguments. We remember that all the distances are measured in <span>$h_0^{-1}\mathrm{Mpc}$</span>.</p><p><strong>Inputs</strong></p><ul><li><p><code>s1</code> and <code>s2</code>: comoving distances where the TPCF has to be calculated;</p></li><li><p><code>y</code>: the cosine of the angle between the two points <code>P1</code> and <code>P2</code> wrt the observer</p></li><li><p><code>cosmo::Cosmology</code>: cosmology to be used in this computation; it contains all the splines used for the conversion <code>s</code> -&gt; <code>Point</code>, and all the cosmological parameters <span>$b$</span>, ...</p></li></ul><p><strong>Keyword Arguments</strong></p><ul><li><code>kwargs...</code> : Keyword arguments to be passed to the symmetric TPCF</li></ul><p>See also: <a href="../Cosmology/#GaPSE.Point"><code>Point</code></a>, <a href="../Cosmology/#GaPSE.Cosmology"><code>Cosmology</code></a>, <a href="#GaPSE.ξ_GNC_multipole"><code>ξ_GNC_multipole</code></a>,  <a href="#GaPSE.map_ξ_GNC_multipole"><code>map_ξ_GNC_multipole</code></a>, <a href="#GaPSE.print_map_ξ_GNC_multipole"><code>print_map_ξ_GNC_multipole</code></a>, <a href="#GaPSE.ξ_GNC_Newtonian_Lensing"><code>ξ_GNC_Newtonian_Lensing</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cosmofico97/GaPSE/blob/5f3347ff3b074f172d8e3ff7fa715eea30fd3aad/src/GNC_CrossCorrelations/GNC_NewtonianLensing.jl#L523-L551">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="GaPSE.ξ_GNC_Newtonian_LocalGP" href="#GaPSE.ξ_GNC_Newtonian_LocalGP"><code>GaPSE.ξ_GNC_Newtonian_LocalGP</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs"> ξ_GNC_Newtonian_LocalGP(
      P1::Point, P2::Point, y, cosmo::Cosmology; 
      obs::Union{Bool, Symbol} = :noobsvel
      ) ::Float64

 ξ_GNC_Newtonian_LocalGP(s1, s2, y, cosmo::Cosmology;
      kwargs...) ::Float64</code></pre><p>Return the Two-Point Correlation Function (TPCF) given by the cross correlation between the  Newtonian and the Local Gravitational Potential (GP) effects arising from the Galaxy Number Counts (GNC).</p><p>In the first method, you should pass the two <code>Point</code> (<code>P1</code> and <code>P2</code>) where to  evaluate the function, while in the second method (that internally recalls the first)  you must provide the two corresponding comoving distances <code>s1</code> and <code>s2</code>. We remember that all the distances are measured in <span>$h_0^{-1}\mathrm{Mpc}$</span>.</p><p>The analytical expression of this term is the following:</p><p class="math-container">\[\begin{split}
    \xi^{\delta \phi}( s_1 , s_2, y ) &amp;= 
    D_1 D_2 J^{\delta \phi}_{\alpha} \left[ 
        J^{\delta \phi}_{\beta} 
        \left(
            \frac{1}{30} I_0^0 (s) + 
            \frac{1}{21} I_2^0 (s) +
            \frac{1}{70} I_4^0 (s) 
        \right) +
        J^{\delta \phi}_{20} I_0^2 (s)
    \right] \nonumber \\
    &amp; + D_1 J^{\delta \phi}_{\gamma} \left[ 
        J^{\delta \phi}_{31} I^3_{1} (s_1) +
        J^{\delta \phi}_{11} I^1_{1} (s_1) +  
        J^{\delta \phi}_{13} I^1_{3} (s_1) 
        \right] 
\end{split}\]</p><p>where</p><p class="math-container">\[\begin{split}
    J^{\delta \phi}_{\alpha} &amp;=
    \frac{1}{3 a_2} \left[ 
        2 f_2 a_2 \mathcal{H}_2^2 (\mathit{f}_{\mathrm{evo}, 2} - 3) +
        3 \mathcal{H}_0^2 \Omega_{\mathrm{M}0} (f_2 + \mathcal{R}_2 + 5 s_{\mathrm{b}, 2}  - 2)
    \right] 
    \, , \\
    %%%%%%%%%%%%%%%%%%%%%
    J^{\delta \phi}_{\beta} &amp;=
    f_1 \left[ 
        (3 y^2 - 1) s_2^2 - 4 y s_1 s_2 + 2 s_1^2
    \right] 
    \, , \\
    %%%%%%%%%%%%%%%%%%%%%
    J^{\delta \phi}_{\gamma} &amp;=
    \frac{\mathcal{H}_0 s_1^2}{2 s_2} \left[ 
        2 f_0 (\mathcal{H}_0 s_2 \mathcal{R}_2 + 5 s_{\mathrm{b}, 2}  - 2) - 
        3 \mathcal{H}_0 s_2 \mathcal{R}_2
    \right] 
    \, , \\
    %%%%%%%%%%%%%%%%%%%%%
    J^{\delta \phi}_{20} &amp;= 
    - \frac{1}{2}(3 b_1 + f_1) (s_1^2 + s_2^2 - 2 y s_1 s_2)
    \, , \\
    %%%%%%%%%%%%%%%%%%%%%
    J^{\delta \phi}_{31} &amp;= - (3 b_1 + f_1) 
    \, , \\
    %%%%%%%%%%%%%%%%%%%%%
    J^{\delta \phi}_{11} &amp;=
    J^{\delta \phi}_{13} = \frac{1}{5}(b_1 + f_1) 
    \, .
\end{split}\]</p><p>where:</p><ul><li><p><span>$s_1$</span> and <span>$s_2$</span> are comoving distances;</p></li><li><p><span>$D_1 = D(s_1)$</span>, ... is the linear growth factor (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$a_1 = a(s_1)$</span>, ... is the scale factor (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$f_1 = f(s_1)$</span>, ... is the linear growth rate (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$\mathcal{H}_1 = \mathcal{H}(s_1)$</span>, ... is the comoving  Hubble distances (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$y = \cos{\theta} = \hat{\mathbf{s}}_1 \cdot \hat{\mathbf{s}}_2$</span>;</p></li><li><p><span>$\mathcal{R}_1 = \mathcal{R}(s_1)$</span>, ... is  computed by <code>func_ℛ_GNC</code> in <code>cosmo::Cosmology</code> (and evaluated in <span>$s_1$</span> ); the definition of <span>$\mathcal{R}(s)$</span> is the following:</p><p class="math-container">\[\mathcal{R}(s) = 5 s_{\mathrm{b}}(s) + \frac{2 - 5 s_{\mathrm{b}}(s)}{\mathcal{H}(s) \, s} +  
\frac{\dot{\mathcal{H}}(s)}{\mathcal{H}(s)^2} - \mathit{f}_{\mathrm{evo}} \quad ;\]</p></li><li><p><span>$b_1 = b(s_1)$</span>, <span>$s_{\mathrm{b}, 1} = s_{\mathrm{b}}(s_1)$</span>, <span>$\mathit{f}_{\mathrm{evo}}$</span>, ... :  galaxy bias, magnification bias (i.e. the slope of the luminosity function at the luminosity threshold),  and evolution bias (the first two evaluated in <span>$s_1$</span>); they are all stored in <code>cosmo</code>;</p></li><li><p><span>$\Omega_{\mathrm{M}0} = \Omega_{\mathrm{cdm}} + \Omega_{\mathrm{b}}$</span> is the sum of  cold-dark-matter and barionic density parameters (again, stored in <code>cosmo</code>);</p></li><li><p><span>$I_\ell^n$</span> and <span>$\sigma_i$</span> are defined as</p><p class="math-container">\[I_\ell^n(s) = \int_0^{+\infty} \frac{\mathrm{d}q}{2\pi^2} 
\, q^2 \, P(q) \, \frac{j_\ell(qs)}{(qs)^n} \quad , 
\quad \sigma_i = \int_0^{+\infty} \frac{\mathrm{d}q}{2\pi^2} 
\, q^{2-i} \, P(q)\]</p><p>with <span>$P(q)$</span> as the matter Power Spectrum at <span>$z=0$</span> (stored in <code>cosmo</code>)  and <span>$j_\ell$</span> as spherical Bessel function of order <span>$\ell$</span>;</p></li><li><p><span>$\tilde{I}_0^4$</span> is defined as</p><p class="math-container">\[\tilde{I}_0^4 = \int_0^{+\infty} \frac{\mathrm{d}q}{2\pi^2} 
\, q^2 \, P(q) \, \frac{j_0(qs) - 1}{(qs)^4}\]</p><p>with <span>$P(q)$</span> as the matter Power Spectrum at <span>$z=0$</span> (stored in <code>cosmo</code>)  and <span>$j_\ell$</span> as spherical Bessel function of order <span>$\ell$</span>;</p></li><li><p><span>$\mathcal{H}_0$</span>, <span>$f_0$</span> and so on are evaluated at the observer position (i.e. at present day);</p></li><li><p><span>$\Delta\chi_1 := \sqrt{\chi_1^2 + s_2^2-2\,\chi_1\,s_2\,y}$</span> and  <span>$\Delta\chi_2 := \sqrt{s_1^2 + \chi_2^2-2\,s_1\,\chi_2\,y}$</span>;</p></li><li><p><span>$s=\sqrt{s_1^2 + s_2^2 - 2 \, s_1 \, s_2 \, y}$</span> and  <span>$\Delta\chi := \sqrt{\chi_1^2 + \chi_2^2-2\,\chi_1\,\chi_2\,y}$</span>.</p></li></ul><p>In this TPCF, the term proportional to only<span>$D(s_1)$</span> is an observer term  (while the term proportional to <span>$D(s_1) \, D(s_2)$</span> is not), but does not depend  on the observer velocitz. Consequently, if you set <code>obs = :yes</code>, <code>obs = true</code> or even <code>obs = :noobsvel</code> both of them will computed, while for <code>obs = :no</code> or <code>obs = false</code> only the first one will be taken into account.</p><p><strong>Inputs</strong></p><ul><li><p><code>P1::Point</code> and <code>P2::Point</code>, or <code>s1</code> and <code>s2</code>: <code>Point</code>/comoving distances where the  TPCF has to be calculated; they contain all the  data of interest needed for this calculus (comoving distance, growth factor and so on).</p></li><li><p><code>y</code>: the cosine of the angle between the two points <code>P1</code> and <code>P2</code> wrt the observer</p></li><li><p><code>cosmo::Cosmology</code>: cosmology to be used in this computation; it contains all the splines used for the conversion <code>s</code> -&gt; <code>Point</code>, and all the cosmological parameters <span>$b$</span>, ...</p></li></ul><p><strong>Keyword Arguments</strong></p><ul><li><code>obs::Union{Bool,Symbol} = :noobsvel</code> : do you want to consider the observer terms in the computation of the  chosen GNC TPCF effect?<ul><li><code>:yes</code> or <code>true</code> -&gt; all the observer effects will be considered</li><li><code>:no</code> or <code>false</code> -&gt; no observer term will be taken into account</li><li><code>:noobsvel</code> -&gt; the observer terms related to the observer velocity (that you can find in the CF concerning Doppler) will be neglected, the other ones will be taken into account</li></ul></li></ul><p>See also: <a href="../Cosmology/#GaPSE.Point"><code>Point</code></a>, <a href="../Cosmology/#GaPSE.Cosmology"><code>Cosmology</code></a>, <a href="#GaPSE.ξ_GNC_multipole"><code>ξ_GNC_multipole</code></a>,  <a href="#GaPSE.map_ξ_GNC_multipole"><code>map_ξ_GNC_multipole</code></a>, <a href="#GaPSE.print_map_ξ_GNC_multipole"><code>print_map_ξ_GNC_multipole</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cosmofico97/GaPSE/blob/5f3347ff3b074f172d8e3ff7fa715eea30fd3aad/src/GNC_CrossCorrelations/GNC_NewtonianLocalGP.jl#L81-L243">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="GaPSE.ξ_GNC_LocalGP_Newtonian" href="#GaPSE.ξ_GNC_LocalGP_Newtonian"><code>GaPSE.ξ_GNC_LocalGP_Newtonian</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs"> ξ_GNC_LocalGP_Newtonian(s1, s2, y, cosmo::Cosmology; kwargs...) = 
      ξ_GNC_Newtonian_LocalGP(s2, s1, y, cosmo; kwargs...)</code></pre><p>Return the Two-Point Correlation Function (TPCF) given by the cross correlation between the  Local Gravitational Potential (GP) and the Newtonian effects arising from the Galaxy Number Counts (GNC).</p><p>It&#39;s computed through the symmetric function <code>ξ_GNC_Newtonian_LocalGP</code>; check its documentation for more details about the analytical expression and the keyword arguments. We remember that all the distances are measured in <span>$h_0^{-1}\mathrm{Mpc}$</span>.</p><p><strong>Inputs</strong></p><ul><li><p><code>s1</code> and <code>s2</code>: comoving distances where the TPCF has to be calculated;</p></li><li><p><code>y</code>: the cosine of the angle between the two points <code>P1</code> and <code>P2</code> wrt the observer</p></li><li><p><code>cosmo::Cosmology</code>: cosmology to be used in this computation; it contains all the splines used for the conversion <code>s</code> -&gt; <code>Point</code>, and all the cosmological parameters <span>$b$</span>, ...</p></li></ul><p><strong>Keyword Arguments</strong></p><ul><li><code>kwargs...</code> : Keyword arguments to be passed to the symmetric TPCF</li></ul><p>See also: <a href="../Cosmology/#GaPSE.Point"><code>Point</code></a>, <a href="../Cosmology/#GaPSE.Cosmology"><code>Cosmology</code></a>, <a href="#GaPSE.ξ_GNC_multipole"><code>ξ_GNC_multipole</code></a>,  <a href="#GaPSE.map_ξ_GNC_multipole"><code>map_ξ_GNC_multipole</code></a>, <a href="#GaPSE.print_map_ξ_GNC_multipole"><code>print_map_ξ_GNC_multipole</code></a>, <a href="#GaPSE.ξ_GNC_Newtonian_LocalGP"><code>ξ_GNC_Newtonian_LocalGP</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cosmofico97/GaPSE/blob/5f3347ff3b074f172d8e3ff7fa715eea30fd3aad/src/GNC_CrossCorrelations/GNC_NewtonianLocalGP.jl#L256-L284">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="GaPSE.ξ_GNC_Newtonian_IntegratedGP" href="#GaPSE.ξ_GNC_Newtonian_IntegratedGP"><code>GaPSE.ξ_GNC_Newtonian_IntegratedGP</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">ξ_GNC_Newtonian_IntegratedGP(
    s1, s2, y, cosmo::Cosmology;
    en::Float64=1e6, N_χs::Int=100, 
    obs::Union{Bool,Symbol}=:noobsvel
    ) ::Float64</code></pre><p>Return the Two-Point Correlation Function (TPCF) given by the cross correlation between the  Newtonian and the Integrated Gravitational Potential (GP) effects arising from the Galaxy Number Counts (GNC).</p><p>You must provide the two comoving distances <code>s1</code> and <code>s2</code> where to  evaluate the function. We remember that all the distances are measured in <span>$h_0^{-1}\mathrm{Mpc}$</span>.</p><p>The analytical expression of this integrand is the following:</p><p class="math-container">\[\begin{split}
    \xi^{\delta \int\!\phi}( s_1 , s_2, y ) =
    D_1 \int_0^{s_2}\mathrm{d} \chi_2 \;  
    &amp;J^{\delta \int\!\phi}_{\alpha}
    \left[ 
        J^{\delta \int\!\phi}_{20} I_0^2 ( \Delta\chi_2 ) +
        \right.  \\
        &amp; \left. 
        J^{\delta \int\!\phi}_{\beta}
            \left(
                \frac{1}{15} I_0^0 ( \Delta\chi_2 ) + 
                \frac{1}{21} I_2^0 ( \Delta\chi_2 ) +
                \frac{1}{35} I_4^0 ( \Delta\chi_2 )
            \right) 
    \right] \, , \nonumber
\end{split}\]</p><p>where</p><p class="math-container">\[\begin{split}
    J^{\delta \int\!\phi}_{\alpha} &amp;=
    \frac{\mathcal{H}_0^2 \Omega_{\mathrm{M}0} D(\chi_2)}{3 a(\chi_2) s_2} 
    \left[ 
        s_2 \mathcal{R}_2 \mathcal{H}(\chi_2) ( f(\chi_2) - 1) - 5 s_{\mathrm{b}, 2} + 2
    \right] 
    \, , \\
    %%%%%%%%%%%%%%%%%%%%%
    J^{\delta \int\!\phi}_{\beta} &amp;=
    f_1 \left[ 
        (3 y^2 - 1) \chi_2^2 - 4 y s_1 \chi_2 + 2 s_1^2
    \right] 
    \, , \\
    %%%%%%%%%%%%%%%%%%%%%
    J^{\delta \int\!\phi}_{20} &amp;=
    - \Delta\chi_2^2 ( 3 b_1 + f_1)
    \, .
\end{split}\]</p><p>where:</p><ul><li><p><span>$s_1$</span> and <span>$s_2$</span> are comoving distances;</p></li><li><p><span>$D_1 = D(s_1)$</span>, ... is the linear growth factor (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$a_1 = a(s_1)$</span>, ... is the scale factor (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$f_1 = f(s_1)$</span>, ... is the linear growth rate (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$\mathcal{H}_1 = \mathcal{H}(s_1)$</span>, ... is the comoving  Hubble distances (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$y = \cos{\theta} = \hat{\mathbf{s}}_1 \cdot \hat{\mathbf{s}}_2$</span>;</p></li><li><p><span>$\mathcal{R}_1 = \mathcal{R}(s_1)$</span>, ... is  computed by <code>func_ℛ_GNC</code> in <code>cosmo::Cosmology</code> (and evaluated in <span>$s_1$</span> ); the definition of <span>$\mathcal{R}(s)$</span> is the following:</p><p class="math-container">\[\mathcal{R}(s) = 5 s_{\mathrm{b}}(s) + \frac{2 - 5 s_{\mathrm{b}}(s)}{\mathcal{H}(s) \, s} +  
\frac{\dot{\mathcal{H}}(s)}{\mathcal{H}(s)^2} - \mathit{f}_{\mathrm{evo}} \quad ;\]</p></li><li><p><span>$b_1 = b(s_1)$</span>, <span>$s_{\mathrm{b}, 1} = s_{\mathrm{b}}(s_1)$</span>, <span>$\mathit{f}_{\mathrm{evo}}$</span>, ... :  galaxy bias, magnification bias (i.e. the slope of the luminosity function at the luminosity threshold),  and evolution bias (the first two evaluated in <span>$s_1$</span>); they are all stored in <code>cosmo</code>;</p></li><li><p><span>$\Omega_{\mathrm{M}0} = \Omega_{\mathrm{cdm}} + \Omega_{\mathrm{b}}$</span> is the sum of  cold-dark-matter and barionic density parameters (again, stored in <code>cosmo</code>);</p></li><li><p><span>$I_\ell^n$</span> and <span>$\sigma_i$</span> are defined as</p><p class="math-container">\[I_\ell^n(s) = \int_0^{+\infty} \frac{\mathrm{d}q}{2\pi^2} 
\, q^2 \, P(q) \, \frac{j_\ell(qs)}{(qs)^n} \quad , 
\quad \sigma_i = \int_0^{+\infty} \frac{\mathrm{d}q}{2\pi^2} 
\, q^{2-i} \, P(q)\]</p><p>with <span>$P(q)$</span> as the matter Power Spectrum at <span>$z=0$</span> (stored in <code>cosmo</code>)  and <span>$j_\ell$</span> as spherical Bessel function of order <span>$\ell$</span>;</p></li><li><p><span>$\tilde{I}_0^4$</span> is defined as</p><p class="math-container">\[\tilde{I}_0^4 = \int_0^{+\infty} \frac{\mathrm{d}q}{2\pi^2} 
\, q^2 \, P(q) \, \frac{j_0(qs) - 1}{(qs)^4}\]</p><p>with <span>$P(q)$</span> as the matter Power Spectrum at <span>$z=0$</span> (stored in <code>cosmo</code>)  and <span>$j_\ell$</span> as spherical Bessel function of order <span>$\ell$</span>;</p></li><li><p><span>$\mathcal{H}_0$</span>, <span>$f_0$</span> and so on are evaluated at the observer position (i.e. at present day);</p></li><li><p><span>$\Delta\chi_1 := \sqrt{\chi_1^2 + s_2^2-2\,\chi_1\,s_2\,y}$</span> and  <span>$\Delta\chi_2 := \sqrt{s_1^2 + \chi_2^2-2\,s_1\,\chi_2\,y}$</span>;</p></li><li><p><span>$s=\sqrt{s_1^2 + s_2^2 - 2 \, s_1 \, s_2 \, y}$</span> and  <span>$\Delta\chi := \sqrt{\chi_1^2 + \chi_2^2-2\,\chi_1\,\chi_2\,y}$</span>.</p></li></ul><p>In this TPCF there are no observer terms. The <code>obs</code> keyword is inserted only for compatibility with  the other GNC TPCFs.</p><p>This function is computed integrating <code>integrand_ξ_GNC_Newtonian_IntegratedGP</code> with <a href="@ref"><code>trapz</code></a> from the  <a href="https://github.com/francescoalemanno/Trapz.jl">Trapz</a> Julia package.</p><p><strong>Inputs</strong></p><ul><li><p><code>P1::Point</code> and <code>P2::Point</code>, or <code>s1</code> and <code>s2</code>: <code>Point</code>/comoving distances where the  TPCF has to be calculated; they contain all the  data of interest needed for this calculus (comoving distance, growth factor and so on).</p></li><li><p><code>y</code>: the cosine of the angle between the two points <code>P1</code> and <code>P2</code> wrt the observer</p></li><li><p><code>cosmo::Cosmology</code>: cosmology to be used in this computation; it contains all the splines used for the conversion <code>s</code> -&gt; <code>Point</code>, and all the cosmological parameters <span>$b$</span>, ...</p></li></ul><p><strong>Keyword Arguments</strong></p><ul><li><p><code>obs::Union{Bool,Symbol} = :noobsvel</code> : do you want to consider the observer terms in the computation of the  chosen GNC TPCF effect?</p><ul><li><code>:yes</code> or <code>true</code> -&gt; all the observer effects will be considered</li><li><code>:no</code> or <code>false</code> -&gt; no observer term will be taken into account</li><li><code>:noobsvel</code> -&gt; the observer terms related to the observer velocity (that you can find in the CF concerning Doppler) will be neglected, the other ones will be taken into account</li></ul></li><li><p><code>en::Float64 = 1e6</code>: just a float number used in order to deal better  with small numbers;</p></li><li><p><code>N_χs::Int = 100</code>: number of points to be used for sampling the integral along the range <code>(0, s2)</code> (for <code>χ2</code>); it has been checked that with <code>N_χs ≥ 100</code> the result is stable.</p></li></ul><p>See also: <a href="../Cosmology/#GaPSE.Point"><code>Point</code></a>, <a href="../Cosmology/#GaPSE.Cosmology"><code>Cosmology</code></a>, <a href="#GaPSE.ξ_GNC_multipole"><code>ξ_GNC_multipole</code></a>,  <a href="#GaPSE.map_ξ_GNC_multipole"><code>map_ξ_GNC_multipole</code></a>, <a href="#GaPSE.print_map_ξ_GNC_multipole"><code>print_map_ξ_GNC_multipole</code></a>, <a href="#GaPSE.integrand_ξ_GNC_Newtonian_IntegratedGP"><code>integrand_ξ_GNC_Newtonian_IntegratedGP</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cosmofico97/GaPSE/blob/5f3347ff3b074f172d8e3ff7fa715eea30fd3aad/src/GNC_CrossCorrelations/GNC_NewtonianIntegratedGP.jl#L228-L380">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="GaPSE.ξ_GNC_IntegratedGP_Newtonian" href="#GaPSE.ξ_GNC_IntegratedGP_Newtonian"><code>GaPSE.ξ_GNC_IntegratedGP_Newtonian</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs"> ξ_GNC_IntegratedGP_Newtonian(s1, s2, y, cosmo::Cosmology; kwargs...) = 
      ξ_GNC_Newtonian_IntegratedGP(s2, s1, y, cosmo; kwargs...)</code></pre><p>Return the Two-Point Correlation Function (TPCF) given by the cross correlation between the  Integrated Gravitational Potential (GP) and the Newtonian effects arising from the Galaxy Number Counts (GNC).</p><p>It&#39;s computed through the symmetric function <code>ξ_GNC_Newtonian_IntegratedGP</code>; check its documentation for more details about the analytical expression and the keyword arguments. We remember that all the distances are measured in <span>$h_0^{-1}\mathrm{Mpc}$</span>.</p><p><strong>Inputs</strong></p><ul><li><p><code>s1</code> and <code>s2</code>: comoving distances where the TPCF has to be calculated;</p></li><li><p><code>y</code>: the cosine of the angle between the two points <code>P1</code> and <code>P2</code> wrt the observer</p></li><li><p><code>cosmo::Cosmology</code>: cosmology to be used in this computation; it contains all the splines used for the conversion <code>s</code> -&gt; <code>Point</code>, and all the cosmological parameters <span>$b$</span>, ...</p></li></ul><p><strong>Keyword Arguments</strong></p><ul><li><code>kwargs...</code> : Keyword arguments to be passed to the symmetric TPCF</li></ul><p>See also: <a href="../Cosmology/#GaPSE.Point"><code>Point</code></a>, <a href="../Cosmology/#GaPSE.Cosmology"><code>Cosmology</code></a>, <a href="#GaPSE.ξ_GNC_multipole"><code>ξ_GNC_multipole</code></a>,  <a href="#GaPSE.map_ξ_GNC_multipole"><code>map_ξ_GNC_multipole</code></a>, <a href="#GaPSE.print_map_ξ_GNC_multipole"><code>print_map_ξ_GNC_multipole</code></a>, <a href="#GaPSE.ξ_GNC_Newtonian_IntegratedGP"><code>ξ_GNC_Newtonian_IntegratedGP</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cosmofico97/GaPSE/blob/5f3347ff3b074f172d8e3ff7fa715eea30fd3aad/src/GNC_CrossCorrelations/GNC_NewtonianIntegratedGP.jl#L409-L437">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="GaPSE.ξ_GNC_Doppler_Lensing" href="#GaPSE.ξ_GNC_Doppler_Lensing"><code>GaPSE.ξ_GNC_Doppler_Lensing</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs"> ξ_GNC_Doppler_Lensing(s1, s2, y, cosmo::Cosmology; kwargs...) = 
      ξ_GNC_Lensing_Doppler(s2, s1, y, cosmo; kwargs...)</code></pre><p>Return the Two-Point Correlation Function (TPCF) given by the cross correlation between the  Doppler and the Lensing effects arising from the Galaxy Number Counts (GNC).</p><p>It&#39;s computed through the symmetric function <code>ξ_GNC_Lensing_Doppler</code>; check its documentation for more details about the analytical expression and the keyword arguments. We remember that all the distances are measured in <span>$h_0^{-1}\mathrm{Mpc}$</span>.</p><p><strong>Inputs</strong></p><ul><li><p><code>s1</code> and <code>s2</code>: comoving distances where the TPCF has to be calculated;</p></li><li><p><code>y</code>: the cosine of the angle between the two points <code>P1</code> and <code>P2</code> wrt the observer</p></li><li><p><code>cosmo::Cosmology</code>: cosmology to be used in this computation; it contains all the splines used for the conversion <code>s</code> -&gt; <code>Point</code>, and all the cosmological parameters <span>$b$</span>, ...</p></li></ul><p><strong>Keyword Arguments</strong></p><ul><li><code>kwargs...</code> : Keyword arguments to be passed to the symmetric TPCF</li></ul><p>See also: <a href="../Cosmology/#GaPSE.Point"><code>Point</code></a>, <a href="../Cosmology/#GaPSE.Cosmology"><code>Cosmology</code></a>, <a href="#GaPSE.ξ_GNC_multipole"><code>ξ_GNC_multipole</code></a>,  <a href="#GaPSE.map_ξ_GNC_multipole"><code>map_ξ_GNC_multipole</code></a>, <a href="#GaPSE.print_map_ξ_GNC_multipole"><code>print_map_ξ_GNC_multipole</code></a>, <a href="#GaPSE.ξ_GNC_Lensing_Doppler"><code>ξ_GNC_Lensing_Doppler</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cosmofico97/GaPSE/blob/5f3347ff3b074f172d8e3ff7fa715eea30fd3aad/src/GNC_CrossCorrelations/GNC_LensingDoppler.jl#L538-L566">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="GaPSE.ξ_GNC_Lensing_Doppler" href="#GaPSE.ξ_GNC_Lensing_Doppler"><code>GaPSE.ξ_GNC_Lensing_Doppler</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs"> ξ_GNC_Lensing_Doppler(
      s1, s2, y, cosmo::Cosmology;
      en::Float64=1e6, N_χs::Int=100, 
      obs::Union{Bool,Symbol}=:noobsvel,
      Δχ_min::Float64=1e-1
      ) ::Float64</code></pre><p>Return the Two-Point Correlation Function (TPCF) given  by the cross correlation between the Lensing and the Doppler effects arising  from the Galaxy Number Counts (GNC).</p><p>You must provide the two comoving distances <code>s1</code> and <code>s2</code> where to  evaluate the function. We remember that all the distances are measured in <span>$h_0^{-1}\mathrm{Mpc}$</span>.</p><p>The analytical expression of this integrand is the following:</p><p class="math-container">\[\begin{split}
    \xi^{\kappa v_{\parallel}} ( s_1 , s_2, y ) &amp;= 
    D_2 \int_0^{s_1}\dd \chi_1 
    J^{\kappa v_{\parallel}}_{\alpha} \left[
        J^{\kappa v_{\parallel}}_{00} I_0^0 ( \Delta \chi_1 ) +
        J^{\kappa v_{\parallel}}_{02} I_2^0 ( \Delta \chi_1 ) 
    \right. \nonumber \\
    &amp; \left.
    + J^{\kappa v_{\parallel}}_{04} I_4^0 ( \Delta \chi_1 ) 
    + J^{\kappa v_{\parallel}}_{20} I_0^2 ( \Delta \chi_1 ) 
    \right]
    + \int_0^{s_1}\dd \chi_1 
    J^{\kappa v_{\parallel}}_{31} I_1^3 ( \chi_1 ) \, ,
\end{split}\]</p><p>where</p><p class="math-container">\[\begin{split}
     J^{\kappa v_{\parallel}}_{\alpha} &amp;= 
    \frac{\mathcal{H}_0^2 \Omega_{\mathrm{M}0} D(\chi_1)}{a(\chi_1) s_1}
    f_2 \mathcal{H}_2 \mathcal{R}_2 (\chi_1 - s_1) (5 s_{\mathrm{b}, 1} - 2)
    \, , \\
    %%%%%%%%%%%%%%%%%
    J^{\kappa v_{\parallel}}_{00} &amp;= 
    \frac{1}{15}
    \left[
        \chi_1^2 y + \chi_1 s_2 (4 y^2 - 3) - 2 y s_2^2
    \right] 
    \, , \\
    %%%%%%%%%%%%%%%%%
    J^{\kappa v_{\parallel}}_{02} &amp;= 
    \frac{1}{42 \Delta\chi_1^2} \left[
        4 y \chi_1^4 + 4 (2 y^2 - 3) s_2 \chi_1^3 + 
        y (11 - 23 y^2) s_2^2 \chi_1^2 +
        \right.\\
        &amp;\left.\qquad\qquad\qquad
        (23 y^2 - 3) s_2^3 \chi_1 - 8 y s_2^4
    \right] \nonumber
    \, , \\
    %%%%%%%%%%%%%%%%%
    J^{\kappa v_{\parallel}}_{04} &amp;= 
    \frac{1}{70 \Delta\chi_1^2} 
    \left[
        2 y \chi_1^4 + 2 (2 y^2 - 3) s_2 \chi_1^3 - 
        y (y^2 + 5) s_2^2 \chi_1^2 + 
        (y^2 + 9) s_2^3 \chi_1 - 4 y s_2^4
    \right] 
    \, , \\
    %%%%%%%%%%%%%%%%%
    J^{\kappa v_{\parallel}}_{20} &amp;= y \Delta\chi_1^2 
    \, , \\ 
    %%%%%%%%%%%%%%%%%
    J^{\kappa v_{\parallel}}_{31} &amp;=
    -\frac{
        3 \chi_1^2 y f_0 \mathcal{H}_0^3 \Omega_{\mathrm{M}0} D(\chi_1) 
    }{
        a(\chi_1)s_1
    }(\chi_1 - s_1) (5 s_{\mathrm{b}, 1} - 2) (\mathcal{R}_2 - 5 s_{\mathrm{b}, 2} + 2) 
    \, .
\end{split}\]</p><p>where:</p><ul><li><p><span>$s_1$</span> and <span>$s_2$</span> are comoving distances;</p></li><li><p><span>$D_1 = D(s_1)$</span>, ... is the linear growth factor (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$a_1 = a(s_1)$</span>, ... is the scale factor (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$f_1 = f(s_1)$</span>, ... is the linear growth rate (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$\mathcal{H}_1 = \mathcal{H}(s_1)$</span>, ... is the comoving  Hubble distances (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$y = \cos{\theta} = \hat{\mathbf{s}}_1 \cdot \hat{\mathbf{s}}_2$</span>;</p></li><li><p><span>$\mathcal{R}_1 = \mathcal{R}(s_1)$</span>, ... is  computed by <code>func_ℛ_GNC</code> in <code>cosmo::Cosmology</code> (and evaluated in <span>$s_1$</span> ); the definition of <span>$\mathcal{R}(s)$</span> is the following:</p><p class="math-container">\[\mathcal{R}(s) = 5 s_{\mathrm{b}}(s) + \frac{2 - 5 s_{\mathrm{b}}(s)}{\mathcal{H}(s) \, s} +  
\frac{\dot{\mathcal{H}}(s)}{\mathcal{H}(s)^2} - \mathit{f}_{\mathrm{evo}} \quad ;\]</p></li><li><p><span>$b_1 = b(s_1)$</span>, <span>$s_{\mathrm{b}, 1} = s_{\mathrm{b}}(s_1)$</span>, <span>$\mathit{f}_{\mathrm{evo}}$</span>, ... :  galaxy bias, magnification bias (i.e. the slope of the luminosity function at the luminosity threshold),  and evolution bias (the first two evaluated in <span>$s_1$</span>); they are all stored in <code>cosmo</code>;</p></li><li><p><span>$\Omega_{\mathrm{M}0} = \Omega_{\mathrm{cdm}} + \Omega_{\mathrm{b}}$</span> is the sum of  cold-dark-matter and barionic density parameters (again, stored in <code>cosmo</code>);</p></li><li><p><span>$I_\ell^n$</span> and <span>$\sigma_i$</span> are defined as</p><p class="math-container">\[I_\ell^n(s) = \int_0^{+\infty} \frac{\mathrm{d}q}{2\pi^2} 
\, q^2 \, P(q) \, \frac{j_\ell(qs)}{(qs)^n} \quad , 
\quad \sigma_i = \int_0^{+\infty} \frac{\mathrm{d}q}{2\pi^2} 
\, q^{2-i} \, P(q)\]</p><p>with <span>$P(q)$</span> as the matter Power Spectrum at <span>$z=0$</span> (stored in <code>cosmo</code>)  and <span>$j_\ell$</span> as spherical Bessel function of order <span>$\ell$</span>;</p></li><li><p><span>$\tilde{I}_0^4$</span> is defined as</p><p class="math-container">\[\tilde{I}_0^4 = \int_0^{+\infty} \frac{\mathrm{d}q}{2\pi^2} 
\, q^2 \, P(q) \, \frac{j_0(qs) - 1}{(qs)^4}\]</p><p>with <span>$P(q)$</span> as the matter Power Spectrum at <span>$z=0$</span> (stored in <code>cosmo</code>)  and <span>$j_\ell$</span> as spherical Bessel function of order <span>$\ell$</span>;</p></li><li><p><span>$\mathcal{H}_0$</span>, <span>$f_0$</span> and so on are evaluated at the observer position (i.e. at present day);</p></li><li><p><span>$\Delta\chi_1 := \sqrt{\chi_1^2 + s_2^2-2\,\chi_1\,s_2\,y}$</span> and  <span>$\Delta\chi_2 := \sqrt{s_1^2 + \chi_2^2-2\,s_1\,\chi_2\,y}$</span>;</p></li><li><p><span>$s=\sqrt{s_1^2 + s_2^2 - 2 \, s_1 \, s_2 \, y}$</span> and  <span>$\Delta\chi := \sqrt{\chi_1^2 + \chi_2^2-2\,\chi_1\,\chi_2\,y}$</span>.</p></li></ul><p>In this TPCF, the term proportional to <span>$D(s_1)$</span> is not an observer term. The other one instead is and it does depend on the observer velocity. Consequently, if you set <code>obs = :yes</code> or <code>obs = true</code> both of them will computed, while for <code>obs = :no</code>, <code>obs = false</code> or even <code>obs = :noobsvel</code> only the first one will be taken into account.</p><p>This function is computed from <code>integrand_ξ_GNC_Lensing_Doppler</code> with <a href="@ref"><code>trapz</code></a> from the  <a href="https://github.com/francescoalemanno/Trapz.jl">Trapz</a> Julia package.</p><p><strong>Inputs</strong></p><ul><li><p><code>P1::Point</code>, <code>P2::Point</code> or <code>s1</code>,<code>s2</code>: <code>Point</code>/comoving  distances where the TPCF has to be calculated; they contain all the  data of interest needed for this calculus (comoving distance, growth factor and so on).</p></li><li><p><code>y</code>: the cosine of the angle between the two points <code>P1</code> and <code>P2</code> wrt the observer</p></li><li><p><code>cosmo::Cosmology</code>: cosmology to be used in this computation; it contains all the splines used for the conversion <code>s</code> -&gt; <code>Point</code>, and all the cosmological parameters <span>$b$</span>, ...</p></li></ul><p><strong>Keyword Arguments</strong></p><ul><li><p><code>obs::Union{Bool,Symbol} = :noobsvel</code> : do you want to consider the observer terms in the computation of the  chosen GNC TPCF effect?</p><ul><li><code>:yes</code> or <code>true</code> -&gt; all the observer effects will be considered</li><li><code>:no</code> or <code>false</code> -&gt; no observer term will be taken into account</li><li><code>:noobsvel</code> -&gt; the observer terms related to the observer velocity (that you can find in the CF concerning Doppler) will be neglected, the other ones will be taken into account</li></ul></li><li><p><code>Δχ_min::Float64 = 1e-1</code> : when <span>$\Delta\chi_1 = \sqrt{\chi_1^2 + s_2^2 - 2 \, \chi_1 s_2 y} \to 0^{+}$</span>, some <span>$I_\ell^n$</span> term diverges, but the overall parenthesis has a known limit:</p><p class="math-container">\[   \lim_{\Delta\chi_1 \to 0^{+}}
    \left[
      J^{\kappa v_{\parallel}}_{00} I_0^0 ( \Delta \chi_1 ) +
      J^{\kappa v_{\parallel}}_{02} I_2^0 ( \Delta \chi_1 ) +
      J^{\kappa v_{\parallel}}_{04} I_4^0 ( \Delta \chi_1 ) +
      J^{\kappa v_{\parallel}}_{20} I_0^2 ( \Delta \chi_1 ) 
  \right] = \sigma_2\]</p><p>So, when it happens that <span>$\Delta\chi_1 &lt; \Delta\chi_\mathrm{min}$</span>, the function considers this limit as the result of the parenthesis instead of calculating it in the normal way; it prevents computational divergences.</p></li><li><p><code>en::Float64 = 1e6</code>: just a float number used in order to deal better  with small numbers;</p></li><li><p><code>N_χs::Int = 100</code>: number of points to be used for sampling the integral along the range <code>(0, s1)</code> (for <code>χ1</code>); it has been checked that with <code>N_χs ≥ 100</code> the result is stable.</p></li></ul><p>See also: <a href="../Cosmology/#GaPSE.Point"><code>Point</code></a>, <a href="../Cosmology/#GaPSE.Cosmology"><code>Cosmology</code></a>, <a href="#GaPSE.ξ_GNC_multipole"><code>ξ_GNC_multipole</code></a>,  <a href="#GaPSE.map_ξ_GNC_multipole"><code>map_ξ_GNC_multipole</code></a>, <a href="#GaPSE.print_map_ξ_GNC_multipole"><code>print_map_ξ_GNC_multipole</code></a>, <a href="#GaPSE.integrand_ξ_GNC_Lensing_Doppler"><code>integrand_ξ_GNC_Lensing_Doppler</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cosmofico97/GaPSE/blob/5f3347ff3b074f172d8e3ff7fa715eea30fd3aad/src/GNC_CrossCorrelations/GNC_LensingDoppler.jl#L306-L504">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="GaPSE.ξ_GNC_Doppler_LocalGP" href="#GaPSE.ξ_GNC_Doppler_LocalGP"><code>GaPSE.ξ_GNC_Doppler_LocalGP</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs"> ξ_GNC_Doppler_LocalGP(
      P1::Point, P2::Point, y, cosmo::Cosmology; 
      obs::Union{Bool,Symbol}=:noobsvel
      ) ::Float64

 ξ_GNC_Doppler_LocalGP(
      s1, s2, y, cosmo::Cosmology; 
      kwargs...) ::Float64</code></pre><p>Return the Two-Point Correlation Function (TPCF) given by the cross correlation between the  Doppler and the Local Gravitational Potential (GP) effects arising from the Galaxy Number Counts (GNC).</p><p>In the first method, you should pass the two <code>Point</code> (<code>P1</code> and <code>P2</code>) where to  evaluate the function, while in the second method (that internally recalls the first)  you must provide the two corresponding comoving distances <code>s1</code> and <code>s2</code>. We remember that all the distances are measured in <span>$h_0^{-1}\mathrm{Mpc}$</span>.</p><p>The analytical expression of this term is the following:</p><p class="math-container">\[\begin{split}
    \xi^{v_{\parallel} \phi} ( s_1 , s_2, y ) &amp;= 
    D_1 D_2 J^{v_{\parallel} \phi}_{\alpha}
    \left[ 
        \frac{1}{90} I_0^0 (s) +
        \frac{1}{63} I_2^0 (s) + 
        \frac{1}{210} I_4^0 (s) +
        \frac{1}{6} I_0^2 (s) 
    \right]
    \nonumber \\
    &amp; +
    D_1 J^{v_{\parallel} \phi_0 }_{31} I^3_1 (s_1) +
    D_2 J^{v_{\parallel, 0} \phi }_{31} I^3_1 (s_2) \, ,
\end{split}\]</p><p>where</p><p class="math-container">\[\begin{split}
    J^{v_{\parallel} \phi}_{\alpha} &amp;=
    \frac{f_1 \mathcal{H}_1 \mathcal{R}_1 s^2}{a_2} (y s_2 - s_1) 
    \times\\
    &amp;\qquad\qquad\qquad
    \left[ 
        2 f_2 a_2 \mathcal{H}_2^2 (\mathit{f}_{\mathrm{evo}, 2} - 3) + 
        3 \mathcal{H}_0^2 \Omega_{\mathrm{M}0} (f_2 + \mathcal{R}_2 + 5 s_{\mathrm{b}, 2} - 2)
    \right]
    \, , \nonumber \\
    %%%%%%%%%%%%%%%%%%%%
    J^{v_{\parallel} \phi_0 }_{31} &amp;=
    \frac{ f_1 \mathcal{H}_1 \mathcal{R}_1}{2 s_2} \mathcal{H}_0 s_1^3 
    \left[ 
        3 \mathcal{H}_0 \Omega_{\mathrm{M}0} s_2 \mathcal{R}_2 -
        2 f_0 \left( \mathcal{H}_0 s_2 \mathcal{R}_2 + 5 s_{\mathrm{b}, 2} - 2 \right)
    \right]
    \, , \\
    %%%%%%%%%%%%%%%%%%%%
    J^{v_{\parallel, 0} \,  \phi }_{31} &amp;=
    -\frac{y f_0 \mathcal{H}_0 s_2^3}{2 a_2} (\mathcal{R}_1 - 5 s_{\mathrm{b}, 1} + 2) 
    \times \\
    &amp;\qquad\qquad\qquad
    \left[ 
        2 a_2 f_2 \mathcal{H}_2^2 (\mathit{f}_{\mathrm{evo}, 2} - 3) +
        3 \mathcal{H}_0^2 \Omega_{\mathrm{M}0} (f_2 + \mathcal{R}_2 + 5 s_{\mathrm{b}, 2} - 2)
    \right]
    \nonumber \, .
\end{split}\]</p><p>where:</p><ul><li><p><span>$s_1$</span> and <span>$s_2$</span> are comoving distances;</p></li><li><p><span>$D_1 = D(s_1)$</span>, ... is the linear growth factor (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$a_1 = a(s_1)$</span>, ... is the scale factor (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$f_1 = f(s_1)$</span>, ... is the linear growth rate (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$\mathcal{H}_1 = \mathcal{H}(s_1)$</span>, ... is the comoving  Hubble distances (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$y = \cos{\theta} = \hat{\mathbf{s}}_1 \cdot \hat{\mathbf{s}}_2$</span>;</p></li><li><p><span>$\mathcal{R}_1 = \mathcal{R}(s_1)$</span>, ... is  computed by <code>func_ℛ_GNC</code> in <code>cosmo::Cosmology</code> (and evaluated in <span>$s_1$</span> ); the definition of <span>$\mathcal{R}(s)$</span> is the following:</p><p class="math-container">\[\mathcal{R}(s) = 5 s_{\mathrm{b}}(s) + \frac{2 - 5 s_{\mathrm{b}}(s)}{\mathcal{H}(s) \, s} +  
\frac{\dot{\mathcal{H}}(s)}{\mathcal{H}(s)^2} - \mathit{f}_{\mathrm{evo}} \quad ;\]</p></li><li><p><span>$b_1 = b(s_1)$</span>, <span>$s_{\mathrm{b}, 1} = s_{\mathrm{b}}(s_1)$</span>, <span>$\mathit{f}_{\mathrm{evo}}$</span>, ... :  galaxy bias, magnification bias (i.e. the slope of the luminosity function at the luminosity threshold),  and evolution bias (the first two evaluated in <span>$s_1$</span>); they are all stored in <code>cosmo</code>;</p></li><li><p><span>$\Omega_{\mathrm{M}0} = \Omega_{\mathrm{cdm}} + \Omega_{\mathrm{b}}$</span> is the sum of  cold-dark-matter and barionic density parameters (again, stored in <code>cosmo</code>);</p></li><li><p><span>$I_\ell^n$</span> and <span>$\sigma_i$</span> are defined as</p><p class="math-container">\[I_\ell^n(s) = \int_0^{+\infty} \frac{\mathrm{d}q}{2\pi^2} 
\, q^2 \, P(q) \, \frac{j_\ell(qs)}{(qs)^n} \quad , 
\quad \sigma_i = \int_0^{+\infty} \frac{\mathrm{d}q}{2\pi^2} 
\, q^{2-i} \, P(q)\]</p><p>with <span>$P(q)$</span> as the matter Power Spectrum at <span>$z=0$</span> (stored in <code>cosmo</code>)  and <span>$j_\ell$</span> as spherical Bessel function of order <span>$\ell$</span>;</p></li><li><p><span>$\tilde{I}_0^4$</span> is defined as</p><p class="math-container">\[\tilde{I}_0^4 = \int_0^{+\infty} \frac{\mathrm{d}q}{2\pi^2} 
\, q^2 \, P(q) \, \frac{j_0(qs) - 1}{(qs)^4}\]</p><p>with <span>$P(q)$</span> as the matter Power Spectrum at <span>$z=0$</span> (stored in <code>cosmo</code>)  and <span>$j_\ell$</span> as spherical Bessel function of order <span>$\ell$</span>;</p></li><li><p><span>$\mathcal{H}_0$</span>, <span>$f_0$</span> and so on are evaluated at the observer position (i.e. at present day);</p></li><li><p><span>$\Delta\chi_1 := \sqrt{\chi_1^2 + s_2^2-2\,\chi_1\,s_2\,y}$</span> and  <span>$\Delta\chi_2 := \sqrt{s_1^2 + \chi_2^2-2\,s_1\,\chi_2\,y}$</span>;</p></li><li><p><span>$s=\sqrt{s_1^2 + s_2^2 - 2 \, s_1 \, s_2 \, y}$</span> and  <span>$\Delta\chi := \sqrt{\chi_1^2 + \chi_2^2-2\,\chi_1\,\chi_2\,y}$</span>.</p></li></ul><p>In this TPCF, the terms proportional to <span>$D(s_1)$</span> and <span>$D(s_2)$</span> are observer terms  (while the term proportional to <span>$D(s_1) \, D(s_2)$</span> is not), but only the <span>$\propto D(s_2)$</span> one depends on the observer velocity. Consequently, if you set:</p><ul><li><code>obs = :yes</code> or <code>obs = true</code> all of them will be computed</li><li><code>obs = :noobsvel</code> then the  <span>$\propto D(s_2)$</span> term will be neglected</li><li><code>obs = :no</code> or <code>obs = false</code> only the first one <span>$\propto D(s_1) \, D(s_2)$</span> will be taken into account.</li></ul><p><strong>Inputs</strong></p><ul><li><p><code>P1::Point</code> and <code>P2::Point</code>, or <code>s1</code> and <code>s2</code>: <code>Point</code>/comoving distances where the  TPCF has to be calculated; they contain all the  data of interest needed for this calculus (comoving distance, growth factor and so on).</p></li><li><p><code>y</code>: the cosine of the angle between the two points <code>P1</code> and <code>P2</code> wrt the observer</p></li><li><p><code>cosmo::Cosmology</code>: cosmology to be used in this computation; it contains all the splines used for the conversion <code>s</code> -&gt; <code>Point</code>, and all the cosmological parameters <span>$b$</span>, ...</p></li></ul><p><strong>Keyword Arguments</strong></p><ul><li><code>obs::Union{Bool,Symbol} = :noobsvel</code> : do you want to consider the observer terms in the computation of the  chosen GNC TPCF effect?<ul><li><code>:yes</code> or <code>true</code> -&gt; all the observer effects will be considered</li><li><code>:no</code> or <code>false</code> -&gt; no observer term will be taken into account</li><li><code>:noobsvel</code> -&gt; the observer terms related to the observer velocity (that you can find in the CF concerning Doppler) will be neglected, the other ones will be taken into account</li></ul></li></ul><p>See also: <a href="../Cosmology/#GaPSE.Point"><code>Point</code></a>, <a href="../Cosmology/#GaPSE.Cosmology"><code>Cosmology</code></a>, <a href="#GaPSE.ξ_GNC_multipole"><code>ξ_GNC_multipole</code></a>,  <a href="#GaPSE.map_ξ_GNC_multipole"><code>map_ξ_GNC_multipole</code></a>, <a href="#GaPSE.print_map_ξ_GNC_multipole"><code>print_map_ξ_GNC_multipole</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cosmofico97/GaPSE/blob/5f3347ff3b074f172d8e3ff7fa715eea30fd3aad/src/GNC_CrossCorrelations/GNC_DopplerLocalGP.jl#L97-L255">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="GaPSE.ξ_GNC_LocalGP_Doppler" href="#GaPSE.ξ_GNC_LocalGP_Doppler"><code>GaPSE.ξ_GNC_LocalGP_Doppler</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs"> ξ_GNC_LocalGP_Doppler(s1, s2, y, cosmo::Cosmology; kwargs...) = 
      ξ_GNC_Doppler_LocalGP(s2, s1, y, cosmo; kwargs...)</code></pre><p>Return the Two-Point Correlation Function (TPCF) given by the cross correlation between the  Local Gravitational Potential (GP) and the Doppler effects arising from the Galaxy Number Counts (GNC).</p><p>It&#39;s computed through the symmetric function <code>ξ_GNC_Doppler_LocalGP</code>; check its documentation for more details about the analytical expression and the keyword arguments. We remember that all the distances are measured in <span>$h_0^{-1}\mathrm{Mpc}$</span>.</p><p><strong>Inputs</strong></p><ul><li><p><code>s1</code> and <code>s2</code>: comoving distances where the TPCF has to be calculated;</p></li><li><p><code>y</code>: the cosine of the angle between the two points <code>P1</code> and <code>P2</code> wrt the observer</p></li><li><p><code>cosmo::Cosmology</code>: cosmology to be used in this computation; it contains all the splines used for the conversion <code>s</code> -&gt; <code>Point</code>, and all the cosmological parameters <span>$b$</span>, ...</p></li></ul><p><strong>Keyword Arguments</strong></p><ul><li><code>kwargs...</code> : Keyword arguments to be passed to the symmetric TPCF</li></ul><p>See also: <a href="../Cosmology/#GaPSE.Point"><code>Point</code></a>, <a href="../Cosmology/#GaPSE.Cosmology"><code>Cosmology</code></a>, <a href="#GaPSE.ξ_GNC_multipole"><code>ξ_GNC_multipole</code></a>,  <a href="#GaPSE.map_ξ_GNC_multipole"><code>map_ξ_GNC_multipole</code></a>, <a href="#GaPSE.print_map_ξ_GNC_multipole"><code>print_map_ξ_GNC_multipole</code></a>, <a href="#GaPSE.ξ_GNC_Doppler_LocalGP"><code>ξ_GNC_Doppler_LocalGP</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cosmofico97/GaPSE/blob/5f3347ff3b074f172d8e3ff7fa715eea30fd3aad/src/GNC_CrossCorrelations/GNC_DopplerLocalGP.jl#L270-L298">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="GaPSE.ξ_GNC_Doppler_IntegratedGP" href="#GaPSE.ξ_GNC_Doppler_IntegratedGP"><code>GaPSE.ξ_GNC_Doppler_IntegratedGP</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs"> ξ_GNC_Doppler_IntegratedGP(
      s1, s2, y, cosmo::Cosmology;
      en::Float64=1e6, N_χs::Int=100, 
      obs::Union{Bool,Symbol}=:noobsvel
      ) ::Float64</code></pre><p>Return the Two-Point Correlation Function (TPCF) given by the cross correlation between the  Doppler and the Integrated Gravitational Potential (GP) effects arising from the Galaxy Number Counts (GNC).</p><p>You must provide the two comoving distances <code>s1</code> and <code>s2</code> where to  evaluate the function. We remember that all the distances are measured in <span>$h_0^{-1}\mathrm{Mpc}$</span>.</p><p>The analytical expression of this integrand is the following:</p><p class="math-container">\[\begin{split}
    \xi^{v_{\parallel} \int\!\phi} \left( s_1 , s_2, y \right) &amp;= D_1 \int_0^{s_2}\mathrm{d} \chi_2 \; 
    J^{v_{\parallel} \int\!\phi}_{\alpha} 
    \left[
        \frac{1}{15} I_0^0 ( \Delta\chi_2 ) +
        \frac{2}{21} I_2^0 ( \Delta\chi_2 ) +
        \right.  \\
        &amp;\left.
        \frac{1}{35} I_4^0 ( \Delta\chi_2 ) +
        I^2_0 ( \Delta\chi_2) 
    \right]
    + \int_0^{s_2}\mathrm{d} \chi_2  
    J^{v_{\parallel} \int\!\phi}_{31} I^3_1 (\chi_2)  
    \, ,\nonumber
\end{split}\]</p><p>where</p><p class="math-container">\[\begin{split}
    J^{v_{\parallel} \int\!\phi}_{\alpha} &amp;=
    \frac{f_1 \mathcal{H}_1 \mathcal{R}_1}{s_2 a(\chi_2)} 
    D(\chi_2) \mathcal{H}_0^2 \Omega_{\mathrm{M}0} \Delta\chi_2^2 
    (\chi_2 y - s_1) 
    \left[
        s_2 \mathcal{H}(\chi_2) \mathcal{R}_2 (f(\chi_2) - 1) - 5 s_{\mathrm{b}, 2} + 2
    \right]
    \, , \\
    %%%%%%%%%%%%%%%%%%%%%
    J^{v_{\parallel} \int\!\phi}_{31} &amp;=
    -\frac{
        3 \chi_2^3 y f_0 \mathcal{H}_0^3 \Omega_{\mathrm{M}0} D(\chi_2)
    }{
        s_2 a(\chi_2)
    }(\mathcal{R}_1 - 5 s_{\mathrm{b}, 1} + 2)
    \left[
        s_2 \mathcal{H}(\chi_2) \mathcal{R}_2 (f(\chi_2) - 1) - 5 s_{\mathrm{b}, 2} + 2)
    \right] 
    \, . 
\end{split}\]</p><p>where:</p><ul><li><p><span>$s_1$</span> and <span>$s_2$</span> are comoving distances;</p></li><li><p><span>$D_1 = D(s_1)$</span>, ... is the linear growth factor (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$a_1 = a(s_1)$</span>, ... is the scale factor (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$f_1 = f(s_1)$</span>, ... is the linear growth rate (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$\mathcal{H}_1 = \mathcal{H}(s_1)$</span>, ... is the comoving  Hubble distances (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$y = \cos{\theta} = \hat{\mathbf{s}}_1 \cdot \hat{\mathbf{s}}_2$</span>;</p></li><li><p><span>$\mathcal{R}_1 = \mathcal{R}(s_1)$</span>, ... is  computed by <code>func_ℛ_GNC</code> in <code>cosmo::Cosmology</code> (and evaluated in <span>$s_1$</span> ); the definition of <span>$\mathcal{R}(s)$</span> is the following:</p><p class="math-container">\[\mathcal{R}(s) = 5 s_{\mathrm{b}}(s) + \frac{2 - 5 s_{\mathrm{b}}(s)}{\mathcal{H}(s) \, s} +  
\frac{\dot{\mathcal{H}}(s)}{\mathcal{H}(s)^2} - \mathit{f}_{\mathrm{evo}} \quad ;\]</p></li><li><p><span>$b_1 = b(s_1)$</span>, <span>$s_{\mathrm{b}, 1} = s_{\mathrm{b}}(s_1)$</span>, <span>$\mathit{f}_{\mathrm{evo}}$</span>, ... :  galaxy bias, magnification bias (i.e. the slope of the luminosity function at the luminosity threshold),  and evolution bias (the first two evaluated in <span>$s_1$</span>); they are all stored in <code>cosmo</code>;</p></li><li><p><span>$\Omega_{\mathrm{M}0} = \Omega_{\mathrm{cdm}} + \Omega_{\mathrm{b}}$</span> is the sum of  cold-dark-matter and barionic density parameters (again, stored in <code>cosmo</code>);</p></li><li><p><span>$I_\ell^n$</span> and <span>$\sigma_i$</span> are defined as</p><p class="math-container">\[I_\ell^n(s) = \int_0^{+\infty} \frac{\mathrm{d}q}{2\pi^2} 
\, q^2 \, P(q) \, \frac{j_\ell(qs)}{(qs)^n} \quad , 
\quad \sigma_i = \int_0^{+\infty} \frac{\mathrm{d}q}{2\pi^2} 
\, q^{2-i} \, P(q)\]</p><p>with <span>$P(q)$</span> as the matter Power Spectrum at <span>$z=0$</span> (stored in <code>cosmo</code>)  and <span>$j_\ell$</span> as spherical Bessel function of order <span>$\ell$</span>;</p></li><li><p><span>$\tilde{I}_0^4$</span> is defined as</p><p class="math-container">\[\tilde{I}_0^4 = \int_0^{+\infty} \frac{\mathrm{d}q}{2\pi^2} 
\, q^2 \, P(q) \, \frac{j_0(qs) - 1}{(qs)^4}\]</p><p>with <span>$P(q)$</span> as the matter Power Spectrum at <span>$z=0$</span> (stored in <code>cosmo</code>)  and <span>$j_\ell$</span> as spherical Bessel function of order <span>$\ell$</span>;</p></li><li><p><span>$\mathcal{H}_0$</span>, <span>$f_0$</span> and so on are evaluated at the observer position (i.e. at present day);</p></li><li><p><span>$\Delta\chi_1 := \sqrt{\chi_1^2 + s_2^2-2\,\chi_1\,s_2\,y}$</span> and  <span>$\Delta\chi_2 := \sqrt{s_1^2 + \chi_2^2-2\,s_1\,\chi_2\,y}$</span>;</p></li><li><p><span>$s=\sqrt{s_1^2 + s_2^2 - 2 \, s_1 \, s_2 \, y}$</span> and  <span>$\Delta\chi := \sqrt{\chi_1^2 + \chi_2^2-2\,\chi_1\,\chi_2\,y}$</span>.</p></li></ul><p>In this TPCF, the term proportional to <span>$D(s_1)$</span> is not an observer term. The other one instead is and it does depend on the observer velocity. Consequently, if you set <code>obs = :yes</code> or <code>obs = true</code> both of them will computed, while for <code>obs = :no</code>, <code>obs = false</code> or even <code>obs = :noobsvel</code> only the <span>$\propto D(s_1)$</span> one will be taken into account.</p><p>This function is computed integrating <code>integrand_ξ_GNC_Doppler_IntegratedGP</code> with <a href="@ref"><code>trapz</code></a> from the  <a href="https://github.com/francescoalemanno/Trapz.jl">Trapz</a> Julia package.</p><p><strong>Inputs</strong></p><ul><li><p><code>P1::Point</code> and <code>P2::Point</code>, or <code>s1</code> and <code>s2</code>: <code>Point</code>/comoving distances where the  TPCF has to be calculated; they contain all the  data of interest needed for this calculus (comoving distance, growth factor and so on).</p></li><li><p><code>y</code>: the cosine of the angle between the two points <code>P1</code> and <code>P2</code> wrt the observer</p></li><li><p><code>cosmo::Cosmology</code>: cosmology to be used in this computation; it contains all the splines used for the conversion <code>s</code> -&gt; <code>Point</code>, and all the cosmological parameters <span>$b$</span>, ...</p></li></ul><p><strong>Keyword Arguments</strong></p><ul><li><p><code>obs::Union{Bool,Symbol} = :noobsvel</code> : do you want to consider the observer terms in the computation of the  chosen GNC TPCF effect?</p><ul><li><code>:yes</code> or <code>true</code> -&gt; all the observer effects will be considered</li><li><code>:no</code> or <code>false</code> -&gt; no observer term will be taken into account</li><li><code>:noobsvel</code> -&gt; the observer terms related to the observer velocity (that you can find in the CF concerning Doppler) will be neglected, the other ones will be taken into account</li></ul></li><li><p><code>en::Float64 = 1e6</code>: just a float number used in order to deal better  with small numbers;</p></li><li><p><code>N_χs::Int = 100</code>: number of points to be used for sampling the integral along the range <code>(0, s2)</code> (for <code>χ2</code>); it has been checked that with <code>N_χs ≥ 100</code> the result is stable.</p></li></ul><p>See also: <a href="../Cosmology/#GaPSE.Point"><code>Point</code></a>, <a href="../Cosmology/#GaPSE.Cosmology"><code>Cosmology</code></a>, <a href="#GaPSE.ξ_GNC_multipole"><code>ξ_GNC_multipole</code></a>,  <a href="#GaPSE.map_ξ_GNC_multipole"><code>map_ξ_GNC_multipole</code></a>, <a href="#GaPSE.print_map_ξ_GNC_multipole"><code>print_map_ξ_GNC_multipole</code></a>, <a href="#GaPSE.integrand_ξ_GNC_Doppler_IntegratedGP"><code>integrand_ξ_GNC_Doppler_IntegratedGP</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cosmofico97/GaPSE/blob/5f3347ff3b074f172d8e3ff7fa715eea30fd3aad/src/GNC_CrossCorrelations/GNC_DopplerIntegratedGP.jl#L247-L403">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="GaPSE.ξ_GNC_IntegratedGP_Doppler" href="#GaPSE.ξ_GNC_IntegratedGP_Doppler"><code>GaPSE.ξ_GNC_IntegratedGP_Doppler</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs"> ξ_GNC_IntegratedGP_Doppler(s1, s2, y, cosmo::Cosmology; kwargs...) = 
      ξ_GNC_Doppler_IntegratedGP(s2, s1, y, cosmo; kwargs...)</code></pre><p>Return the Two-Point Correlation Function (TPCF) given by the cross correlation between the  Integrated Gravitational Potential (GP) and the Doppler effects arising from the Galaxy Number Counts (GNC).</p><p>It&#39;s computed through the symmetric function <code>ξ_GNC_Doppler_IntegratedGP</code>; check its documentation for more details about the analytical expression and the keyword arguments. We remember that all the distances are measured in <span>$h_0^{-1}\mathrm{Mpc}$</span>.</p><p><strong>Inputs</strong></p><ul><li><p><code>s1</code> and <code>s2</code>: comoving distances where the TPCF has to be calculated;</p></li><li><p><code>y</code>: the cosine of the angle between the two points <code>P1</code> and <code>P2</code> wrt the observer</p></li><li><p><code>cosmo::Cosmology</code>: cosmology to be used in this computation; it contains all the splines used for the conversion <code>s</code> -&gt; <code>Point</code>, and all the cosmological parameters <span>$b$</span>, ...</p></li></ul><p><strong>Keyword Arguments</strong></p><ul><li><code>kwargs...</code> : Keyword arguments to be passed to the symmetric TPCF</li></ul><p>See also: <a href="../Cosmology/#GaPSE.Point"><code>Point</code></a>, <a href="../Cosmology/#GaPSE.Cosmology"><code>Cosmology</code></a>, <a href="#GaPSE.ξ_GNC_multipole"><code>ξ_GNC_multipole</code></a>,  <a href="#GaPSE.map_ξ_GNC_multipole"><code>map_ξ_GNC_multipole</code></a>, <a href="#GaPSE.print_map_ξ_GNC_multipole"><code>print_map_ξ_GNC_multipole</code></a>, <a href="#GaPSE.ξ_GNC_Doppler_IntegratedGP"><code>ξ_GNC_Doppler_IntegratedGP</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cosmofico97/GaPSE/blob/5f3347ff3b074f172d8e3ff7fa715eea30fd3aad/src/GNC_CrossCorrelations/GNC_DopplerIntegratedGP.jl#L433-L461">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="GaPSE.ξ_GNC_Lensing_LocalGP" href="#GaPSE.ξ_GNC_Lensing_LocalGP"><code>GaPSE.ξ_GNC_Lensing_LocalGP</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs"> ξ_GNC_Lensing_LocalGP(
      s1, s2, y, cosmo::Cosmology;
      en::Float64=1e6, N_χs::Int=100, 
      obs::Union{Bool,Symbol}=:noobsvel
      ) ::Float64</code></pre><p>Return the Two-Point Correlation Function (TPCF) given  by the cross correlation between the Lensing and the Local Gravitational Potential (GP) effects arising  from the Galaxy Number Counts (GNC).</p><p>You must provide the two comoving distances <code>s1</code> and <code>s2</code> where to  evaluate the function. We remember that all the distances are measured in <span>$h_0^{-1}\mathrm{Mpc}$</span>.</p><p>The analytical expression of this integrand is the following:</p><p class="math-container">\[\begin{split}
    \xi^{\kappa \phi} ( s_1 , s_2, y ) &amp;= 
    D_2 \int_0^{s_1}\mathrm{d} \chi_1 \; 
    J^{\kappa \phi}_{\alpha}\left[ 
        J^{\kappa \phi}_{20} I_0^2 ( \Delta \chi_1 ) +
        \right.\nonumber \\
        &amp;\left.\qquad
        J^{\kappa \phi}_{\beta}
        \left(
            \frac{1}{60} I_0^0 ( \Delta \chi_1 ) +
            \frac{1}{42} I_2^0 ( \Delta \chi_1 ) +
            \frac{1}{140} I_4^0 ( \Delta \chi_1 ) 
        \right)
    \right] \, ,
\end{split}\]</p><p>where</p><p class="math-container">\[\begin{split}
    J^{\kappa \phi}_{\alpha}  &amp;= 
    \frac{\mathcal{H}_0^2 \Omega_{\mathrm{M}0} s_2 D(\chi_1)}{a(\chi_1) a_2 s_1}
    (\chi_1 - s_1)  (5s_{\mathrm{b}, 1} - 2) 
    \times\\
    &amp;\qquad\qquad
    \left[
       2 f_2 a_2 \mathcal{H}_2^2 (\mathit{f}_{\mathrm{evo}, 2} - 3) + 
       3 \mathcal{H}_0^2 \Omega_{\mathrm{M}0} (f_2 + \mathcal{R}_2 + 5s_{\mathrm{b}, 2} - 2)
    \right] \nonumber
    \, , \\
    %%%%%%%%%%%%%%%%%%%
    J^{\kappa \phi}_{\beta} &amp;=
    2 y \chi_1^2 - \chi_1 s_2 (y^2 + 3) + 2 y s_2^2
    \, ,\\
    %%%%%%%%%%%%%%%%%%%
    J^{\kappa \phi}_{20} &amp;= \frac{1}{2} y \Delta\chi_1^2\, .
\end{split}\]</p><p>where:</p><ul><li><p><span>$s_1$</span> and <span>$s_2$</span> are comoving distances;</p></li><li><p><span>$D_1 = D(s_1)$</span>, ... is the linear growth factor (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$a_1 = a(s_1)$</span>, ... is the scale factor (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$f_1 = f(s_1)$</span>, ... is the linear growth rate (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$\mathcal{H}_1 = \mathcal{H}(s_1)$</span>, ... is the comoving  Hubble distances (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$y = \cos{\theta} = \hat{\mathbf{s}}_1 \cdot \hat{\mathbf{s}}_2$</span>;</p></li><li><p><span>$\mathcal{R}_1 = \mathcal{R}(s_1)$</span>, ... is  computed by <code>func_ℛ_GNC</code> in <code>cosmo::Cosmology</code> (and evaluated in <span>$s_1$</span> ); the definition of <span>$\mathcal{R}(s)$</span> is the following:</p><p class="math-container">\[\mathcal{R}(s) = 5 s_{\mathrm{b}}(s) + \frac{2 - 5 s_{\mathrm{b}}(s)}{\mathcal{H}(s) \, s} +  
\frac{\dot{\mathcal{H}}(s)}{\mathcal{H}(s)^2} - \mathit{f}_{\mathrm{evo}} \quad ;\]</p></li><li><p><span>$b_1 = b(s_1)$</span>, <span>$s_{\mathrm{b}, 1} = s_{\mathrm{b}}(s_1)$</span>, <span>$\mathit{f}_{\mathrm{evo}}$</span>, ... :  galaxy bias, magnification bias (i.e. the slope of the luminosity function at the luminosity threshold),  and evolution bias (the first two evaluated in <span>$s_1$</span>); they are all stored in <code>cosmo</code>;</p></li><li><p><span>$\Omega_{\mathrm{M}0} = \Omega_{\mathrm{cdm}} + \Omega_{\mathrm{b}}$</span> is the sum of  cold-dark-matter and barionic density parameters (again, stored in <code>cosmo</code>);</p></li><li><p><span>$I_\ell^n$</span> and <span>$\sigma_i$</span> are defined as</p><p class="math-container">\[I_\ell^n(s) = \int_0^{+\infty} \frac{\mathrm{d}q}{2\pi^2} 
\, q^2 \, P(q) \, \frac{j_\ell(qs)}{(qs)^n} \quad , 
\quad \sigma_i = \int_0^{+\infty} \frac{\mathrm{d}q}{2\pi^2} 
\, q^{2-i} \, P(q)\]</p><p>with <span>$P(q)$</span> as the matter Power Spectrum at <span>$z=0$</span> (stored in <code>cosmo</code>)  and <span>$j_\ell$</span> as spherical Bessel function of order <span>$\ell$</span>;</p></li><li><p><span>$\tilde{I}_0^4$</span> is defined as</p><p class="math-container">\[\tilde{I}_0^4 = \int_0^{+\infty} \frac{\mathrm{d}q}{2\pi^2} 
\, q^2 \, P(q) \, \frac{j_0(qs) - 1}{(qs)^4}\]</p><p>with <span>$P(q)$</span> as the matter Power Spectrum at <span>$z=0$</span> (stored in <code>cosmo</code>)  and <span>$j_\ell$</span> as spherical Bessel function of order <span>$\ell$</span>;</p></li><li><p><span>$\mathcal{H}_0$</span>, <span>$f_0$</span> and so on are evaluated at the observer position (i.e. at present day);</p></li><li><p><span>$\Delta\chi_1 := \sqrt{\chi_1^2 + s_2^2-2\,\chi_1\,s_2\,y}$</span> and  <span>$\Delta\chi_2 := \sqrt{s_1^2 + \chi_2^2-2\,s_1\,\chi_2\,y}$</span>;</p></li><li><p><span>$s=\sqrt{s_1^2 + s_2^2 - 2 \, s_1 \, s_2 \, y}$</span> and  <span>$\Delta\chi := \sqrt{\chi_1^2 + \chi_2^2-2\,\chi_1\,\chi_2\,y}$</span>.</p></li></ul><p>In this TPCF there are no observer terms. The <code>obs</code> keyword is inserted only for compatibility with  the other GNC TPCFs.</p><p>This function is computed from <code>integrand_ξ_GNC_Lensing_LocalGP</code> with <a href="@ref"><code>trapz</code></a> from the  <a href="https://github.com/francescoalemanno/Trapz.jl">Trapz</a> Julia package.</p><p><strong>Inputs</strong></p><ul><li><p><code>P1::Point</code>, <code>P2::Point</code> or <code>s1</code>,<code>s2</code>: <code>Point</code>/comoving  distances where the TPCF has to be calculated; they contain all the  data of interest needed for this calculus (comoving distance, growth factor and so on).</p></li><li><p><code>y</code>: the cosine of the angle between the two points <code>P1</code> and <code>P2</code> wrt the observer</p></li><li><p><code>cosmo::Cosmology</code>: cosmology to be used in this computation; it contains all the splines used for the conversion <code>s</code> -&gt; <code>Point</code>, and all the cosmological parameters <span>$b$</span>, ...</p></li></ul><p><strong>Keyword Arguments</strong></p><ul><li><p><code>obs::Union{Bool,Symbol} = :noobsvel</code> : do you want to consider the observer terms in the computation of the  chosen GNC TPCF effect?</p><ul><li><code>:yes</code> or <code>true</code> -&gt; all the observer effects will be considered</li><li><code>:no</code> or <code>false</code> -&gt; no observer term will be taken into account</li><li><code>:noobsvel</code> -&gt; the observer terms related to the observer velocity (that you can find in the CF concerning Doppler) will be neglected, the other ones will be taken into account</li></ul></li><li><p><code>en::Float64 = 1e6</code>: just a float number used in order to deal better  with small numbers;</p></li><li><p><code>N_χs::Int = 100</code>: number of points to be used for sampling the integral along the range <code>(0, s1)</code> (for <code>χ1</code>); it has been checked that with <code>N_χs ≥ 100</code> the result is stable.</p></li></ul><p>See also: <a href="../Cosmology/#GaPSE.Point"><code>Point</code></a>, <a href="../Cosmology/#GaPSE.Cosmology"><code>Cosmology</code></a>, <a href="#GaPSE.ξ_GNC_multipole"><code>ξ_GNC_multipole</code></a>,  <a href="#GaPSE.map_ξ_GNC_multipole"><code>map_ξ_GNC_multipole</code></a>, <a href="#GaPSE.print_map_ξ_GNC_multipole"><code>print_map_ξ_GNC_multipole</code></a>, <a href="#GaPSE.integrand_ξ_GNC_Lensing_LocalGP"><code>integrand_ξ_GNC_Lensing_LocalGP</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cosmofico97/GaPSE/blob/5f3347ff3b074f172d8e3ff7fa715eea30fd3aad/src/GNC_CrossCorrelations/GNC_LensingLocalGP.jl#L231-L385">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="GaPSE.ξ_GNC_LocalGP_Lensing" href="#GaPSE.ξ_GNC_LocalGP_Lensing"><code>GaPSE.ξ_GNC_LocalGP_Lensing</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs"> ξ_GNC_LocalGP_Lensing(s1, s2, y, cosmo::Cosmology; kwargs...) = 
      ξ_GNC_Lensing_LocalGP(s2, s1, y, cosmo; kwargs...)</code></pre><p>Return the Two-Point Correlation Function (TPCF) given by the cross correlation between the  Local Gravitational Potential (GP) and the Lensing effects arising from the Galaxy Number Counts (GNC).</p><p>It&#39;s computed through the symmetric function <code>ξ_GNC_Lensing_LocalGP</code>; check its documentation for more details about the analytical expression and the keyword arguments. We remember that all the distances are measured in <span>$h_0^{-1}\mathrm{Mpc}$</span>.</p><p><strong>Inputs</strong></p><ul><li><p><code>s1</code> and <code>s2</code>: comoving distances where the TPCF has to be calculated;</p></li><li><p><code>y</code>: the cosine of the angle between the two points <code>P1</code> and <code>P2</code> wrt the observer</p></li><li><p><code>cosmo::Cosmology</code>: cosmology to be used in this computation; it contains all the splines used for the conversion <code>s</code> -&gt; <code>Point</code>, and all the cosmological parameters <span>$b$</span>, ...</p></li></ul><p><strong>Keyword Arguments</strong></p><ul><li><code>kwargs...</code> : Keyword arguments to be passed to the symmetric TPCF</li></ul><p>See also: <a href="../Cosmology/#GaPSE.Point"><code>Point</code></a>, <a href="../Cosmology/#GaPSE.Cosmology"><code>Cosmology</code></a>, <a href="#GaPSE.ξ_GNC_multipole"><code>ξ_GNC_multipole</code></a>,  <a href="#GaPSE.map_ξ_GNC_multipole"><code>map_ξ_GNC_multipole</code></a>, <a href="#GaPSE.print_map_ξ_GNC_multipole"><code>print_map_ξ_GNC_multipole</code></a>, <a href="#GaPSE.ξ_GNC_Lensing_LocalGP"><code>ξ_GNC_Lensing_LocalGP</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cosmofico97/GaPSE/blob/5f3347ff3b074f172d8e3ff7fa715eea30fd3aad/src/GNC_CrossCorrelations/GNC_LensingLocalGP.jl#L414-L442">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="GaPSE.ξ_GNC_Lensing_IntegratedGP" href="#GaPSE.ξ_GNC_Lensing_IntegratedGP"><code>GaPSE.ξ_GNC_Lensing_IntegratedGP</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs"> ξ_GNC_Lensing_IntegratedGP(
      P1::Point, P2::Point, y, cosmo::Cosmology;
      en::Float64=1e6, N_χs_2::Int=100, 
      obs::Union{Bool,Symbol}=:noobsvel
      ) ::Float64

 ξ_GNC_Lensing_IntegratedGP(
      s1, s2, y, cosmo::Cosmology; 
      kwargs...) ::Float64</code></pre><p>Return the Two-Point Correlation Function (TPCF) given  by the cross correlation between the Lensing and the Integrated Gravitational Potential (GP) effects arising  from the Galaxy Number Counts (GNC).</p><p>In the first method, you should pass the two <code>Point</code> (<code>P1</code> and <code>P2</code>) where to  evaluate the function, while in the second method (that internally recalls the first)  you must provide the two corresponding comoving distances <code>s1</code> and <code>s2</code>. We remember that all the distances are measured in <span>$h_0^{-1}\mathrm{Mpc}$</span>.</p><p>The analytical expression of this integrand is the following:</p><p class="math-container">\[\begin{split}
    \xi^{\kappa \int\!\phi} ( s_1 , s_2, y ) = 
    \int_0^{s_1}\mathrm{d} \chi_1 \int_0^{s_2}\mathrm{d} \chi_2 \;
    J_{\alpha}^{\kappa \int\!\phi} 
    \left[ 
        J_{31}^{\kappa \int\!\phi} I_1^3 ( \Delta \chi ) +
        J_{22}^{\kappa \int\!\phi} I_2^2 ( \Delta \chi ) 
     \right] \, ,
\end{split}\]</p><p>where</p><p class="math-container">\[\begin{split}
     J_{\alpha}^{\kappa \int\!\phi} &amp;=
    \frac{
        9 \chi_2 \ \mathcal{H}_0^4  \Omega_{\mathrm{M}0}^2 D(\chi_1) D(\chi_2) 
    }{
        a(\chi_1)  a(\chi_2) s_1  s_2
    }
    (\chi_1 - s_1) (5 s_{\mathrm{b}, 1} - 2) \times\\
    &amp;\qquad\qquad\qquad\qquad\qquad\qquad
    \left[
        \ \mathcal{H}(\chi_2)  \mathcal{R}_2 s_1 (f(\chi_2) - 1) - 5 s_{\mathrm{b}, 1} + 2
    \right] \nonumber
    \, , \\
    %%%%%%%%%%%%%
    J_{31}^{\kappa \int\!\phi} &amp;=  y \Delta\chi^2
    \, , \\
    %%%%%%%%%%%%%
    J_{22}^{\kappa \int\!\phi} &amp;= 
    \frac{1}{2} (y^2 - 1) \chi_1 \chi_2 
    \, .
\end{split}\]</p><p>where:</p><ul><li><p><span>$s_1$</span> and <span>$s_2$</span> are comoving distances;</p></li><li><p><span>$D_1 = D(s_1)$</span>, ... is the linear growth factor (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$a_1 = a(s_1)$</span>, ... is the scale factor (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$f_1 = f(s_1)$</span>, ... is the linear growth rate (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$\mathcal{H}_1 = \mathcal{H}(s_1)$</span>, ... is the comoving  Hubble distances (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$y = \cos{\theta} = \hat{\mathbf{s}}_1 \cdot \hat{\mathbf{s}}_2$</span>;</p></li><li><p><span>$\mathcal{R}_1 = \mathcal{R}(s_1)$</span>, ... is  computed by <code>func_ℛ_GNC</code> in <code>cosmo::Cosmology</code> (and evaluated in <span>$s_1$</span> ); the definition of <span>$\mathcal{R}(s)$</span> is the following:</p><p class="math-container">\[\mathcal{R}(s) = 5 s_{\mathrm{b}}(s) + \frac{2 - 5 s_{\mathrm{b}}(s)}{\mathcal{H}(s) \, s} +  
\frac{\dot{\mathcal{H}}(s)}{\mathcal{H}(s)^2} - \mathit{f}_{\mathrm{evo}} \quad ;\]</p></li><li><p><span>$b_1 = b(s_1)$</span>, <span>$s_{\mathrm{b}, 1} = s_{\mathrm{b}}(s_1)$</span>, <span>$\mathit{f}_{\mathrm{evo}}$</span>, ... :  galaxy bias, magnification bias (i.e. the slope of the luminosity function at the luminosity threshold),  and evolution bias (the first two evaluated in <span>$s_1$</span>); they are all stored in <code>cosmo</code>;</p></li><li><p><span>$\Omega_{\mathrm{M}0} = \Omega_{\mathrm{cdm}} + \Omega_{\mathrm{b}}$</span> is the sum of  cold-dark-matter and barionic density parameters (again, stored in <code>cosmo</code>);</p></li><li><p><span>$I_\ell^n$</span> and <span>$\sigma_i$</span> are defined as</p><p class="math-container">\[I_\ell^n(s) = \int_0^{+\infty} \frac{\mathrm{d}q}{2\pi^2} 
\, q^2 \, P(q) \, \frac{j_\ell(qs)}{(qs)^n} \quad , 
\quad \sigma_i = \int_0^{+\infty} \frac{\mathrm{d}q}{2\pi^2} 
\, q^{2-i} \, P(q)\]</p><p>with <span>$P(q)$</span> as the matter Power Spectrum at <span>$z=0$</span> (stored in <code>cosmo</code>)  and <span>$j_\ell$</span> as spherical Bessel function of order <span>$\ell$</span>;</p></li><li><p><span>$\tilde{I}_0^4$</span> is defined as</p><p class="math-container">\[\tilde{I}_0^4 = \int_0^{+\infty} \frac{\mathrm{d}q}{2\pi^2} 
\, q^2 \, P(q) \, \frac{j_0(qs) - 1}{(qs)^4}\]</p><p>with <span>$P(q)$</span> as the matter Power Spectrum at <span>$z=0$</span> (stored in <code>cosmo</code>)  and <span>$j_\ell$</span> as spherical Bessel function of order <span>$\ell$</span>;</p></li><li><p><span>$\mathcal{H}_0$</span>, <span>$f_0$</span> and so on are evaluated at the observer position (i.e. at present day);</p></li><li><p><span>$\Delta\chi_1 := \sqrt{\chi_1^2 + s_2^2-2\,\chi_1\,s_2\,y}$</span> and  <span>$\Delta\chi_2 := \sqrt{s_1^2 + \chi_2^2-2\,s_1\,\chi_2\,y}$</span>;</p></li><li><p><span>$s=\sqrt{s_1^2 + s_2^2 - 2 \, s_1 \, s_2 \, y}$</span> and  <span>$\Delta\chi := \sqrt{\chi_1^2 + \chi_2^2-2\,\chi_1\,\chi_2\,y}$</span>.</p></li></ul><p>In this TPCF there are no observer terms. The <code>obs</code> keyword is inserted only for compatibility with  the other GNC TPCFs.</p><p>This function is computed from <code>integrand_ξ_GNC_Lensing_IntegratedGP</code> with <a href="@ref"><code>trapz</code></a> from the  <a href="https://github.com/francescoalemanno/Trapz.jl">Trapz</a> Julia package.</p><p><strong>Inputs</strong></p><ul><li><p><code>P1::Point</code>, <code>P2::Point</code> or <code>s1</code>,<code>s2</code>: <code>Point</code>/comoving  distances where the TPCF has to be calculated; they contain all the  data of interest needed for this calculus (comoving distance, growth factor and so on).</p></li><li><p><code>y</code>: the cosine of the angle between the two points <code>P1</code> and <code>P2</code> wrt the observer</p></li><li><p><code>cosmo::Cosmology</code>: cosmology to be used in this computation; it contains all the splines used for the conversion <code>s</code> -&gt; <code>Point</code>, and all the cosmological parameters <span>$b$</span>, ...</p></li></ul><p><strong>Keyword Arguments</strong></p><ul><li><p><code>obs::Union{Bool,Symbol} = :noobsvel</code> : do you want to consider the observer terms in the computation of the  chosen GNC TPCF effect?</p><ul><li><code>:yes</code> or <code>true</code> -&gt; all the observer effects will be considered</li><li><code>:no</code> or <code>false</code> -&gt; no observer term will be taken into account</li><li><code>:noobsvel</code> -&gt; the observer terms related to the observer velocity (that you can find in the CF concerning IntegratedGP) will be neglected, the other ones will be taken into account</li></ul></li><li><p><code>en::Float64 = 1e6</code>: just a float number used in order to deal better  with small numbers;</p></li><li><p><code>N_χs_2::Int = 100</code>: number of points to be used for sampling the integral along the ranges <code>(0, s1)</code> (for <code>χ1</code>) and <code>(0, s2)</code> (for <code>χ2</code>); it has been checked that with <code>N_χs_2 ≥ 50</code> the result is stable.</p></li></ul><p>See also: <a href="../Cosmology/#GaPSE.Point"><code>Point</code></a>, <a href="../Cosmology/#GaPSE.Cosmology"><code>Cosmology</code></a>, <a href="#GaPSE.ξ_GNC_multipole"><code>ξ_GNC_multipole</code></a>,  <a href="#GaPSE.map_ξ_GNC_multipole"><code>map_ξ_GNC_multipole</code></a>, <a href="#GaPSE.print_map_ξ_GNC_multipole"><code>print_map_ξ_GNC_multipole</code></a>, <a href="#GaPSE.integrand_ξ_GNC_Lensing_IntegratedGP"><code>integrand_ξ_GNC_Lensing_IntegratedGP</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cosmofico97/GaPSE/blob/5f3347ff3b074f172d8e3ff7fa715eea30fd3aad/src/GNC_CrossCorrelations/GNC_LensingIntegratedGP.jl#L262-L418">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="GaPSE.ξ_GNC_IntegratedGP_Lensing" href="#GaPSE.ξ_GNC_IntegratedGP_Lensing"><code>GaPSE.ξ_GNC_IntegratedGP_Lensing</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs"> ξ_GNC_IntegratedGP_Lensing(s1, s2, y, cosmo::Cosmology; kwargs...) = 
      ξ_GNC_Lensing_IntegratedGP(s2, s1, y, cosmo; kwargs...)</code></pre><p>Return the Two-Point Correlation Function (TPCF) given by the cross correlation between the  Integrated Gravitational Potential (GP) and the Lensing effects arising from the Galaxy Number Counts (GNC).</p><p>It&#39;s computed through the symmetric function <code>ξ_GNC_Lensing_IntegratedGP</code>; check its documentation for more details about the analytical expression and the keyword arguments. We remember that all the distances are measured in <span>$h_0^{-1}\mathrm{Mpc}$</span>.</p><p><strong>Inputs</strong></p><ul><li><p><code>s1</code> and <code>s2</code>: comoving distances where the TPCF has to be calculated;</p></li><li><p><code>y</code>: the cosine of the angle between the two points <code>P1</code> and <code>P2</code> wrt the observer</p></li><li><p><code>cosmo::Cosmology</code>: cosmology to be used in this computation; it contains all the splines used for the conversion <code>s</code> -&gt; <code>Point</code>, and all the cosmological parameters <span>$b$</span>, ...</p></li></ul><p><strong>Keyword Arguments</strong></p><ul><li><code>kwargs...</code> : Keyword arguments to be passed to the symmetric TPCF</li></ul><p>See also: <a href="../Cosmology/#GaPSE.Point"><code>Point</code></a>, <a href="../Cosmology/#GaPSE.Cosmology"><code>Cosmology</code></a>, <a href="#GaPSE.ξ_GNC_multipole"><code>ξ_GNC_multipole</code></a>,  <a href="#GaPSE.map_ξ_GNC_multipole"><code>map_ξ_GNC_multipole</code></a>, <a href="#GaPSE.print_map_ξ_GNC_multipole"><code>print_map_ξ_GNC_multipole</code></a>, <a href="#GaPSE.ξ_GNC_Lensing_IntegratedGP"><code>ξ_GNC_Lensing_IntegratedGP</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cosmofico97/GaPSE/blob/5f3347ff3b074f172d8e3ff7fa715eea30fd3aad/src/GNC_CrossCorrelations/GNC_LensingIntegratedGP.jl#L429-L457">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="GaPSE.ξ_GNC_LocalGP_IntegratedGP" href="#GaPSE.ξ_GNC_LocalGP_IntegratedGP"><code>GaPSE.ξ_GNC_LocalGP_IntegratedGP</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs"> ξ_GNC_LocalGP_IntegratedGP(
      s1, s2, y, cosmo::Cosmology;
      en::Float64=1e6, N_χs::Int=100, 
      obs::Union{Bool,Symbol}=:noobsvel
      ) ::Float64</code></pre><p>Return the Two-Point Correlation Function (TPCF) given  by the cross correlation between the Local Gravitational Potential (GP)  and the Integrated Gravitational Potential (GP) effects arising  from the Galaxy Number Counts (GNC).</p><p>You must provide the two comoving distances <code>s1</code> and <code>s2</code> where to  evaluate the function. We remember that all the distances are measured in <span>$h_0^{-1}\mathrm{Mpc}$</span>.</p><p>The analytical expression of this integrand is the following:</p><p class="math-container">\[\begin{split}
    \xi^{\phi \int\!\phi} (\chi_2, s_1 , s_2, y ) = 
    D_1 \int_0^{s_2}\mathrm{d} \chi_2
    J^{\phi \int\!\phi}_{40} \tilde{I}_0^4 ( \Delta\chi_2 ) + 
    \int_0^{s_2}\mathrm{d} \chi_2  
    J^{\phi_0 \int\!\phi}_{04} \tilde{I}_0^4 ( \chi_2 )  \, ,
\end{split}\]</p><p>where</p><p class="math-container">\[\begin{split}
    J^{\phi \int\!\phi}_{40} &amp;=
    \frac{
        3 \Delta\chi_2^4 \mathcal{H}_0^2 \Omega_{\mathrm{M}0} D(\chi_2) 
    }{
        2 s_2 a(\chi_2) a_1
    } \left[
    s_2 \mathcal{H}(\chi_2) \mathcal{R}_2(f(\chi_2)-1) -5 s_{\mathrm{b}, 2}+2
    \right] 
    \times\\
    &amp;\qquad\qquad\qquad
    \left[
        2 a_1 f_1 \mathcal{H}_1^2 (\mathit{f}_{\mathrm{evo}, 1} - 3) +
        3 \mathcal{H}_0^2 \Omega_{\mathrm{M}0} (f_1 + \mathcal{R}_1 + 5 s_{\mathrm{b}, 1} - 2)
    \right]
    \, , \nonumber \\
    %%%%%%%%%%%%%%%%%
    J^{\phi_0 \int\!\phi}_{40} &amp;=
    \frac{
        3 \chi_2^4 \mathcal{H}_0^3 \Omega_{\mathrm{M}0} D(\chi_2)
    }{
        2 s_1 s_2 a(\chi_2)
    } \left[
        s_2 \mathcal{H}(\chi_2) \mathcal{R}_2 (f(\chi_2) - 1) - 5 s_{\mathrm{b}, 2} + 2
    \right]\times
    \nonumber \\
    &amp;\qquad\qquad\qquad
    \left[
        - 3 \Omega_{\mathrm{M}0} \mathcal{H}_0 s_1 \mathcal{R}_1 +
        2 f_0 (\mathcal{H}_0 s_1 \mathcal{R}_1 + 5 s_{\mathrm{b}, 1} - 2)
    \right] 
    \, .
\end{split}\]</p><p>where:</p><ul><li><p><span>$s_1$</span> and <span>$s_2$</span> are comoving distances;</p></li><li><p><span>$D_1 = D(s_1)$</span>, ... is the linear growth factor (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$a_1 = a(s_1)$</span>, ... is the scale factor (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$f_1 = f(s_1)$</span>, ... is the linear growth rate (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$\mathcal{H}_1 = \mathcal{H}(s_1)$</span>, ... is the comoving  Hubble distances (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$y = \cos{\theta} = \hat{\mathbf{s}}_1 \cdot \hat{\mathbf{s}}_2$</span>;</p></li><li><p><span>$\mathcal{R}_1 = \mathcal{R}(s_1)$</span>, ... is  computed by <code>func_ℛ_GNC</code> in <code>cosmo::Cosmology</code> (and evaluated in <span>$s_1$</span> ); the definition of <span>$\mathcal{R}(s)$</span> is the following:</p><p class="math-container">\[\mathcal{R}(s) = 5 s_{\mathrm{b}}(s) + \frac{2 - 5 s_{\mathrm{b}}(s)}{\mathcal{H}(s) \, s} +  
\frac{\dot{\mathcal{H}}(s)}{\mathcal{H}(s)^2} - \mathit{f}_{\mathrm{evo}} \quad ;\]</p></li><li><p><span>$b_1 = b(s_1)$</span>, <span>$s_{\mathrm{b}, 1} = s_{\mathrm{b}}(s_1)$</span>, <span>$\mathit{f}_{\mathrm{evo}}$</span>, ... :  galaxy bias, magnification bias (i.e. the slope of the luminosity function at the luminosity threshold),  and evolution bias (the first two evaluated in <span>$s_1$</span>); they are all stored in <code>cosmo</code>;</p></li><li><p><span>$\Omega_{\mathrm{M}0} = \Omega_{\mathrm{cdm}} + \Omega_{\mathrm{b}}$</span> is the sum of  cold-dark-matter and barionic density parameters (again, stored in <code>cosmo</code>);</p></li><li><p><span>$I_\ell^n$</span> and <span>$\sigma_i$</span> are defined as</p><p class="math-container">\[I_\ell^n(s) = \int_0^{+\infty} \frac{\mathrm{d}q}{2\pi^2} 
\, q^2 \, P(q) \, \frac{j_\ell(qs)}{(qs)^n} \quad , 
\quad \sigma_i = \int_0^{+\infty} \frac{\mathrm{d}q}{2\pi^2} 
\, q^{2-i} \, P(q)\]</p><p>with <span>$P(q)$</span> as the matter Power Spectrum at <span>$z=0$</span> (stored in <code>cosmo</code>)  and <span>$j_\ell$</span> as spherical Bessel function of order <span>$\ell$</span>;</p></li><li><p><span>$\tilde{I}_0^4$</span> is defined as</p><p class="math-container">\[\tilde{I}_0^4 = \int_0^{+\infty} \frac{\mathrm{d}q}{2\pi^2} 
\, q^2 \, P(q) \, \frac{j_0(qs) - 1}{(qs)^4}\]</p><p>with <span>$P(q)$</span> as the matter Power Spectrum at <span>$z=0$</span> (stored in <code>cosmo</code>)  and <span>$j_\ell$</span> as spherical Bessel function of order <span>$\ell$</span>;</p></li><li><p><span>$\mathcal{H}_0$</span>, <span>$f_0$</span> and so on are evaluated at the observer position (i.e. at present day);</p></li><li><p><span>$\Delta\chi_1 := \sqrt{\chi_1^2 + s_2^2-2\,\chi_1\,s_2\,y}$</span> and  <span>$\Delta\chi_2 := \sqrt{s_1^2 + \chi_2^2-2\,s_1\,\chi_2\,y}$</span>;</p></li><li><p><span>$s=\sqrt{s_1^2 + s_2^2 - 2 \, s_1 \, s_2 \, y}$</span> and  <span>$\Delta\chi := \sqrt{\chi_1^2 + \chi_2^2-2\,\chi_1\,\chi_2\,y}$</span>.</p></li></ul><p>In this TPCF, the term proportional to <span>$D(s_1)$</span> is not an observer term. The other one instead is, and it does also depend on the observer velocity. Consequently, if you set <code>obs = :yes</code> or <code>obs = true</code> both of them will computed, while for <code>obs = :no</code>, <code>obs = false</code> or even <code>obs = :noobsvel</code> only the first one will be taken into account.</p><p>This function is computed from <code>integrand_ξ_GNC_LocalGP_IntegratedGP</code> with <a href="@ref"><code>trapz</code></a> from the  <a href="https://github.com/francescoalemanno/Trapz.jl">Trapz</a> Julia package.</p><p><strong>Inputs</strong></p><ul><li><p><code>P1::Point</code>, <code>P2::Point</code> or <code>s1</code>,<code>s2</code>: <code>Point</code>/comoving  distances where the TPCF has to be calculated; they contain all the  data of interest needed for this calculus (comoving distance, growth factor and so on).</p></li><li><p><code>y</code>: the cosine of the angle between the two points <code>P1</code> and <code>P2</code> wrt the observer</p></li><li><p><code>cosmo::Cosmology</code>: cosmology to be used in this computation; it contains all the splines used for the conversion <code>s</code> -&gt; <code>Point</code>, and all the cosmological parameters <span>$b$</span>, ...</p></li></ul><p><strong>Keyword Arguments</strong></p><ul><li><p><code>obs::Union{Bool,Symbol} = :noobsvel</code> : do you want to consider the observer terms in the computation of the  chosen GNC TPCF effect?</p><ul><li><code>:yes</code> or <code>true</code> -&gt; all the observer effects will be considered</li><li><code>:no</code> or <code>false</code> -&gt; no observer term will be taken into account</li><li><code>:noobsvel</code> -&gt; the observer terms related to the observer velocity (that you can find in the CF concerning Doppler) will be neglected, the other ones will be taken into account</li></ul></li><li><p><code>en::Float64 = 1e6</code>: just a float number used in order to deal better  with small numbers;</p></li><li><p><code>N_χs::Int = 100</code>: number of points to be used for sampling the integral along the range <code>(0, s2)</code> (for <code>χ2</code>); it has been checked that with <code>N_χs ≥ 100</code> the result is stable.</p></li></ul><p>See also: <a href="../Cosmology/#GaPSE.Point"><code>Point</code></a>, <a href="../Cosmology/#GaPSE.Cosmology"><code>Cosmology</code></a>, <a href="#GaPSE.ξ_GNC_multipole"><code>ξ_GNC_multipole</code></a>,  <a href="#GaPSE.map_ξ_GNC_multipole"><code>map_ξ_GNC_multipole</code></a>, <a href="#GaPSE.print_map_ξ_GNC_multipole"><code>print_map_ξ_GNC_multipole</code></a>, <a href="#GaPSE.integrand_ξ_GNC_LocalGP_IntegratedGP"><code>integrand_ξ_GNC_LocalGP_IntegratedGP</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cosmofico97/GaPSE/blob/5f3347ff3b074f172d8e3ff7fa715eea30fd3aad/src/GNC_CrossCorrelations/GNC_LocalGPIntegratedGP.jl#L238-L401">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="GaPSE.ξ_GNC_IntegratedGP_LocalGP" href="#GaPSE.ξ_GNC_IntegratedGP_LocalGP"><code>GaPSE.ξ_GNC_IntegratedGP_LocalGP</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs"> ξ_GNC_IntegratedGP_LocalGP(s1, s2, y, cosmo::Cosmology; kwargs...) = 
      ξ_GNC_LocalGP_IntegratedGP(s2, s1, y, cosmo; kwargs...)</code></pre><p>Return the Two-Point Correlation Function (TPCF) given by the cross correlation between the  Integrated Gravitational Potential (GP) and the Local Gravitational Potential (GP)  effects arising from the Galaxy Number Counts (GNC).</p><p>It&#39;s computed through the symmetric function <code>ξ_GNC_LocalGP_IntegratedGP</code>; check its documentation for more details about the analytical expression and the keyword arguments. We remember that all the distances are measured in <span>$h_0^{-1}\mathrm{Mpc}$</span>.</p><p><strong>Inputs</strong></p><ul><li><p><code>s1</code> and <code>s2</code>: comoving distances where the TPCF has to be calculated;</p></li><li><p><code>y</code>: the cosine of the angle between the two points <code>P1</code> and <code>P2</code> wrt the observer</p></li><li><p><code>cosmo::Cosmology</code>: cosmology to be used in this computation; it contains all the splines used for the conversion <code>s</code> -&gt; <code>Point</code>, and all the cosmological parameters <span>$b$</span>, ...</p></li></ul><p><strong>Keyword Arguments</strong></p><ul><li><code>kwargs...</code> : Keyword arguments to be passed to the symmetric TPCF</li></ul><p>See also: <a href="../Cosmology/#GaPSE.Point"><code>Point</code></a>, <a href="../Cosmology/#GaPSE.Cosmology"><code>Cosmology</code></a>, <a href="#GaPSE.ξ_GNC_multipole"><code>ξ_GNC_multipole</code></a>,  <a href="#GaPSE.map_ξ_GNC_multipole"><code>map_ξ_GNC_multipole</code></a>, <a href="#GaPSE.print_map_ξ_GNC_multipole"><code>print_map_ξ_GNC_multipole</code></a>, <a href="#GaPSE.ξ_GNC_LocalGP_IntegratedGP"><code>ξ_GNC_LocalGP_IntegratedGP</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cosmofico97/GaPSE/blob/5f3347ff3b074f172d8e3ff7fa715eea30fd3aad/src/GNC_CrossCorrelations/GNC_LocalGPIntegratedGP.jl#L431-L460">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="GaPSE.integrand_ξ_GNC_Newtonian_Lensing" href="#GaPSE.integrand_ξ_GNC_Newtonian_Lensing"><code>GaPSE.integrand_ξ_GNC_Newtonian_Lensing</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs"> integrand_ξ_GNC_Newtonian_Lensing(
      IP::Point, P1::Point, P2::Point,
      y, cosmo::Cosmology;
      Δχ_min::Float64=1e-1, 
      obs::Union{Bool,Symbol}=:noobsvel
      ) ::Float64

 integrand_ξ_GNC_Newtonian_Lensing(
      χ2::Float64, s1::Float64, s2::Float64,
      y, cosmo::Cosmology;
      kwargs... )::Float64</code></pre><p>Return the integrand of the Two-Point Correlation Function (TPCF)  given by the cross correlation between the Newtonian and the Lensing effects  arising from the Galaxy Number Counts (GNC).</p><p>In the first method, you should pass the two extreme <code>Point</code>s (<code>P1</code> and <code>P2</code>) and the  intermediate integrand <code>Point</code> (<code>IP</code>) where to  evaluate the function. In the second method (that internally recalls the first), you must provide the three corresponding comoving distances <code>s1</code>, <code>s2</code>, <code>χ2</code>. We remember that all the distances are measured in <span>$h_0^{-1}\mathrm{Mpc}$</span>.</p><p>The analytical expression of this integrand is the following:</p><p class="math-container">\[\begin{equation}
    f^{\delta\kappa} (\chi_2, s_1, s_2, y) =
    D_1 J^{\delta \kappa}_{\alpha}
    \left[ 
        J^{\delta \kappa}_{00} I_0^0 ( \Delta\chi_2 ) + 
        J^{\delta \kappa}_{02} I_2^0 ( \Delta \chi_2 ) + 
        J^{\delta \kappa}_{04} I_4^0 ( \Delta \chi_2 ) 
    \right] \, ,
\end{equation}\]</p><p>where</p><p class="math-container">\[\begin{split}
    J^{\delta \kappa}_{\alpha} &amp;=
    \frac{
        \mathcal{H}_0 ^2 \Omega_{\mathrm{M}0} D (\chi_2)
    }{
        a(\chi_2 ) s_2
    } 
    (\chi_2 - s_2 ) (5s_{\mathrm{b}, 2} - 2) 
    \, , \\
    %%%%%%%%%%%%%%%%%%%%%%%%
    J^{\delta \kappa}_{00} &amp;=
        \frac{1}{5}
        \left[
            (3 y^2 - 1) \chi_2 f_1 - y s_1(3 f_1 + 5 b_1) 
        \right] 
    \, , \\
    %%%%%%%%%%%%%%%%%%%%%%%%
    J^{\delta \kappa}_{02} &amp;=
        \frac{1}{14 \Delta\chi_2^2} 
        \left\{
            4 f_1 (3 y^2 - 1) \chi_2^3 - 
            2 y 
            \left[
                (3 y^2 + 8) f_1 + 7 b_1
            \right] s_1 \chi_2^2 +
            \right. \nonumber \\
            &amp;\left.\qquad \qquad\qquad
            \left[
                (9 y^2 + 11) f_1 - 7 (y^2 + 3) b_1
            \right] s_1^2 \chi_2 -
            2 y \left[7 b_1 + 3 f_1 \right] s_1^3
        \right\} 
    \, , \\
    %%%%%%%%%%%%%%%%%%%%%%%%
    J^{\delta \kappa}_{04} &amp;=
    \frac{f_1}{70 \Delta\chi_2^4 }
    \left\{
        (6 y^2 - 2) \chi_2^5 +
        6 y (y^2 - 3) s_1 \chi_2^4 -
        (y^4 + 12 y^2 - 21) s_1^2 \chi_2^3 +
        \right.\nonumber \\
        &amp;\left.\qquad\qquad\qquad
        2 y (y^2 + 3) s_1^3 \chi_2^2 -
        12 \chi_2 s_1^4 + 
        4 y s_1 ^5
    \right\} 
    \, .
\end{split}\]</p><p>where:</p><ul><li><p><span>$s_1$</span> and <span>$s_2$</span> are comoving distances;</p></li><li><p><span>$D_1 = D(s_1)$</span>, ... is the linear growth factor (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$a_1 = a(s_1)$</span>, ... is the scale factor (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$f_1 = f(s_1)$</span>, ... is the linear growth rate (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$\mathcal{H}_1 = \mathcal{H}(s_1)$</span>, ... is the comoving  Hubble distances (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$y = \cos{\theta} = \hat{\mathbf{s}}_1 \cdot \hat{\mathbf{s}}_2$</span>;</p></li><li><p><span>$\mathcal{R}_1 = \mathcal{R}(s_1)$</span>, ... is  computed by <code>func_ℛ_GNC</code> in <code>cosmo::Cosmology</code> (and evaluated in <span>$s_1$</span> ); the definition of <span>$\mathcal{R}(s)$</span> is the following:</p><p class="math-container">\[\mathcal{R}(s) = 5 s_{\mathrm{b}}(s) + \frac{2 - 5 s_{\mathrm{b}}(s)}{\mathcal{H}(s) \, s} +  
\frac{\dot{\mathcal{H}}(s)}{\mathcal{H}(s)^2} - \mathit{f}_{\mathrm{evo}} \quad ;\]</p></li><li><p><span>$b_1 = b(s_1)$</span>, <span>$s_{\mathrm{b}, 1} = s_{\mathrm{b}}(s_1)$</span>, <span>$\mathit{f}_{\mathrm{evo}}$</span>, ... :  galaxy bias, magnification bias (i.e. the slope of the luminosity function at the luminosity threshold),  and evolution bias (the first two evaluated in <span>$s_1$</span>); they are all stored in <code>cosmo</code>;</p></li><li><p><span>$\Omega_{\mathrm{M}0} = \Omega_{\mathrm{cdm}} + \Omega_{\mathrm{b}}$</span> is the sum of  cold-dark-matter and barionic density parameters (again, stored in <code>cosmo</code>);</p></li><li><p><span>$I_\ell^n$</span> and <span>$\sigma_i$</span> are defined as</p><p class="math-container">\[I_\ell^n(s) = \int_0^{+\infty} \frac{\mathrm{d}q}{2\pi^2} 
\, q^2 \, P(q) \, \frac{j_\ell(qs)}{(qs)^n} \quad , 
\quad \sigma_i = \int_0^{+\infty} \frac{\mathrm{d}q}{2\pi^2} 
\, q^{2-i} \, P(q)\]</p><p>with <span>$P(q)$</span> as the matter Power Spectrum at <span>$z=0$</span> (stored in <code>cosmo</code>)  and <span>$j_\ell$</span> as spherical Bessel function of order <span>$\ell$</span>;</p></li><li><p><span>$\tilde{I}_0^4$</span> is defined as</p><p class="math-container">\[\tilde{I}_0^4 = \int_0^{+\infty} \frac{\mathrm{d}q}{2\pi^2} 
\, q^2 \, P(q) \, \frac{j_0(qs) - 1}{(qs)^4}\]</p><p>with <span>$P(q)$</span> as the matter Power Spectrum at <span>$z=0$</span> (stored in <code>cosmo</code>)  and <span>$j_\ell$</span> as spherical Bessel function of order <span>$\ell$</span>;</p></li><li><p><span>$\mathcal{H}_0$</span>, <span>$f_0$</span> and so on are evaluated at the observer position (i.e. at present day);</p></li><li><p><span>$\Delta\chi_1 := \sqrt{\chi_1^2 + s_2^2-2\,\chi_1\,s_2\,y}$</span> and  <span>$\Delta\chi_2 := \sqrt{s_1^2 + \chi_2^2-2\,s_1\,\chi_2\,y}$</span>;</p></li><li><p><span>$s=\sqrt{s_1^2 + s_2^2 - 2 \, s_1 \, s_2 \, y}$</span> and  <span>$\Delta\chi := \sqrt{\chi_1^2 + \chi_2^2-2\,\chi_1\,\chi_2\,y}$</span>.</p></li></ul><p>In this TPCF there are no observer terms. The <code>obs</code> keyword is inserted only for compatibility with  the other GNC TPCFs.</p><p>This function is used inside <code>ξ_GNC_Newton_Lensing</code> with the <a href="@ref"><code>trapz</code></a> from the  <a href="https://github.com/francescoalemanno/Trapz.jl">Trapz</a> Julia package.</p><p><strong>Inputs</strong></p><ul><li><p><code>IP::Point</code>, <code>P1::Point</code>, <code>P2::Point</code> or <code>χ2</code>,<code>s1</code>,<code>s2</code>: <code>Point</code>/comoving  distances where the TPCF has to be calculated; they contain all the  data of interest needed for this calculus (comoving distance, growth factor and so on).</p></li><li><p><code>y</code>: the cosine of the angle between the two points <code>P1</code> and <code>P2</code> wrt the observer</p></li><li><p><code>cosmo::Cosmology</code>: cosmology to be used in this computation; it contains all the splines used for the conversion <code>s</code> -&gt; <code>Point</code>, and all the cosmological parameters <span>$b$</span>, ...</p></li></ul><p><strong>Keyword Arguments</strong></p><ul><li><p><code>obs::Union{Bool,Symbol} = :noobsvel</code> : do you want to consider the observer terms in the computation of the  chosen GNC TPCF effect?</p><ul><li><code>:yes</code> or <code>true</code> -&gt; all the observer effects will be considered</li><li><code>:no</code> or <code>false</code> -&gt; no observer term will be taken into account</li><li><code>:noobsvel</code> -&gt; the observer terms related to the observer velocity (that you can find in the CF concerning Doppler) will be neglected, the other ones will be taken into account</li></ul></li><li><p><code>Δχ_min::Float64 = 1e-4</code> : when <span>$\Delta\chi_2 = \sqrt{s_1^2 + \chi_2^2 - 2 \, s_1 \chi_2 y} \to 0^{+}$</span>, some <span>$I_\ell^n$</span> term diverges, but the overall parenthesis has a known limit:</p><p class="math-container">\[    \lim_{\Delta \chi_2 \to 0^{+}} 
    \left(
        J_{00}^{\delta \kappa} \, I^0_0(\Delta \chi_2 ) + 
        J_{02}^{\delta \kappa} \, I^0_2(\Delta \chi_2 ) + 
        J_{04}^{\delta \kappa} \, I^4_0(\Delta \chi_2 ) 
    \right) = 
    - \frac{1}{5} \, s_1 \left(f_1 + 5 b_1\right) \, \sigma_0\]</p><p>So, when it happens that <span>$\Delta \chi_2 &lt; \Delta\chi_\mathrm{min}$</span>, the function considers this limit as the result of the parenthesis instead of calculating it in the normal way; it prevents computational divergences.</p></li></ul><p>See also: <a href="../Cosmology/#GaPSE.Point"><code>Point</code></a>, <a href="../Cosmology/#GaPSE.Cosmology"><code>Cosmology</code></a>, <a href="#GaPSE.ξ_GNC_multipole"><code>ξ_GNC_multipole</code></a>,  <a href="#GaPSE.map_ξ_GNC_multipole"><code>map_ξ_GNC_multipole</code></a>, <a href="#GaPSE.print_map_ξ_GNC_multipole"><code>print_map_ξ_GNC_multipole</code></a>, <a href="@ref"><code>ξ_GNC_Newton_Lensing</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cosmofico97/GaPSE/blob/5f3347ff3b074f172d8e3ff7fa715eea30fd3aad/src/GNC_CrossCorrelations/GNC_NewtonianLensing.jl#L84-L278">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="GaPSE.integrand_ξ_GNC_Newtonian_IntegratedGP" href="#GaPSE.integrand_ξ_GNC_Newtonian_IntegratedGP"><code>GaPSE.integrand_ξ_GNC_Newtonian_IntegratedGP</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs"> integrand_ξ_GNC_Newtonian_IntegratedGP(
      IP::Point, P1::Point, P2::Point,
      y, cosmo::Cosmology; 
      obs::Union{Bool,Symbol}=:noobsvel
      ) ::Float64

 integrand_ξ_GNC_Newtonian_IntegratedGP(
      χ2::Float64, s1::Float64, s2::Float64,
      y, cosmo::Cosmology;
      kwargs... )::Float64</code></pre><p>Return the integrand of the Two-Point Correlation Function (TPCF) given  by the cross correlation between the Newtonian and the Integrated Gravitational  Potential (GP) effects arising from the Galaxy Number Counts (GNC).</p><p>In the first method, you should pass the two extreme <code>Point</code>s (<code>P1</code> and <code>P2</code>) and the  intermediate integrand <code>Point</code> (<code>IP</code>) where to  evaluate the function. In the second method (that internally recalls the first), you must provide the three corresponding comoving distances <code>s1</code>, <code>s2</code>, <code>χ2</code>. We remember that all the distances are measured in <span>$h_0^{-1}\mathrm{Mpc}$</span>.</p><p>The analytical expression of this integrand is the following:</p><p class="math-container">\[\begin{split}
    f^{\delta \int\!\phi}(\chi_2, s_1 , s_2, y ) =
    D_1 \;  
    &amp;J^{\delta \int\!\phi}_{\alpha}
    \left[ 
        J^{\delta \int\!\phi}_{20} I_0^2 ( \Delta\chi_2 ) +
        \right.  \\
        &amp; \left. 
        J^{\delta \int\!\phi}_{\beta}
            \left(
                \frac{1}{15} I_0^0 ( \Delta\chi_2 ) + 
                \frac{1}{21} I_2^0 ( \Delta\chi_2 ) +
                \frac{1}{35} I_4^0 ( \Delta\chi_2 )
            \right) 
    \right] \, , \nonumber
\end{split}\]</p><p>where</p><p class="math-container">\[\begin{split}
    J^{\delta \int\!\phi}_{\alpha} &amp;=
    \frac{\mathcal{H}_0^2 \Omega_{\mathrm{M}0} D(\chi_2)}{3 a(\chi_2) s_2} 
    \left[ 
        s_2 \mathcal{R}_2 \mathcal{H}(\chi_2) ( f(\chi_2) - 1) - 5 s_{\mathrm{b}, 2} + 2
    \right] 
    \, , \\
    %%%%%%%%%%%%%%%%%%%%%
    J^{\delta \int\!\phi}_{\beta} &amp;=
    f_1 \left[ 
        (3 y^2 - 1) \chi_2^2 - 4 y s_1 \chi_2 + 2 s_1^2
    \right] 
    \, , \\
    %%%%%%%%%%%%%%%%%%%%%
    J^{\delta \int\!\phi}_{20} &amp;=
    - \Delta\chi_2^2 ( 3 b_1 + f_1)
    \, .
\end{split}\]</p><p>where:</p><ul><li><p><span>$s_1$</span> and <span>$s_2$</span> are comoving distances;</p></li><li><p><span>$D_1 = D(s_1)$</span>, ... is the linear growth factor (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$a_1 = a(s_1)$</span>, ... is the scale factor (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$f_1 = f(s_1)$</span>, ... is the linear growth rate (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$\mathcal{H}_1 = \mathcal{H}(s_1)$</span>, ... is the comoving  Hubble distances (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$y = \cos{\theta} = \hat{\mathbf{s}}_1 \cdot \hat{\mathbf{s}}_2$</span>;</p></li><li><p><span>$\mathcal{R}_1 = \mathcal{R}(s_1)$</span>, ... is  computed by <code>func_ℛ_GNC</code> in <code>cosmo::Cosmology</code> (and evaluated in <span>$s_1$</span> ); the definition of <span>$\mathcal{R}(s)$</span> is the following:</p><p class="math-container">\[\mathcal{R}(s) = 5 s_{\mathrm{b}}(s) + \frac{2 - 5 s_{\mathrm{b}}(s)}{\mathcal{H}(s) \, s} +  
\frac{\dot{\mathcal{H}}(s)}{\mathcal{H}(s)^2} - \mathit{f}_{\mathrm{evo}} \quad ;\]</p></li><li><p><span>$b_1 = b(s_1)$</span>, <span>$s_{\mathrm{b}, 1} = s_{\mathrm{b}}(s_1)$</span>, <span>$\mathit{f}_{\mathrm{evo}}$</span>, ... :  galaxy bias, magnification bias (i.e. the slope of the luminosity function at the luminosity threshold),  and evolution bias (the first two evaluated in <span>$s_1$</span>); they are all stored in <code>cosmo</code>;</p></li><li><p><span>$\Omega_{\mathrm{M}0} = \Omega_{\mathrm{cdm}} + \Omega_{\mathrm{b}}$</span> is the sum of  cold-dark-matter and barionic density parameters (again, stored in <code>cosmo</code>);</p></li><li><p><span>$I_\ell^n$</span> and <span>$\sigma_i$</span> are defined as</p><p class="math-container">\[I_\ell^n(s) = \int_0^{+\infty} \frac{\mathrm{d}q}{2\pi^2} 
\, q^2 \, P(q) \, \frac{j_\ell(qs)}{(qs)^n} \quad , 
\quad \sigma_i = \int_0^{+\infty} \frac{\mathrm{d}q}{2\pi^2} 
\, q^{2-i} \, P(q)\]</p><p>with <span>$P(q)$</span> as the matter Power Spectrum at <span>$z=0$</span> (stored in <code>cosmo</code>)  and <span>$j_\ell$</span> as spherical Bessel function of order <span>$\ell$</span>;</p></li><li><p><span>$\tilde{I}_0^4$</span> is defined as</p><p class="math-container">\[\tilde{I}_0^4 = \int_0^{+\infty} \frac{\mathrm{d}q}{2\pi^2} 
\, q^2 \, P(q) \, \frac{j_0(qs) - 1}{(qs)^4}\]</p><p>with <span>$P(q)$</span> as the matter Power Spectrum at <span>$z=0$</span> (stored in <code>cosmo</code>)  and <span>$j_\ell$</span> as spherical Bessel function of order <span>$\ell$</span>;</p></li><li><p><span>$\mathcal{H}_0$</span>, <span>$f_0$</span> and so on are evaluated at the observer position (i.e. at present day);</p></li><li><p><span>$\Delta\chi_1 := \sqrt{\chi_1^2 + s_2^2-2\,\chi_1\,s_2\,y}$</span> and  <span>$\Delta\chi_2 := \sqrt{s_1^2 + \chi_2^2-2\,s_1\,\chi_2\,y}$</span>;</p></li><li><p><span>$s=\sqrt{s_1^2 + s_2^2 - 2 \, s_1 \, s_2 \, y}$</span> and  <span>$\Delta\chi := \sqrt{\chi_1^2 + \chi_2^2-2\,\chi_1\,\chi_2\,y}$</span>.</p></li></ul><p>In this TPCF there are no observer terms. The <code>obs</code> keyword is inserted only for compatibility with  the other GNC TPCFs.</p><p>This function is used inside <code>ξ_GNC_Newtonian_IntegratedGP</code> with <a href="@ref"><code>trapz</code></a> from the  <a href="https://github.com/francescoalemanno/Trapz.jl">Trapz</a> Julia package.</p><p><strong>Inputs</strong></p><ul><li><p><code>IP::Point</code>, <code>P1::Point</code>, <code>P2::Point</code> or <code>χ2</code>,<code>s1</code>,<code>s2</code>: <code>Point</code>/comoving  distances where the TPCF has to be calculated; they contain all the  data of interest needed for this calculus (comoving distance, growth factor and so on).</p></li><li><p><code>y</code>: the cosine of the angle between the two points <code>P1</code> and <code>P2</code> wrt the observer</p></li><li><p><code>cosmo::Cosmology</code>: cosmology to be used in this computation; it contains all the splines used for the conversion <code>s</code> -&gt; <code>Point</code>, and all the cosmological parameters <span>$b$</span>, ...</p></li></ul><p><strong>Keyword Arguments</strong></p><ul><li><code>obs::Union{Bool,Symbol} = :noobsvel</code> : do you want to consider the observer terms in the computation of the  chosen GNC TPCF effect?<ul><li><code>:yes</code> or <code>true</code> -&gt; all the observer effects will be considered</li><li><code>:no</code> or <code>false</code> -&gt; no observer term will be taken into account</li><li><code>:noobsvel</code> -&gt; the observer terms related to the observer velocity (that you can find in the CF concerning Doppler) will be neglected, the other ones will be taken into account</li></ul></li></ul><p>See also: <a href="../Cosmology/#GaPSE.Point"><code>Point</code></a>, <a href="../Cosmology/#GaPSE.Cosmology"><code>Cosmology</code></a>, <a href="#GaPSE.ξ_GNC_multipole"><code>ξ_GNC_multipole</code></a>,  <a href="#GaPSE.map_ξ_GNC_multipole"><code>map_ξ_GNC_multipole</code></a>, <a href="#GaPSE.print_map_ξ_GNC_multipole"><code>print_map_ξ_GNC_multipole</code></a>, <a href="#GaPSE.ξ_GNC_Newtonian_IntegratedGP"><code>ξ_GNC_Newtonian_IntegratedGP</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cosmofico97/GaPSE/blob/5f3347ff3b074f172d8e3ff7fa715eea30fd3aad/src/GNC_CrossCorrelations/GNC_NewtonianIntegratedGP.jl#L66-L220">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="GaPSE.integrand_ξ_GNC_Doppler_IntegratedGP" href="#GaPSE.integrand_ξ_GNC_Doppler_IntegratedGP"><code>GaPSE.integrand_ξ_GNC_Doppler_IntegratedGP</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs"> integrand_ξ_GNC_Doppler_IntegratedGP(
      IP::Point, P1::Point, P2::Point,
      y, cosmo::Cosmology; 
      obs::Union{Bool,Symbol}=:noobsvel
      ) ::Float64

 integrand_ξ_GNC_Doppler_IntegratedGP(
      χ2::Float64, s1::Float64, s2::Float64,
      y, cosmo::Cosmology; 
      kwargs...) ::Float64</code></pre><p>Return the integrand of the Two-Point Correlation Function (TPCF) given  by the cross correlation between the Doppler and the Integrated  Gravitational Potential (GP) effects arising from the Galaxy Number Counts (GNC).</p><p>In the first method, you should pass the two extreme <code>Point</code>s (<code>P1</code> and <code>P2</code>) and the  intermediate integrand <code>Point</code> (<code>IP</code>) where to  evaluate the function. In the second method (that internally recalls the first), you must provide the three corresponding comoving distances <code>s1</code>, <code>s2</code>, <code>χ2</code>. We remember that all the distances are measured in <span>$h_0^{-1}\mathrm{Mpc}$</span>.</p><p>The analytical expression of this integrand is the following:</p><p class="math-container">\[\begin{split}
    f^{v_{\parallel} \int\!\phi} \left(\chi_2, s_1 , s_2, y \right) &amp;= 
    D_1 \;
    J^{v_{\parallel} \int\!\phi}_{\alpha} 
    \left[
        \frac{1}{15} I_0^0 ( \Delta\chi_2 ) +
        \frac{2}{21} I_2^0 ( \Delta\chi_2 ) +
        \right.  \\
        &amp;\left.
        \frac{1}{35} I_4^0 ( \Delta\chi_2 ) +
        I^2_0 ( \Delta\chi_2) 
    \right]
    + 
    J^{v_{\parallel} \int\!\phi}_{31} I^3_1 (\chi_2)  
    \, ,\nonumber
\end{split}\]</p><p>where</p><p class="math-container">\[\begin{split}
    J^{v_{\parallel} \int\!\phi}_{\alpha} &amp;=
    \frac{f_1 \mathcal{H}_1 \mathcal{R}_1}{s_2 a(\chi_2)} 
    D(\chi_2) \mathcal{H}_0^2 \Omega_{\mathrm{M}0} \Delta\chi_2^2 
    (\chi_2 y - s_1) 
    \left[
        s_2 \mathcal{H}(\chi_2) \mathcal{R}_2 (f(\chi_2) - 1) - 5 s_{\mathrm{b}, 2} + 2
    \right]
    \, , \\
    %%%%%%%%%%%%%%%%%%%%%
    J^{v_{\parallel} \int\!\phi}_{31} &amp;=
    -\frac{
        3 \chi_2^3 y f_0 \mathcal{H}_0^3 \Omega_{\mathrm{M}0} D(\chi_2)
    }{
        s_2 a(\chi_2)
    }(\mathcal{R}_1 - 5 s_{\mathrm{b}, 1} + 2)
    \left[
        s_2 \mathcal{H}(\chi_2) \mathcal{R}_2 (f(\chi_2) - 1) - 5 s_{\mathrm{b}, 2} + 2)
    \right] 
    \, . 
\end{split}\]</p><p>where:</p><ul><li><p><span>$s_1$</span> and <span>$s_2$</span> are comoving distances;</p></li><li><p><span>$D_1 = D(s_1)$</span>, ... is the linear growth factor (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$a_1 = a(s_1)$</span>, ... is the scale factor (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$f_1 = f(s_1)$</span>, ... is the linear growth rate (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$\mathcal{H}_1 = \mathcal{H}(s_1)$</span>, ... is the comoving  Hubble distances (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$y = \cos{\theta} = \hat{\mathbf{s}}_1 \cdot \hat{\mathbf{s}}_2$</span>;</p></li><li><p><span>$\mathcal{R}_1 = \mathcal{R}(s_1)$</span>, ... is  computed by <code>func_ℛ_GNC</code> in <code>cosmo::Cosmology</code> (and evaluated in <span>$s_1$</span> ); the definition of <span>$\mathcal{R}(s)$</span> is the following:</p><p class="math-container">\[\mathcal{R}(s) = 5 s_{\mathrm{b}}(s) + \frac{2 - 5 s_{\mathrm{b}}(s)}{\mathcal{H}(s) \, s} +  
\frac{\dot{\mathcal{H}}(s)}{\mathcal{H}(s)^2} - \mathit{f}_{\mathrm{evo}} \quad ;\]</p></li><li><p><span>$b_1 = b(s_1)$</span>, <span>$s_{\mathrm{b}, 1} = s_{\mathrm{b}}(s_1)$</span>, <span>$\mathit{f}_{\mathrm{evo}}$</span>, ... :  galaxy bias, magnification bias (i.e. the slope of the luminosity function at the luminosity threshold),  and evolution bias (the first two evaluated in <span>$s_1$</span>); they are all stored in <code>cosmo</code>;</p></li><li><p><span>$\Omega_{\mathrm{M}0} = \Omega_{\mathrm{cdm}} + \Omega_{\mathrm{b}}$</span> is the sum of  cold-dark-matter and barionic density parameters (again, stored in <code>cosmo</code>);</p></li><li><p><span>$I_\ell^n$</span> and <span>$\sigma_i$</span> are defined as</p><p class="math-container">\[I_\ell^n(s) = \int_0^{+\infty} \frac{\mathrm{d}q}{2\pi^2} 
\, q^2 \, P(q) \, \frac{j_\ell(qs)}{(qs)^n} \quad , 
\quad \sigma_i = \int_0^{+\infty} \frac{\mathrm{d}q}{2\pi^2} 
\, q^{2-i} \, P(q)\]</p><p>with <span>$P(q)$</span> as the matter Power Spectrum at <span>$z=0$</span> (stored in <code>cosmo</code>)  and <span>$j_\ell$</span> as spherical Bessel function of order <span>$\ell$</span>;</p></li><li><p><span>$\tilde{I}_0^4$</span> is defined as</p><p class="math-container">\[\tilde{I}_0^4 = \int_0^{+\infty} \frac{\mathrm{d}q}{2\pi^2} 
\, q^2 \, P(q) \, \frac{j_0(qs) - 1}{(qs)^4}\]</p><p>with <span>$P(q)$</span> as the matter Power Spectrum at <span>$z=0$</span> (stored in <code>cosmo</code>)  and <span>$j_\ell$</span> as spherical Bessel function of order <span>$\ell$</span>;</p></li><li><p><span>$\mathcal{H}_0$</span>, <span>$f_0$</span> and so on are evaluated at the observer position (i.e. at present day);</p></li><li><p><span>$\Delta\chi_1 := \sqrt{\chi_1^2 + s_2^2-2\,\chi_1\,s_2\,y}$</span> and  <span>$\Delta\chi_2 := \sqrt{s_1^2 + \chi_2^2-2\,s_1\,\chi_2\,y}$</span>;</p></li><li><p><span>$s=\sqrt{s_1^2 + s_2^2 - 2 \, s_1 \, s_2 \, y}$</span> and  <span>$\Delta\chi := \sqrt{\chi_1^2 + \chi_2^2-2\,\chi_1\,\chi_2\,y}$</span>.</p></li></ul><p>In this TPCF, the term proportional to <span>$D(s_1)$</span> is not an observer term. The other one instead is and it does depend on the observer velocity. Consequently, if you set <code>obs = :yes</code> or <code>obs = true</code> both of them will computed, while for <code>obs = :no</code>, <code>obs = false</code> or even <code>obs = :noobsvel</code> only the <span>$\propto D(s_1)$</span> one will be taken into account.</p><p>This function is used inside <code>ξ_GNC_Doppler_IntegratedGP</code> with <a href="@ref"><code>trapz</code></a> from the  <a href="https://github.com/francescoalemanno/Trapz.jl">Trapz</a> Julia package.</p><p><strong>Inputs</strong></p><ul><li><p><code>IP::Point</code>, <code>P1::Point</code> and <code>P2::Point</code>, or <code>χ2</code>,<code>s1</code>,<code>s2</code>: <code>Point</code>/comoving distances where the  TPCF has to be calculated; they contain all the  data of interest needed for this calculus (comoving distance, growth factor and so on).</p></li><li><p><code>y</code>: the cosine of the angle between the two points <code>P1</code> and <code>P2</code> wrt the observer</p></li><li><p><code>cosmo::Cosmology</code>: cosmology to be used in this computation; it contains all the splines used for the conversion <code>s</code> -&gt; <code>Point</code>, and all the cosmological parameters <span>$b$</span>, ...</p></li></ul><p><strong>Keyword Arguments</strong></p><ul><li><code>obs::Union{Bool,Symbol} = :noobsvel</code> : do you want to consider the observer terms in the computation of the  chosen GNC TPCF effect?<ul><li><code>:yes</code> or <code>true</code> -&gt; all the observer effects will be considered</li><li><code>:no</code> or <code>false</code> -&gt; no observer term will be taken into account</li><li><code>:noobsvel</code> -&gt; the observer terms related to the observer velocity (that you can find in the CF concerning Doppler) will be neglected, the other ones will be taken into account</li></ul></li></ul><p>See also: <a href="../Cosmology/#GaPSE.Point"><code>Point</code></a>, <a href="../Cosmology/#GaPSE.Cosmology"><code>Cosmology</code></a>, <a href="#GaPSE.ξ_GNC_multipole"><code>ξ_GNC_multipole</code></a>,  <a href="#GaPSE.map_ξ_GNC_multipole"><code>map_ξ_GNC_multipole</code></a>, <a href="#GaPSE.print_map_ξ_GNC_multipole"><code>print_map_ξ_GNC_multipole</code></a>, <a href="#GaPSE.ξ_GNC_Doppler_IntegratedGP"><code>ξ_GNC_Doppler_IntegratedGP</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cosmofico97/GaPSE/blob/5f3347ff3b074f172d8e3ff7fa715eea30fd3aad/src/GNC_CrossCorrelations/GNC_DopplerIntegratedGP.jl#L81-L239">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="GaPSE.integrand_ξ_GNC_Lensing_Doppler" href="#GaPSE.integrand_ξ_GNC_Lensing_Doppler"><code>GaPSE.integrand_ξ_GNC_Lensing_Doppler</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs"> integrand_ξ_GNC_Lensing_Doppler(
      IP::Point, P1::Point, P2::Point,
      y, cosmo::Cosmology;
      Δχ_min::Float64=1e-1, 
      obs::Union{Bool,Symbol}=:noobsvel
      ) ::Float64

 integrand_ξ_GNC_Lensing_Doppler(
      χ1::Float64, s1::Float64, s2::Float64,
      y, cosmo::Cosmology;
      kwargs... )::Float64</code></pre><p>Return the integrand of the Two-Point Correlation Function (TPCF) given  by the cross correlation between the Lensing and the Doppler effects arising  from the Galaxy Number Counts (GNC).</p><p>In the first method, you should pass the two extreme <code>Point</code>s (<code>P1</code> and <code>P2</code>) and the  intermediate integrand <code>Point</code> (<code>IP</code>) where to  evaluate the function. In the second method (that internally recalls the first), you must provide the three corresponding comoving distances <code>s1</code>, <code>s2</code>, <code>χ1</code>. We remember that all the distances are measured in <span>$h_0^{-1}\mathrm{Mpc}$</span>.</p><p>The analytical expression of this integrand is the following:</p><p class="math-container">\[\begin{split}
    f^{\kappa \phi} (\chi_1, s_1 , s_2, y ) &amp;= 
    D_2 
    J^{\kappa v_{\parallel}}_{\alpha} \left[
        J^{\kappa v_{\parallel}}_{00} I_0^0 ( \Delta \chi_1 ) +
        J^{\kappa v_{\parallel}}_{02} I_2^0 ( \Delta \chi_1 ) 
    \right. \nonumber \\
    &amp; \left.
    + J^{\kappa v_{\parallel}}_{04} I_4^0 ( \Delta \chi_1 ) 
    + J^{\kappa v_{\parallel}}_{20} I_0^2 ( \Delta \chi_1 ) 
    \right]
    +
    J^{\kappa v_{\parallel}}_{31} I_1^3 ( \chi_1 ) \, ,
\end{split}\]</p><p>where</p><p class="math-container">\[\begin{split}
     J^{\kappa v_{\parallel}}_{\alpha} &amp;= 
    \frac{\mathcal{H}_0^2 \Omega_{\mathrm{M}0} D(\chi_1)}{a(\chi_1) s_1}
    f_2 \mathcal{H}_2 \mathcal{R}_2 (\chi_1 - s_1) (5 s_{\mathrm{b}, 1} - 2)
    \, , \\
    %%%%%%%%%%%%%%%%%
    J^{\kappa v_{\parallel}}_{00} &amp;= 
    \frac{1}{15}
    \left[
        \chi_1^2 y + \chi_1 s_2 (4 y^2 - 3) - 2 y s_2^2
    \right] 
    \, , \\
    %%%%%%%%%%%%%%%%%
    J^{\kappa v_{\parallel}}_{02} &amp;= 
    \frac{1}{42 \Delta\chi_1^2} \left[
        4 y \chi_1^4 + 4 (2 y^2 - 3) s_2 \chi_1^3 + 
        y (11 - 23 y^2) s_2^2 \chi_1^2 +
        \right.\\
        &amp;\left.\qquad\qquad\qquad
        (23 y^2 - 3) s_2^3 \chi_1 - 8 y s_2^4
    \right] \nonumber
    \, , \\
    %%%%%%%%%%%%%%%%%
    J^{\kappa v_{\parallel}}_{04} &amp;= 
    \frac{1}{70 \Delta\chi_1^2} 
    \left[
        2 y \chi_1^4 + 2 (2 y^2 - 3) s_2 \chi_1^3 - 
        y (y^2 + 5) s_2^2 \chi_1^2 + 
        (y^2 + 9) s_2^3 \chi_1 - 4 y s_2^4
    \right] 
    \, , \\
    %%%%%%%%%%%%%%%%%
    J^{\kappa v_{\parallel}}_{20} &amp;= y \Delta\chi_1^2 
    \, , \\ 
    %%%%%%%%%%%%%%%%%
    J^{\kappa v_{\parallel}}_{31} &amp;=
    -\frac{
        3 \chi_1^2 y f_0 \mathcal{H}_0^3 \Omega_{\mathrm{M}0} D(\chi_1) 
    }{
        a(\chi_1)s_1
    }(\chi_1 - s_1) (5 s_{\mathrm{b}, 1} - 2) (\mathcal{R}_2 - 5 s_{\mathrm{b}, 2} + 2) 
    \, .
\end{split}\]</p><p>where:</p><ul><li><p><span>$s_1$</span> and <span>$s_2$</span> are comoving distances;</p></li><li><p><span>$D_1 = D(s_1)$</span>, ... is the linear growth factor (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$a_1 = a(s_1)$</span>, ... is the scale factor (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$f_1 = f(s_1)$</span>, ... is the linear growth rate (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$\mathcal{H}_1 = \mathcal{H}(s_1)$</span>, ... is the comoving  Hubble distances (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$y = \cos{\theta} = \hat{\mathbf{s}}_1 \cdot \hat{\mathbf{s}}_2$</span>;</p></li><li><p><span>$\mathcal{R}_1 = \mathcal{R}(s_1)$</span>, ... is  computed by <code>func_ℛ_GNC</code> in <code>cosmo::Cosmology</code> (and evaluated in <span>$s_1$</span> ); the definition of <span>$\mathcal{R}(s)$</span> is the following:</p><p class="math-container">\[\mathcal{R}(s) = 5 s_{\mathrm{b}}(s) + \frac{2 - 5 s_{\mathrm{b}}(s)}{\mathcal{H}(s) \, s} +  
\frac{\dot{\mathcal{H}}(s)}{\mathcal{H}(s)^2} - \mathit{f}_{\mathrm{evo}} \quad ;\]</p></li><li><p><span>$b_1 = b(s_1)$</span>, <span>$s_{\mathrm{b}, 1} = s_{\mathrm{b}}(s_1)$</span>, <span>$\mathit{f}_{\mathrm{evo}}$</span>, ... :  galaxy bias, magnification bias (i.e. the slope of the luminosity function at the luminosity threshold),  and evolution bias (the first two evaluated in <span>$s_1$</span>); they are all stored in <code>cosmo</code>;</p></li><li><p><span>$\Omega_{\mathrm{M}0} = \Omega_{\mathrm{cdm}} + \Omega_{\mathrm{b}}$</span> is the sum of  cold-dark-matter and barionic density parameters (again, stored in <code>cosmo</code>);</p></li><li><p><span>$I_\ell^n$</span> and <span>$\sigma_i$</span> are defined as</p><p class="math-container">\[I_\ell^n(s) = \int_0^{+\infty} \frac{\mathrm{d}q}{2\pi^2} 
\, q^2 \, P(q) \, \frac{j_\ell(qs)}{(qs)^n} \quad , 
\quad \sigma_i = \int_0^{+\infty} \frac{\mathrm{d}q}{2\pi^2} 
\, q^{2-i} \, P(q)\]</p><p>with <span>$P(q)$</span> as the matter Power Spectrum at <span>$z=0$</span> (stored in <code>cosmo</code>)  and <span>$j_\ell$</span> as spherical Bessel function of order <span>$\ell$</span>;</p></li><li><p><span>$\tilde{I}_0^4$</span> is defined as</p><p class="math-container">\[\tilde{I}_0^4 = \int_0^{+\infty} \frac{\mathrm{d}q}{2\pi^2} 
\, q^2 \, P(q) \, \frac{j_0(qs) - 1}{(qs)^4}\]</p><p>with <span>$P(q)$</span> as the matter Power Spectrum at <span>$z=0$</span> (stored in <code>cosmo</code>)  and <span>$j_\ell$</span> as spherical Bessel function of order <span>$\ell$</span>;</p></li><li><p><span>$\mathcal{H}_0$</span>, <span>$f_0$</span> and so on are evaluated at the observer position (i.e. at present day);</p></li><li><p><span>$\Delta\chi_1 := \sqrt{\chi_1^2 + s_2^2-2\,\chi_1\,s_2\,y}$</span> and  <span>$\Delta\chi_2 := \sqrt{s_1^2 + \chi_2^2-2\,s_1\,\chi_2\,y}$</span>;</p></li><li><p><span>$s=\sqrt{s_1^2 + s_2^2 - 2 \, s_1 \, s_2 \, y}$</span> and  <span>$\Delta\chi := \sqrt{\chi_1^2 + \chi_2^2-2\,\chi_1\,\chi_2\,y}$</span>.</p></li></ul><p>In this TPCF, the term proportional to <span>$D(s_1)$</span> is not an observer term. The other one instead is and it does depend on the observer velocity. Consequently, if you set <code>obs = :yes</code> or <code>obs = true</code> both of them will computed, while for <code>obs = :no</code>, <code>obs = false</code> or even <code>obs = :noobsvel</code> only the first one will be taken into account.</p><p>This function is used inside <code>ξ_GNC_Lensing_Doppler</code> with <a href="@ref"><code>trapz</code></a> from the  <a href="https://github.com/francescoalemanno/Trapz.jl">Trapz</a> Julia package.</p><p><strong>Inputs</strong></p><ul><li><p><code>IP::Point</code>, <code>P1::Point</code>, <code>P2::Point</code> or <code>χ1</code>,<code>s1</code>,<code>s2</code>: <code>Point</code>/comoving  distances where the TPCF has to be calculated; they contain all the  data of interest needed for this calculus (comoving distance, growth factor and so on).</p></li><li><p><code>y</code>: the cosine of the angle between the two points <code>P1</code> and <code>P2</code> wrt the observer</p></li><li><p><code>cosmo::Cosmology</code>: cosmology to be used in this computation; it contains all the splines used for the conversion <code>s</code> -&gt; <code>Point</code>, and all the cosmological parameters <span>$b$</span>, ...</p></li></ul><p><strong>Keyword Arguments</strong></p><ul><li><p><code>obs::Union{Bool,Symbol} = :noobsvel</code> : do you want to consider the observer terms in the computation of the  chosen GNC TPCF effect?</p><ul><li><code>:yes</code> or <code>true</code> -&gt; all the observer effects will be considered</li><li><code>:no</code> or <code>false</code> -&gt; no observer term will be taken into account</li><li><code>:noobsvel</code> -&gt; the observer terms related to the observer velocity (that you can find in the CF concerning Doppler) will be neglected, the other ones will be taken into account</li></ul></li><li><p><code>Δχ_min::Float64 = 1e-1</code> : when <span>$\Delta\chi_1 = \sqrt{\chi_1^2 + s_2^2 - 2 \, \chi_1 s_2 y} \to 0^{+}$</span>, some <span>$I_\ell^n$</span> term diverges, but the overall parenthesis has a known limit:</p><p class="math-container">\[   \lim_{\Delta\chi_1 \to 0^{+}}
    \left[
      J^{\kappa v_{\parallel}}_{00} I_0^0 ( \Delta \chi_1 ) +
      J^{\kappa v_{\parallel}}_{02} I_2^0 ( \Delta \chi_1 ) +
      J^{\kappa v_{\parallel}}_{04} I_4^0 ( \Delta \chi_1 ) +
      J^{\kappa v_{\parallel}}_{20} I_0^2 ( \Delta \chi_1 ) 
  \right] = \sigma_2\]</p><p>So, when it happens that <span>$\Delta\chi_1 &lt; \Delta\chi_\mathrm{min}$</span>, the function considers this limit as the result of the parenthesis instead of calculating it in the normal way; it prevents computational divergences.</p></li></ul><p>See also: <a href="../Cosmology/#GaPSE.Point"><code>Point</code></a>, <a href="../Cosmology/#GaPSE.Cosmology"><code>Cosmology</code></a>, <a href="#GaPSE.ξ_GNC_multipole"><code>ξ_GNC_multipole</code></a>,  <a href="#GaPSE.map_ξ_GNC_multipole"><code>map_ξ_GNC_multipole</code></a>, <a href="#GaPSE.print_map_ξ_GNC_multipole"><code>print_map_ξ_GNC_multipole</code></a>, <a href="#GaPSE.ξ_GNC_Lensing_Doppler"><code>ξ_GNC_Lensing_Doppler</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cosmofico97/GaPSE/blob/5f3347ff3b074f172d8e3ff7fa715eea30fd3aad/src/GNC_CrossCorrelations/GNC_LensingDoppler.jl#L99-L298">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="GaPSE.integrand_ξ_GNC_Lensing_LocalGP" href="#GaPSE.integrand_ξ_GNC_Lensing_LocalGP"><code>GaPSE.integrand_ξ_GNC_Lensing_LocalGP</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs"> integrand_ξ_GNC_Lensing_LocalGP(
      IP::Point, P1::Point, P2::Point,
      y, cosmo::Cosmology;
      obs::Union{Bool,Symbol}=:noobsvel
      ) ::Float64

 integrand_ξ_GNC_Lensing_LocalGP(
      χ1::Float64, s1::Float64, s2::Float64,
      y, cosmo::Cosmology;
      kwargs... )::Float64</code></pre><p>Return the integrand of the Two-Point Correlation Function (TPCF) given  by the cross correlation between the Lensing and the Local Gravitational Potential (GP) effects arising  from the Galaxy Number Counts (GNC).</p><p>In the first method, you should pass the two extreme <code>Point</code>s (<code>P1</code> and <code>P2</code>) and the  intermediate integrand <code>Point</code> (<code>IP</code>) where to  evaluate the function. In the second method (that internally recalls the first), you must provide the three corresponding comoving distances <code>s1</code>, <code>s2</code>, <code>χ1</code>. We remember that all the distances are measured in <span>$h_0^{-1}\mathrm{Mpc}$</span>.</p><p>The analytical expression of this integrand is the following:</p><p class="math-container">\[\begin{split}
    f^{\kappa \phi} (\chi_1, s_1 , s_2, y ) &amp;= 
    D_2 \; 
    J^{\kappa \phi}_{\alpha}\left[ 
        J^{\kappa \phi}_{20} I_0^2 ( \Delta \chi_1 ) +
        \right.\nonumber \\
        &amp;\left.\qquad
        J^{\kappa \phi}_{\beta}
        \left(
            \frac{1}{60} I_0^0 ( \Delta \chi_1 ) +
            \frac{1}{42} I_2^0 ( \Delta \chi_1 ) +
            \frac{1}{140} I_4^0 ( \Delta \chi_1 ) 
        \right)
    \right] \, ,
\end{split}\]</p><p>where</p><p class="math-container">\[\begin{split}
    J^{\kappa \phi}_{\alpha}  &amp;= 
    \frac{\mathcal{H}_0^2 \Omega_{\mathrm{M}0} s_2 D(\chi_1)}{a(\chi_1) a_2 s_1}
    (\chi_1 - s_1)  (5s_{\mathrm{b}, 1} - 2) 
    \times\\
    &amp;\qquad\qquad
    \left[
       2 f_2 a_2 \mathcal{H}_2^2 (\mathit{f}_{\mathrm{evo}, 2} - 3) + 
       3 \mathcal{H}_0^2 \Omega_{\mathrm{M}0} (f_2 + \mathcal{R}_2 + 5s_{\mathrm{b}, 2} - 2)
    \right] \nonumber
    \, , \\
    %%%%%%%%%%%%%%%%%%%
    J^{\kappa \phi}_{\beta} &amp;=
    2 y \chi_1^2 - \chi_1 s_2 (y^2 + 3) + 2 y s_2^2
    \, ,\\
    %%%%%%%%%%%%%%%%%%%
    J^{\kappa \phi}_{20} &amp;= \frac{1}{2} y \Delta\chi_1^2\, .
\end{split}\]</p><p>where:</p><ul><li><p><span>$s_1$</span> and <span>$s_2$</span> are comoving distances;</p></li><li><p><span>$D_1 = D(s_1)$</span>, ... is the linear growth factor (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$a_1 = a(s_1)$</span>, ... is the scale factor (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$f_1 = f(s_1)$</span>, ... is the linear growth rate (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$\mathcal{H}_1 = \mathcal{H}(s_1)$</span>, ... is the comoving  Hubble distances (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$y = \cos{\theta} = \hat{\mathbf{s}}_1 \cdot \hat{\mathbf{s}}_2$</span>;</p></li><li><p><span>$\mathcal{R}_1 = \mathcal{R}(s_1)$</span>, ... is  computed by <code>func_ℛ_GNC</code> in <code>cosmo::Cosmology</code> (and evaluated in <span>$s_1$</span> ); the definition of <span>$\mathcal{R}(s)$</span> is the following:</p><p class="math-container">\[\mathcal{R}(s) = 5 s_{\mathrm{b}}(s) + \frac{2 - 5 s_{\mathrm{b}}(s)}{\mathcal{H}(s) \, s} +  
\frac{\dot{\mathcal{H}}(s)}{\mathcal{H}(s)^2} - \mathit{f}_{\mathrm{evo}} \quad ;\]</p></li><li><p><span>$b_1 = b(s_1)$</span>, <span>$s_{\mathrm{b}, 1} = s_{\mathrm{b}}(s_1)$</span>, <span>$\mathit{f}_{\mathrm{evo}}$</span>, ... :  galaxy bias, magnification bias (i.e. the slope of the luminosity function at the luminosity threshold),  and evolution bias (the first two evaluated in <span>$s_1$</span>); they are all stored in <code>cosmo</code>;</p></li><li><p><span>$\Omega_{\mathrm{M}0} = \Omega_{\mathrm{cdm}} + \Omega_{\mathrm{b}}$</span> is the sum of  cold-dark-matter and barionic density parameters (again, stored in <code>cosmo</code>);</p></li><li><p><span>$I_\ell^n$</span> and <span>$\sigma_i$</span> are defined as</p><p class="math-container">\[I_\ell^n(s) = \int_0^{+\infty} \frac{\mathrm{d}q}{2\pi^2} 
\, q^2 \, P(q) \, \frac{j_\ell(qs)}{(qs)^n} \quad , 
\quad \sigma_i = \int_0^{+\infty} \frac{\mathrm{d}q}{2\pi^2} 
\, q^{2-i} \, P(q)\]</p><p>with <span>$P(q)$</span> as the matter Power Spectrum at <span>$z=0$</span> (stored in <code>cosmo</code>)  and <span>$j_\ell$</span> as spherical Bessel function of order <span>$\ell$</span>;</p></li><li><p><span>$\tilde{I}_0^4$</span> is defined as</p><p class="math-container">\[\tilde{I}_0^4 = \int_0^{+\infty} \frac{\mathrm{d}q}{2\pi^2} 
\, q^2 \, P(q) \, \frac{j_0(qs) - 1}{(qs)^4}\]</p><p>with <span>$P(q)$</span> as the matter Power Spectrum at <span>$z=0$</span> (stored in <code>cosmo</code>)  and <span>$j_\ell$</span> as spherical Bessel function of order <span>$\ell$</span>;</p></li><li><p><span>$\mathcal{H}_0$</span>, <span>$f_0$</span> and so on are evaluated at the observer position (i.e. at present day);</p></li><li><p><span>$\Delta\chi_1 := \sqrt{\chi_1^2 + s_2^2-2\,\chi_1\,s_2\,y}$</span> and  <span>$\Delta\chi_2 := \sqrt{s_1^2 + \chi_2^2-2\,s_1\,\chi_2\,y}$</span>;</p></li><li><p><span>$s=\sqrt{s_1^2 + s_2^2 - 2 \, s_1 \, s_2 \, y}$</span> and  <span>$\Delta\chi := \sqrt{\chi_1^2 + \chi_2^2-2\,\chi_1\,\chi_2\,y}$</span>.</p></li></ul><p>In this TPCF there are no observer terms. The <code>obs</code> keyword is inserted only for compatibility with  the other GNC TPCFs.</p><p>This function is used inside <code>ξ_GNC_Lensing_LocalGP</code> with <a href="@ref"><code>trapz</code></a> from the  <a href="https://github.com/francescoalemanno/Trapz.jl">Trapz</a> Julia package.</p><p><strong>Inputs</strong></p><ul><li><p><code>IP::Point</code>, <code>P1::Point</code>, <code>P2::Point</code> or <code>χ1</code>,<code>s1</code>,<code>s2</code>: <code>Point</code>/comoving  distances where the TPCF has to be calculated; they contain all the  data of interest needed for this calculus (comoving distance, growth factor and so on).</p></li><li><p><code>y</code>: the cosine of the angle between the two points <code>P1</code> and <code>P2</code> wrt the observer</p></li><li><p><code>cosmo::Cosmology</code>: cosmology to be used in this computation; it contains all the splines used for the conversion <code>s</code> -&gt; <code>Point</code>, and all the cosmological parameters <span>$b$</span>, ...</p></li></ul><p><strong>Keyword Arguments</strong></p><ul><li><code>obs::Union{Bool,Symbol} = :noobsvel</code> : do you want to consider the observer terms in the computation of the  chosen GNC TPCF effect?<ul><li><code>:yes</code> or <code>true</code> -&gt; all the observer effects will be considered</li><li><code>:no</code> or <code>false</code> -&gt; no observer term will be taken into account</li><li><code>:noobsvel</code> -&gt; the observer terms related to the observer velocity (that you can find in the CF concerning Doppler) will be neglected, the other ones will be taken into account</li></ul></li></ul><p>See also: <a href="../Cosmology/#GaPSE.Point"><code>Point</code></a>, <a href="../Cosmology/#GaPSE.Cosmology"><code>Cosmology</code></a>, <a href="#GaPSE.ξ_GNC_multipole"><code>ξ_GNC_multipole</code></a>,  <a href="#GaPSE.map_ξ_GNC_multipole"><code>map_ξ_GNC_multipole</code></a>, <a href="#GaPSE.print_map_ξ_GNC_multipole"><code>print_map_ξ_GNC_multipole</code></a>, <a href="#GaPSE.ξ_GNC_Lensing_LocalGP"><code>ξ_GNC_Lensing_LocalGP</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cosmofico97/GaPSE/blob/5f3347ff3b074f172d8e3ff7fa715eea30fd3aad/src/GNC_CrossCorrelations/GNC_LensingLocalGP.jl#L68-L223">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="GaPSE.integrand_ξ_GNC_Lensing_IntegratedGP" href="#GaPSE.integrand_ξ_GNC_Lensing_IntegratedGP"><code>GaPSE.integrand_ξ_GNC_Lensing_IntegratedGP</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs"> integrand_ξ_GNC_Lensing_IntegratedGP(
      IP1::Point, IP2::Point,
      P1::Point, P2::Point,
      y, cosmo::Cosmology; 
      obs::Union{Bool,Symbol}=:noobsvel
      ) ::Float64

 integrand_ξ_GNC_Lensing_IntegratedGP(
      χ1::Float64, χ2::Float64,
      s1::Float64, s2::Float64,
      y, cosmo::Cosmology;
      kwargs...) ::Float64</code></pre><p>Return the integrand of the Two-Point Correlation Function (TPCF) given  by the cross correlation between the Lensing and the Integrated Gravitational Potential (GP) effects arising  from the Galaxy Number Counts (GNC).</p><p>In the first method, you should pass the two extreme <code>Point</code>s (<code>P1</code> and <code>P2</code>) and the two  intermediate integrand <code>Point</code>s (<code>IP1</code> and <code>IP2</code>) where to  evaluate the function. In the second method (that internally recalls the first), you must provide the four corresponding comoving distances <code>s1</code>, <code>s2</code>, <code>χ1</code>, <code>χ2</code>. We remember that all the distances are measured in <span>$h_0^{-1}\mathrm{Mpc}$</span>.</p><p>The analytical expression of this integrand is the following:</p><p class="math-container">\[\begin{split}
    f^{\kappa \int\!\phi} (\chi_1, \chi_2, s_1 , s_2, y ) = 
    J_{\alpha}^{\kappa \int\!\phi} 
    \left[ 
        J_{31}^{\kappa \int\!\phi} I_1^3 ( \Delta \chi ) +
        J_{22}^{\kappa \int\!\phi} I_2^2 ( \Delta \chi ) 
     \right] \, ,
\end{split}\]</p><p>where</p><p class="math-container">\[\begin{split}
     J_{\alpha}^{\kappa \int\!\phi} &amp;=
    \frac{
        9 \chi_2 \ \mathcal{H}_0^4  \Omega_{\mathrm{M}0}^2 D(\chi_1) D(\chi_2) 
    }{
        a(\chi_1)  a(\chi_2) s_1  s_2
    }
    (\chi_1 - s_1) (5 s_{\mathrm{b}, 1} - 2) \times\\
    &amp;\qquad\qquad\qquad\qquad\qquad\qquad
    \left[
        \ \mathcal{H}(\chi_2)  \mathcal{R}_2 s_1 (f(\chi_2) - 1) - 5 s_{\mathrm{b}, 1} + 2
    \right] \nonumber
    \, , \\
    %%%%%%%%%%%%%
    J_{31}^{\kappa \int\!\phi} &amp;=  y \Delta\chi^2
    \, , \\
    %%%%%%%%%%%%%
    J_{22}^{\kappa \int\!\phi} &amp;= 
    \frac{1}{2} (y^2 - 1) \chi_1 \chi_2 
    \, .
\end{split}\]</p><p>where:</p><ul><li><p><span>$s_1$</span> and <span>$s_2$</span> are comoving distances;</p></li><li><p><span>$D_1 = D(s_1)$</span>, ... is the linear growth factor (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$a_1 = a(s_1)$</span>, ... is the scale factor (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$f_1 = f(s_1)$</span>, ... is the linear growth rate (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$\mathcal{H}_1 = \mathcal{H}(s_1)$</span>, ... is the comoving  Hubble distances (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$y = \cos{\theta} = \hat{\mathbf{s}}_1 \cdot \hat{\mathbf{s}}_2$</span>;</p></li><li><p><span>$\mathcal{R}_1 = \mathcal{R}(s_1)$</span>, ... is  computed by <code>func_ℛ_GNC</code> in <code>cosmo::Cosmology</code> (and evaluated in <span>$s_1$</span> ); the definition of <span>$\mathcal{R}(s)$</span> is the following:</p><p class="math-container">\[\mathcal{R}(s) = 5 s_{\mathrm{b}}(s) + \frac{2 - 5 s_{\mathrm{b}}(s)}{\mathcal{H}(s) \, s} +  
\frac{\dot{\mathcal{H}}(s)}{\mathcal{H}(s)^2} - \mathit{f}_{\mathrm{evo}} \quad ;\]</p></li><li><p><span>$b_1 = b(s_1)$</span>, <span>$s_{\mathrm{b}, 1} = s_{\mathrm{b}}(s_1)$</span>, <span>$\mathit{f}_{\mathrm{evo}}$</span>, ... :  galaxy bias, magnification bias (i.e. the slope of the luminosity function at the luminosity threshold),  and evolution bias (the first two evaluated in <span>$s_1$</span>); they are all stored in <code>cosmo</code>;</p></li><li><p><span>$\Omega_{\mathrm{M}0} = \Omega_{\mathrm{cdm}} + \Omega_{\mathrm{b}}$</span> is the sum of  cold-dark-matter and barionic density parameters (again, stored in <code>cosmo</code>);</p></li><li><p><span>$I_\ell^n$</span> and <span>$\sigma_i$</span> are defined as</p><p class="math-container">\[I_\ell^n(s) = \int_0^{+\infty} \frac{\mathrm{d}q}{2\pi^2} 
\, q^2 \, P(q) \, \frac{j_\ell(qs)}{(qs)^n} \quad , 
\quad \sigma_i = \int_0^{+\infty} \frac{\mathrm{d}q}{2\pi^2} 
\, q^{2-i} \, P(q)\]</p><p>with <span>$P(q)$</span> as the matter Power Spectrum at <span>$z=0$</span> (stored in <code>cosmo</code>)  and <span>$j_\ell$</span> as spherical Bessel function of order <span>$\ell$</span>;</p></li><li><p><span>$\tilde{I}_0^4$</span> is defined as</p><p class="math-container">\[\tilde{I}_0^4 = \int_0^{+\infty} \frac{\mathrm{d}q}{2\pi^2} 
\, q^2 \, P(q) \, \frac{j_0(qs) - 1}{(qs)^4}\]</p><p>with <span>$P(q)$</span> as the matter Power Spectrum at <span>$z=0$</span> (stored in <code>cosmo</code>)  and <span>$j_\ell$</span> as spherical Bessel function of order <span>$\ell$</span>;</p></li><li><p><span>$\mathcal{H}_0$</span>, <span>$f_0$</span> and so on are evaluated at the observer position (i.e. at present day);</p></li><li><p><span>$\Delta\chi_1 := \sqrt{\chi_1^2 + s_2^2-2\,\chi_1\,s_2\,y}$</span> and  <span>$\Delta\chi_2 := \sqrt{s_1^2 + \chi_2^2-2\,s_1\,\chi_2\,y}$</span>;</p></li><li><p><span>$s=\sqrt{s_1^2 + s_2^2 - 2 \, s_1 \, s_2 \, y}$</span> and  <span>$\Delta\chi := \sqrt{\chi_1^2 + \chi_2^2-2\,\chi_1\,\chi_2\,y}$</span>.</p></li></ul><p>In this TPCF there are no observer terms. The <code>obs</code> keyword is inserted only for compatibility with  the other GNC TPCFs.</p><p>This function is used inside <code>ξ_GNC_Lensing_IntegratedGP</code> with <a href="@ref"><code>trapz</code></a> from the  <a href="https://github.com/francescoalemanno/Trapz.jl">Trapz</a> Julia package.</p><p><strong>Inputs</strong></p><ul><li><p><code>IP1::Point</code>, <code>IP2::Point</code>, <code>P1::Point</code>, <code>P2::Point</code> or <code>χ1</code>, <code>χ2</code>, <code>s1</code>, <code>s2</code>: <code>Point</code>/comoving  distances where the TPCF has to be calculated; they contain all the  data of interest needed for this calculus (comoving distance, growth factor and so on).</p></li><li><p><code>y</code>: the cosine of the angle between the two points <code>P1</code> and <code>P2</code> wrt the observer</p></li><li><p><code>cosmo::Cosmology</code>: cosmology to be used in this computation; it contains all the splines used for the conversion <code>s</code> -&gt; <code>Point</code>, and all the cosmological parameters <span>$b$</span>, ...</p></li></ul><p><strong>Keyword Arguments</strong></p><ul><li><code>obs::Union{Bool,Symbol} = :noobsvel</code> : do you want to consider the observer terms in the computation of the  chosen GNC TPCF effect?<ul><li><code>:yes</code> or <code>true</code> -&gt; all the observer effects will be considered</li><li><code>:no</code> or <code>false</code> -&gt; no observer term will be taken into account</li><li><code>:noobsvel</code> -&gt; the observer terms related to the observer velocity (that you can find in the CF concerning IntegratedGP) will be neglected, the other ones will be taken into account</li></ul></li></ul><p>See also: <a href="../Cosmology/#GaPSE.Point"><code>Point</code></a>, <a href="../Cosmology/#GaPSE.Cosmology"><code>Cosmology</code></a>, <a href="#GaPSE.ξ_GNC_multipole"><code>ξ_GNC_multipole</code></a>,  <a href="#GaPSE.map_ξ_GNC_multipole"><code>map_ξ_GNC_multipole</code></a>, <a href="#GaPSE.print_map_ξ_GNC_multipole"><code>print_map_ξ_GNC_multipole</code></a>, <a href="#GaPSE.ξ_GNC_Lensing_IntegratedGP"><code>ξ_GNC_Lensing_IntegratedGP</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cosmofico97/GaPSE/blob/5f3347ff3b074f172d8e3ff7fa715eea30fd3aad/src/GNC_CrossCorrelations/GNC_LensingIntegratedGP.jl#L66-L218">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="GaPSE.integrand_ξ_GNC_LocalGP_IntegratedGP" href="#GaPSE.integrand_ξ_GNC_LocalGP_IntegratedGP"><code>GaPSE.integrand_ξ_GNC_LocalGP_IntegratedGP</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs"> integrand_ξ_GNC_LocalGP_IntegratedGP(
      IP::Point, P1::Point, P2::Point,
      y, cosmo::Cosmology; 
      obs::Union{Bool,Symbol}=:noobsvel
      ) ::Float64

 integrand_ξ_GNC_LocalGP_IntegratedGP(
      χ2::Float64, s1::Float64, s2::Float64,
      y, cosmo::Cosmology;
      kwargs... )::Float64</code></pre><p>Return the integrand of the Two-Point Correlation Function (TPCF) given  by the cross correlation between the Local Gravitational Potential (GP)  and the Integrated Gravitational Potential (GP) effects arising  from the Galaxy Number Counts (GNC).</p><p>In the first method, you should pass the two extreme <code>Point</code>s (<code>P1</code> and <code>P2</code>) and the  intermediate integrand <code>Point</code> (<code>IP</code>) where to  evaluate the function. In the second method (that internally recalls the first), you must provide the three corresponding comoving distances <code>s1</code>, <code>s2</code>, <code>χ2</code>. We remember that all the distances are measured in <span>$h_0^{-1}\mathrm{Mpc}$</span>.</p><p>The analytical expression of this integrand is the following:</p><p class="math-container">\[\begin{split}
    f^{\phi \int\!\phi} (\chi_2, s_1 , s_2, y ) = 
    D_1 \, J^{\phi \int\!\phi}_{40} \tilde{I}_0^4 ( \Delta\chi_2 ) + 
    J^{\phi_0 \int\!\phi}_{04} \tilde{I}_0^4 ( \chi_2 )  \, ,
\end{split}\]</p><p>where</p><p class="math-container">\[\begin{split}
    J^{\phi \int\!\phi}_{40} &amp;=
    \frac{
        3 \Delta\chi_2^4 \mathcal{H}_0^2 \Omega_{\mathrm{M}0} D(\chi_2) 
    }{
        2 s_2 a(\chi_2) a_1
    } \left[
    s_2 \mathcal{H}(\chi_2) \mathcal{R}_2(f(\chi_2)-1) -5 s_{\mathrm{b}, 2}+2
    \right] 
    \times\\
    &amp;\qquad\qquad\qquad
    \left[
        2 a_1 f_1 \mathcal{H}_1^2 (\mathit{f}_{\mathrm{evo}, 1} - 3) +
        3 \mathcal{H}_0^2 \Omega_{\mathrm{M}0} (f_1 + \mathcal{R}_1 + 5 s_{\mathrm{b}, 1} - 2)
    \right]
    \, , \nonumber \\
    %%%%%%%%%%%%%%%%%
    J^{\phi_0 \int\!\phi}_{40} &amp;=
    \frac{
        3 \chi_2^4 \mathcal{H}_0^3 \Omega_{\mathrm{M}0} D(\chi_2)
    }{
        2 s_1 s_2 a(\chi_2)
    } \left[
        s_2 \mathcal{H}(\chi_2) \mathcal{R}_2 (f(\chi_2) - 1) - 5 s_{\mathrm{b}, 2} + 2
    \right]\times
    \nonumber \\
    &amp;\qquad\qquad\qquad
    \left[
        - 3 \Omega_{\mathrm{M}0} \mathcal{H}_0 s_1 \mathcal{R}_1 +
        2 f_0 (\mathcal{H}_0 s_1 \mathcal{R}_1 + 5 s_{\mathrm{b}, 1} - 2)
    \right] 
    \, .
\end{split}\]</p><p>where:</p><ul><li><p><span>$s_1$</span> and <span>$s_2$</span> are comoving distances;</p></li><li><p><span>$D_1 = D(s_1)$</span>, ... is the linear growth factor (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$a_1 = a(s_1)$</span>, ... is the scale factor (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$f_1 = f(s_1)$</span>, ... is the linear growth rate (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$\mathcal{H}_1 = \mathcal{H}(s_1)$</span>, ... is the comoving  Hubble distances (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$y = \cos{\theta} = \hat{\mathbf{s}}_1 \cdot \hat{\mathbf{s}}_2$</span>;</p></li><li><p><span>$\mathcal{R}_1 = \mathcal{R}(s_1)$</span>, ... is  computed by <code>func_ℛ_GNC</code> in <code>cosmo::Cosmology</code> (and evaluated in <span>$s_1$</span> ); the definition of <span>$\mathcal{R}(s)$</span> is the following:</p><p class="math-container">\[\mathcal{R}(s) = 5 s_{\mathrm{b}}(s) + \frac{2 - 5 s_{\mathrm{b}}(s)}{\mathcal{H}(s) \, s} +  
\frac{\dot{\mathcal{H}}(s)}{\mathcal{H}(s)^2} - \mathit{f}_{\mathrm{evo}} \quad ;\]</p></li><li><p><span>$b_1 = b(s_1)$</span>, <span>$s_{\mathrm{b}, 1} = s_{\mathrm{b}}(s_1)$</span>, <span>$\mathit{f}_{\mathrm{evo}}$</span>, ... :  galaxy bias, magnification bias (i.e. the slope of the luminosity function at the luminosity threshold),  and evolution bias (the first two evaluated in <span>$s_1$</span>); they are all stored in <code>cosmo</code>;</p></li><li><p><span>$\Omega_{\mathrm{M}0} = \Omega_{\mathrm{cdm}} + \Omega_{\mathrm{b}}$</span> is the sum of  cold-dark-matter and barionic density parameters (again, stored in <code>cosmo</code>);</p></li><li><p><span>$I_\ell^n$</span> and <span>$\sigma_i$</span> are defined as</p><p class="math-container">\[I_\ell^n(s) = \int_0^{+\infty} \frac{\mathrm{d}q}{2\pi^2} 
\, q^2 \, P(q) \, \frac{j_\ell(qs)}{(qs)^n} \quad , 
\quad \sigma_i = \int_0^{+\infty} \frac{\mathrm{d}q}{2\pi^2} 
\, q^{2-i} \, P(q)\]</p><p>with <span>$P(q)$</span> as the matter Power Spectrum at <span>$z=0$</span> (stored in <code>cosmo</code>)  and <span>$j_\ell$</span> as spherical Bessel function of order <span>$\ell$</span>;</p></li><li><p><span>$\tilde{I}_0^4$</span> is defined as</p><p class="math-container">\[\tilde{I}_0^4 = \int_0^{+\infty} \frac{\mathrm{d}q}{2\pi^2} 
\, q^2 \, P(q) \, \frac{j_0(qs) - 1}{(qs)^4}\]</p><p>with <span>$P(q)$</span> as the matter Power Spectrum at <span>$z=0$</span> (stored in <code>cosmo</code>)  and <span>$j_\ell$</span> as spherical Bessel function of order <span>$\ell$</span>;</p></li><li><p><span>$\mathcal{H}_0$</span>, <span>$f_0$</span> and so on are evaluated at the observer position (i.e. at present day);</p></li><li><p><span>$\Delta\chi_1 := \sqrt{\chi_1^2 + s_2^2-2\,\chi_1\,s_2\,y}$</span> and  <span>$\Delta\chi_2 := \sqrt{s_1^2 + \chi_2^2-2\,s_1\,\chi_2\,y}$</span>;</p></li><li><p><span>$s=\sqrt{s_1^2 + s_2^2 - 2 \, s_1 \, s_2 \, y}$</span> and  <span>$\Delta\chi := \sqrt{\chi_1^2 + \chi_2^2-2\,\chi_1\,\chi_2\,y}$</span>.</p></li></ul><p>In this TPCF, the term proportional to <span>$D(s_1)$</span> is not an observer term. The other one instead is, and it does also depend on the observer velocity. Consequently, if you set <code>obs = :yes</code> or <code>obs = true</code> both of them will computed, while for <code>obs = :no</code>, <code>obs = false</code> or even <code>obs = :noobsvel</code> only the first one will be taken into account.</p><p>This function is used inside <code>ξ_GNC_LocalGP_IntegratedGP</code> with <a href="@ref"><code>trapz</code></a> from the  <a href="https://github.com/francescoalemanno/Trapz.jl">Trapz</a> Julia package.</p><p><strong>Inputs</strong></p><ul><li><p><code>IP::Point</code>, <code>P1::Point</code>, <code>P2::Point</code> or <code>χ2</code>,<code>s1</code>,<code>s2</code>: <code>Point</code>/comoving  distances where the TPCF has to be calculated; they contain all the  data of interest needed for this calculus (comoving distance, growth factor and so on).</p></li><li><p><code>y</code>: the cosine of the angle between the two points <code>P1</code> and <code>P2</code> wrt the observer</p></li><li><p><code>cosmo::Cosmology</code>: cosmology to be used in this computation; it contains all the splines used for the conversion <code>s</code> -&gt; <code>Point</code>, and all the cosmological parameters <span>$b$</span>, ...</p></li></ul><p><strong>Keyword Arguments</strong></p><ul><li><code>obs::Union{Bool,Symbol} = :noobsvel</code> : do you want to consider the observer terms in the computation of the  chosen GNC TPCF effect?<ul><li><code>:yes</code> or <code>true</code> -&gt; all the observer effects will be considered</li><li><code>:no</code> or <code>false</code> -&gt; no observer term will be taken into account</li><li><code>:noobsvel</code> -&gt; the observer terms related to the observer velocity (that you can find in the CF concerning Doppler) will be neglected, the other ones will be taken into account</li></ul></li></ul><p>See also: <a href="../Cosmology/#GaPSE.Point"><code>Point</code></a>, <a href="../Cosmology/#GaPSE.Cosmology"><code>Cosmology</code></a>, <a href="#GaPSE.ξ_GNC_multipole"><code>ξ_GNC_multipole</code></a>,  <a href="#GaPSE.map_ξ_GNC_multipole"><code>map_ξ_GNC_multipole</code></a>, <a href="#GaPSE.print_map_ξ_GNC_multipole"><code>print_map_ξ_GNC_multipole</code></a>, <a href="#GaPSE.ξ_GNC_LocalGP_IntegratedGP"><code>ξ_GNC_LocalGP_IntegratedGP</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cosmofico97/GaPSE/blob/5f3347ff3b074f172d8e3ff7fa715eea30fd3aad/src/GNC_CrossCorrelations/GNC_LocalGPIntegratedGP.jl#L71-L232">source</a></section></article><h1 id="Two-Point-Cross-Correlation-Function-multipoles"><a class="docs-heading-anchor" href="#Two-Point-Cross-Correlation-Function-multipoles">Two-Point Cross-Correlation Function multipoles</a><a id="Two-Point-Cross-Correlation-Function-multipoles-1"></a><a class="docs-heading-anchor-permalink" href="#Two-Point-Cross-Correlation-Function-multipoles" title="Permalink"></a></h1><article class="docstring"><header><a class="docstring-binding" id="GaPSE.integrand_ξ_GNC_multipole" href="#GaPSE.integrand_ξ_GNC_multipole"><code>GaPSE.integrand_ξ_GNC_multipole</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs"> integrand_ξ_GNC_multipole(s1, s, μ, effect::Function, cosmo::Cosmology;
      L::Int = 0, use_windows::Bool = true, kwargs...)

 integrand_ξ_GNC_multipole(s1, s, μ, effect::String, cosmo::Cosmology; kwargs...)</code></pre><p>Return the integrand on <span>$\mu = \hat{\mathbf{s}}_1 \cdot \hat{\mathbf{s}}$</span>  of the of the chosen Galaxy Number Counts (GNC) Two-Point Correlation Function (TPCF)  term, i.e. the following function <span>$f(s_1, s, \mu)$</span>:</p><p class="math-container">\[     f_L(s_1, s, \mu) = \xi \left(s_1, s_2, y\right) 
          \, \mathcal{L}_L(\mu) \, \times 
     \begin{cases} 
          \frac{1}{\mathcal{N}}\mathcal{F}(s, \mu) \quad \mathrm{use\_windows == true} \\
          1 \quad\quad \mathrm{use\_windows == false}
     \end{cases}\]</p><p>where:</p><ul><li><span>$s_2 = s_2(s_1, s, \mu) = \sqrt{s_1^2 + s^2 + 2 \, s_1 \, s \, \mu}$</span> </li><li><span>$y = \cos{\theta} = \hat{\mathbf{s}}_1 \cdot \hat{\mathbf{s}}_2 = \frac{\mu \, s + s_1}{s_2(s_1, s, \mu)}$</span></li><li><span>$\xi$</span> is the corresponding GNC TPCF effect</li><li><span>$\mathcal{L}_L(\mu)$</span> is the Legendre polynomial of order <span>$L$</span></li><li><span>$\mathcal{F}(s, \mu)$</span> is the integrated window function stored in <code>cosmo::Cosmology</code> (check the documentation of <code>WindowFIntegrated</code>)</li><li><span>$\mathcal{N}$</span> is the integrated window function norm (check the documentation of <code>WindowFIntegrated</code>)</li></ul><p>In the former method you have to pass as an input the GNC <code>effect</code> function you want  to integrate, while in the (recommended) latter one it&#39;s necessary to specify the name of the GNC TPCF term among the following:</p><p><code>auto_newton , auto_doppler , auto_lensing , auto_localgp , auto_integratedgp , newton_doppler , doppler_newton , newton_lensing , lensing_newton , newton_localgp , localgp_newton , newton_integratedgp , integratedgp_newton , lensing_doppler , doppler_lensing , doppler_localgp , localgp_doppler , doppler_integratedgp , integratedgp_doppler , lensing_localgp , localgp_lensing , lensing_integratedgp , integratedgp_lensing , localgp_integratedgp , integratedgp_localgp ,</code></p><p>to which correspond the following functions, respectively:</p><p><code>ξ_GNC_Newtonian , ξ_GNC_Doppler , ξ_GNC_Lensing , ξ_GNC_LocalGP , ξ_GNC_IntegratedGP , ξ_GNC_Newtonian_Doppler , ξ_GNC_Doppler_Newtonian , ξ_GNC_Newtonian_Lensing , ξ_GNC_Lensing_Newtonian , ξ_GNC_Newtonian_LocalGP , ξ_GNC_LocalGP_Newtonian , ξ_GNC_Newtonian_IntegratedGP , ξ_GNC_IntegratedGP_Newtonian , ξ_GNC_Lensing_Doppler , ξ_GNC_Doppler_Lensing , ξ_GNC_Doppler_LocalGP , ξ_GNC_LocalGP_Doppler , ξ_GNC_Doppler_IntegratedGP , ξ_GNC_IntegratedGP_Doppler , ξ_GNC_Lensing_LocalGP , ξ_GNC_LocalGP_Lensing , ξ_GNC_Lensing_IntegratedGP , ξ_GNC_IntegratedGP_Lensing , ξ_GNC_LocalGP_IntegratedGP , ξ_GNC_IntegratedGP_LocalGP ,</code></p><p>Internally, the second method recall the first, so all the keyword arguments are in common.</p><p>Note that these is an internal conversion of coordiate sistems from <code>(s1, s, μ)</code> to <code>(s1, s2, y)</code> thorugh the functions <code>y</code> and <code>s2</code>. The inverse relations are:</p><ul><li><span>$s = s(s_1, s_2, y) = \sqrt{s_1^2 + s_2^2 - 2 \, s_1 \, s_2 \, y}$</span></li><li><span>$\mu = \cos{\theta} = \hat{\mathbf{s}}_1 \cdot \hat{\mathbf{s}} = \frac{y \, s_2 - s_1}{s(s_1, s_2, y)}$</span>.</li></ul><p><strong>Inputs</strong></p><ul><li><p><code>s1</code>: the comoving distance where must be evaluated the integral</p></li><li><p><code>s</code>: the comoving distance from <code>s1</code> where must be evaluated the integral</p></li><li><p><code>μ</code>: the cosine between <code>s1</code> and <code>s</code> where must be evaluated the integral</p></li><li><p><code>effect::Function</code> or <code>effect::String</code> : name/function you want to consider, among the ones inside <code>GaPSE.GR_EFFECTS_GNC</code>/<code>GaPSE.VEC_ξs_GNC</code> respectively.</p></li><li><p><code>cosmo::Cosmology</code>: cosmology to be used in this computation</p></li></ul><p><strong>Optional arguments</strong></p><ul><li><p><code>L::Int = 0</code>: order of the Legendre polynomial to be used</p></li><li><p><code>use_windows::Bool = false</code>: tells if the integrand must consider the two  window function <span>$\phi$</span> and <span>$\mathcal{F}$</span></p></li><li><p><code>kwargs...</code> : other keyword arguments that will be passed to the selected  GR TPCF effect (<code>ξ_GNC_Doppler</code>, <code>ξ_GNC_Lensing</code>, ...)</p></li></ul><p>See also: <a href="#GaPSE.ξ_GNC_multipole"><code>ξ_GNC_multipole</code></a>, <a href="#GaPSE.map_ξ_GNC_multipole"><code>map_ξ_GNC_multipole</code></a>, <a href="#GaPSE.print_map_ξ_GNC_multipole"><code>print_map_ξ_GNC_multipole</code></a>, <a href="../WindowFIntegrated/#GaPSE.WindowFIntegrated"><code>WindowFIntegrated</code></a>, <a href="../CosmoUtils/#GaPSE.ϕ"><code>ϕ</code></a>, <a href="../Cosmology/#GaPSE.Cosmology"><code>Cosmology</code></a>,  <a href="../CosmoUtils/#GaPSE.y"><code>y</code></a>, <a href="../CosmoUtils/#GaPSE.s2"><code>s2</code></a>, <a href="@ref"><code>GR_EFFECTS_GNC</code></a>, <a href="@ref"><code>GaPSE.VEC_ξs_GNC</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cosmofico97/GaPSE/blob/5f3347ff3b074f172d8e3ff7fa715eea30fd3aad/src/GNC_XiMultipoles.jl#L62-L136">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="GaPSE.ξ_GNC_multipole" href="#GaPSE.ξ_GNC_multipole"><code>GaPSE.ξ_GNC_multipole</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs"> ξ_GNC_multipole(
      s1, s, effect::Function, cosmo::Cosmology;
      L::Int = 0, alg::Symbol = :lobatto, 
      use_windows::Bool = true, 
      obs::Union{Bool,Symbol} = :noobsvel,
      N_lob::Int = 100, N_trap::Int = 200, 
      atol_quad::Float64 = 0.0, rtol_quad::Float64 = 1e-2,
      enhancer::Float64 = 1e6, 
      kwargs...) ::Float64

 ξ_GNC_multipole(s1, s, effect::String, cosmo::Cosmology; 
      kwargs...) ::Float64</code></pre><p>Evaluate the multipole of order <code>L</code> of the chosen Galaxy Number Counts (GNC)  Two-Point Correlation Function (TPCF) term i.e. the following function <span>$\xi_L(s_1, s)$</span>:</p><p class="math-container">\[    \xi_L(s_1, s) = \frac{2 L + 1}{2} \int_{-1}^{+1} \mathrm{d}\mu \; 
        \xi (s_1, s_2, \cos{\theta}) \, \mathcal{L}_L(\mu) \,  \times
    \begin{cases} 
        \frac{1}{\mathcal{N}}\mathcal{F}(s, \mu) \quad \mathrm{use\_windows == true} \\
        1 \quad\quad \mathrm{use\_windows == false}
    \end{cases}\]</p><p>where:</p><ul><li><span>$s_2 = s_2(s_1, s, \mu) = \sqrt{s_1^2 + s^2 + 2 \, s_1 \, s \, \mu}$</span> </li><li><span>$y = \cos{\theta} = \hat{\mathbf{s}}_1 \cdot \hat{\mathbf{s}}_2 = \frac{\mu \, s + s_1}{s_2(s_1, s, \mu)}$</span></li><li><span>$\xi$</span> is the corresponding GNC TPCF effect</li><li><span>$\mathcal{L}_L(\mu)$</span> is the Legendre polynomial of order <span>$L$</span></li><li><span>$\mathcal{F}(s, \mu)$</span> is the integrated window function stored in <code>cosmo::Cosmology</code> (check the documentation of <code>WindowFIntegrated</code>)</li><li><span>$\mathcal{N}$</span> is the integrated window function norm (check the documentation of <code>WindowFIntegrated</code>) </li></ul><p>In the former method you have to pass as an input the GNC <code>effect</code> function you want  to integrate, while in the (recommended) latter one it&#39;s necessary to specify the name of the GNC TPCF term among the following:</p><p><code>auto_newton , auto_doppler , auto_lensing , auto_localgp , auto_integratedgp , newton_doppler , doppler_newton , newton_lensing , lensing_newton , newton_localgp , localgp_newton , newton_integratedgp , integratedgp_newton , lensing_doppler , doppler_lensing , doppler_localgp , localgp_doppler , doppler_integratedgp , integratedgp_doppler , lensing_localgp , localgp_lensing , lensing_integratedgp , integratedgp_lensing , localgp_integratedgp , integratedgp_localgp ,</code></p><p>to which correspond the following functions:</p><p><code>ξ_GNC_Newtonian , ξ_GNC_Doppler , ξ_GNC_Lensing , ξ_GNC_LocalGP , ξ_GNC_IntegratedGP , ξ_GNC_Newtonian_Doppler , ξ_GNC_Doppler_Newtonian , ξ_GNC_Newtonian_Lensing , ξ_GNC_Lensing_Newtonian , ξ_GNC_Newtonian_LocalGP , ξ_GNC_LocalGP_Newtonian , ξ_GNC_Newtonian_IntegratedGP , ξ_GNC_IntegratedGP_Newtonian , ξ_GNC_Lensing_Doppler , ξ_GNC_Doppler_Lensing , ξ_GNC_Doppler_LocalGP , ξ_GNC_LocalGP_Doppler , ξ_GNC_Doppler_IntegratedGP , ξ_GNC_IntegratedGP_Doppler , ξ_GNC_Lensing_LocalGP , ξ_GNC_LocalGP_Lensing , ξ_GNC_Lensing_IntegratedGP , ξ_GNC_IntegratedGP_Lensing , ξ_GNC_LocalGP_IntegratedGP , ξ_GNC_IntegratedGP_LocalGP ,</code></p><p>Internally, the second method recall the first, so all the keyword arguments are in common.</p><p>Note that these is an internal conversion of coordiate sistems from <code>(s1, s, μ)</code> to <code>(s1, s2, y)</code> thorugh the functions <code>y</code> and <code>s2</code>. The inverse relations are:</p><ul><li><span>$s = s(s_1, s_2, y) = \sqrt{s_1^2 + s_2^2 - 2 \, s_1 \, s_2 \, y}$</span></li><li><span>$\mu = \cos{\theta} = \hat{\mathbf{s}}_1 \cdot \hat{\mathbf{s}} = \frac{y \, s_2 - s_1}{s(s_1, s_2, y)}$</span>.</li></ul><p><strong>Inputs</strong></p><ul><li><p><code>s1</code>: the comoving distance where must be evaluated the integral</p></li><li><p><code>s</code>: the comoving distance from <code>s1</code> where must be evaluated the integral</p></li><li><p><code>effect::Function</code> or <code>effect::String</code> : name/function you want to consider, among the ones inside <code>GaPSE.GR_EFFECTS_GNC</code>/<code>GaPSE.VEC_ξs_GNC</code> respectively.</p></li><li><p><code>cosmo::Cosmology</code>: cosmology to be used in this computation</p></li></ul><p><strong>Optional arguments</strong></p><ul><li><p><code>L::Int = 0</code>: order of the Legendre polynomial to be used</p></li><li><p><code>alg::Symbol = :trap</code> : algorithm to be used for the integration; the valid options  are (other values will lead to <code>AssertionError</code>):</p><ul><li><code>:quad</code> -&gt; the integration over <span>$\mu$</span> will be preformed through the Julia function <code>quadgk</code> </li></ul><p>from the <a href="https://github.com/JuliaMath/QuadGK.jl"><code>QuadGK.jl</code></a> Julia package, that uses an adaptive  Gauss-Kronrod quadrature.</p><ul><li><code>:trap</code> -&gt; the integration over <span>$\mu$</span> will be preformed through the Julia function <code>trapz</code> </li></ul><p>from the <a href="https://github.com/francescoalemanno/Trapz.jl"><code>Trapz.jl</code></a> Julia package, that uses the simple trapezoidal rulae.</p><ul><li><code>:lobatto</code> -&gt; the integration over <span>$\mu$</span> will be preformed through the Julia function <code>gausslobatto</code> </li></ul><p>from the <a href="https://github.com/JuliaApproximation/FastGaussQuadrature.jl"><code>FastGaussQuadrature.jl</code></a> Julia package,  that uses the Gauss-Lobatto quadrature.  WE RECOMMEND TO USE <code>:quad</code> FOR MONOPOLES AND <code>:lobatto</code> FOR HIGHER ORDER MULTIPOLES!</p></li><li><p><code>use_windows::Bool = false</code>: tells if the integrand must consider the two  window function <span>$\phi$</span> and <span>$\mathcal{F}$</span></p></li><li><p><code>obs::Union{Bool,Symbol} = :noobsvel</code> : do you want to consider the observer terms in the computation of the  chosen GNC TPCF effect?</p><ul><li><code>:yes</code> or <code>true</code> -&gt; all the observer effects will be considered</li><li><code>:no</code> or <code>false</code> -&gt; no observer term will be taken into account</li><li><code>:noobsvel</code> -&gt; the observer terms related to the observer velocity (that you can find in the CF concerning Doppler) will be neglected, the other ones will be taken into account</li></ul></li><li><p><code>N_lob::Int = 100</code> : number of points to be used in the sampling made by the function <code>trapz</code>. Note that these options will have an effect only if you se <code>alg = :quad</code>.</p></li><li><p><code>N_trap::Int = 200</code> : number of points to be used in the sampling made by the function <code>trapz</code>. Note that these options will have an effect only if you se <code>alg = :quad</code>.</p></li><li><p><code>atol_quad::Float64 = 0.0</code> and <code>rtol_quad::Float64 = 1e-2</code>: absolute and relative tolerance to be passed to the function <code>quadgk</code>; it&#39;s recommended not to set <code>rtol_quad &lt; 1e-2</code>  because the time for evaluation increase quickly. Note that these options will have an effect only if you se <code>alg = :quad</code>.</p></li><li><p><code>enhancer::Float64 = 1e6</code>: just a float number used in order to deal better with small numbers;  the returned value is NOT modified by this value, because after a multiplication the internal result is divided by <code>enhancer</code>.</p></li><li><p><code>kwargs...</code> : other keyword arguments that will be passed to the selected  GNC TPCF effect (<code>ξ_GNC_Doppler</code>, <code>ξ_GNC_Lensing</code>, ...)</p></li></ul><p>See also: <a href="#GaPSE.integrand_ξ_GNC_multipole"><code>integrand_ξ_GNC_multipole</code></a>,  <a href="#GaPSE.map_ξ_GNC_multipole"><code>map_ξ_GNC_multipole</code></a>, <a href="#GaPSE.print_map_ξ_GNC_multipole"><code>print_map_ξ_GNC_multipole</code></a> <a href="../WindowFIntegrated/#GaPSE.WindowFIntegrated"><code>WindowFIntegrated</code></a>, <a href="../Cosmology/#GaPSE.Cosmology"><code>Cosmology</code></a>,  <a href="../CosmoUtils/#GaPSE.y"><code>y</code></a>, <a href="../CosmoUtils/#GaPSE.s2"><code>s2</code></a>, <a href="@ref"><code>GR_EFFECTS_GNC</code></a>, <a href="@ref"><code>VEC_ξs_GNC</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cosmofico97/GaPSE/blob/5f3347ff3b074f172d8e3ff7fa715eea30fd3aad/src/GNC_XiMultipoles.jl#L211-L324">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="GaPSE.map_ξ_GNC_multipole" href="#GaPSE.map_ξ_GNC_multipole"><code>GaPSE.map_ξ_GNC_multipole</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs"> map_ξ_GNC_multipole(cosmo::Cosmology,
      effect::Union{String,Function}, ss = nothing;
      s1 = nothing, L::Int = 0, alg::Symbol = :lobatto,
      obs::Union{Bool,Symbol} = :noobsvel,
      N_lob::Int = 100, N_trap::Int = 50,
      atol_quad::Float64 = 0.0, rtol_quad::Float64 = 1e-2,
      enhancer::Float64=1e6, N_log::Int = 1000, 
      pr::Bool = true,
      kwargs...) ::Tuple{Vector{Float64}, Vector{Float64}}</code></pre><p>Evaluate the multipole of order <code>L</code> of the chosen Galaxy Number Counts (GNC)  Two-Point Correlation Function (TPCF) term for all the comoving distance  values stored inside <code>ss</code>. If <code>ss = nothing</code>, it is set <code>ss = 10 .^ range(0, log10(2 * cosmo.s_max), length=N_log)</code>. If <code>s1 = nothing</code>, it is set <code>s1 = cosmo.s_eff</code>.</p><p>The function evaluated is then the following <span>$\xi_L(s_1, s)$</span>:</p><p class="math-container">\[    \xi_L(s_1, s) = \frac{2 L + 1}{2} \int_{-1}^{+1} \mathrm{d}\mu \; 
        \xi (s_1, s_2, \cos{\theta}) \, \mathcal{L}_L(\mu) \,  \times
    \begin{cases} 
        \frac{1}{\mathcal{N}}\mathcal{F}(s, \mu) \quad \mathrm{use\_windows == true} \\
        1 \quad\quad \mathrm{use\_windows == false}
    \end{cases}\]</p><p>where:</p><ul><li><span>$s_2 = s_2(s_1, s, \mu) = \sqrt{s_1^2 + s^2 + 2 \, s_1 \, s \, \mu}$</span> </li><li><span>$y = \cos{\theta} = \hat{\mathbf{s}}_1 \cdot \hat{\mathbf{s}}_2 = \frac{\mu \, s + s_1}{s_2(s_1, s, \mu)}$</span></li><li><span>$\xi$</span> is the corresponding GNC TPCF effect</li><li><span>$\mathcal{L}_L(\mu)$</span> is the Legendre polynomial of order <span>$L$</span></li><li><span>$\mathcal{F}(s, \mu)$</span> is the integrated window function stored in <code>cosmo::Cosmology</code> (check the documentation of <code>WindowFIntegrated</code>)</li><li><span>$\mathcal{N}$</span> is the integrated window function norm (check the documentation of <code>WindowFIntegrated</code>) </li></ul><p>Note that these is an internal conversion of coordiate sistems from <code>(s1, s, μ)</code> to <code>(s1, s2, y)</code> thorugh the functions <code>y</code> and <code>s2</code>. The inverse relations are:</p><ul><li><span>$s = s(s_1, s_2, y) = \sqrt{s_1^2 + s_2^2 - 2 \, s_1 \, s_2 \, y}$</span></li><li><span>$\mu = \cos{\theta} = \hat{\mathbf{s}}_1 \cdot \hat{\mathbf{s}} = \frac{y \, s_2 - s_1}{s(s_1, s_2, y)}$</span>.</li></ul><p><strong>Inputs</strong></p><ul><li><p><code>cosmo::Cosmology</code> : cosmology to be used in this computation</p></li><li><p><code>effect::Union{String,Function}</code> : the GR effect TPCF you want to consider; you may specify the name of the effect as one of the following strings (recommended):</p><p><code>auto_newton , auto_doppler , auto_lensing , auto_localgp , auto_integratedgp , newton_doppler , doppler_newton , newton_lensing , lensing_newton , newton_localgp , localgp_newton , newton_integratedgp , integratedgp_newton , lensing_doppler , doppler_lensing , doppler_localgp , localgp_doppler , doppler_integratedgp , integratedgp_doppler , lensing_localgp , localgp_lensing , lensing_integratedgp , integratedgp_lensing , localgp_integratedgp , integratedgp_localgp ,</code></p><p>or directly the name of the function among the following: </p><p><code>ξ_GNC_Newtonian , ξ_GNC_Doppler , ξ_GNC_Lensing , ξ_GNC_LocalGP , ξ_GNC_IntegratedGP , ξ_GNC_Newtonian_Doppler , ξ_GNC_Doppler_Newtonian , ξ_GNC_Newtonian_Lensing , ξ_GNC_Lensing_Newtonian , ξ_GNC_Newtonian_LocalGP , ξ_GNC_LocalGP_Newtonian , ξ_GNC_Newtonian_IntegratedGP , ξ_GNC_IntegratedGP_Newtonian , ξ_GNC_Lensing_Doppler , ξ_GNC_Doppler_Lensing , ξ_GNC_Doppler_LocalGP , ξ_GNC_LocalGP_Doppler , ξ_GNC_Doppler_IntegratedGP , ξ_GNC_IntegratedGP_Doppler , ξ_GNC_Lensing_LocalGP , ξ_GNC_LocalGP_Lensing , ξ_GNC_Lensing_IntegratedGP , ξ_GNC_IntegratedGP_Lensing , ξ_GNC_LocalGP_IntegratedGP , ξ_GNC_IntegratedGP_LocalGP ,</code></p></li><li><p><code>ss</code> : vector/range of <code>s</code> values where the function must be evaluated; if <code>ss = nothing</code>,  it is set <code>ss = 10 .^ range(0, log10(2 * cosmo.s_max), length=N_log)</code>. This is why it is returned  also the vector of the &quot;input&quot; values.</p></li></ul><p><strong>Optional arguments</strong></p><ul><li><p><code>s1 = nothing</code> : comoving distance from the observer where the TPCF should be evaluated; if <code>s1 = nothing</code>, it is automatically set <code>s1 = cosmo.s_eff</code> from the given input <code>cosmo::Cosmology</code>.</p></li><li><p><code>L::Int = 0</code>: order of the Legendre polynomial to be used</p></li><li><p><code>alg::Symbol = :trap</code> : algorithm to be used for the integration; the valid options  are (other values will lead to <code>AssertionError</code>):</p><ul><li><code>:quad</code> -&gt; the integration over <span>$\mu$</span> will be preformed through the Julia function <code>quadgk</code> </li></ul><p>from the <a href="https://github.com/JuliaMath/QuadGK.jl"><code>QuadGK.jl</code></a> Julia package, that uses an adaptive  Gauss-Kronrod quadrature.</p><ul><li><code>:trap</code> -&gt; the integration over <span>$\mu$</span> will be preformed through the Julia function <code>trapz</code> </li></ul><p>from the <a href="https://github.com/francescoalemanno/Trapz.jl"><code>Trapz.jl</code></a> Julia package, that uses the simple trapezoidal rulae.</p><ul><li><code>:lobatto</code> -&gt; the integration over <span>$\mu$</span> will be preformed through the Julia function <code>gausslobatto</code> </li></ul><p>from the <a href="https://github.com/JuliaApproximation/FastGaussQuadrature.jl"><code>FastGaussQuadrature.jl</code></a> Julia package,  that uses the Gauss-Lobatto quadrature.  WE RECOMMEND TO USE <code>:quad</code> FOR MONOPOLES AND <code>:lobatto</code> FOR HIGHER ORDER MULTIPOLES!</p></li><li><p><code>use_windows::Bool = false</code>: tells if the integrand must consider the two  window function <span>$\phi$</span> and <span>$\mathcal{F}$</span></p></li><li><p><code>obs::Union{Bool,Symbol} = :noobsvel</code> : do you want to consider the observer terms in the computation of the  chosen GNC TPCF effect?</p><ul><li><code>:yes</code> or <code>true</code> -&gt; all the observer effects will be considered</li><li><code>:no</code> or <code>false</code> -&gt; no observer term will be taken into account</li><li><code>:noobsvel</code> -&gt; the observer terms related to the observer velocity (that you can find in the CF concerning Doppler) will be neglected, the other ones will be taken into account</li></ul></li><li><p><code>N_lob::Int = 100</code> : number of points to be used in the sampling made by the function <code>trapz</code>. Note that these options will have an effect only if you se <code>alg = :quad</code>.</p></li><li><p><code>N_trap::Int = 200</code> : number of points to be used in the sampling made by the function <code>trapz</code>. Note that these options will have an effect only if you se <code>alg = :quad</code>.</p></li><li><p><code>atol_quad::Float64 = 0.0</code> and <code>rtol_quad::Float64 = 1e-2</code>: absolute and relative tolerance to be passed to the function <code>quadgk</code>; it&#39;s recommended not to set <code>rtol_quad &lt; 1e-2</code>  because the time for evaluation increase quickly. Note that these options will have an effect only if you se <code>alg = :quad</code>.</p></li><li><p><code>enhancer::Float64 = 1e6</code>: just a float number used in order to deal better with small numbers;  the returned value is NOT modified by this value, because after a multiplication the internal result is divided by <code>enhancer</code>.</p></li><li><p><code>N_log::Int = 1000</code> : number of points to be used in the default logaritmically-spaced  range for <code>ss</code>, i.e. <code>range(0, log10(2 * cosmo.s_max), length=N_log)</code>; it is ignored if <code>ss ≠ nothing</code> </p></li><li><p><code>pr::Bool = true</code> : do you want the progress bar showed on screen, in order to  check the time needed for the computation? (<code>true</code> recommended)</p></li><li><p><code>kwargs...</code> : other keyword arguments that will be passed to the selected  GNC TPCF effect (<code>ξ_GNC_Doppler</code>, <code>ξ_GNC_Lensing</code>, ...)</p></li></ul><p><strong>Returns</strong></p><p>A <code>Tuple{Vector{Float64}, Vector{Float64}}</code>, which has as first element the <code>ss</code> vector and as second one the corresponding ξ value evaluated.</p><p>See also: <a href="#GaPSE.integrand_ξ_GNC_multipole"><code>integrand_ξ_GNC_multipole</code></a>, <a href="#GaPSE.ξ_GNC_multipole"><code>ξ_GNC_multipole</code></a>, <a href="#GaPSE.print_map_ξ_GNC_multipole"><code>print_map_ξ_GNC_multipole</code></a>, <a href="../WindowFIntegrated/#GaPSE.WindowFIntegrated"><code>WindowFIntegrated</code></a>, <a href="../Cosmology/#GaPSE.Cosmology"><code>Cosmology</code></a>,  <a href="../CosmoUtils/#GaPSE.y"><code>y</code></a>, <a href="../CosmoUtils/#GaPSE.s2"><code>s2</code></a>, <a href="@ref"><code>GR_EFFECTS_GNC</code></a>, <a href="@ref"><code>GaPSE.VEC_ξs_GNC</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cosmofico97/GaPSE/blob/5f3347ff3b074f172d8e3ff7fa715eea30fd3aad/src/GNC_XiMultipoles.jl#L331-L454">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="GaPSE.print_map_ξ_GNC_multipole" href="#GaPSE.print_map_ξ_GNC_multipole"><code>GaPSE.print_map_ξ_GNC_multipole</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs"> print_map_ξ_GNC_multipole(
      cosmo::Cosmology, out::String,
      effect::Union{String,Function},
      ss = nothing;
      s1 = nothing, L::Int = 0, alg::Symbol = :lobatto,
      obs::Union{Bool,Symbol} = :noobsvel,
      N_lob::Int = 100, N_trap::Int = 50,
      atol_quad::Float64 = 0.0, rtol_quad::Float64 = 1e-2,
      enhancer::Float64=1e6, N_log::Int = 1000, 
      pr::Bool = true,
      kwargs...)</code></pre><p>Evaluate the multipole of order <code>L</code> of the chosen Galaxy Number Counts (GNC)  Two-Point Correlation Function (TPCF) term for all the  comoving distance  values stored inside <code>ss</code>, and print the results (with all the options used)  in a file named <code>out</code>. If <code>ss = nothing</code>, it is set <code>ss = 10 .^ range(0, log10(2 * cosmo.s_max), length=N_log)</code>. If <code>s1 = nothing</code>, it is set <code>s1 = cosmo.s_eff</code>.</p><p>The function evaluated is then the following <span>$\xi_L(s_1, s)$</span>:</p><p class="math-container">\[    \xi_L(s_1, s) = \frac{2 L + 1}{2} \int_{-1}^{+1} \mathrm{d}\mu \; 
        \xi (s_1, s_2, \cos{\theta}) \, \mathcal{L}_L(\mu) \,  \times
    \begin{cases} 
        \frac{1}{\mathcal{N}}\mathcal{F}(s, \mu) \quad \mathrm{use\_windows == true} \\
        1 \quad\quad \mathrm{use\_windows == false}
    \end{cases}\]</p><p>where:</p><ul><li><span>$s_2 = s_2(s_1, s, \mu) = \sqrt{s_1^2 + s^2 + 2 \, s_1 \, s \, \mu}$</span> </li><li><span>$y = \cos{\theta} = \hat{\mathbf{s}}_1 \cdot \hat{\mathbf{s}}_2 = \frac{\mu \, s + s_1}{s_2(s_1, s, \mu)}$</span></li><li><span>$\xi$</span> is the corresponding GNC TPCF effect</li><li><span>$\mathcal{L}_L(\mu)$</span> is the Legendre polynomial of order <span>$L$</span></li><li><span>$\mathcal{F}(s, \mu)$</span> is the integrated window function stored in <code>cosmo::Cosmology</code> (check the documentation of <code>WindowFIntegrated</code>)</li><li><span>$\mathcal{N}$</span> is the integrated window function norm (check the documentation of <code>WindowFIntegrated</code>) </li></ul><p>Note that these is an internal conversion of coordiate sistems from <code>(s1, s, μ)</code> to <code>(s1, s2, y)</code> thorugh the functions <code>y</code> and <code>s2</code>. The inverse relations are:</p><ul><li><span>$s = s(s_1, s_2, y) = \sqrt{s_1^2 + s_2^2 - 2 \, s_1 \, s_2 \, y}$</span></li><li><span>$\mu = \cos{\theta} = \hat{\mathbf{s}}_1 \cdot \hat{\mathbf{s}} = \frac{y \, s_2 - s_1}{s(s_1, s_2, y)}$</span>.</li></ul><p><strong>Inputs</strong></p><ul><li><p><code>cosmo::Cosmology</code> : cosmology to be used in this computation</p></li><li><p><code>effect::Union{String,Function}</code> : the GR effect TPCF you want to consider; you may specify the name of the effect as one of the following strings (recommended):</p><p><code>auto_newton , auto_doppler , auto_lensing , auto_localgp , auto_integratedgp , newton_doppler , doppler_newton , newton_lensing , lensing_newton , newton_localgp , localgp_newton , newton_integratedgp , integratedgp_newton , lensing_doppler , doppler_lensing , doppler_localgp , localgp_doppler , doppler_integratedgp , integratedgp_doppler , lensing_localgp , localgp_lensing , lensing_integratedgp , integratedgp_lensing , localgp_integratedgp , integratedgp_localgp ,</code></p><p>or directly the name of the function among the following: </p><p><code>ξ_GNC_Newtonian , ξ_GNC_Doppler , ξ_GNC_Lensing , ξ_GNC_LocalGP , ξ_GNC_IntegratedGP , ξ_GNC_Newtonian_Doppler , ξ_GNC_Doppler_Newtonian , ξ_GNC_Newtonian_Lensing , ξ_GNC_Lensing_Newtonian , ξ_GNC_Newtonian_LocalGP , ξ_GNC_LocalGP_Newtonian , ξ_GNC_Newtonian_IntegratedGP , ξ_GNC_IntegratedGP_Newtonian , ξ_GNC_Lensing_Doppler , ξ_GNC_Doppler_Lensing , ξ_GNC_Doppler_LocalGP , ξ_GNC_LocalGP_Doppler , ξ_GNC_Doppler_IntegratedGP , ξ_GNC_IntegratedGP_Doppler , ξ_GNC_Lensing_LocalGP , ξ_GNC_LocalGP_Lensing , ξ_GNC_Lensing_IntegratedGP , ξ_GNC_IntegratedGP_Lensing , ξ_GNC_LocalGP_IntegratedGP , ξ_GNC_IntegratedGP_LocalGP ,</code></p></li><li><p><code>out::String</code> : name of the file where the results must be stored.</p></li><li><p><code>ss</code> : vector/range of <code>s</code> values where the function must be evaluated; if <code>ss = nothing</code>,  it is set <code>ss = 10 .^ range(0, log10(2 * cosmo.s_max), length=N_log)</code>.</p></li></ul><p><strong>Optional arguments</strong></p><p>This function recall internally <code>map_ξ_GNC_multipole</code>, so the kwargs are the same; we report them for comfortness:</p><ul><li><p><code>s1 = nothing</code> : comoving distance from the observer where the TPCF should be evaluated; if <code>s1 = nothing</code>, it is automatically set <code>s1 = cosmo.s_eff</code> from the given input <code>cosmo::Cosmology</code>.</p></li><li><p><code>L::Int = 0</code>: order of the Legendre polynomial to be used</p></li><li><p><code>alg::Symbol = :trap</code> : algorithm to be used for the integration; the valid options  are (other values will lead to <code>AssertionError</code>):</p><ul><li><code>:quad</code> -&gt; the integration over <span>$\mu$</span> will be preformed through the Julia function <code>quadgk</code> </li></ul><p>from the <a href="https://github.com/JuliaMath/QuadGK.jl"><code>QuadGK.jl</code></a> Julia package, that uses an adaptive  Gauss-Kronrod quadrature.</p><ul><li><code>:trap</code> -&gt; the integration over <span>$\mu$</span> will be preformed through the Julia function <code>trapz</code> </li></ul><p>from the <a href="https://github.com/francescoalemanno/Trapz.jl"><code>Trapz.jl</code></a> Julia package, that uses the simple trapezoidal rulae.</p><ul><li><code>:lobatto</code> -&gt; the integration over <span>$\mu$</span> will be preformed through the Julia function <code>gausslobatto</code> </li></ul><p>from the <a href="https://github.com/JuliaApproximation/FastGaussQuadrature.jl"><code>FastGaussQuadrature.jl</code></a> Julia package,  that uses the Gauss-Lobatto quadrature.  WE RECOMMEND TO USE <code>:quad</code> FOR MONOPOLES AND <code>:lobatto</code> FOR HIGHER ORDER MULTIPOLES!</p></li><li><p><code>use_windows::Bool = false</code>: tells if the integrand must consider the two  window function <span>$\phi$</span> and <span>$\mathcal{F}$</span></p></li><li><p><code>obs::Union{Bool,Symbol} = :noobsvel</code> : do you want to consider the observer terms in the computation of the  chosen GNC TPCF effect?</p><ul><li><code>:yes</code> or <code>true</code> -&gt; all the observer effects will be considered</li><li><code>:no</code> or <code>false</code> -&gt; no observer term will be taken into account</li><li><code>:noobsvel</code> -&gt; the observer terms related to the observer velocity (that you can find in the CF concerning Doppler) will be neglected, the other ones will be taken into account</li></ul></li><li><p><code>N_lob::Int = 100</code> : number of points to be used in the sampling made by the function <code>trapz</code>. Note that these options will have an effect only if you se <code>alg = :quad</code>.</p></li><li><p><code>N_trap::Int = 200</code> : number of points to be used in the sampling made by the function <code>trapz</code>. Note that these options will have an effect only if you se <code>alg = :quad</code>.</p></li><li><p><code>atol_quad::Float64 = 0.0</code> and <code>rtol_quad::Float64 = 1e-2</code>: absolute and relative tolerance to be passed to the function <code>quadgk</code>; it&#39;s recommended not to set <code>rtol_quad &lt; 1e-2</code>  because the time for evaluation increase quickly. Note that these options will have an effect only if you se <code>alg = :quad</code>.</p></li><li><p><code>enhancer::Float64 = 1e6</code>: just a float number used in order to deal better with small numbers;  the returned value is NOT modified by this value, because after a multiplication the internal result is divided by <code>enhancer</code>.</p></li><li><p><code>N_log::Int = 1000</code> : number of points to be used in the default logaritmically-spaced  range for <code>ss</code>, i.e. <code>range(0, log10(2 * cosmo.s_max), length=N_log)</code>; it is ignored if <code>ss ≠ nothing</code> </p></li><li><p><code>pr::Bool = true</code> : do you want the progress bar showed on screen, in order to  check the time needed for the computation? (<code>true</code> recommended)</p></li><li><p><code>kwargs...</code> : other keyword arguments that will be passed to the selected  GNC TPCF effect (<code>ξ_GNC_Doppler</code>, <code>ξ_GNC_Lensing</code>, ...)</p></li></ul><p>See also: <a href="#GaPSE.integrand_ξ_GNC_multipole"><code>integrand_ξ_GNC_multipole</code></a>, <a href="#GaPSE.ξ_GNC_multipole"><code>ξ_GNC_multipole</code></a>, <a href="#GaPSE.print_map_ξ_GNC_multipole"><code>print_map_ξ_GNC_multipole</code></a>, <a href="../WindowFIntegrated/#GaPSE.WindowFIntegrated"><code>WindowFIntegrated</code></a>, <a href="../Cosmology/#GaPSE.Cosmology"><code>Cosmology</code></a>,  <a href="../CosmoUtils/#GaPSE.y"><code>y</code></a>, <a href="../CosmoUtils/#GaPSE.s2"><code>s2</code></a>, <a href="@ref"><code>GR_EFFECTS_GNC</code></a>, <a href="@ref"><code>GaPSE.VEC_ξs_GNC</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cosmofico97/GaPSE/blob/5f3347ff3b074f172d8e3ff7fa715eea30fd3aad/src/GNC_XiMultipoles.jl#L550-L674">source</a></section></article><h1 id="Two-Point-Cross-Correlation-Function-Sum-multipoles"><a class="docs-heading-anchor" href="#Two-Point-Cross-Correlation-Function-Sum-multipoles">Two-Point Cross-Correlation Function Sum multipoles</a><a id="Two-Point-Cross-Correlation-Function-Sum-multipoles-1"></a><a class="docs-heading-anchor-permalink" href="#Two-Point-Cross-Correlation-Function-Sum-multipoles" title="Permalink"></a></h1><article class="docstring"><header><a class="docstring-binding" id="GaPSE.sum_ξ_GNC_multipole" href="#GaPSE.sum_ξ_GNC_multipole"><code>GaPSE.sum_ξ_GNC_multipole</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs"> sum_ξ_GNC_multipole(s1, s, cosmo::Cosmology;
      s1 = nothing, L::Int = 0, alg::Symbol = :lobatto,
      obs::Union{Bool,Symbol} = :noobsvel,
      N_lob::Int = 100, N_trap::Int = 50,
      atol_quad::Float64 = 0.0, rtol_quad::Float64 = 1e-2,
      enhancer::Float64=1e6, N_log::Int = 1000, 
      pr::Bool = true,
      kwargs...) ::Tuple{Float64, Vector{Float64}}</code></pre><p>Evaluate the multipole of order <code>L</code> of all the Galaxy Number Counts (GNC)  Two-Point Correlation Function (TPCF) multipoles and their sum in the comoving distance <code>s1</code> and a comoving distance <code>s</code> from it  for the input <code>cosmo::Cosmology</code>. We remember that all the distances are measured in <span>$h_0^{-1}\mathrm{Mpc}$</span>.</p><p>This function makes a for-loop on the <code>GaPSE.GR_EFFECTS_GNC</code> strings, calling  <code>ξ_GNC_multipole</code> for each of them. To each string corresponds pretty intuitively one of the  25 GNC effects. They are currently, in order:</p><p><code>auto_newton , auto_doppler , auto_lensing , auto_localgp , auto_integratedgp , newton_doppler , doppler_newton , newton_lensing , lensing_newton , newton_localgp , localgp_newton , newton_integratedgp , integratedgp_newton , lensing_doppler , doppler_lensing , doppler_localgp , localgp_doppler , doppler_integratedgp , integratedgp_doppler , lensing_localgp , localgp_lensing , lensing_integratedgp , integratedgp_lensing , localgp_integratedgp , integratedgp_localgp ,</code></p><p><strong>Inputs</strong></p><ul><li><p><code>s1</code>: the comoving distance where must be evaluated the integral</p></li><li><p><code>s</code>: the comoving distance from <code>s1</code> where must be evaluated the integral</p></li><li><p><code>cosmo::Cosmology</code>: cosmology to be used in this computation</p></li></ul><p><strong>Optional arguments</strong></p><p>This function recall internally <code>ξ_GNC_multipole</code>, so the kwargs are the same; we report them for comfortness:</p><ul><li><p><code>L::Int = 0</code>: order of the Legendre polynomial to be used</p></li><li><p><code>alg::Symbol = :trap</code> : algorithm to be used for the integration; the valid options  are (other values will lead to <code>AssertionError</code>):</p><ul><li><code>:quad</code> -&gt; the integration over <span>$\mu$</span> will be preformed through the Julia function <code>quadgk</code> </li></ul><p>from the <a href="https://github.com/JuliaMath/QuadGK.jl"><code>QuadGK.jl</code></a> Julia package, that uses an adaptive  Gauss-Kronrod quadrature.</p><ul><li><code>:trap</code> -&gt; the integration over <span>$\mu$</span> will be preformed through the Julia function <code>trapz</code> </li></ul><p>from the <a href="https://github.com/francescoalemanno/Trapz.jl"><code>Trapz.jl</code></a> Julia package, that uses the simple trapezoidal rulae.</p><ul><li><code>:lobatto</code> -&gt; the integration over <span>$\mu$</span> will be preformed through the Julia function <code>gausslobatto</code> </li></ul><p>from the <a href="https://github.com/JuliaApproximation/FastGaussQuadrature.jl"><code>FastGaussQuadrature.jl</code></a> Julia package,  that uses the Gauss-Lobatto quadrature.  WE RECOMMEND TO USE <code>:quad</code> FOR MONOPOLES AND <code>:lobatto</code> FOR HIGHER ORDER MULTIPOLES!</p></li><li><p><code>use_windows::Bool = false</code>: tells if the integrand must consider the two  window function <span>$\phi$</span> and <span>$\mathcal{F}$</span></p></li><li><p><code>obs::Union{Bool,Symbol} = :noobsvel</code> : do you want to consider the observer terms in the computation of the  chosen GNC TPCF effect?</p><ul><li><code>:yes</code> or <code>true</code> -&gt; all the observer effects will be considered</li><li><code>:no</code> or <code>false</code> -&gt; no observer term will be taken into account</li><li><code>:noobsvel</code> -&gt; the observer terms related to the observer velocity (that you can find in the CF concerning Doppler) will be neglected, the other ones will be taken into account</li></ul></li><li><p><code>N_lob::Int = 100</code> : number of points to be used in the sampling made by the function <code>trapz</code>. Note that these options will have an effect only if you se <code>alg = :quad</code>.</p></li><li><p><code>N_trap::Int = 200</code> : number of points to be used in the sampling made by the function <code>trapz</code>. Note that these options will have an effect only if you se <code>alg = :quad</code>.</p></li><li><p><code>atol_quad::Float64 = 0.0</code> and <code>rtol_quad::Float64 = 1e-2</code>: absolute and relative tolerance to be passed to the function <code>quadgk</code>; it&#39;s recommended not to set <code>rtol_quad &lt; 1e-2</code>  because the time for evaluation increase quickly. Note that these options will have an effect only if you se <code>alg = :quad</code>.</p></li><li><p><code>enhancer::Float64 = 1e6</code>: just a float number used in order to deal better with small numbers;  the returned value is NOT modified by this value, because after a multiplication the internal result is divided by <code>enhancer</code>.</p></li><li><p><code>kwargs...</code> : other keyword arguments that will be passed to ALL the  GNC TPCF effect (<code>ξ_GNC_Doppler</code>, <code>ξ_GNC_Lensing</code>, ...); if one of them has that keyword argument, it will use the given value, otherwise it will be unaffected.</p></li></ul><p><strong>Returns</strong></p><p>A tuple containing:</p><ul><li>the sum of all the ξ multipoles as first element</li><li>a <code>Vector{Float64}</code> with all the values of each ξ; they are ordered following <code>GR_EFFECTS_GNC</code></li></ul><p>See also: <a href="#GaPSE.integrand_ξ_GNC_multipole"><code>integrand_ξ_GNC_multipole</code></a>, <a href="#GaPSE.ξ_GNC_multipole"><code>ξ_GNC_multipole</code></a>, <a href="#GaPSE.map_sum_ξ_GNC_multipole"><code>map_sum_ξ_GNC_multipole</code></a>, <a href="#GaPSE.print_map_sum_ξ_GNC_multipole"><code>print_map_sum_ξ_GNC_multipole</code></a>, <a href="../Cosmology/#GaPSE.Cosmology"><code>Cosmology</code></a>, <a href="@ref"><code>GR_EFFECTS_GNC</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cosmofico97/GaPSE/blob/5f3347ff3b074f172d8e3ff7fa715eea30fd3aad/src/GNC_SumXiMultipoles.jl#L22-L112">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="GaPSE.map_sum_ξ_GNC_multipole" href="#GaPSE.map_sum_ξ_GNC_multipole"><code>GaPSE.map_sum_ξ_GNC_multipole</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs"> map_sum_ξ_GNC_multipole(
      effect::Union{String,Function}, ss = nothing;
      s1 = nothing, L::Int = 0, alg::Symbol = :lobatto,
      obs::Union{Bool,Symbol} = :noobsvel,
      N_lob::Int = 100, N_trap::Int = 50,
      atol_quad::Float64 = 0.0, rtol_quad::Float64 = 1e-2,
      enhancer::Float64=1e6, N_log::Int = 1000, 
      pr::Bool = true,
      kwargs...) ::Tuple{Vector{Float64}, Vector{Float64}, Vector{Vector{Float64}}}</code></pre><p>Evaluate the multipole of order <code>L</code> of all the Galaxy Number Counts (GNC)  Two-Point Correlation Function (TPCF) multipoles and their sum in the comoving distance <code>s1</code>,  for all the comoving distances stored inside <code>ss</code> (representing  the comoving distance from <code>s1</code>) for the input <code>cosmo::Cosmology</code>. If <code>ss = nothing</code>, it is set <code>ss = 10 .^ range(0, log10(2 * cosmo.s_max), length=N_log)</code>. If <code>s1 = nothing</code>, it is set <code>s1 = cosmo.s_eff</code>. We remember that all the distances are measured in <span>$h_0^{-1}\mathrm{Mpc}$</span>.</p><p>This function makes a for-loop on the <code>GaPSE.GR_EFFECTS_GNC</code> strings, calling  <code>map_ξ_GNC_multipole</code> for each of them. To each string corresponds pretty intuitively one of the  25 GNC effects. They are currently, in order:</p><p><code>auto_newton , auto_doppler , auto_lensing , auto_localgp , auto_integratedgp , newton_doppler , doppler_newton , newton_lensing , lensing_newton , newton_localgp , localgp_newton , newton_integratedgp , integratedgp_newton , lensing_doppler , doppler_lensing , doppler_localgp , localgp_doppler , doppler_integratedgp , integratedgp_doppler , lensing_localgp , localgp_lensing , lensing_integratedgp , integratedgp_lensing , localgp_integratedgp , integratedgp_localgp ,</code></p><p><strong>Inputs</strong></p><ul><li><p><code>cosmo::Cosmology</code> : cosmology to be used in this computation</p></li><li><p><code>ss</code> : vector/range of <code>s</code> values where the function must be evaluated; if <code>ss = nothing</code>,  it is set <code>ss = 10 .^ range(0, log10(2 * cosmo.s_max), length=N_log)</code>. This is why it is returned  also the vector of the &quot;input&quot; values.</p></li></ul><p><strong>Optional arguments</strong></p><p>This function recall internally <code>map_ξ_GNC_multipole</code>, so the kwargs are the same; we report them for comfortness:</p><ul><li><p><code>s1 = nothing</code> : comoving distance from the observer where the TPCF should be evaluated; if <code>s1 = nothing</code>, it is automatically set <code>s1 = cosmo.s_eff</code> from the given input <code>cosmo::Cosmology</code>.</p></li><li><p><code>L::Int = 0</code>: order of the Legendre polynomial to be used</p></li><li><p><code>alg::Symbol = :trap</code> : algorithm to be used for the integration; the valid options  are (other values will lead to <code>AssertionError</code>):</p><ul><li><code>:quad</code> -&gt; the integration over <span>$\mu$</span> will be preformed through the Julia function <code>quadgk</code> </li></ul><p>from the <a href="https://github.com/JuliaMath/QuadGK.jl"><code>QuadGK.jl</code></a> Julia package, that uses an adaptive  Gauss-Kronrod quadrature.</p><ul><li><code>:trap</code> -&gt; the integration over <span>$\mu$</span> will be preformed through the Julia function <code>trapz</code> </li></ul><p>from the <a href="https://github.com/francescoalemanno/Trapz.jl"><code>Trapz.jl</code></a> Julia package, that uses the simple trapezoidal rulae.</p><ul><li><code>:lobatto</code> -&gt; the integration over <span>$\mu$</span> will be preformed through the Julia function <code>gausslobatto</code> </li></ul><p>from the <a href="https://github.com/JuliaApproximation/FastGaussQuadrature.jl"><code>FastGaussQuadrature.jl</code></a> Julia package,  that uses the Gauss-Lobatto quadrature.  WE RECOMMEND TO USE <code>:quad</code> FOR MONOPOLES AND <code>:lobatto</code> FOR HIGHER ORDER MULTIPOLES!</p></li><li><p><code>use_windows::Bool = false</code>: tells if the integrand must consider the two  window function <span>$\phi$</span> and <span>$\mathcal{F}$</span></p></li><li><p><code>obs::Union{Bool,Symbol} = :noobsvel</code> : do you want to consider the observer terms in the computation of the  chosen GNC TPCF effect?</p><ul><li><code>:yes</code> or <code>true</code> -&gt; all the observer effects will be considered</li><li><code>:no</code> or <code>false</code> -&gt; no observer term will be taken into account</li><li><code>:noobsvel</code> -&gt; the observer terms related to the observer velocity (that you can find in the CF concerning Doppler) will be neglected, the other ones will be taken into account</li></ul></li><li><p><code>N_lob::Int = 100</code> : number of points to be used in the sampling made by the function <code>trapz</code>. Note that these options will have an effect only if you se <code>alg = :quad</code>.</p></li><li><p><code>N_trap::Int = 200</code> : number of points to be used in the sampling made by the function <code>trapz</code>. Note that these options will have an effect only if you se <code>alg = :quad</code>.</p></li><li><p><code>atol_quad::Float64 = 0.0</code> and <code>rtol_quad::Float64 = 1e-2</code>: absolute and relative tolerance to be passed to the function <code>quadgk</code>; it&#39;s recommended not to set <code>rtol_quad &lt; 1e-2</code>  because the time for evaluation increase quickly. Note that these options will have an effect only if you se <code>alg = :quad</code>.</p></li><li><p><code>enhancer::Float64 = 1e6</code>: just a float number used in order to deal better with small numbers;  the returned value is NOT modified by this value, because after a multiplication the internal result is divided by <code>enhancer</code>.</p></li><li><p><code>N_log::Int = 1000</code> : number of points to be used in the default logaritmically-spaced  range for <code>ss</code>, i.e. <code>range(0, log10(2 * cosmo.s_max), length=N_log)</code>; it is ignored if <code>ss ≠ nothing</code> </p></li><li><p><code>pr::Bool = true</code> : do you want the progress bar showed on screen, in order to  check the time needed for the computation? (<code>true</code> recommended)</p></li><li><p><code>kwargs...</code> : other keyword arguments that will be passed to ALL the  GNC TPCF effect (<code>ξ_GNC_Doppler</code>, <code>ξ_GNC_Lensing</code>, ...); if one of them has that keyword argument, it will use the given value, otherwise it will be unaffected.</p></li></ul><p><strong>Returns</strong></p><p>A tuple containing:</p><ul><li>as first element, the vector <code>ss</code> itself;</li><li>as second one, the  <code>Vector{Float64}</code> of the sum of all the ξ multipoles;</li><li>as third one, a <code>Vector{Vector{Float64}}</code> with all the values of each ξ; they are ordered following <code>GR_EFFECTS_GNC</code></li></ul><p>See also: <a href="#GaPSE.map_ξ_GNC_multipole"><code>map_ξ_GNC_multipole</code></a>, <a href="#GaPSE.sum_ξ_GNC_multipole"><code>sum_ξ_GNC_multipole</code></a>, <a href="#GaPSE.print_map_sum_ξ_GNC_multipole"><code>print_map_sum_ξ_GNC_multipole</code></a>, <a href="../Cosmology/#GaPSE.Cosmology"><code>Cosmology</code></a>, <a href="@ref"><code>GR_EFFECTS_GNC</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cosmofico97/GaPSE/blob/5f3347ff3b074f172d8e3ff7fa715eea30fd3aad/src/GNC_SumXiMultipoles.jl#L126-L229">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="GaPSE.print_map_sum_ξ_GNC_multipole" href="#GaPSE.print_map_sum_ξ_GNC_multipole"><code>GaPSE.print_map_sum_ξ_GNC_multipole</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs"> print_map_sum_ξ_GNC_multipole(
      cosmo::Cosmology, out::String, ss = nothing;
      s1 = nothing, L::Int = 0, alg::Symbol = :lobatto,
      obs::Union{Bool,Symbol} = :noobsvel,
      N_lob::Int = 100, N_trap::Int = 50,
      atol_quad::Float64 = 0.0, rtol_quad::Float64 = 1e-2,
      enhancer::Float64=1e6, N_log::Int = 1000, 
      pr::Bool = true,
      single::Bool = true,
      kwargs...)</code></pre><p>Evaluate the multipole of order <code>L</code> of all the Galaxy Number Counts (GNC)  Two-Point Correlation Function (TPCF) multipoles and their sum in the comoving distance <code>s1</code>,  for all the comoving distances stored inside <code>ss</code> (representing  the comoving distance from <code>s1</code>) for the input <code>cosmo::Cosmology</code>; finally, it saves the results inside the file <code>out</code>. If <code>ss = nothing</code>, it is set <code>ss = 10 .^ range(0, log10(2 * cosmo.s_max), length=N_log)</code>. If <code>s1 = nothing</code>, it is set <code>s1 = cosmo.s_eff</code>. We remember that all the distances are measured in <span>$h_0^{-1}\mathrm{Mpc}$</span>.</p><p>This function makes a for-loop on the <code>GaPSE.GR_EFFECTS_GNC</code> strings, calling  <code>map_ξ_GNC_multipole</code> for each of them. To each string corresponds pretty intuitively one of the  25 GNC effects. They are currently, in order:</p><p><code>auto_newton , auto_doppler , auto_lensing , auto_localgp , auto_integratedgp , newton_doppler , doppler_newton , newton_lensing , lensing_newton , newton_localgp , localgp_newton , newton_integratedgp , integratedgp_newton , lensing_doppler , doppler_lensing , doppler_localgp , localgp_doppler , doppler_integratedgp , integratedgp_doppler , lensing_localgp , localgp_lensing , lensing_integratedgp , integratedgp_lensing , localgp_integratedgp , integratedgp_localgp ,</code></p><p><strong>Inputs</strong></p><ul><li><p><code>cosmo::Cosmology</code> : cosmology to be used in this computation</p></li><li><p><code>out::String</code> : name of the file where the results must be stored.</p></li><li><p><code>ss</code> : vector/range of <code>s</code> values where the function must be evaluated; if <code>ss = nothing</code>,  it is set <code>ss = 10 .^ range(0, log10(2 * cosmo.s_max), length=N_log)</code>.</p></li></ul><p><strong>Optional arguments</strong></p><p>This function recall internally <code>map_ξ_GNC_multipole</code>, so the kwargs are the same; we report them for comfortness:</p><ul><li><p><code>s1 = nothing</code> : comoving distance from the observer where the TPCF should be evaluated; if <code>s1 = nothing</code>, it is automatically set <code>s1 = cosmo.s_eff</code> from the given input <code>cosmo::Cosmology</code>.</p></li><li><p><code>L::Int = 0</code>: order of the Legendre polynomial to be used</p></li><li><p><code>alg::Symbol = :trap</code> : algorithm to be used for the integration; the valid options  are (other values will lead to <code>AssertionError</code>):</p><ul><li><code>:quad</code> -&gt; the integration over <span>$\mu$</span> will be preformed through the Julia function <code>quadgk</code> </li></ul><p>from the <a href="https://github.com/JuliaMath/QuadGK.jl"><code>QuadGK.jl</code></a> Julia package, that uses an adaptive  Gauss-Kronrod quadrature.</p><ul><li><code>:trap</code> -&gt; the integration over <span>$\mu$</span> will be preformed through the Julia function <code>trapz</code> </li></ul><p>from the <a href="https://github.com/francescoalemanno/Trapz.jl"><code>Trapz.jl</code></a> Julia package, that uses the simple trapezoidal rulae.</p><ul><li><code>:lobatto</code> -&gt; the integration over <span>$\mu$</span> will be preformed through the Julia function <code>gausslobatto</code> </li></ul><p>from the <a href="https://github.com/JuliaApproximation/FastGaussQuadrature.jl"><code>FastGaussQuadrature.jl</code></a> Julia package,  that uses the Gauss-Lobatto quadrature.  WE RECOMMEND TO USE <code>:quad</code> FOR MONOPOLES AND <code>:lobatto</code> FOR HIGHER ORDER MULTIPOLES!</p></li><li><p><code>use_windows::Bool = false</code>: tells if the integrand must consider the two  window function <span>$\phi$</span> and <span>$\mathcal{F}$</span></p></li><li><p><code>obs::Union{Bool,Symbol} = :noobsvel</code> : do you want to consider the observer terms in the computation of the  chosen GNC TPCF effect?</p><ul><li><code>:yes</code> or <code>true</code> -&gt; all the observer effects will be considered</li><li><code>:no</code> or <code>false</code> -&gt; no observer term will be taken into account</li><li><code>:noobsvel</code> -&gt; the observer terms related to the observer velocity (that you can find in the CF concerning Doppler) will be neglected, the other ones will be taken into account</li></ul></li><li><p><code>N_lob::Int = 100</code> : number of points to be used in the sampling made by the function <code>trapz</code>. Note that these options will have an effect only if you se <code>alg = :quad</code>.</p></li><li><p><code>N_trap::Int = 200</code> : number of points to be used in the sampling made by the function <code>trapz</code>. Note that these options will have an effect only if you se <code>alg = :quad</code>.</p></li><li><p><code>atol_quad::Float64 = 0.0</code> and <code>rtol_quad::Float64 = 1e-2</code>: absolute and relative tolerance to be passed to the function <code>quadgk</code>; it&#39;s recommended not to set <code>rtol_quad &lt; 1e-2</code>  because the time for evaluation increase quickly. Note that these options will have an effect only if you se <code>alg = :quad</code>.</p></li><li><p><code>enhancer::Float64 = 1e6</code>: just a float number used in order to deal better with small numbers;  the returned value is NOT modified by this value, because after a multiplication the internal result is divided by <code>enhancer</code>.</p></li><li><p><code>N_log::Int = 1000</code> : number of points to be used in the default logaritmically-spaced  range for <code>ss</code>, i.e. <code>range(0, log10(2 * cosmo.s_max), length=N_log)</code>; it is ignored if <code>ss ≠ nothing</code> </p></li><li><p><code>pr::Bool = true</code> : do you want the progress bar showed on screen, in order to  check the time needed for the computation? (<code>true</code> recommended)</p></li><li><p><code>single::Bool = true</code> : if <code>true</code>, all the CFs are printed inside the file of the sum, in a  table with 18 columns (first one for <code>ss</code>, second for their sum an the next 16 for each effect). Otherwise, a new directory &quot;all<em>standalones</em>CFs&quot; is created (in the same path given in <code>out</code>) and  they are separately saved in files there placed.</p></li><li><p><code>kwargs...</code> : other keyword arguments that will be passed to ALL the  GNC TPCF effect (<code>ξ_GNC_Doppler</code>, <code>ξ_GNC_Lensing</code>, ...); if one of them has that keyword argument, it will use the given value, otherwise it will be unaffected.</p></li></ul><p>See also: <a href="#GaPSE.map_ξ_GNC_multipole"><code>map_ξ_GNC_multipole</code></a>, <a href="#GaPSE.sum_ξ_GNC_multipole"><code>sum_ξ_GNC_multipole</code></a>, <a href="#GaPSE.map_sum_ξ_GNC_multipole"><code>map_sum_ξ_GNC_multipole</code></a>, <a href="../Cosmology/#GaPSE.Cosmology"><code>Cosmology</code></a>, <a href="@ref"><code>GR_EFFECTS_GNC</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cosmofico97/GaPSE/blob/5f3347ff3b074f172d8e3ff7fa715eea30fd3aad/src/GNC_SumXiMultipoles.jl#L256-L359">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../WindowFIntegrated/">« Integrated Window F</a><a class="docs-footer-nextpage" href="../LD_Correlations/">LD »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.23 on <span class="colophon-date" title="Monday 16 January 2023 12:48">Monday 16 January 2023</span>. Using Julia version 1.8.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
