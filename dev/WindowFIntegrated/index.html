<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Integrated Window F · GaPSE.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">GaPSE.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Introduction</a></li><li><span class="tocitem">The basic structure</span><ul><li><a class="tocitem" href="../BackgroundData/">Background Data</a></li><li><a class="tocitem" href="../CosmoParams/">Cosmology Parameters</a></li><li><a class="tocitem" href="../Cosmology/">Cosmology Struct</a></li></ul></li><li><span class="tocitem">The window function F and its integration</span><ul><li><a class="tocitem" href="../WindowF/">Window F</a></li><li class="is-active"><a class="tocitem" href>Integrated Window F</a></li></ul></li><li><span class="tocitem">Calculating TPCFs multipoles</span><ul><li><a class="tocitem" href="../GNC_Correlations/">GNC</a></li><li><a class="tocitem" href="../LD_Correlations/">LD</a></li><li><a class="tocitem" href="../GNCxLD_Correlations/">GNCxLD</a></li><li><a class="tocitem" href="../GNCxLD_Correlations/">LDxGNC</a></li></ul></li><li><a class="tocitem" href="../PlaneParallelApprox/">Calculating TPCFs with the PP Approximation</a></li><li><a class="tocitem" href="../PowerSpectrum/">Calculating Power Spectra</a></li><li><a class="tocitem" href="../PNG/">implication on PNG</a></li><li><span class="tocitem">Utilities</span><ul><li><a class="tocitem" href="../Dicts/">Dictionaries and names</a></li><li><a class="tocitem" href="../MathUtils/">Mathematical Utilities</a></li><li><a class="tocitem" href="../CosmoUtils/">Cosmology Utilities</a></li><li><a class="tocitem" href="../IPSTools/">Input Power Spectrum Tools</a></li><li><a class="tocitem" href="../OtherUtils/">Other Utilities</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">The window function F and its integration</a></li><li class="is-active"><a href>Integrated Window F</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Integrated Window F</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/cosmofico97/GaPSE/blob/main/docs/src/WindowFIntegrated.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="The-F-window-function"><a class="docs-heading-anchor" href="#The-F-window-function">The F window function</a><a id="The-F-window-function-1"></a><a class="docs-heading-anchor-permalink" href="#The-F-window-function" title="Permalink"></a></h1><article class="docstring"><header><a class="docstring-binding" id="GaPSE.integrated_F_quadgk" href="#GaPSE.integrated_F_quadgk"><code>GaPSE.integrated_F_quadgk</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs"> integrated_F_quadgk(s, μ, s_min, s_max, windowF::WindowF;
      llim=0.0, rlim=Inf, rtol=1e-2, atol=0.0)</code></pre><p>Computes the Integrated Window Function fron the input Window Function <code>windowF</code>,  through the <code>quadgk</code> function of the <a href="https://github.com/JuliaMath/QuadGK.jl">QuadGK</a> Julia pagkage, in the point <code>(s,μ)</code> (where s is the comoving distance and μ the angle cosine). <code>s_min</code> and <code>s_max</code> are the min and max value for the radial part of the survey window function.</p><p>The analytical expression of the Integrated window function is the following:</p><p class="math-container">\[\mathcal{F}(s, \mu) = 
    \int_0^\infty \mathrm{d}s_1 \, \phi(s_1) \,
    \phi\left(\sqrt{s_1^2 + s^2 + 2 \, s_1 \, s \, \mu}\right) 
    \, F\left(\frac{s}{s_1}, \mu \right)\]</p><p>where <span>$s$</span> is the comoving distance, <span>$\mu$</span> the cosine angle, <span>$\phi$</span> is the angular part of the survey window function and <span>$F(x, μ)$</span> is the  window function. Check the documentation of <code>WindowF</code> for its definition. We remember that all the distances are measured in <span>$h_0^{-1}\mathrm{Mpc}$</span>.</p><p><strong>Optional arguments</strong></p><ul><li><code>llim=nothing</code> and <code>rlim=nothing</code> : integration limits for <code>quadgk</code>; if <code>llim=nothing</code> it will be set to <code>0.95 * s_min</code>; if <code>rlim=nothing</code>, it will be set to <code>1.05*s_max</code>, while if <code>rlim=Inf</code> it will be set to <code>3 * s_max</code></li><li><code>rtol=1e-2</code> and <code>atol=0.0</code> : relative and absoute tolerance for <code>quadgk</code></li></ul><p>See also: [<code>WindowF</code>], <a href="../CosmoUtils/#GaPSE.ϕ"><code>ϕ</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cosmofico97/GaPSE/blob/5f3347ff3b074f172d8e3ff7fa715eea30fd3aad/src/WindowFIntegrated.jl#L21-L52">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="GaPSE.integrated_F_trapz" href="#GaPSE.integrated_F_trapz"><code>GaPSE.integrated_F_trapz</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs"> integrated_F_trapz(s, μ, s_min, s_max, windowF::WindowF;
      llim=nothing, rlim=nothing, N::Int=1000)</code></pre><p>Computes the Integrated Window Function fron the input Window Function <code>windowF</code>,  through the <code>trapz</code> function of the <a href="https://juliapackages.com/p/trapz">Trapz</a> Julia pagkage, in the point <code>(s,μ)</code> (where s is the comoving distance and μ the angle cosine). <code>s_min</code> and <code>s_max</code> are the min and max value for the radial part of the survey window function.</p><p>The analytical expression of the Integrated window function is the following:</p><p class="math-container">\[\mathcal{F}(s, \mu) = 
    \int_0^\infty \mathrm{d}s_1 \, \phi(s_1) \,
    \phi\left(\sqrt{s_1^2 + s^2 + 2 \, s_1 \, s \, \mu}\right) 
    \, F\left(\frac{s}{s_1}, \mu \right)\]</p><p>where <span>$s$</span> is the comoving distance, <span>$\mu$</span> the cosine angle, <span>$\phi$</span> is the angular part of the survey window function and <span>$F(x, μ)$</span> is the  window function. Check the documentation of <code>WindowF</code> for its definition. We remember that all the distances are measured in <span>$h_0^{-1}\mathrm{Mpc}$</span>.</p><p><strong>Optional arguments</strong></p><ul><li><code>llim=nothing</code> and <code>rlim=nothing</code> : limits of the sampling interval to be used for <code>trapz</code>; if <code>llim=nothing</code> it will be set to <code>0.95 * s_min</code>; if <code>rlim=nothing</code>, it will be set to <code>1.05*s_max</code>, while if <code>rlim=Inf</code> it will be set to <code>3 * s_max</code></li><li><code>N::Int = 1000</code> : number of points to be used for the sampling</li></ul><p>See also: [<code>WindowF</code>], <a href="../CosmoUtils/#GaPSE.ϕ"><code>ϕ</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cosmofico97/GaPSE/blob/5f3347ff3b074f172d8e3ff7fa715eea30fd3aad/src/WindowFIntegrated.jl#L83-L114">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="GaPSE.print_map_IntegratedF" href="#GaPSE.print_map_IntegratedF"><code>GaPSE.print_map_IntegratedF</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs"> print_map_IntegratedF(
      s_min, s_max, 
      ss::Vector{Float64}, μs::Vector{Float64}, 
      windowF::Union{String,WindowF}, out::String;
      alg::Symbol=:trap, llim=nothing, rlim=nothing,
      rtol=1e-2, atol=0.0, N::Int=1000, pr::Bool=true)

 print_map_IntegratedF(
      z_min, z_max, 
      zs::Vector{Float64}, μs::Vector{Float64}, 
      windowF::Union{String,WindowF}, out::String,
      file_data::String; 
      names_bg = NAMES_BACKGROUND, h_0 = 0.7, kwargs...)

 print_map_IntegratedF(
      z_min, z_max,
      μs::Vector{Float64}, 
      windowF::Union{String,WindowF}, out::String,
      file_data::String;
      names_bg = NAMES_BACKGROUND, h_0 = 0.7, N_ss::Int = 100, 
      m::Float64 = 2.1, kwargs...)</code></pre><p>Evaluate the integrated window function <span>$\mathcal{F}(s,\mu)$</span> in a rectangual grid  of <span>$\mu$</span> and <span>$s$</span> values, and print the results in the <code>out</code> file.</p><p>The first method takes as input:</p><ul><li><p><code>s_min</code> and <code>s_max</code> : min and max comoving distance of the survey; their values will be internally used by the radial function <code>ϕ</code></p></li><li><p><code>ss::Vector{Float64}</code> and <code>μs::Vector{Float64}</code> :  the vector of s and μ points where to   sample the integrated window function <span>$\mathcal{F}$</span>. They must be a float vector of  increasing values; more precisely:</p><ul><li><code>ss</code> must be a float vector of increasing comoving distance values (so each element must be ≥ 0); the first and last values ARE NOT RELATED to <code>s_min</code> and <code>s_max</code>.</li><li><code>μs</code> must be a float vector of increasing cosine values (so each element x must be -1 ≤ x ≤ 1).</li></ul></li><li><p><code>windowF::Union{String,WindowF}</code>, i.e. the window function itself; it can be passed as the namefile where the window is stored in (that will be opened with <code>WindowF</code>) or as a <code>WindowF</code> struct directly.</p></li><li><p><code>out::String</code> : the name of the output file</p></li></ul><p>The second method takes as input the min and max redshifts of the survey (<code>z_min</code>and <code>z_max</code>), the vector of redshifts <code>zs::Vector{Float64}</code> for the integrated window function sampling, <code>μs</code> and <code>windowF</code>  as before and the <code>file_data</code> where can be found the association <span>$z \rightarrow s(z)$</span>.  Such file must have the structure of the  background data produced by the <a href="https://github.com/lesgourg/class_public"><code>CLASS</code></a> code. Note that also <code>zs</code> musyt be a float vector of increasing redshift values (so each element must be ≥ 0). This method internally recalls the first one, so the other <code>kwargs...</code> are in common.</p><p>The third method takes as input the min and max redshifts of the survey (<code>z_min</code>and <code>z_max</code>) and the same  input as the second method (<code>μs</code>, <code>widnowF</code>, <code>out</code> and <code>file_data</code>) but NOT THE REDSHIFT SAMPLING VECTOR <code>zs</code>. The sampling will be internally made linearly from <span>$s = 0$</span> to <span>$s = m \, s_{\mathrm{max}}$</span>,  where <code>s_max</code> is the comoving distance associated to <code>z_max</code> (for the data stored in <code>file_data</code>)  and <code>m::Float64 = 2.1</code> a coefficient that we suggest to set equals to <code>2 &lt; m &lt; 3</code>. <code>N_ss::Int = 100</code> is the number of <code>s</code> values used for the sampling in the interval  <span>$[0, m \, s_{\mathrm{max}}]$</span>. This method internally recalls the first one, so the other <code>kwargs...</code> are in common.</p><p>The analytical expression for the integrated window function is the following:</p><p class="math-container">\[\mathcal{F}(s, \mu) = 
    \int_0^\infty \mathrm{d}s_1 \, \phi(s_1) \,  
    \phi\left(\sqrt{s_1^2 + s^2 + 2 \, s_1 \, s \, \mu}\right) 
    \, F\left(\frac{s}{s_1}, \mu \right)\]</p><p>where <span>$s$</span> is the comoving distance, <span>$\mu$</span> the cosine angle, <span>$\phi$</span> is the angular part of the survey window function and <span>$F(x, μ)$</span> is the  window function. Check the documentation of <code>WindowF</code> for its definition. We remember that all the distances are measured in <span>$h_0^{-1}\mathrm{Mpc}$</span>.</p><p><strong>Optional arguments</strong></p><p>As optional arguments of the first method:</p><ul><li><code>alg::Symbol = :trap</code> : algorithm to be used for the integration; the valid options are <code>:quad</code> (that will recall <code>integrated_F_quadgk</code>) and <code>:trap</code> (that will recall <code>integrated_F_trapz</code>); other values will lead to <code>AssertionError</code></li><li><code>llim=nothing</code> and <code>rlim=nothing</code> : integration limits for quad/trap;  if <code>llim=nothing</code> it will be set to <code>0.95 * s_min</code>; if <code>rlim=nothing</code>, it will be set to <code>1.05*s_max</code>, while if <code>rlim=Inf</code> it will be set to <code>3 * s_max</code>.</li><li><code>N::Int = 1000</code> : number of points to be used for the sampling of <code>trapz</code>; it&#39;s useless if you set <code>alg = :quad</code>;</li><li><code>rtol=1e-2</code> and <code>atol=0.0</code> : relative and absoute tolerance for <code>quadgk</code>; they are useless if you set <code>alg = :trap</code>;</li><li><code>pr::Bool = true</code> : do you want to see the progress-bar of the computation?</li></ul><p>The optional arguments given to the second method will be directly given to the first one. The only two exceptions are options relative to the background data, managed internally by the struct <code>BackgroundData</code>:</p><ul><li><p><code>names = NAMES_BACKGROUND</code> : the column names of the <code>file_data</code>. If the colum order change from the default one <code>NAMES_BACKGROUND</code>, you must set as input the vector of string with the correct one, with the SAME names. They are, with the default order:</p><p>[&quot;z&quot;, &quot;proper time [Gyr]&quot;, &quot;conf. time [Mpc]&quot;, &quot;H [1/Mpc]&quot;, &quot;comov. dist.&quot;, &quot;ang.diam.dist.&quot;, &quot;lum. dist.&quot;, &quot;comov.snd.hrz.&quot;, &quot;(.)rho<em>g&quot;, &quot;(.)rho</em>b&quot;, &quot;(.)rho<em>cdm&quot;, &quot;(.)rho</em>lambda&quot;, &quot;(.)rho<em>ur&quot;, &quot;(.)rho</em>crit&quot;, &quot;gr.fac. D&quot;, &quot;gr.fac. f&quot;]</p></li><li><p><code>h = 0.7</code> : the adimensional hubble constant. By default, CLASS background data are measured with it numerically expressed (so distances are measured in <code>Mpc</code>, for example), while this code works with <code>h</code> in the unit of measure (so distances are measured in <code>Mpc/h</code>, for example). Change this value to <code>1.0</code> if the input data do not have this issue, or to your value of interest  (<code>0.67</code>, <code>0.5</code>, ...).</p></li></ul><p>See also: <a href="#GaPSE.integrated_F_quadgk"><code>integrated_F_quadgk</code></a>, <a href="#GaPSE.integrated_F_trapz"><code>integrated_F_trapz</code></a>, <a href="../CosmoUtils/#GaPSE.ϕ"><code>ϕ</code></a>, <a href="../WindowF/#GaPSE.WindowF"><code>WindowF</code></a>, <a href="#GaPSE.WindowFIntegrated"><code>WindowFIntegrated</code></a>, <a href="../BackgroundData/#GaPSE.BackgroundData"><code>BackgroundData</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cosmofico97/GaPSE/blob/5f3347ff3b074f172d8e3ff7fa715eea30fd3aad/src/WindowFIntegrated.jl#L286-L393">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="GaPSE.WindowFIntegrated" href="#GaPSE.WindowFIntegrated"><code>GaPSE.WindowFIntegrated</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs"> WindowFIntegrated(
      ss::Vector{Float64}
      μs::Vector{Float64}
      IFs::Matrix{Float64}
      )</code></pre><p>Struct containing ss, μs and IFs values of the integrated window function <span>$\mathcal{F}(s, μ)$</span>. <code>ss</code> and <code>μs</code> are 1D vectors containing each value only once, while  <code>IFs</code> values are contained in a matrix of size <code>(length(ss), length(μs))</code>, so:</p><ul><li>along a fixed column the changing value is <code>s</code></li><li>along a fixed row the changing value is <code>μ</code></li></ul><p>The analytical expression for the integrated window function is the following:</p><p class="math-container">\[\mathcal{F}(s, \mu) = 
    \int_0^\infty \mathrm{d}s_1 \, \phi(s_1) \,  
    \phi\left(\sqrt{s_1^2 + s^2 + 2 \, s_1 \, s \, \mu}\right) 
    \, F\left(\frac{s}{s_1}, \mu \right)\]</p><p>where <span>$s$</span> is the comoving distance, <span>$\mu$</span> the cosine angle, <span>$\phi$</span> is the angular part of the survey window function and <span>$F(x, μ)$</span> is the  window function. Check the documentation of <code>WindowF</code> for its definition. We remember that all the distances are measured in <span>$h_0^{-1}\mathrm{Mpc}$</span>.</p><p><strong>Constructors</strong></p><pre><code class="nohighlight hljs"> WindowFIntegrated(file::String)</code></pre><p>Read the IF map from the file <code>file</code>. Such a file might be produced by <code>print_map_IntegratedF</code>, check its docstring. </p><p>It does not matter if the pattern is</p><pre><code class="language-data hljs"># ss      μs      IFs
0.0       -1.0       ...
0.0       -0.9       ...
0.0       -0.8       ...
...       ...      ...</code></pre><p>or </p><pre><code class="language-data hljs"># ss      μs      IFs
0.0       -1.0       ...
0.1       -1.0       ...
0.2       -1.0       ...
...       ...      ...</code></pre><p>because the constructor will recognise it. What does matter is the columns order: <code>ss</code> first, then <code>μs</code> and finally <code>IFs</code>.</p><p>See also: <a href="#GaPSE.integrated_F_trapz"><code>integrated_F_trapz</code></a>, <a href="#GaPSE.integrated_F_quadgk"><code>integrated_F_quadgk</code></a>, <a href="@ref"><code>spline_integrF</code></a>, <a href="../WindowF/#GaPSE.WindowF"><code>WindowF</code></a>, <a href="../CosmoUtils/#GaPSE.ϕ"><code>ϕ</code></a>, <a href="#GaPSE.print_map_IntegratedF"><code>print_map_IntegratedF</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cosmofico97/GaPSE/blob/5f3347ff3b074f172d8e3ff7fa715eea30fd3aad/src/WindowFIntegrated.jl#L415-L477">source</a></section></article><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>GaPSE.spline_IntegratedF</code>. Check Documenter&#39;s build log for details.</p></div></div></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../WindowF/">« Window F</a><a class="docs-footer-nextpage" href="../GNC_Correlations/">GNC »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.23 on <span class="colophon-date" title="Monday 16 January 2023 12:48">Monday 16 January 2023</span>. Using Julia version 1.8.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
