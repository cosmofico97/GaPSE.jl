<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>LD TPCFs · GaPSE.jl</title><meta name="title" content="LD TPCFs · GaPSE.jl"/><meta property="og:title" content="LD TPCFs · GaPSE.jl"/><meta property="twitter:title" content="LD TPCFs · GaPSE.jl"/><meta name="description" content="Documentation for GaPSE.jl."/><meta property="og:description" content="Documentation for GaPSE.jl."/><meta property="twitter:description" content="Documentation for GaPSE.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">GaPSE.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Introduction</a></li><li><span class="tocitem">The basic structure</span><ul><li><a class="tocitem" href="../BackgroundData/">Background Data</a></li><li><a class="tocitem" href="../CosmoParams/">Cosmology Parameters</a></li><li><a class="tocitem" href="../Cosmology/">Cosmology Struct</a></li></ul></li><li><span class="tocitem">The window function F and its integration</span><ul><li><a class="tocitem" href="../WindowF/">Window F</a></li><li><a class="tocitem" href="../WindowFIntegrated/">Integrated Window F</a></li></ul></li><li><span class="tocitem">Calculating TPCFs multipoles</span><ul><li><input class="collapse-toggle" id="menuitem-4-1" type="checkbox"/><label class="tocitem" for="menuitem-4-1"><span class="docs-label">GNC</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../GNC_Correlations_1/">GNC TPCFs</a></li><li><a class="tocitem" href="../GNC_Correlations_2/">GNC TPCFs</a></li><li><a class="tocitem" href="../GNC_Correlations_3/">GNC TPCFs</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-2" type="checkbox" checked/><label class="tocitem" for="menuitem-4-2"><span class="docs-label">LD</span><i class="docs-chevron"></i></label><ul class="collapsed"><li class="is-active"><a class="tocitem" href>LD TPCFs</a><ul class="internal"><li><a class="tocitem" href="#Two-Point-Auto-Correlation-Functions"><span>Two-Point Auto-Correlation Functions</span></a></li><li><a class="tocitem" href="#Two-Point-Cross-Correlation-Functions"><span>Two-Point Cross-Correlation Functions</span></a></li></ul></li><li><a class="tocitem" href="../LD_Correlations_2/">LD TPCFs</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-3" type="checkbox"/><label class="tocitem" for="menuitem-4-3"><span class="docs-label">GNCxLD</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../GNCxLD_Correlations_1/">GNCxLD TPCFs</a></li><li><a class="tocitem" href="../GNCxLD_Correlations_2/">GNCxLD TPCFs</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-4" type="checkbox"/><label class="tocitem" for="menuitem-4-4"><span class="docs-label">LDxGNC</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../LDxGNC_Correlations_1/">LDxGNC TPCFs</a></li><li><a class="tocitem" href="../LDxGNC_Correlations_2/">LDxGNC TPCFs</a></li></ul></li></ul></li><li><a class="tocitem" href="../PlaneParallelApprox/">Calculating TPCFs with the PP Approximation</a></li><li><a class="tocitem" href="../PowerSpectra/">Calculating Power Spectra</a></li><li><a class="tocitem" href="../PowerSpectraGenWin/">Power Spectra for a generic window</a></li><li><a class="tocitem" href="../PNG/">implication on PNG</a></li><li><span class="tocitem">Utilities</span><ul><li><a class="tocitem" href="../Dicts/">Dictionaries and names</a></li><li><a class="tocitem" href="../MathUtils/">Mathematical Utilities</a></li><li><a class="tocitem" href="../CosmoUtils/">Cosmology Utilities</a></li><li><a class="tocitem" href="../IPSTools/">Input Power Spectrum Tools</a></li><li><a class="tocitem" href="../OtherUtils/">Other Utilities</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Calculating TPCFs multipoles</a></li><li><a class="is-disabled">LD</a></li><li class="is-active"><a href>LD TPCFs</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>LD TPCFs</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/foglienimatteo/GaPSE.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/foglienimatteo/GaPSE.jl/blob/main/docs/src/LD_Correlations_1.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="LD-TPCFs"><a class="docs-heading-anchor" href="#LD-TPCFs">LD TPCFs</a><a id="LD-TPCFs-1"></a><a class="docs-heading-anchor-permalink" href="#LD-TPCFs" title="Permalink"></a></h1><h2 id="Two-Point-Auto-Correlation-Functions"><a class="docs-heading-anchor" href="#Two-Point-Auto-Correlation-Functions">Two-Point Auto-Correlation Functions</a><a id="Two-Point-Auto-Correlation-Functions-1"></a><a class="docs-heading-anchor-permalink" href="#Two-Point-Auto-Correlation-Functions" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GaPSE.ξ_LD_Doppler" href="#GaPSE.ξ_LD_Doppler"><code>GaPSE.ξ_LD_Doppler</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">ξ_LD_Doppler(P1::Point, P2::Point, y, cosmo::Cosmology) ::Float64

ξ_LD_Doppler(s1, s2, y, cosmo::Cosmology) ::Float64</code></pre><p>Return the Two-Point Correlation Function (TPCF) of the Doppler auto-correlation effect arising from the Luminosity Distance (LD) perturbations.</p><p>In the first method, you should pass the two <code>Point</code> (<code>P1</code> and <code>P2</code>) where to  evaluate the function, while in the second method (that internally recalls the first)  you must provide the two corresponding comoving distances <code>s1</code> and <code>s2</code>. We remember that all the distances are measured in <span>$h_0^{-1}\mathrm{Mpc}$</span>.</p><p>The analytical expression of this term is the following:</p><p class="math-container">\[\begin{split}
    \xi^{v_{\parallel}v_{\parallel}} (s_1, s_2, y) = 
    \mathcal{J}^{v_{\parallel}v_{\parallel}}_{\alpha}
    \left[
        \mathcal{J}^{v_{\parallel}v_{\parallel}}_{00} I_0^0(s) + 
        \mathcal{J}^{v_{\parallel}v_{\parallel}}_{02} I_2^0(s) +
        \mathcal{J}^{v_{\parallel}v_{\parallel}}_{04} I_4^0(s) + 
        \mathcal{J}^{v_{\parallel}v_{\parallel}}_{20} I_0^2(s)
    \right] \, ,
\end{split}\]</p><p>with</p><p class="math-container">\[\begin{split}
    \mathcal{J}^{v_{\parallel}v_{\parallel}}_{\alpha} &amp; = 
    D_1 D_2 f_1 f_2 \mathcal{H}_1 \mathcal{H}_2  \mathfrak{R}_1  \mathfrak{R}_2
    \, , \\
    %%%%%%%%%%%%%%%%%%%%%%%%
    \mathcal{J}^{v_{\parallel}v_{\parallel}}_{00} &amp; = 
    \frac{1}{45} \left[
        y^2 s_1 s_2 - 2y(s_1^2 + s_2^2) + 3s_1 s_2
    \right]
    \, , \\
    %%%%%%%%%%%%%%%%%%%%%%%%
    \mathcal{J}^{v_{\parallel}v_{\parallel}}_{02}  &amp; = 
    \frac{2}{63} \left[
        y^2 s_1 s_2 - 2y(s_1^2 + s_2^2) + 3s_1 s_2
    \right]
    \, , \\
    %%%%%%%%%%%%%%%%%%%%%%%%
    \mathcal{J}^{v_{\parallel}v_{\parallel}}_{04} &amp; = 
    \frac{1}{105} \left[
        y^2 s_1 s_2 - 2y(s_1^2 + s_2^2) + 3s_1 s_2
    \right]
    \, , \\
    %%%%%%%%%%%%%%%%%%%%%%%%
    \mathcal{J}^{v_{\parallel}v_{\parallel}}_{20} &amp; = \frac{1}{3} y s^2 
    \, ,
\end{split}\]</p><p>where:</p><ul><li><p><span>$s_1$</span> and <span>$s_2$</span> are comoving distances;</p></li><li><p><span>$D_1 = D(s_1)$</span>, ... is the linear growth factor (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$a_1 = a(s_1)$</span>, ... is the scale factor (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$f_1 = f(s_1)$</span>, ... is the linear growth rate (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$\mathcal{H}_1 = \mathcal{H}(s_1)$</span>, ... is the comoving  Hubble distances (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$y = \cos{\theta} = \hat{\mathbf{s}}_1 \cdot \hat{\mathbf{s}}_2$</span>;</p></li><li><p><span>$\mathfrak{R}_1 = \mathfrak{R}(s_1)$</span>, ... is  computed by <code>func_ℛ_LD</code> in <code>cosmo::Cosmology</code> (and evaluated in <span>$s_1$</span> ); the definition of <span>$\mathcal{R}(s)$</span> is the following:</p><p class="math-container">\[\mathfrak{R}(s) = 1 - \frac{1}{\mathcal{H}(s) s} ;\]</p></li><li><p><span>$\Omega_{\mathrm{M}0} = \Omega_{\mathrm{cdm}} + \Omega_{\mathrm{b}}$</span> is the sum of  cold-dark-matter and barionic density parameters (again, stored in <code>cosmo</code>);</p></li><li><p><span>$I_\ell^n$</span> and <span>$\sigma_i$</span> are defined as</p><p class="math-container">\[I_\ell^n(s) = \int_0^{+\infty} \frac{\mathrm{d}q}{2\pi^2} 
\, q^2 \, P(q) \, \frac{j_\ell(qs)}{(qs)^n} \quad , 
\quad \sigma_i = \int_0^{+\infty} \frac{\mathrm{d}q}{2\pi^2} 
\, q^{2-i} \, P(q)\]</p><p>with <span>$P(q)$</span> as the matter Power Spectrum at <span>$z=0$</span> (stored in <code>cosmo</code>)  and <span>$j_\ell$</span> as spherical Bessel function of order <span>$\ell$</span>;</p></li><li><p><span>$\tilde{I}_0^4$</span> is defined as</p><p class="math-container">\[\tilde{I}_0^4 = \int_0^{+\infty} \frac{\mathrm{d}q}{2\pi^2} 
\, q^2 \, P(q) \, \frac{j_0(qs) - 1}{(qs)^4}\]</p><p>with <span>$P(q)$</span> as the matter Power Spectrum at <span>$z=0$</span> (stored in <code>cosmo</code>)  and <span>$j_\ell$</span> as spherical Bessel function of order <span>$\ell$</span>;</p></li><li><p><span>$\mathcal{H}_0$</span>, <span>$f_0$</span> and so on are evaluated at the observer position (i.e. at present day);</p></li><li><p><span>$\Delta\chi_1 := \sqrt{\chi_1^2 + s_2^2-2\,\chi_1\,s_2\,y}$</span> and  <span>$\Delta\chi_2 := \sqrt{s_1^2 + \chi_2^2-2\,s_1\,\chi_2\,y}$</span>;</p></li><li><p><span>$s=\sqrt{s_1^2 + s_2^2 - 2 \, s_1 \, s_2 \, y}$</span> and  <span>$\Delta\chi := \sqrt{\chi_1^2 + \chi_2^2-2\,\chi_1\,\chi_2\,y}$</span>.</p></li></ul><p><strong>Inputs</strong></p><ul><li><p><code>P1::Point</code> and <code>P2::Point</code>, or <code>s1</code> and <code>s2</code>: <code>Point</code>/comoving distances where the  TPCF has to be calculated; they contain all the  data of interest needed for this calculus (comoving distance, growth factor and so on).</p></li><li><p><code>y</code>: the cosine of the angle between the two points <code>P1</code> and <code>P2</code> wrt the observer</p></li><li><p><code>cosmo::Cosmology</code>: cosmology to be used in this computation; it contains all the splines used for the conversion <code>s</code> -&gt; <code>Point</code>, and all the cosmological parameters <span>$\Omega_{\mathrm{M}0}$</span>, ...</p></li></ul><p>See also: <a href="../Cosmology/#GaPSE.Point"><code>Point</code></a>, <a href="../Cosmology/#GaPSE.Cosmology"><code>Cosmology</code></a>, <a href="../LD_Correlations_2/#GaPSE.ξ_LD_multipole"><code>ξ_LD_multipole</code></a>,  <a href="../LD_Correlations_2/#GaPSE.map_ξ_LD_multipole"><code>map_ξ_LD_multipole</code></a>, <a href="../LD_Correlations_2/#GaPSE.print_map_ξ_LD_multipole"><code>print_map_ξ_LD_multipole</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/foglienimatteo/GaPSE.jl/blob/e601437c432ee08c2009b9fd4aee18390ba3e877/src/LD_AutoCorrelations/LD_AutoDoppler.jl#L49-L172">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GaPSE.ξ_LD_Lensing" href="#GaPSE.ξ_LD_Lensing"><code>GaPSE.ξ_LD_Lensing</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">ξ_LD_Lensing(P1::Point, P2::Point, y, cosmo::Cosmology;
    en::Float64 = 1e6, Δχ_min::Float64 = 1e-3,
    N_χs_2::Int = 100) ::Float64

ξ_LD_Lensing(s1, s2, y, cosmo::Cosmology; kwargs...) ::Float64</code></pre><p>Return the Two-Point Correlation Function (TPCF) of the Lensing  auto-correlation effect arising from the Luminosity Distance (LD) perturbations.</p><p>In the first method, you should pass the two <code>Point</code> (<code>P1</code> and <code>P2</code>) where to  evaluate the function, while in the second method (that internally recalls the first)  you must provide the two corresponding comoving distances <code>s1</code> and <code>s2</code>. We remember that all the distances are measured in <span>$h_0^{-1}\mathrm{Mpc}$</span>.</p><p>The analytical expression of this term is the following:</p><p class="math-container">\[\begin{split}
    \xi^{\kappa\kappa} (s_1, s_2, y) = 
    \int_0^{s_1} \mathrm{d}\chi_1 \int_0^{s_2} \mathrm{d}\chi_2 \;
    \mathcal{J}^{\kappa\kappa}_{\alpha} \left[
        \mathcal{J}^{\kappa\kappa}_{00}I^0_0(\Delta\chi) + 
        \mathcal{J}^{\kappa\kappa}_{02} I^0_2(\Delta\chi) +
        \mathcal{J}^{\kappa\kappa}_{31}I^3_1(\Delta\chi) +
        \mathcal{J}^{\kappa\kappa}_{22}I^2_2(\Delta\chi)
    \right] \nonumber \, ,
\end{split}\]</p><p>with</p><p class="math-container">\[\begin{split}
    \mathcal{J}^{\kappa\kappa}_{\alpha} &amp; = 
    \frac{
        \mathcal{H}_0^4 \Omega_{\mathrm{M}0}^2 D(\chi_1) D(\chi_2)
    }{
        s_1 s_2 a(\chi_1) a(\chi_2)
    }(\chi_1 - s_1)(\chi_2 - s_2)
    \, , \\
    %%%%%%%%%%%%%%%%%%%%%%%%
    \mathcal{J}^{\kappa\kappa}_{00} &amp; = 
    -\frac{ 3 \chi_1^2 \chi_2^2}{4 \Delta\chi^4} (y^2 - 1)
    \left[
        8 y (\chi_1^2 + \chi_2^2) - 9\chi_1\chi_2y^2 - 
        7\chi_1\chi_2
    \right] 
    \, , \\
    %%%%%%%%%%%%%%%%%%%%%%%%
    \mathcal{J}^{\kappa\kappa}_{02} &amp; = 
    -\frac{ 3 \chi_1^2 \chi_2^2}{2 \Delta\chi^4}(y^2 - 1)
    \left[
        4 y (\chi_1^2 + \chi_2^2) - 3 \chi_1 \chi_2 y^2 -
        5 \chi_1 \chi_2
    \right] 
    \, , \\
    %%%%%%%%%%%%%%%%%%%%%%%%
    \mathcal{J}^{\kappa\kappa}_{31} &amp; = 9 y \Delta\chi^2
    \, , \\
    %%%%%%%%%%%%%%%%%%%%%%%%
    \mathcal{J}^{\kappa\kappa}_{22} &amp; = 
    \frac{9 \chi_1 \chi_2}{4 \Delta\chi^4}
    \left[
        2(\chi_1^4 + \chi_2^4)(7 y^2 - 3) - 
        16 y \chi_1 \chi_2 (\chi_1^2 + \chi_2^2)(y^2 + 1) + 
        \right.\\
        &amp;\left.\qquad\qquad\qquad
        \chi_1^2 \chi_2^2 (11y^4 + 14y^2 + 23) 
    \right] \nonumber
    \, ,
\end{split}\]</p><p>where:</p><ul><li><p><span>$s_1$</span> and <span>$s_2$</span> are comoving distances;</p></li><li><p><span>$D_1 = D(s_1)$</span>, ... is the linear growth factor (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$a_1 = a(s_1)$</span>, ... is the scale factor (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$f_1 = f(s_1)$</span>, ... is the linear growth rate (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$\mathcal{H}_1 = \mathcal{H}(s_1)$</span>, ... is the comoving  Hubble distances (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$y = \cos{\theta} = \hat{\mathbf{s}}_1 \cdot \hat{\mathbf{s}}_2$</span>;</p></li><li><p><span>$\mathfrak{R}_1 = \mathfrak{R}(s_1)$</span>, ... is  computed by <code>func_ℛ_LD</code> in <code>cosmo::Cosmology</code> (and evaluated in <span>$s_1$</span> ); the definition of <span>$\mathcal{R}(s)$</span> is the following:</p><p class="math-container">\[\mathfrak{R}(s) = 1 - \frac{1}{\mathcal{H}(s) s} ;\]</p></li><li><p><span>$\Omega_{\mathrm{M}0} = \Omega_{\mathrm{cdm}} + \Omega_{\mathrm{b}}$</span> is the sum of  cold-dark-matter and barionic density parameters (again, stored in <code>cosmo</code>);</p></li><li><p><span>$I_\ell^n$</span> and <span>$\sigma_i$</span> are defined as</p><p class="math-container">\[I_\ell^n(s) = \int_0^{+\infty} \frac{\mathrm{d}q}{2\pi^2} 
\, q^2 \, P(q) \, \frac{j_\ell(qs)}{(qs)^n} \quad , 
\quad \sigma_i = \int_0^{+\infty} \frac{\mathrm{d}q}{2\pi^2} 
\, q^{2-i} \, P(q)\]</p><p>with <span>$P(q)$</span> as the matter Power Spectrum at <span>$z=0$</span> (stored in <code>cosmo</code>)  and <span>$j_\ell$</span> as spherical Bessel function of order <span>$\ell$</span>;</p></li><li><p><span>$\tilde{I}_0^4$</span> is defined as</p><p class="math-container">\[\tilde{I}_0^4 = \int_0^{+\infty} \frac{\mathrm{d}q}{2\pi^2} 
\, q^2 \, P(q) \, \frac{j_0(qs) - 1}{(qs)^4}\]</p><p>with <span>$P(q)$</span> as the matter Power Spectrum at <span>$z=0$</span> (stored in <code>cosmo</code>)  and <span>$j_\ell$</span> as spherical Bessel function of order <span>$\ell$</span>;</p></li><li><p><span>$\mathcal{H}_0$</span>, <span>$f_0$</span> and so on are evaluated at the observer position (i.e. at present day);</p></li><li><p><span>$\Delta\chi_1 := \sqrt{\chi_1^2 + s_2^2-2\,\chi_1\,s_2\,y}$</span> and  <span>$\Delta\chi_2 := \sqrt{s_1^2 + \chi_2^2-2\,s_1\,\chi_2\,y}$</span>;</p></li><li><p><span>$s=\sqrt{s_1^2 + s_2^2 - 2 \, s_1 \, s_2 \, y}$</span> and  <span>$\Delta\chi := \sqrt{\chi_1^2 + \chi_2^2-2\,\chi_1\,\chi_2\,y}$</span>.</p></li></ul><p>This function is computed integrating <code>integrand_ξ_LD_Lensing</code> with trapz() from the  <a href="https://github.com/francescoalemanno/Trapz.jl">Trapz</a> Julia package.</p><p><strong>Inputs</strong></p><ul><li><p><code>P1::Point</code> and <code>P2::Point</code>, or <code>s1</code> and <code>s2</code>: <code>Point</code>/comoving distances where the  TPCF has to be calculated; they contain all the  data of interest needed for this calculus (comoving distance, growth factor and so on).</p></li><li><p><code>y</code>: the cosine of the angle between the two points <code>P1</code> and <code>P2</code> wrt the observer</p></li><li><p><code>cosmo::Cosmology</code>: cosmology to be used in this computation; it contains all the splines used for the conversion <code>s</code> -&gt; <code>Point</code>, and all the cosmological parameters <span>$\Omega_{\mathrm{M}0}$</span>, ...</p></li></ul><p><strong>Keyword arguments</strong></p><ul><li><p><code>en::Float64 = 1e6</code>: just a float number used in order to deal better  with small numbers;</p></li><li><p><code>N_χs_2::Int = 100</code>: number of points to be used for sampling the integral along the ranges <code>(0, s1)</code> (for <code>χ1</code>) and <code>(0, s2)</code> (for <code>χ2</code>); it has been checked that with <code>N_χs_2 ≥ 50</code> the result is stable.</p></li><li><p><code>Δχ_min::Float64 = 1e-4</code> : when <span>$\Delta\chi = \sqrt{\chi_1^2 + \chi_2^2 - 2 \, \chi_1 \chi_2 y} \to 0^{+}$</span>, some <span>$I_\ell^n$</span> term diverges, but the overall parenthesis has a known limit:</p><p class="math-container">\[\lim_{\Delta\chi\to 0^{+}} \left(J^{\kappa\kappa}_{00} \, I^0_0(\Delta\chi) + 
      J^{\kappa\kappa}_{02} \, I^0_2(\Delta\chi) + 
      J^{\kappa\kappa}_{31} \, I^3_1(\Delta\chi) + J^{\kappa\kappa}_{22} \, I^2_2(\Delta\chi)
      \right) = 
      \frac{4}{15} \, \left(5 \, \sigma_2 + \frac{2}{3} \, σ_0 \,s_1^2 \, \chi_2^2\right)\]</p></li></ul><p>See also: <a href="../Cosmology/#GaPSE.Point"><code>Point</code></a>, <a href="../Cosmology/#GaPSE.Cosmology"><code>Cosmology</code></a>, <a href="../LD_Correlations_2/#GaPSE.ξ_LD_multipole"><code>ξ_LD_multipole</code></a>,  <a href="../LD_Correlations_2/#GaPSE.map_ξ_LD_multipole"><code>map_ξ_LD_multipole</code></a>, <a href="../LD_Correlations_2/#GaPSE.print_map_ξ_LD_multipole"><code>print_map_ξ_LD_multipole</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/foglienimatteo/GaPSE.jl/blob/e601437c432ee08c2009b9fd4aee18390ba3e877/src/LD_AutoCorrelations/LD_AutoLensing.jl#L282-L442">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GaPSE.ξ_LD_LocalGP" href="#GaPSE.ξ_LD_LocalGP"><code>GaPSE.ξ_LD_LocalGP</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">ξ_LD_LocalGP(P1::Point, P2::Point, y, cosmo::Cosmology) ::Float64

ξ_LD_LocalGP(s1, s2, y, cosmo::Cosmology; kwargs...) ::Float64</code></pre><p>Return the Two-Point Correlation Function (TPCF) of the Local Gravitational Potential (GP) auto-correlation effect arising from the Luminosity Distance (LD) perturbations.</p><p>In the first method, you should pass the two <code>Point</code> (<code>P1</code> and <code>P2</code>) where to  evaluate the function, while in the second method (that internally recalls the first)  you must provide the two corresponding comoving distances <code>s1</code> and <code>s2</code>. We remember that all the distances are measured in <span>$h_0^{-1}\mathrm{Mpc}$</span>.</p><p>The analytical expression of this term is the following:</p><p class="math-container">\[\begin{split}
    \xi^{\phi\phi} (s_1, s_2, y) = 
    \frac{9 \mathcal{H}_0^4 \Omega_{\mathrm{M}0}^2 D_1 D_2 s^4 }{4 a_1 a_2}
    \left(1 + \mathfrak{R}_1 + \mathfrak{R}_2 + \mathfrak{R}_1 \mathfrak{R}_2 \right)
    \tilde{I}^4_0(s) \, ,
\end{split}\]</p><p>where:</p><ul><li><p><span>$s_1$</span> and <span>$s_2$</span> are comoving distances;</p></li><li><p><span>$D_1 = D(s_1)$</span>, ... is the linear growth factor (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$a_1 = a(s_1)$</span>, ... is the scale factor (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$f_1 = f(s_1)$</span>, ... is the linear growth rate (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$\mathcal{H}_1 = \mathcal{H}(s_1)$</span>, ... is the comoving  Hubble distances (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$y = \cos{\theta} = \hat{\mathbf{s}}_1 \cdot \hat{\mathbf{s}}_2$</span>;</p></li><li><p><span>$\mathfrak{R}_1 = \mathfrak{R}(s_1)$</span>, ... is  computed by <code>func_ℛ_LD</code> in <code>cosmo::Cosmology</code> (and evaluated in <span>$s_1$</span> ); the definition of <span>$\mathcal{R}(s)$</span> is the following:</p><p class="math-container">\[\mathfrak{R}(s) = 1 - \frac{1}{\mathcal{H}(s) s} ;\]</p></li><li><p><span>$\Omega_{\mathrm{M}0} = \Omega_{\mathrm{cdm}} + \Omega_{\mathrm{b}}$</span> is the sum of  cold-dark-matter and barionic density parameters (again, stored in <code>cosmo</code>);</p></li><li><p><span>$I_\ell^n$</span> and <span>$\sigma_i$</span> are defined as</p><p class="math-container">\[I_\ell^n(s) = \int_0^{+\infty} \frac{\mathrm{d}q}{2\pi^2} 
\, q^2 \, P(q) \, \frac{j_\ell(qs)}{(qs)^n} \quad , 
\quad \sigma_i = \int_0^{+\infty} \frac{\mathrm{d}q}{2\pi^2} 
\, q^{2-i} \, P(q)\]</p><p>with <span>$P(q)$</span> as the matter Power Spectrum at <span>$z=0$</span> (stored in <code>cosmo</code>)  and <span>$j_\ell$</span> as spherical Bessel function of order <span>$\ell$</span>;</p></li><li><p><span>$\tilde{I}_0^4$</span> is defined as</p><p class="math-container">\[\tilde{I}_0^4 = \int_0^{+\infty} \frac{\mathrm{d}q}{2\pi^2} 
\, q^2 \, P(q) \, \frac{j_0(qs) - 1}{(qs)^4}\]</p><p>with <span>$P(q)$</span> as the matter Power Spectrum at <span>$z=0$</span> (stored in <code>cosmo</code>)  and <span>$j_\ell$</span> as spherical Bessel function of order <span>$\ell$</span>;</p></li><li><p><span>$\mathcal{H}_0$</span>, <span>$f_0$</span> and so on are evaluated at the observer position (i.e. at present day);</p></li><li><p><span>$\Delta\chi_1 := \sqrt{\chi_1^2 + s_2^2-2\,\chi_1\,s_2\,y}$</span> and  <span>$\Delta\chi_2 := \sqrt{s_1^2 + \chi_2^2-2\,s_1\,\chi_2\,y}$</span>;</p></li><li><p><span>$s=\sqrt{s_1^2 + s_2^2 - 2 \, s_1 \, s_2 \, y}$</span> and  <span>$\Delta\chi := \sqrt{\chi_1^2 + \chi_2^2-2\,\chi_1\,\chi_2\,y}$</span>.</p></li></ul><p><strong>Inputs</strong></p><ul><li><p><code>P1::Point</code> and <code>P2::Point</code>, or <code>s1</code> and <code>s2</code>: <code>Point</code>/comoving distances where the  TPCF has to be calculated; they contain all the  data of interest needed for this calculus (comoving distance, growth factor and so on).</p></li><li><p><code>y</code>: the cosine of the angle between the two points <code>P1</code> and <code>P2</code> wrt the observer</p></li><li><p><code>cosmo::Cosmology</code>: cosmology to be used in this computation; it contains all the splines used for the conversion <code>s</code> -&gt; <code>Point</code>, and all the cosmological parameters <span>$\Omega_{\mathrm{M}0}$</span>, ...</p></li></ul><p>See also: <a href="../Cosmology/#GaPSE.Point"><code>Point</code></a>, <a href="../Cosmology/#GaPSE.Cosmology"><code>Cosmology</code></a>, <a href="../LD_Correlations_2/#GaPSE.ξ_LD_multipole"><code>ξ_LD_multipole</code></a>,  <a href="../LD_Correlations_2/#GaPSE.map_ξ_LD_multipole"><code>map_ξ_LD_multipole</code></a>, <a href="../LD_Correlations_2/#GaPSE.print_map_ξ_LD_multipole"><code>print_map_ξ_LD_multipole</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/foglienimatteo/GaPSE.jl/blob/e601437c432ee08c2009b9fd4aee18390ba3e877/src/LD_AutoCorrelations/LD_AutoLocalGP.jl#L43-L132">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GaPSE.ξ_LD_IntegratedGP" href="#GaPSE.ξ_LD_IntegratedGP"><code>GaPSE.ξ_LD_IntegratedGP</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">ξ_LD_IntegratedGP(P1::Point, P2::Point, y, cosmo::Cosmology; 
    en::Float64 = 1e10, N_χs_2::Int = 100) :: Float64

ξ_LD_IntegratedGP(s1, s2, y, cosmo::Cosmology; kwargs... )::Float64</code></pre><p>Return the Two-Point Correlation Function (TPCF) of the Integrated Gravitational Potential (GP)  auto-correlation effect arising from the Luminosity Distance (LD) perturbations.</p><p>In the first method, you should pass the two <code>Point</code> (<code>P1</code> and <code>P2</code>) where to  evaluate the function, while in the second method (that internally recalls the first)  you must provide the two corresponding comoving distances <code>s1</code> and <code>s2</code>. We remember that all the distances are measured in <span>$h_0^{-1}\mathrm{Mpc}$</span>.</p><p>The analytical expression of this term is the following:</p><p class="math-container">\[\begin{split}
    \xi^{\int\!\phi\int\!\phi} (s_1, s_2, y) = \int_0^{s_1}\mathrm{d}\chi_1\int_0^{s_2}\mathrm{d}\chi_2 \; 
    \mathcal{J}^{\int\!\phi\int\!\phi}_{40}
    \tilde{I}^4_0(\chi) \, ,
\end{split}\]</p><p>with</p><p class="math-container">\[\begin{split}
     \mathcal{J}^{\int\!\phi\int\!\phi}_{40} = 
    \frac{
        9 \mathcal{H}_0^4 \Omega_{\mathrm{M}0}^2 D(\chi_1) D(\chi_2) \Delta\chi^4
    }{  a(\chi_1)\, a(\chi_2)\, s_1\, s_2 } 
    &amp;\left[
        s_2 \mathcal{H}(\chi_2) \mathfrak{R}_2(f(\chi_2) - 1) - 1
    \right] \times \\ 
    &amp;\left[
        s_1 \mathcal{H}(\chi_1) \mathfrak{R}_1(f(\chi_1) - 1) - 1
    \right] \,  ,
\end{split}\]</p><p>where:</p><ul><li><p><span>$s_1$</span> and <span>$s_2$</span> are comoving distances;</p></li><li><p><span>$D_1 = D(s_1)$</span>, ... is the linear growth factor (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$a_1 = a(s_1)$</span>, ... is the scale factor (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$f_1 = f(s_1)$</span>, ... is the linear growth rate (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$\mathcal{H}_1 = \mathcal{H}(s_1)$</span>, ... is the comoving  Hubble distances (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$y = \cos{\theta} = \hat{\mathbf{s}}_1 \cdot \hat{\mathbf{s}}_2$</span>;</p></li><li><p><span>$\mathfrak{R}_1 = \mathfrak{R}(s_1)$</span>, ... is  computed by <code>func_ℛ_LD</code> in <code>cosmo::Cosmology</code> (and evaluated in <span>$s_1$</span> ); the definition of <span>$\mathcal{R}(s)$</span> is the following:</p><p class="math-container">\[\mathfrak{R}(s) = 1 - \frac{1}{\mathcal{H}(s) s} ;\]</p></li><li><p><span>$\Omega_{\mathrm{M}0} = \Omega_{\mathrm{cdm}} + \Omega_{\mathrm{b}}$</span> is the sum of  cold-dark-matter and barionic density parameters (again, stored in <code>cosmo</code>);</p></li><li><p><span>$I_\ell^n$</span> and <span>$\sigma_i$</span> are defined as</p><p class="math-container">\[I_\ell^n(s) = \int_0^{+\infty} \frac{\mathrm{d}q}{2\pi^2} 
\, q^2 \, P(q) \, \frac{j_\ell(qs)}{(qs)^n} \quad , 
\quad \sigma_i = \int_0^{+\infty} \frac{\mathrm{d}q}{2\pi^2} 
\, q^{2-i} \, P(q)\]</p><p>with <span>$P(q)$</span> as the matter Power Spectrum at <span>$z=0$</span> (stored in <code>cosmo</code>)  and <span>$j_\ell$</span> as spherical Bessel function of order <span>$\ell$</span>;</p></li><li><p><span>$\tilde{I}_0^4$</span> is defined as</p><p class="math-container">\[\tilde{I}_0^4 = \int_0^{+\infty} \frac{\mathrm{d}q}{2\pi^2} 
\, q^2 \, P(q) \, \frac{j_0(qs) - 1}{(qs)^4}\]</p><p>with <span>$P(q)$</span> as the matter Power Spectrum at <span>$z=0$</span> (stored in <code>cosmo</code>)  and <span>$j_\ell$</span> as spherical Bessel function of order <span>$\ell$</span>;</p></li><li><p><span>$\mathcal{H}_0$</span>, <span>$f_0$</span> and so on are evaluated at the observer position (i.e. at present day);</p></li><li><p><span>$\Delta\chi_1 := \sqrt{\chi_1^2 + s_2^2-2\,\chi_1\,s_2\,y}$</span> and  <span>$\Delta\chi_2 := \sqrt{s_1^2 + \chi_2^2-2\,s_1\,\chi_2\,y}$</span>;</p></li><li><p><span>$s=\sqrt{s_1^2 + s_2^2 - 2 \, s_1 \, s_2 \, y}$</span> and  <span>$\Delta\chi := \sqrt{\chi_1^2 + \chi_2^2-2\,\chi_1\,\chi_2\,y}$</span>.</p></li></ul><p>This function is computed integrating <code>integrand_ξ_LD_IntegratedGP</code> with trapz() from the  <a href="https://github.com/francescoalemanno/Trapz.jl">Trapz</a> Julia package.</p><p><strong>Inputs</strong></p><ul><li><p><code>P1::Point</code> and <code>P2::Point</code>, or <code>s1</code> and <code>s2</code>: <code>Point</code>/comoving distances where the  TPCF has to be calculated; they contain all the  data of interest needed for this calculus (comoving distance, growth factor and so on).</p></li><li><p><code>y</code>: the cosine of the angle between the two points <code>P1</code> and <code>P2</code> wrt the observer</p></li><li><p><code>cosmo::Cosmology</code>: cosmology to be used in this computation; it contains all the splines used for the conversion <code>s</code> -&gt; <code>Point</code>, and all the cosmological parameters <span>$\Omega_{\mathrm{M}0}$</span>, ...</p></li></ul><p><strong>Keyword Arguments</strong></p><ul><li><p><code>en::Float64 = 1e6</code>: just a float number used in order to deal better  with small numbers;</p></li><li><p><code>N_χs_2::Int = 100</code>: number of points to be used for sampling the integral along the ranges <code>(0, s1)</code> (for <code>χ1</code>) and <code>(0, s2)</code> (for <code>χ2</code>); it has been checked that with <code>N_χs_2 ≥ 50</code> the result is stable.</p></li></ul><p>See also: <a href="../Cosmology/#GaPSE.Point"><code>Point</code></a>, <a href="../Cosmology/#GaPSE.Cosmology"><code>Cosmology</code></a>, <a href="../LD_Correlations_2/#GaPSE.ξ_LD_multipole"><code>ξ_LD_multipole</code></a>,  <a href="../LD_Correlations_2/#GaPSE.map_ξ_LD_multipole"><code>map_ξ_LD_multipole</code></a>, <a href="../LD_Correlations_2/#GaPSE.print_map_ξ_LD_multipole"><code>print_map_ξ_LD_multipole</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/foglienimatteo/GaPSE.jl/blob/e601437c432ee08c2009b9fd4aee18390ba3e877/src/LD_AutoCorrelations/LD_AutoIntegratedGP.jl#L229-L346">source</a></section></article><h2 id="Two-Point-Cross-Correlation-Functions"><a class="docs-heading-anchor" href="#Two-Point-Cross-Correlation-Functions">Two-Point Cross-Correlation Functions</a><a id="Two-Point-Cross-Correlation-Functions-1"></a><a class="docs-heading-anchor-permalink" href="#Two-Point-Cross-Correlation-Functions" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GaPSE.ξ_LD_Doppler_Lensing" href="#GaPSE.ξ_LD_Doppler_Lensing"><code>GaPSE.ξ_LD_Doppler_Lensing</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">ξ_LD_Doppler_Lensing(
    s1, s2, y, cosmo::Cosmology; 
    kwargs... ) ::Float64</code></pre><p>Return the Two-Point Correlation Function (TPCF) given by the cross correlation between the  Doppler and the Lensing effects arising from the  Luminosity Distance (LD) perturbations.</p><p>It&#39;s computed through the symmetric function <code>ξ_LD_Lensing_Doppler</code>; check its documentation for more details about the analytical expression and the keyword arguments. We remember that all the distances are measured in <span>$h_0^{-1}\mathrm{Mpc}$</span>.</p><p><strong>Inputs</strong></p><ul><li><p><code>s1</code> and <code>s2</code>: comoving distances where the TPCF has to be calculated;</p></li><li><p><code>y</code>: the cosine of the angle between the two points <code>P1</code> and <code>P2</code> wrt the observer</p></li><li><p><code>cosmo::Cosmology</code>: cosmology to be used in this computation; it contains all the splines used for the conversion <code>s</code> -&gt; <code>Point</code>, and all the cosmological parameters <span>$b$</span>, ...</p></li></ul><p><strong>Keyword Arguments</strong></p><ul><li><code>kwargs...</code> : Keyword arguments to be passed to the symmetric TPCF</li></ul><p>See also: <a href="../Cosmology/#GaPSE.Point"><code>Point</code></a>, <a href="../Cosmology/#GaPSE.Cosmology"><code>Cosmology</code></a>, <a href="../LD_Correlations_2/#GaPSE.ξ_LD_multipole"><code>ξ_LD_multipole</code></a>,  <a href="../LD_Correlations_2/#GaPSE.map_ξ_LD_multipole"><code>map_ξ_LD_multipole</code></a>, <a href="../LD_Correlations_2/#GaPSE.print_map_ξ_LD_multipole"><code>print_map_ξ_LD_multipole</code></a>, <a href="#GaPSE.ξ_LD_Lensing_Doppler"><code>ξ_LD_Lensing_Doppler</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/foglienimatteo/GaPSE.jl/blob/e601437c432ee08c2009b9fd4aee18390ba3e877/src/LD_CrossCorrelations/LD_LensingDoppler.jl#L417-L447">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GaPSE.ξ_LD_Lensing_Doppler" href="#GaPSE.ξ_LD_Lensing_Doppler"><code>GaPSE.ξ_LD_Lensing_Doppler</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">ξ_LD_Lensing_Doppler(
    s1, s2, y, cosmo::Cosmology;
    en::Float64 = 1e6, N_χs::Int = 100 ) ::Float64</code></pre><p>Return the Two-Point Correlation Function (TPCF) given by the cross correlation between the  Lensing and the Doppler effects arising from the Luminosity Distance (LD) perturbations.</p><p>You must provide the two comoving distances <code>s1</code> and <code>s2</code> where to  evaluate the function. We remember that all the distances are measured in <span>$h_0^{-1}\mathrm{Mpc}$</span>.</p><p>The analytical expression of this integrand is the following:</p><p class="math-container">\[\begin{split}
    \xi^{\kappa v_{\parallel}} (s_1, s_2, y) = 
    \int_0^{s_1} &amp;\mathrm{d}\chi_1 \; 
    \mathcal{J}^{\kappa v_{\parallel}}_{\alpha} \times \\
    &amp;\left[
        \mathcal{J}^{\kappa v_{\parallel}}_{00} I_0^0(\Delta\chi_1) + 
        \mathcal{J}^{\kappa v_{\parallel}}_{02} I_2^0(\Delta\chi_1) + 
        \mathcal{J}^{\kappa v_{\parallel}}_{04} I_4^0(\Delta\chi_1) + 
        \mathcal{J}^{\kappa v_{\parallel}}_{20} I_0^2(\Delta\chi_1)
    \right] \, ,
\end{split}\]</p><p>with</p><p class="math-container">\[\begin{split}
    \mathcal{J}^{\kappa v_{\parallel}}_{\alpha} &amp;= 
    \mathcal{H}_0^2 \Omega_{\mathrm{M}0} D_2 f_2 \mathcal{H}_2 \mathfrak{R}_2 
    \frac{D(\chi_1) (\chi_1 - s_1)}{a(\chi_1) s_1}
    \, , \\
    %%%%%%%%%%%%%%%%%%%%%%%%
    \mathcal{J}^{\kappa v_{\parallel}}_{00} &amp; = 
    \frac{1}{15}
    \left[
        \chi_1^2 y + \chi_1(4 y^2 - 3) s_2 - 2 y s_2^2
    \right]
    \, , \\
    %%%%%%%%%%%%%%%%%%%%%%%%
    \mathcal{J}^{\kappa v_{\parallel}}_{02} &amp; = 
    \frac{1}{42 \Delta\chi_1^2}
    \left[
        4 \chi_1^4 y + 4 \chi_1^3 (2 y^2 - 3) s_2 +
        \chi_1^2 y (11 - 23 y^2) s_2^2 +
        \right.\\
        &amp;\left.\qquad\qquad\qquad
        \chi_1 (23 y^2 - 3) s_2^3 - 8 y s_2^4
    \right] \nonumber
    \, , \\
    %%%%%%%%%%%%%%%%%%%%%%%%
    \mathcal{J}^{\kappa v_{\parallel}}_{04} &amp; = 
    \frac{1}{70 \Delta\chi_1^2} 
    \left[
        2\chi_1^4 y + 2 \chi_1^3 (2 y^2 - 3) s_2 -
        \chi_1^2 y (y^2 + 5) s_2^2 + 
        \right.\\
        &amp;\left.\qquad\qquad\qquad
        \chi_1(y^2 + 9) s_2^3 - 4 y s_2^4
    \right] \nonumber
    \, , \\
    %%%%%%%%%%%%%%%%%%%%%%%%
    \mathcal{J}^{\kappa v_{\parallel}}_{20} &amp; = y \Delta\chi_1^2 \, ,
\end{split}\]</p><p>where:</p><ul><li><p><span>$s_1$</span> and <span>$s_2$</span> are comoving distances;</p></li><li><p><span>$D_1 = D(s_1)$</span>, ... is the linear growth factor (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$a_1 = a(s_1)$</span>, ... is the scale factor (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$f_1 = f(s_1)$</span>, ... is the linear growth rate (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$\mathcal{H}_1 = \mathcal{H}(s_1)$</span>, ... is the comoving  Hubble distances (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$y = \cos{\theta} = \hat{\mathbf{s}}_1 \cdot \hat{\mathbf{s}}_2$</span>;</p></li><li><p><span>$\mathfrak{R}_1 = \mathfrak{R}(s_1)$</span>, ... is  computed by <code>func_ℛ_LD</code> in <code>cosmo::Cosmology</code> (and evaluated in <span>$s_1$</span> ); the definition of <span>$\mathcal{R}(s)$</span> is the following:</p><p class="math-container">\[\mathfrak{R}(s) = 1 - \frac{1}{\mathcal{H}(s) s} ;\]</p></li><li><p><span>$\Omega_{\mathrm{M}0} = \Omega_{\mathrm{cdm}} + \Omega_{\mathrm{b}}$</span> is the sum of  cold-dark-matter and barionic density parameters (again, stored in <code>cosmo</code>);</p></li><li><p><span>$I_\ell^n$</span> and <span>$\sigma_i$</span> are defined as</p><p class="math-container">\[I_\ell^n(s) = \int_0^{+\infty} \frac{\mathrm{d}q}{2\pi^2} 
\, q^2 \, P(q) \, \frac{j_\ell(qs)}{(qs)^n} \quad , 
\quad \sigma_i = \int_0^{+\infty} \frac{\mathrm{d}q}{2\pi^2} 
\, q^{2-i} \, P(q)\]</p><p>with <span>$P(q)$</span> as the matter Power Spectrum at <span>$z=0$</span> (stored in <code>cosmo</code>)  and <span>$j_\ell$</span> as spherical Bessel function of order <span>$\ell$</span>;</p></li><li><p><span>$\tilde{I}_0^4$</span> is defined as</p><p class="math-container">\[\tilde{I}_0^4 = \int_0^{+\infty} \frac{\mathrm{d}q}{2\pi^2} 
\, q^2 \, P(q) \, \frac{j_0(qs) - 1}{(qs)^4}\]</p><p>with <span>$P(q)$</span> as the matter Power Spectrum at <span>$z=0$</span> (stored in <code>cosmo</code>)  and <span>$j_\ell$</span> as spherical Bessel function of order <span>$\ell$</span>;</p></li><li><p><span>$\mathcal{H}_0$</span>, <span>$f_0$</span> and so on are evaluated at the observer position (i.e. at present day);</p></li><li><p><span>$\Delta\chi_1 := \sqrt{\chi_1^2 + s_2^2-2\,\chi_1\,s_2\,y}$</span> and  <span>$\Delta\chi_2 := \sqrt{s_1^2 + \chi_2^2-2\,s_1\,\chi_2\,y}$</span>;</p></li><li><p><span>$s=\sqrt{s_1^2 + s_2^2 - 2 \, s_1 \, s_2 \, y}$</span> and  <span>$\Delta\chi := \sqrt{\chi_1^2 + \chi_2^2-2\,\chi_1\,\chi_2\,y}$</span>.</p></li></ul><p>This function is computed integrating <code>integrand_ξ_LD_Lensing_Doppler</code> with trapz() from the  <a href="https://github.com/francescoalemanno/Trapz.jl">Trapz</a> Julia package.</p><p><strong>Inputs</strong></p><ul><li><p><code>P1::Point</code> and <code>P2::Point</code>, or <code>s1</code> and <code>s2</code>: <code>Point</code>/comoving distances where the  TPCF has to be calculated; they contain all the  data of interest needed for this calculus (comoving distance, growth factor and so on).</p></li><li><p><code>y</code>: the cosine of the angle between the two points <code>P1</code> and <code>P2</code> wrt the observer</p></li><li><p><code>cosmo::Cosmology</code>: cosmology to be used in this computation; it contains all the splines used for the conversion <code>s</code> -&gt; <code>Point</code>, and all the cosmological parameters <span>$\Omega_{\mathrm{M}0}$</span>, ...</p></li></ul><p><strong>Keyword Arguments</strong></p><ul><li><p><code>en::Float64 = 1e6</code>: just a float number used in order to deal better  with small numbers;</p></li><li><p><code>N_χs::Int = 100</code>: number of points to be used for sampling the integral along the range <code>(0, s1)</code> (for <code>χ1</code>); it has been checked that with <code>N_χs ≥ 50</code> the result is stable.</p></li></ul><p>See also: <a href="../Cosmology/#GaPSE.Point"><code>Point</code></a>, <a href="../Cosmology/#GaPSE.Cosmology"><code>Cosmology</code></a>, <a href="../LD_Correlations_2/#GaPSE.ξ_LD_multipole"><code>ξ_LD_multipole</code></a>,  <a href="../LD_Correlations_2/#GaPSE.map_ξ_LD_multipole"><code>map_ξ_LD_multipole</code></a>, <a href="../LD_Correlations_2/#GaPSE.print_map_ξ_LD_multipole"><code>print_map_ξ_LD_multipole</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/foglienimatteo/GaPSE.jl/blob/e601437c432ee08c2009b9fd4aee18390ba3e877/src/LD_CrossCorrelations/LD_LensingDoppler.jl#L239-L386">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GaPSE.ξ_LD_Doppler_LocalGP" href="#GaPSE.ξ_LD_Doppler_LocalGP"><code>GaPSE.ξ_LD_Doppler_LocalGP</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">ξ_LD_Doppler_LocalGP(P1::Point, P2::Point, y, cosmo::Cosmology ) ::Float64
ξ_LD_Doppler_LocalGP(s1, s2, y, cosmo::Cosmology ) ::Float64</code></pre><p>Return the Two-Point Correlation Function (TPCF) given by the cross correlation between the  Doppler and the Local Gravitational Potential (GP) effects arising from the Luminosity Distance (LD) perturbations.</p><p>In the first method, you should pass the two <code>Point</code> (<code>P1</code> and <code>P2</code>) where to  evaluate the function, while in the second method (that internally recalls the first)  you must provide the two corresponding comoving distances <code>s1</code> and <code>s2</code>. We remember that all the distances are measured in <span>$h_0^{-1}\mathrm{Mpc}$</span>.</p><p>The analytical expression of this TPCF is the following:</p><p class="math-container">\[\begin{split}
    \xi^{v_{\parallel}\phi} (s_1, s_2, y) = 
    \mathcal{J}^{v_{\parallel}\phi}_{31} I^3_1(s) \, ,
\end{split}\]</p><p>with</p><p class="math-container">\[\begin{split}
    \mathcal{J}^{v_{\parallel}\phi}_{31} = 
    \frac{3}{2 a_2} \mathcal{H}_1 f_1 D_1 \mathfrak{R}_1 \mathcal{H}_0^2 
    \Omega_{\mathrm{M}0} D_2 (1 + \mathfrak{R}_2)(s_1 - s_2 y) 
    \, s^2 \, ,
\end{split}\]</p><p>where:</p><ul><li><p><span>$s_1$</span> and <span>$s_2$</span> are comoving distances;</p></li><li><p><span>$D_1 = D(s_1)$</span>, ... is the linear growth factor (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$a_1 = a(s_1)$</span>, ... is the scale factor (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$f_1 = f(s_1)$</span>, ... is the linear growth rate (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$\mathcal{H}_1 = \mathcal{H}(s_1)$</span>, ... is the comoving  Hubble distances (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$y = \cos{\theta} = \hat{\mathbf{s}}_1 \cdot \hat{\mathbf{s}}_2$</span>;</p></li><li><p><span>$\mathfrak{R}_1 = \mathfrak{R}(s_1)$</span>, ... is  computed by <code>func_ℛ_LD</code> in <code>cosmo::Cosmology</code> (and evaluated in <span>$s_1$</span> ); the definition of <span>$\mathcal{R}(s)$</span> is the following:</p><p class="math-container">\[\mathfrak{R}(s) = 1 - \frac{1}{\mathcal{H}(s) s} ;\]</p></li><li><p><span>$\Omega_{\mathrm{M}0} = \Omega_{\mathrm{cdm}} + \Omega_{\mathrm{b}}$</span> is the sum of  cold-dark-matter and barionic density parameters (again, stored in <code>cosmo</code>);</p></li><li><p><span>$I_\ell^n$</span> and <span>$\sigma_i$</span> are defined as</p><p class="math-container">\[I_\ell^n(s) = \int_0^{+\infty} \frac{\mathrm{d}q}{2\pi^2} 
\, q^2 \, P(q) \, \frac{j_\ell(qs)}{(qs)^n} \quad , 
\quad \sigma_i = \int_0^{+\infty} \frac{\mathrm{d}q}{2\pi^2} 
\, q^{2-i} \, P(q)\]</p><p>with <span>$P(q)$</span> as the matter Power Spectrum at <span>$z=0$</span> (stored in <code>cosmo</code>)  and <span>$j_\ell$</span> as spherical Bessel function of order <span>$\ell$</span>;</p></li><li><p><span>$\tilde{I}_0^4$</span> is defined as</p><p class="math-container">\[\tilde{I}_0^4 = \int_0^{+\infty} \frac{\mathrm{d}q}{2\pi^2} 
\, q^2 \, P(q) \, \frac{j_0(qs) - 1}{(qs)^4}\]</p><p>with <span>$P(q)$</span> as the matter Power Spectrum at <span>$z=0$</span> (stored in <code>cosmo</code>)  and <span>$j_\ell$</span> as spherical Bessel function of order <span>$\ell$</span>;</p></li><li><p><span>$\mathcal{H}_0$</span>, <span>$f_0$</span> and so on are evaluated at the observer position (i.e. at present day);</p></li><li><p><span>$\Delta\chi_1 := \sqrt{\chi_1^2 + s_2^2-2\,\chi_1\,s_2\,y}$</span> and  <span>$\Delta\chi_2 := \sqrt{s_1^2 + \chi_2^2-2\,s_1\,\chi_2\,y}$</span>;</p></li><li><p><span>$s=\sqrt{s_1^2 + s_2^2 - 2 \, s_1 \, s_2 \, y}$</span> and  <span>$\Delta\chi := \sqrt{\chi_1^2 + \chi_2^2-2\,\chi_1\,\chi_2\,y}$</span>.</p></li></ul><p><strong>Inputs</strong></p><ul><li><p><code>P1::Point</code> and <code>P2::Point</code>, or <code>s1</code> and <code>s2</code>: <code>Point</code>/comoving distances where the  TPCF has to be calculated; they contain all the  data of interest needed for this calculus (comoving distance, growth factor and so on).</p></li><li><p><code>y</code>: the cosine of the angle between the two points <code>P1</code> and <code>P2</code> wrt the observer</p></li><li><p><code>cosmo::Cosmology</code>: cosmology to be used in this computation; it contains all the splines used for the conversion <code>s</code> -&gt; <code>Point</code>, and all the cosmological parameters <span>$\Omega_{\mathrm{M}0}$</span>, ...</p></li></ul><p>See also: <a href="../Cosmology/#GaPSE.Point"><code>Point</code></a>, <a href="../Cosmology/#GaPSE.Cosmology"><code>Cosmology</code></a>, <a href="../LD_Correlations_2/#GaPSE.ξ_LD_multipole"><code>ξ_LD_multipole</code></a>,  <a href="../LD_Correlations_2/#GaPSE.map_ξ_LD_multipole"><code>map_ξ_LD_multipole</code></a>, <a href="../LD_Correlations_2/#GaPSE.print_map_ξ_LD_multipole"><code>print_map_ξ_LD_multipole</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/foglienimatteo/GaPSE.jl/blob/e601437c432ee08c2009b9fd4aee18390ba3e877/src/LD_CrossCorrelations/LD_DopplerLocalGP.jl#L43-L141">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GaPSE.ξ_LD_LocalGP_Doppler" href="#GaPSE.ξ_LD_LocalGP_Doppler"><code>GaPSE.ξ_LD_LocalGP_Doppler</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">ξ_LD_LocalGP_Doppler(
    s1, s2, y, cosmo::Cosmology; 
    kwargs... ) ::Float64</code></pre><p>Return the Two-Point Correlation Function (TPCF) given by the cross correlation between the  Local Gravitational Potential (GP) and the Doppler effects arising from the  Luminosity Distance (LD) perturbations.</p><p>It&#39;s computed through the symmetric function <code>ξ_LD_Doppler_LocalGP</code>; check its documentation for more details about the analytical expression and the keyword arguments. We remember that all the distances are measured in <span>$h_0^{-1}\mathrm{Mpc}$</span>.</p><p><strong>Inputs</strong></p><ul><li><p><code>s1</code> and <code>s2</code>: comoving distances where the TPCF has to be calculated;</p></li><li><p><code>y</code>: the cosine of the angle between the two points <code>P1</code> and <code>P2</code> wrt the observer</p></li><li><p><code>cosmo::Cosmology</code>: cosmology to be used in this computation; it contains all the splines used for the conversion <code>s</code> -&gt; <code>Point</code>, and all the cosmological parameters <span>$b$</span>, ...</p></li></ul><p><strong>Keyword Arguments</strong></p><ul><li><code>kwargs...</code> : Keyword arguments to be passed to the symmetric TPCF</li></ul><p>See also: <a href="../Cosmology/#GaPSE.Point"><code>Point</code></a>, <a href="../Cosmology/#GaPSE.Cosmology"><code>Cosmology</code></a>, <a href="../LD_Correlations_2/#GaPSE.ξ_LD_multipole"><code>ξ_LD_multipole</code></a>,  <a href="../LD_Correlations_2/#GaPSE.map_ξ_LD_multipole"><code>map_ξ_LD_multipole</code></a>, <a href="../LD_Correlations_2/#GaPSE.print_map_ξ_LD_multipole"><code>print_map_ξ_LD_multipole</code></a>, <a href="#GaPSE.ξ_LD_Doppler_LocalGP"><code>ξ_LD_Doppler_LocalGP</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/foglienimatteo/GaPSE.jl/blob/e601437c432ee08c2009b9fd4aee18390ba3e877/src/LD_CrossCorrelations/LD_DopplerLocalGP.jl#L155-L185">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GaPSE.ξ_LD_Doppler_IntegratedGP" href="#GaPSE.ξ_LD_Doppler_IntegratedGP"><code>GaPSE.ξ_LD_Doppler_IntegratedGP</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">ξ_LD_Doppler_IntegratedGP(
    s1, s2, y, cosmo::Cosmology;
    en::Float64 = 1e6, N_χs::Int = 100 ) ::Float64</code></pre><p>Return the Two-Point Correlation Function (TPCF) given by the cross correlation between the  Doppler and the Integrated Gravitational Potential (GP) effects arising from the  Luminosity Distance (LD) perturbations.</p><p>You must provide the two comoving distances <code>s1</code> and <code>s2</code> where to  evaluate the function. We remember that all the distances are measured in <span>$h_0^{-1}\mathrm{Mpc}$</span>.</p><p>The analytical expression of this TPCF is the following:</p><p class="math-container">\[\begin{split}
    \xi^{v_{\parallel} \int\!\phi} \left(\chi_2, s_1 , s_2, y \right) &amp;= 
    \int_0^{s_2} \mathrm{d}\chi_2 \;
    \mathcal{J}^{v_{\parallel} \int\!\phi}_{31} \,I_1^3(\Delta\chi_2) \, ,
\end{split}\]</p><p>with</p><p class="math-container">\[\begin{split}
    \mathcal{J}^{v_{\parallel} \int\!\phi}_{31} =
    3 \mathcal{H}_1 f_1 D_1 \mathcal{H}_0^2 \Omega_{\mathrm{M}0} \mathfrak{R}_1 
    \frac{
        D(\chi_2)(s_1 - \chi_2 y)
    }{
        a(\chi_2) s_2
    } \Delta\chi_2^2 \left[
    s_2 \mathfrak{R}_2 \mathcal{H}(\chi_2)(f_2 -1) - 1
    \right] \, ,
\end{split}\]</p><p>where:</p><ul><li><p><span>$s_1$</span> and <span>$s_2$</span> are comoving distances;</p></li><li><p><span>$D_1 = D(s_1)$</span>, ... is the linear growth factor (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$a_1 = a(s_1)$</span>, ... is the scale factor (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$f_1 = f(s_1)$</span>, ... is the linear growth rate (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$\mathcal{H}_1 = \mathcal{H}(s_1)$</span>, ... is the comoving  Hubble distances (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$y = \cos{\theta} = \hat{\mathbf{s}}_1 \cdot \hat{\mathbf{s}}_2$</span>;</p></li><li><p><span>$\mathfrak{R}_1 = \mathfrak{R}(s_1)$</span>, ... is  computed by <code>func_ℛ_LD</code> in <code>cosmo::Cosmology</code> (and evaluated in <span>$s_1$</span> ); the definition of <span>$\mathcal{R}(s)$</span> is the following:</p><p class="math-container">\[\mathfrak{R}(s) = 1 - \frac{1}{\mathcal{H}(s) s} ;\]</p></li><li><p><span>$\Omega_{\mathrm{M}0} = \Omega_{\mathrm{cdm}} + \Omega_{\mathrm{b}}$</span> is the sum of  cold-dark-matter and barionic density parameters (again, stored in <code>cosmo</code>);</p></li><li><p><span>$I_\ell^n$</span> and <span>$\sigma_i$</span> are defined as</p><p class="math-container">\[I_\ell^n(s) = \int_0^{+\infty} \frac{\mathrm{d}q}{2\pi^2} 
\, q^2 \, P(q) \, \frac{j_\ell(qs)}{(qs)^n} \quad , 
\quad \sigma_i = \int_0^{+\infty} \frac{\mathrm{d}q}{2\pi^2} 
\, q^{2-i} \, P(q)\]</p><p>with <span>$P(q)$</span> as the matter Power Spectrum at <span>$z=0$</span> (stored in <code>cosmo</code>)  and <span>$j_\ell$</span> as spherical Bessel function of order <span>$\ell$</span>;</p></li><li><p><span>$\tilde{I}_0^4$</span> is defined as</p><p class="math-container">\[\tilde{I}_0^4 = \int_0^{+\infty} \frac{\mathrm{d}q}{2\pi^2} 
\, q^2 \, P(q) \, \frac{j_0(qs) - 1}{(qs)^4}\]</p><p>with <span>$P(q)$</span> as the matter Power Spectrum at <span>$z=0$</span> (stored in <code>cosmo</code>)  and <span>$j_\ell$</span> as spherical Bessel function of order <span>$\ell$</span>;</p></li><li><p><span>$\mathcal{H}_0$</span>, <span>$f_0$</span> and so on are evaluated at the observer position (i.e. at present day);</p></li><li><p><span>$\Delta\chi_1 := \sqrt{\chi_1^2 + s_2^2-2\,\chi_1\,s_2\,y}$</span> and  <span>$\Delta\chi_2 := \sqrt{s_1^2 + \chi_2^2-2\,s_1\,\chi_2\,y}$</span>;</p></li><li><p><span>$s=\sqrt{s_1^2 + s_2^2 - 2 \, s_1 \, s_2 \, y}$</span> and  <span>$\Delta\chi := \sqrt{\chi_1^2 + \chi_2^2-2\,\chi_1\,\chi_2\,y}$</span>.</p></li></ul><p>This function is computed integrating <code>integrand_ξ_LD_Doppler_IntegratedGP</code> with trapz() from the  <a href="https://github.com/francescoalemanno/Trapz.jl">Trapz</a> Julia package.</p><p><strong>Inputs</strong></p><ul><li><p><code>P1::Point</code> and <code>P2::Point</code>, or <code>s1</code> and <code>s2</code>: <code>Point</code>/comoving distances where the  TPCF has to be calculated; they contain all the  data of interest needed for this calculus (comoving distance, growth factor and so on).</p></li><li><p><code>y</code>: the cosine of the angle between the two points <code>P1</code> and <code>P2</code> wrt the observer</p></li><li><p><code>cosmo::Cosmology</code>: cosmology to be used in this computation; it contains all the splines used for the conversion <code>s</code> -&gt; <code>Point</code>, and all the cosmological parameters <span>$\Omega_{\mathrm{M}0}$</span>, ...</p></li></ul><p><strong>Keyword Arguments</strong></p><ul><li><p><code>en::Float64 = 1e6</code>: just a float number used in order to deal better  with small numbers;</p></li><li><p><code>N_χs::Int = 100</code>: number of points to be used for sampling the integral along the range <code>(0, s2)</code> (for <code>χ2</code>); it has been checked that with <code>N_χs ≥ 100</code> the result is stable.</p></li></ul><p>See also: <a href="../Cosmology/#GaPSE.Point"><code>Point</code></a>, <a href="../Cosmology/#GaPSE.Cosmology"><code>Cosmology</code></a>, <a href="../LD_Correlations_2/#GaPSE.ξ_LD_multipole"><code>ξ_LD_multipole</code></a>,  <a href="../LD_Correlations_2/#GaPSE.map_ξ_LD_multipole"><code>map_ξ_LD_multipole</code></a>, <a href="../LD_Correlations_2/#GaPSE.print_map_ξ_LD_multipole"><code>print_map_ξ_LD_multipole</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/foglienimatteo/GaPSE.jl/blob/e601437c432ee08c2009b9fd4aee18390ba3e877/src/LD_CrossCorrelations/LD_DopplerIntegratedGP.jl#L193-L310">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GaPSE.ξ_LD_IntegratedGP_Doppler" href="#GaPSE.ξ_LD_IntegratedGP_Doppler"><code>GaPSE.ξ_LD_IntegratedGP_Doppler</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">ξ_LD_IntegratedGP_Doppler(
    s1, s2, y, cosmo::Cosmology; 
    kwargs... ) ::Float64</code></pre><p>Return the Two-Point Correlation Function (TPCF) given by the cross correlation between the  Integrated Gravitational Potential (GP) and the Doppler effects arising from the  Luminosity Distance (LD) perturbations.</p><p>It&#39;s computed through the symmetric function <code>ξ_LD_Doppler_IntegratedGP</code>; check its documentation for more details about the analytical expression and the keyword arguments. We remember that all the distances are measured in <span>$h_0^{-1}\mathrm{Mpc}$</span>.</p><p><strong>Inputs</strong></p><ul><li><p><code>s1</code> and <code>s2</code>: comoving distances where the TPCF has to be calculated;</p></li><li><p><code>y</code>: the cosine of the angle between the two points <code>P1</code> and <code>P2</code> wrt the observer</p></li><li><p><code>cosmo::Cosmology</code>: cosmology to be used in this computation; it contains all the splines used for the conversion <code>s</code> -&gt; <code>Point</code>, and all the cosmological parameters <span>$b$</span>, ...</p></li></ul><p><strong>Keyword Arguments</strong></p><ul><li><code>kwargs...</code> : Keyword arguments to be passed to the symmetric TPCF</li></ul><p>See also: <a href="../Cosmology/#GaPSE.Point"><code>Point</code></a>, <a href="../Cosmology/#GaPSE.Cosmology"><code>Cosmology</code></a>, <a href="../LD_Correlations_2/#GaPSE.ξ_LD_multipole"><code>ξ_LD_multipole</code></a>,  <a href="../LD_Correlations_2/#GaPSE.map_ξ_LD_multipole"><code>map_ξ_LD_multipole</code></a>, <a href="../LD_Correlations_2/#GaPSE.print_map_ξ_LD_multipole"><code>print_map_ξ_LD_multipole</code></a>, <a href="#GaPSE.ξ_LD_Doppler_IntegratedGP"><code>ξ_LD_Doppler_IntegratedGP</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/foglienimatteo/GaPSE.jl/blob/e601437c432ee08c2009b9fd4aee18390ba3e877/src/LD_CrossCorrelations/LD_DopplerIntegratedGP.jl#L339-L369">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GaPSE.ξ_LD_Lensing_LocalGP" href="#GaPSE.ξ_LD_Lensing_LocalGP"><code>GaPSE.ξ_LD_Lensing_LocalGP</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">ξ_LD_Lensing_LocalGP(
    s1, s2, y, cosmo::Cosmology;
    en::Float64 = 1e6, N_χs::Int = 100 ) ::Float64</code></pre><p>Return the Two-Point Correlation Function (TPCF) given by the cross correlation between the  Lensing and the Local Gravitational Potential (GP) effects arising from the  Luminosity Distance (LD) perturbations.</p><p>You must provide the two comoving distances <code>s1</code> and <code>s2</code> where to  evaluate the function. We remember that all the distances are measured in <span>$h_0^{-1}\mathrm{Mpc}$</span>.</p><p>The analytical expression of this TPCF is the following:</p><p class="math-container">\[\begin{split}
    \xi^{\kappa \phi} (s_1, s_2, y) = 
    \int_0^{s_1} \mathrm{d}\chi_1 \,
    \mathcal{J}^{\kappa \phi}_{\alpha} \left[
        \mathcal{J}^{\kappa \phi}_{31} I_1^3(\Delta\chi_1) +  
        \mathcal{J}^{\kappa \phi}_{22} I_2^2(\Delta\chi_1)
    \right] \nonumber \, ,
\end{split}\]</p><p>with</p><p class="math-container">\[\begin{split}
    \mathcal{J}^{\kappa \phi}_{\alpha} &amp;=
    \frac{
        9 \mathcal{H}_0^4 \Omega_{\mathrm{M}0}^2 D_2 s_2
    }{4 a_2 s_1} (1 + \mathfrak{R}_2)
    \frac{D(\chi_1)(s_1 - \chi_1)}{a(\chi_1)}
    \, , \\
    %%%%%%%%%%%%%%%%%%%%%%%%
    \mathcal{J}^{\kappa \phi}_{31} &amp; = -2 y \Delta\chi_1^2 
    \, , \\
    %%%%%%%%%%%%%%%%%%%%%%%%
    \mathcal{J}^{\kappa \phi}_{22} &amp; = \chi_1 s_2 (1 - y^2) 
    \, ,
\end{split}\]</p><p>where:</p><ul><li><p><span>$s_1$</span> and <span>$s_2$</span> are comoving distances;</p></li><li><p><span>$D_1 = D(s_1)$</span>, ... is the linear growth factor (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$a_1 = a(s_1)$</span>, ... is the scale factor (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$f_1 = f(s_1)$</span>, ... is the linear growth rate (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$\mathcal{H}_1 = \mathcal{H}(s_1)$</span>, ... is the comoving  Hubble distances (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$y = \cos{\theta} = \hat{\mathbf{s}}_1 \cdot \hat{\mathbf{s}}_2$</span>;</p></li><li><p><span>$\mathfrak{R}_1 = \mathfrak{R}(s_1)$</span>, ... is  computed by <code>func_ℛ_LD</code> in <code>cosmo::Cosmology</code> (and evaluated in <span>$s_1$</span> ); the definition of <span>$\mathcal{R}(s)$</span> is the following:</p><p class="math-container">\[\mathfrak{R}(s) = 1 - \frac{1}{\mathcal{H}(s) s} ;\]</p></li><li><p><span>$\Omega_{\mathrm{M}0} = \Omega_{\mathrm{cdm}} + \Omega_{\mathrm{b}}$</span> is the sum of  cold-dark-matter and barionic density parameters (again, stored in <code>cosmo</code>);</p></li><li><p><span>$I_\ell^n$</span> and <span>$\sigma_i$</span> are defined as</p><p class="math-container">\[I_\ell^n(s) = \int_0^{+\infty} \frac{\mathrm{d}q}{2\pi^2} 
\, q^2 \, P(q) \, \frac{j_\ell(qs)}{(qs)^n} \quad , 
\quad \sigma_i = \int_0^{+\infty} \frac{\mathrm{d}q}{2\pi^2} 
\, q^{2-i} \, P(q)\]</p><p>with <span>$P(q)$</span> as the matter Power Spectrum at <span>$z=0$</span> (stored in <code>cosmo</code>)  and <span>$j_\ell$</span> as spherical Bessel function of order <span>$\ell$</span>;</p></li><li><p><span>$\tilde{I}_0^4$</span> is defined as</p><p class="math-container">\[\tilde{I}_0^4 = \int_0^{+\infty} \frac{\mathrm{d}q}{2\pi^2} 
\, q^2 \, P(q) \, \frac{j_0(qs) - 1}{(qs)^4}\]</p><p>with <span>$P(q)$</span> as the matter Power Spectrum at <span>$z=0$</span> (stored in <code>cosmo</code>)  and <span>$j_\ell$</span> as spherical Bessel function of order <span>$\ell$</span>;</p></li><li><p><span>$\mathcal{H}_0$</span>, <span>$f_0$</span> and so on are evaluated at the observer position (i.e. at present day);</p></li><li><p><span>$\Delta\chi_1 := \sqrt{\chi_1^2 + s_2^2-2\,\chi_1\,s_2\,y}$</span> and  <span>$\Delta\chi_2 := \sqrt{s_1^2 + \chi_2^2-2\,s_1\,\chi_2\,y}$</span>;</p></li><li><p><span>$s=\sqrt{s_1^2 + s_2^2 - 2 \, s_1 \, s_2 \, y}$</span> and  <span>$\Delta\chi := \sqrt{\chi_1^2 + \chi_2^2-2\,\chi_1\,\chi_2\,y}$</span>.</p></li></ul><p>This function is computed integrating <code>integrand_ξ_LD_Lensing_LocalGP</code> with trapz() from the  <a href="https://github.com/francescoalemanno/Trapz.jl">Trapz</a> Julia package.</p><p><strong>Inputs</strong></p><ul><li><p><code>P1::Point</code> and <code>P2::Point</code>, or <code>s1</code> and <code>s2</code>: <code>Point</code>/comoving distances where the  TPCF has to be calculated; they contain all the  data of interest needed for this calculus (comoving distance, growth factor and so on).</p></li><li><p><code>y</code>: the cosine of the angle between the two points <code>P1</code> and <code>P2</code> wrt the observer</p></li><li><p><code>cosmo::Cosmology</code>: cosmology to be used in this computation; it contains all the splines used for the conversion <code>s</code> -&gt; <code>Point</code>, and all the cosmological parameters <span>$\Omega_{\mathrm{M}0}$</span>, ...</p></li></ul><p><strong>Keyword Arguments</strong></p><ul><li><p><code>en::Float64 = 1e6</code>: just a float number used in order to deal better  with small numbers;</p></li><li><p><code>N_χs::Int = 100</code>: number of points to be used for sampling the integral along the ranges <code>(0, s1)</code> (for <code>χ1</code>); it has been checked that with <code>N_χs ≥ 50</code> the result is stable.</p></li></ul><p>See also: <a href="../Cosmology/#GaPSE.Point"><code>Point</code></a>, <a href="../Cosmology/#GaPSE.Cosmology"><code>Cosmology</code></a>, <a href="../LD_Correlations_2/#GaPSE.ξ_LD_multipole"><code>ξ_LD_multipole</code></a>,  <a href="../LD_Correlations_2/#GaPSE.map_ξ_LD_multipole"><code>map_ξ_LD_multipole</code></a>, <a href="../LD_Correlations_2/#GaPSE.print_map_ξ_LD_multipole"><code>print_map_ξ_LD_multipole</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/foglienimatteo/GaPSE.jl/blob/e601437c432ee08c2009b9fd4aee18390ba3e877/src/LD_CrossCorrelations/LD_LensingLocalGP.jl#L192-L314">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GaPSE.ξ_LD_LocalGP_Lensing" href="#GaPSE.ξ_LD_LocalGP_Lensing"><code>GaPSE.ξ_LD_LocalGP_Lensing</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">ξ_LD_LocalGP_Lensing(
    s1, s2, y, cosmo::Cosmology; 
    kwargs... ) ::Float64</code></pre><p>Return the Two-Point Correlation Function (TPCF) given by the cross correlation between the  Local Gravitational Potential (GP) and the Lensing effects arising from the  Luminosity Distance (LD) perturbations.</p><p>It&#39;s computed through the symmetric function <code>ξ_LD_Lensing_LocalGP</code>; check its documentation for more details about the analytical expression and the keyword arguments. We remember that all the distances are measured in <span>$h_0^{-1}\mathrm{Mpc}$</span>.</p><p><strong>Inputs</strong></p><ul><li><p><code>s1</code> and <code>s2</code>: comoving distances where the TPCF has to be calculated;</p></li><li><p><code>y</code>: the cosine of the angle between the two points <code>P1</code> and <code>P2</code> wrt the observer</p></li><li><p><code>cosmo::Cosmology</code>: cosmology to be used in this computation; it contains all the splines used for the conversion <code>s</code> -&gt; <code>Point</code>, and all the cosmological parameters <span>$b$</span>, ...</p></li></ul><p><strong>Keyword Arguments</strong></p><ul><li><code>kwargs...</code> : Keyword arguments to be passed to the symmetric TPCF</li></ul><p>See also: <a href="../Cosmology/#GaPSE.Point"><code>Point</code></a>, <a href="../Cosmology/#GaPSE.Cosmology"><code>Cosmology</code></a>, <a href="../LD_Correlations_2/#GaPSE.ξ_LD_multipole"><code>ξ_LD_multipole</code></a>,  <a href="../LD_Correlations_2/#GaPSE.map_ξ_LD_multipole"><code>map_ξ_LD_multipole</code></a>, <a href="../LD_Correlations_2/#GaPSE.print_map_ξ_LD_multipole"><code>print_map_ξ_LD_multipole</code></a>, <a href="#GaPSE.ξ_LD_Lensing_LocalGP"><code>ξ_LD_Lensing_LocalGP</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/foglienimatteo/GaPSE.jl/blob/e601437c432ee08c2009b9fd4aee18390ba3e877/src/LD_CrossCorrelations/LD_LensingLocalGP.jl#L344-L374">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GaPSE.ξ_LD_Lensing_IntegratedGP" href="#GaPSE.ξ_LD_Lensing_IntegratedGP"><code>GaPSE.ξ_LD_Lensing_IntegratedGP</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">ξ_LD_Lensing_IntegratedGP(
    P1::Point, P2::Point, y, cosmo::Cosmology;
    en::Float64 = 1e6, N_χs_2::Int = 100 ) ::Float64

ξ_LD_Lensing_IntegratedGP(
    s1, s2, y, cosmo::Cosmology; kwargs... ) ::Float64</code></pre><p>Return the Two-Point Correlation Function (TPCF) given by the cross correlation between the  Lensing and the Integrated Gravitational Potential (GP) effects arising from the  Luminosity Distance (LD) perturbations.</p><p>In the first method, you should pass the two <code>Point</code> (<code>P1</code> and <code>P2</code>) where to  evaluate the function, while in the second method (that internally recalls the first)  you must provide the two corresponding comoving distances <code>s1</code> and <code>s2</code>. We remember that all the distances are measured in <span>$h_0^{-1}\mathrm{Mpc}$</span>.</p><p>The analytical expression of this TPCF is the following:</p><p class="math-container">\[\begin{split}
    \xi^{\kappa\int\!\phi} (s_1, s_2, y) = 
    \int_0^{s_1} \mathrm{d}\chi_1 \int_0^{s_2} \mathrm{d}\chi_2 \;
    \mathcal{J}^{\kappa\int\!\phi}_{\alpha}\left[ 
        \mathcal{J}^{\kappa\int\!\phi}_{31} I_1^3(\Delta\chi) + 
        \mathcal{J}^{\kappa\int\!\phi}_{22} I_2^2(\Delta\chi) 
    \right] \, , 
\end{split}\]</p><p>with</p><p class="math-container">\[\begin{split}
        \mathcal{J}^{\kappa\int\!\phi}_{\alpha} &amp; =
    \frac{9}{2} \mathcal{H}_0^4 \Omega_{\mathrm{M}0}^2 
    \frac{
        D(\chi_1) D(\chi_2) \chi_2 (s_1 - \chi_1)
        }{
        s_1 a(\chi_1) a(\chi_2)
    } 
    \left[
        \mathcal{H}(\chi_2)(f(\chi_2) - 1)\mathfrak{R}_2 -\frac{1}{s_2} 
    \right]
    \, , \\
    %%%%%%%%%%%%%%%%%%%%%%%%
    \mathcal{J}^{\kappa\int\!\phi}_{31} &amp; = -2 y \Delta\chi^2
    \, , \\
    %%%%%%%%%%%%%%%%%%%%%%%%
    \mathcal{J}^{\kappa\int\!\phi}_{22} &amp; = \chi_1 \chi_2(1 - y^2) 
    \, ,
\end{split}\]</p><p>where:</p><ul><li><p><span>$s_1$</span> and <span>$s_2$</span> are comoving distances;</p></li><li><p><span>$D_1 = D(s_1)$</span>, ... is the linear growth factor (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$a_1 = a(s_1)$</span>, ... is the scale factor (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$f_1 = f(s_1)$</span>, ... is the linear growth rate (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$\mathcal{H}_1 = \mathcal{H}(s_1)$</span>, ... is the comoving  Hubble distances (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$y = \cos{\theta} = \hat{\mathbf{s}}_1 \cdot \hat{\mathbf{s}}_2$</span>;</p></li><li><p><span>$\mathfrak{R}_1 = \mathfrak{R}(s_1)$</span>, ... is  computed by <code>func_ℛ_LD</code> in <code>cosmo::Cosmology</code> (and evaluated in <span>$s_1$</span> ); the definition of <span>$\mathcal{R}(s)$</span> is the following:</p><p class="math-container">\[\mathfrak{R}(s) = 1 - \frac{1}{\mathcal{H}(s) s} ;\]</p></li><li><p><span>$\Omega_{\mathrm{M}0} = \Omega_{\mathrm{cdm}} + \Omega_{\mathrm{b}}$</span> is the sum of  cold-dark-matter and barionic density parameters (again, stored in <code>cosmo</code>);</p></li><li><p><span>$I_\ell^n$</span> and <span>$\sigma_i$</span> are defined as</p><p class="math-container">\[I_\ell^n(s) = \int_0^{+\infty} \frac{\mathrm{d}q}{2\pi^2} 
\, q^2 \, P(q) \, \frac{j_\ell(qs)}{(qs)^n} \quad , 
\quad \sigma_i = \int_0^{+\infty} \frac{\mathrm{d}q}{2\pi^2} 
\, q^{2-i} \, P(q)\]</p><p>with <span>$P(q)$</span> as the matter Power Spectrum at <span>$z=0$</span> (stored in <code>cosmo</code>)  and <span>$j_\ell$</span> as spherical Bessel function of order <span>$\ell$</span>;</p></li><li><p><span>$\tilde{I}_0^4$</span> is defined as</p><p class="math-container">\[\tilde{I}_0^4 = \int_0^{+\infty} \frac{\mathrm{d}q}{2\pi^2} 
\, q^2 \, P(q) \, \frac{j_0(qs) - 1}{(qs)^4}\]</p><p>with <span>$P(q)$</span> as the matter Power Spectrum at <span>$z=0$</span> (stored in <code>cosmo</code>)  and <span>$j_\ell$</span> as spherical Bessel function of order <span>$\ell$</span>;</p></li><li><p><span>$\mathcal{H}_0$</span>, <span>$f_0$</span> and so on are evaluated at the observer position (i.e. at present day);</p></li><li><p><span>$\Delta\chi_1 := \sqrt{\chi_1^2 + s_2^2-2\,\chi_1\,s_2\,y}$</span> and  <span>$\Delta\chi_2 := \sqrt{s_1^2 + \chi_2^2-2\,s_1\,\chi_2\,y}$</span>;</p></li><li><p><span>$s=\sqrt{s_1^2 + s_2^2 - 2 \, s_1 \, s_2 \, y}$</span> and  <span>$\Delta\chi := \sqrt{\chi_1^2 + \chi_2^2-2\,\chi_1\,\chi_2\,y}$</span>.</p></li></ul><p>This function is computed integrating <code>integrand_ξ_LD_Lensing_IntegratedGP</code> with trapz() from the  <a href="https://github.com/francescoalemanno/Trapz.jl">Trapz</a> Julia package.</p><p><strong>Inputs</strong></p><ul><li><p><code>P1::Point</code> and <code>P2::Point</code>, or <code>s1</code> and <code>s2</code>: <code>Point</code>/comoving distances where the  TPCF has to be calculated; they contain all the  data of interest needed for this calculus (comoving distance, growth factor and so on).</p></li><li><p><code>y</code>: the cosine of the angle between the two points <code>P1</code> and <code>P2</code> wrt the observer</p></li><li><p><code>cosmo::Cosmology</code>: cosmology to be used in this computation; it contains all the splines used for the conversion <code>s</code> -&gt; <code>Point</code>, and all the cosmological parameters <span>$\Omega_{\mathrm{M}0}$</span>, ...</p></li></ul><p><strong>Keyword Arguments</strong></p><ul><li><p><code>en::Float64 = 1e6</code>: just a float number used in order to deal better  with small numbers;</p></li><li><p><code>N_χs_2::Int = 100</code>: number of points to be used for sampling the integral along the ranges <code>(0, s1)</code> (for <code>χ1</code>) and <code>(0, s2)</code> (for <code>χ2</code>); it has been checked that with <code>N_χs_2 ≥ 50</code> the result is stable.</p></li></ul><p>See also: <a href="../Cosmology/#GaPSE.Point"><code>Point</code></a>, <a href="../Cosmology/#GaPSE.Cosmology"><code>Cosmology</code></a>, <a href="../LD_Correlations_2/#GaPSE.ξ_LD_multipole"><code>ξ_LD_multipole</code></a>,  <a href="../LD_Correlations_2/#GaPSE.map_ξ_LD_multipole"><code>map_ξ_LD_multipole</code></a>, <a href="../LD_Correlations_2/#GaPSE.print_map_ξ_LD_multipole"><code>print_map_ξ_LD_multipole</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/foglienimatteo/GaPSE.jl/blob/e601437c432ee08c2009b9fd4aee18390ba3e877/src/LD_CrossCorrelations/LD_LensingIntegratedGP.jl#L225-L356">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GaPSE.ξ_LD_IntegratedGP_Lensing" href="#GaPSE.ξ_LD_IntegratedGP_Lensing"><code>GaPSE.ξ_LD_IntegratedGP_Lensing</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">ξ_LD_IntegratedGP_Lensing(
    s1, s2, y, cosmo::Cosmology; 
    kwargs... ) ::Float64</code></pre><p>Return the Two-Point Correlation Function (TPCF) given by the cross correlation between the  Integrated Gravitational Potential (GP) and the Lensing effects arising from the  Luminosity Distance (LD) perturbations.</p><p>It&#39;s computed through the symmetric function <code>ξ_LD_Lensing_IntegratedGP</code>; check its documentation for more details about the analytical expression and the keyword arguments. We remember that all the distances are measured in <span>$h_0^{-1}\mathrm{Mpc}$</span>.</p><p><strong>Inputs</strong></p><ul><li><p><code>s1</code> and <code>s2</code>: comoving distances where the TPCF has to be calculated;</p></li><li><p><code>y</code>: the cosine of the angle between the two points <code>P1</code> and <code>P2</code> wrt the observer</p></li><li><p><code>cosmo::Cosmology</code>: cosmology to be used in this computation; it contains all the splines used for the conversion <code>s</code> -&gt; <code>Point</code>, and all the cosmological parameters <span>$b$</span>, ...</p></li></ul><p><strong>Keyword Arguments</strong></p><ul><li><code>kwargs...</code> : Keyword arguments to be passed to the symmetric TPCF</li></ul><p>See also: <a href="../Cosmology/#GaPSE.Point"><code>Point</code></a>, <a href="../Cosmology/#GaPSE.Cosmology"><code>Cosmology</code></a>, <a href="../LD_Correlations_2/#GaPSE.ξ_LD_multipole"><code>ξ_LD_multipole</code></a>,  <a href="../LD_Correlations_2/#GaPSE.map_ξ_LD_multipole"><code>map_ξ_LD_multipole</code></a>, <a href="../LD_Correlations_2/#GaPSE.print_map_ξ_LD_multipole"><code>print_map_ξ_LD_multipole</code></a>, <a href="#GaPSE.ξ_LD_Lensing_IntegratedGP"><code>ξ_LD_Lensing_IntegratedGP</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/foglienimatteo/GaPSE.jl/blob/e601437c432ee08c2009b9fd4aee18390ba3e877/src/LD_CrossCorrelations/LD_LensingIntegratedGP.jl#L368-L398">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GaPSE.ξ_LD_LocalGP_IntegratedGP" href="#GaPSE.ξ_LD_LocalGP_IntegratedGP"><code>GaPSE.ξ_LD_LocalGP_IntegratedGP</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">ξ_LD_LocalGP_IntegratedGP(
    s1, s2, y, cosmo::Cosmology;
    en::Float64 = 1e6, N_χs::Int = 100 ) ::Float64</code></pre><p>Return the Two-Point Correlation Function (TPCF) given by the cross correlation between the  Local Gravitational Potential (GP) and the Integrated GP effects arising from the  Luminosity Distance (LD) perturbations.</p><p>You must provide the two comoving distances <code>s1</code> and <code>s2</code> where to  evaluate the function. We remember that all the distances are measured in <span>$h_0^{-1}\mathrm{Mpc}$</span>.</p><p>The analytical expression of this TPCF is the following:</p><p class="math-container">\[\begin{split}
    \xi^{\phi\int\!\phi} (s_1, s_2, y) = 
    \int_0^{s_2} \mathrm{d}\chi_2 \,
    \mathcal{J}^{\phi \int\!\phi}_{40} \tilde{I}^4_0(\Delta\chi_2)
    \, ,
\end{split}\]</p><p>with</p><p class="math-container">\[\begin{split}
    \mathcal{J}^{\phi \int\!\phi}_{40} =
    \frac{9 \mathcal{H}_0^4 \Omega_{\mathrm{M}0}^2 D_1}{2 a_1} 
    (\mathfrak{R}_1 + 1)
    \frac{D(\chi_2) \Delta\chi_2^4}{a(\chi_2)}
    \left[
    \mathcal{H}(\chi_2)(f(\chi_2) - 1)\mathfrak{R}_2 - \frac{1}{s_2}
    \right] \, ,
\end{split}\]</p><p>where:</p><ul><li><p><span>$s_1$</span> and <span>$s_2$</span> are comoving distances;</p></li><li><p><span>$D_1 = D(s_1)$</span>, ... is the linear growth factor (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$a_1 = a(s_1)$</span>, ... is the scale factor (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$f_1 = f(s_1)$</span>, ... is the linear growth rate (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$\mathcal{H}_1 = \mathcal{H}(s_1)$</span>, ... is the comoving  Hubble distances (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$y = \cos{\theta} = \hat{\mathbf{s}}_1 \cdot \hat{\mathbf{s}}_2$</span>;</p></li><li><p><span>$\mathfrak{R}_1 = \mathfrak{R}(s_1)$</span>, ... is  computed by <code>func_ℛ_LD</code> in <code>cosmo::Cosmology</code> (and evaluated in <span>$s_1$</span> ); the definition of <span>$\mathcal{R}(s)$</span> is the following:</p><p class="math-container">\[\mathfrak{R}(s) = 1 - \frac{1}{\mathcal{H}(s) s} ;\]</p></li><li><p><span>$\Omega_{\mathrm{M}0} = \Omega_{\mathrm{cdm}} + \Omega_{\mathrm{b}}$</span> is the sum of  cold-dark-matter and barionic density parameters (again, stored in <code>cosmo</code>);</p></li><li><p><span>$I_\ell^n$</span> and <span>$\sigma_i$</span> are defined as</p><p class="math-container">\[I_\ell^n(s) = \int_0^{+\infty} \frac{\mathrm{d}q}{2\pi^2} 
\, q^2 \, P(q) \, \frac{j_\ell(qs)}{(qs)^n} \quad , 
\quad \sigma_i = \int_0^{+\infty} \frac{\mathrm{d}q}{2\pi^2} 
\, q^{2-i} \, P(q)\]</p><p>with <span>$P(q)$</span> as the matter Power Spectrum at <span>$z=0$</span> (stored in <code>cosmo</code>)  and <span>$j_\ell$</span> as spherical Bessel function of order <span>$\ell$</span>;</p></li><li><p><span>$\tilde{I}_0^4$</span> is defined as</p><p class="math-container">\[\tilde{I}_0^4 = \int_0^{+\infty} \frac{\mathrm{d}q}{2\pi^2} 
\, q^2 \, P(q) \, \frac{j_0(qs) - 1}{(qs)^4}\]</p><p>with <span>$P(q)$</span> as the matter Power Spectrum at <span>$z=0$</span> (stored in <code>cosmo</code>)  and <span>$j_\ell$</span> as spherical Bessel function of order <span>$\ell$</span>;</p></li><li><p><span>$\mathcal{H}_0$</span>, <span>$f_0$</span> and so on are evaluated at the observer position (i.e. at present day);</p></li><li><p><span>$\Delta\chi_1 := \sqrt{\chi_1^2 + s_2^2-2\,\chi_1\,s_2\,y}$</span> and  <span>$\Delta\chi_2 := \sqrt{s_1^2 + \chi_2^2-2\,s_1\,\chi_2\,y}$</span>;</p></li><li><p><span>$s=\sqrt{s_1^2 + s_2^2 - 2 \, s_1 \, s_2 \, y}$</span> and  <span>$\Delta\chi := \sqrt{\chi_1^2 + \chi_2^2-2\,\chi_1\,\chi_2\,y}$</span>.</p></li></ul><p>This function is computed integrating <code>integrand_ξ_LD_LocalGP_IntegratedGP</code> with trapz() from the  <a href="https://github.com/francescoalemanno/Trapz.jl">Trapz</a> Julia package.</p><p><strong>Inputs</strong></p><ul><li><p><code>P1::Point</code> and <code>P2::Point</code>, or <code>s1</code>,<code>s2</code>: <code>Point</code>/comoving distances where the  TPCF has to be calculated; they contain all the  data of interest needed for this calculus (comoving distance, growth factor and so on).</p></li><li><p><code>y</code>: the cosine of the angle between the two points <code>P1</code> and <code>P2</code> wrt the observer</p></li><li><p><code>cosmo::Cosmology</code>: cosmology to be used in this computation; it contains all the splines used for the conversion <code>s</code> -&gt; <code>Point</code>, and all the cosmological parameters <span>$\Omega_{\mathrm{M}0}$</span>, ...</p></li></ul><p><strong>Keyword arguments</strong></p><ul><li><p><code>en::Float64 = 1e6</code>: just a float number used in order to deal better  with small numbers;</p></li><li><p><code>N_χs::Int = 100</code>: number of points to be used for sampling the integral along the ranges <code>(0, s1)</code> (for <code>χ1</code>); it has been checked that with <code>N_χs ≥ 50</code> the result is stable.</p></li></ul><p>See also: <a href="../Cosmology/#GaPSE.Point"><code>Point</code></a>, <a href="../Cosmology/#GaPSE.Cosmology"><code>Cosmology</code></a>, <a href="../LD_Correlations_2/#GaPSE.ξ_LD_multipole"><code>ξ_LD_multipole</code></a>,  <a href="../LD_Correlations_2/#GaPSE.map_ξ_LD_multipole"><code>map_ξ_LD_multipole</code></a>, <a href="../LD_Correlations_2/#GaPSE.print_map_ξ_LD_multipole"><code>print_map_ξ_LD_multipole</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/foglienimatteo/GaPSE.jl/blob/e601437c432ee08c2009b9fd4aee18390ba3e877/src/LD_CrossCorrelations/LD_LocalGPIntegratedGP.jl#L175-L291">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GaPSE.ξ_LD_IntegratedGP_LocalGP" href="#GaPSE.ξ_LD_IntegratedGP_LocalGP"><code>GaPSE.ξ_LD_IntegratedGP_LocalGP</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">ξ_LD_IntegratedGP_LocalGP(
    s1, s2, y, cosmo::Cosmology; 
    kwargs... ) ::Float64</code></pre><p>Return the Two-Point Correlation Function (TPCF) given by the cross correlation between the  Integrated Gravitational Potential (GP) and the Local GP effects arising from the  Luminosity Distance (LD) perturbations.</p><p>It&#39;s computed through the symmetric function <code>ξ_LD_IntegratedGP_LocalGP</code>; check its documentation for more details about the analytical expression and the keyword arguments. We remember that all the distances are measured in <span>$h_0^{-1}\mathrm{Mpc}$</span>.</p><p><strong>Inputs</strong></p><ul><li><p><code>s1</code> and <code>s2</code>: comoving distances where the TPCF has to be calculated;</p></li><li><p><code>y</code>: the cosine of the angle between the two points <code>P1</code> and <code>P2</code> wrt the observer</p></li><li><p><code>cosmo::Cosmology</code>: cosmology to be used in this computation; it contains all the splines used for the conversion <code>s</code> -&gt; <code>Point</code>, and all the cosmological parameters <span>$b$</span>, ...</p></li></ul><p><strong>Keyword Arguments</strong></p><ul><li><code>kwargs...</code> : Keyword arguments to be passed to the symmetric TPCF</li></ul><p>See also: <a href="../Cosmology/#GaPSE.Point"><code>Point</code></a>, <a href="../Cosmology/#GaPSE.Cosmology"><code>Cosmology</code></a>, <a href="../LD_Correlations_2/#GaPSE.ξ_LD_multipole"><code>ξ_LD_multipole</code></a>,  <a href="../LD_Correlations_2/#GaPSE.map_ξ_LD_multipole"><code>map_ξ_LD_multipole</code></a>, <a href="../LD_Correlations_2/#GaPSE.print_map_ξ_LD_multipole"><code>print_map_ξ_LD_multipole</code></a>, <a href="#GaPSE.ξ_LD_IntegratedGP_LocalGP"><code>ξ_LD_IntegratedGP_LocalGP</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/foglienimatteo/GaPSE.jl/blob/e601437c432ee08c2009b9fd4aee18390ba3e877/src/LD_CrossCorrelations/LD_LocalGPIntegratedGP.jl#L328-L358">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../GNC_Correlations_3/">« GNC TPCFs</a><a class="docs-footer-nextpage" href="../LD_Correlations_2/">LD TPCFs »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="auto">Automatic (OS)</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.2.1 on <span class="colophon-date" title="Friday 23 February 2024 11:02">Friday 23 February 2024</span>. Using Julia version 1.9.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
