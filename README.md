# GaPSE - a model for the Galaxy Power Spectrum Estimator

![julia-version](https://img.shields.io/badge/julia_version-v1.8-9558B2?style=flat&logo=julia) 
![package-version](https://img.shields.io/github/v/release/cosmofico97/GaPSE?include_prereleases)
![CI-build](https://img.shields.io/github/workflow/status/cosmofico97/GaPSE/Unit%20tests)
![size](https://img.shields.io/github/repo-size/cosmofico97/GaPSE) 
![license]( https://img.shields.io/github/license/cosmofico97/GaPSE)
[![codecov](https://codecov.io/gh/cosmofico97/GaPSE/branch/main/graph/badge.svg?token=67GIZ9RA8Y)](https://codecov.io/gh/cosmofico97/GaPSE)
[![Stable](https://img.shields.io/badge/docs-stable-blue.svg)](https://cosmofico97.github.io/GaPSE/stable) 

GaPSE (Galaxy Power Spectrum Estimator) is a software for cosmological computations written in the [Julia Programming Language](https://julialang.org).

IMPORTANT NOTE: This is a work-in-progress project! As a consequence, currently in this pre-release:
- it's possible to compute the multipoles ($L=1,2,3,...$) of the effects we'll show next, but some of the Galaxy Number Counts multipoles converge very slowly, so their computation is not still ready. The monopoles ($L=0$) computations instead do not give any problem with `quad`;
- you can't go further than $z \simeq 1.5$;
- the code functions are well documented; check the github pages website https://cosmofico97.github.io/GaPSE/stable if you can't see correctly the analytical expressions written in the docstrings. However, the Two-Point Correlation Functions docstrings of the groups `LD`, `GNCxLD` and `LDxGNC` (see below for explanation) are still missing; 
- few people used this code, so bugs are behind the corner; don't esitate to raise the finger to point out them! 




## Brief description

Measurements of the clustering of galaxies in Fourier space, at low wavenumbers, offer a window into the early Universe via the possible presence of scale dependent bias generated by Primordial Non Gaussianities [[1]](#1) [[2]](#1).
On such large scales, a Newtonian treatment of density of density perturbations might not be sufficient to describe the measurements, and a fully relativistic calculation should be employed.

Given the matter Power Spectrum (PS) at redshift $z=0$ and the background quantities for the Universe considered (both read from [CLASS](https://github.com/lesgourg/class_public) outputs), this program can compute:

- all the 16 TPCFs arising from the Luminosity Distance (LD) perturbations (see Eq.(2.48) of [[4]](#1)) for an arbitrary multipole order.

- all the 25 TPCFs concerning the relativistic Galaxy Number Counts (GNC)  (see Eq.(2.52) of [[4]](#1)) for an arbitrary multipole order.

- all the 20 cross correlations between GNC and LD (and their 20 counterparts LD cross GNC) for an arbitrary multipole order.

- the PS multipoles of all of them (based on the Yamamoto estimator).

- the Doppler and matter TPCFs in the plane-parallel approximation.

All these calculations can be performed both with and without a survey window function. The code implements also a toy-survey with azymuthal symmetry.

This project, and the analytical expressions used for the TPCFs, are based on the article of Emanuele Castorina and Enea Di Dio [[3]](#1). 

## Installation

The simplest way to install this software is cloning the repository where it is built in. Run in the command line
```bash
git clone https://github.com/cosmofico97/GaPSE
```
or download the source code from the github repository https://github.com/cosmofico97/GaPSE.

## Execution

The only mandatory instrument to run the code is a Julia REPL with version ≥ 1.8. 
You can write whatever instruction inside the file `GaPSE-exe.jl` and then run it
in the command line:

```bash
     $ julia GaPSE.jl
```

However, the most confortable way to use it is through the Jupyter Notebooks: some `.ipynb` is already provided in the same named directory, and we encourage you to follow the `TUTORIAL.ipynb` file first. The basic structure of the program and the most important functions are there presented.

## Licence

This software is under the [GNU 3.0 General Public Licence](https://www.gnu.org/licenses/gpl-3.0.en.html). See the file [LICENCE.md](./LICENCE.md).


## Acknowledgements

This package make extensive use of the Spherical Bessel Transform function `xicalc` (from the 
[TwoFAST](https://github.com/hsgg/TwoFAST.jl)[[5]](#1) Julia package).


## References
<a id="1">[1]</a> 
Dalal, Doré et al., _Imprints of primordial non-Gaussianities on large-scale structure_ (2008), American Physical Society, DOI: 10.1103/PhysRevD.77.123514, 
url: https://journals.aps.org/prd/abstract/10.1103/PhysRevD.77.123514

<a id="2">[2]</a> 
Slosar, Hirata et al., _Constraints on local primordial non-Gaussianity from large scale structure_ (2008), Journal of Cosmology and Astroparticle Physics, DOI: 10.1088/1475-7516/2008/08/031, url: https://doi.org/10.1088/1475-7516/2008/08/031

<a id="3">[3]</a> 
Castorina, Di Dio, _The observed galaxy power spectrum in General Relativity_ (2022), Journal of Cosmology and Astroparticle Physics, DOI: 10.1088/1475-7516/2022/01/061, url: https://doi.org/10.1088/1475-7516/2022/01/061

<a id="4">[4]</a> 
Di Dio, Montanari, _Curvature constraints from large scale structure_ (2016), Journal of Cosmology and Astroparticle Physics, DOI: 10.1088/1475-7516/2016/06/013, url: https://iopscience.iop.org/article/10.1088/1475-7516/2016/06/013

<a id="5">[5]</a>
Gebhardt, Jeong et al, _Fast and accurate computation of projected two-point functions_ (2018), American Physical Society, DOI: 10.1103/PhysRevD.97.023504, url: https://link.aps.org/doi/10.1103/PhysRevD.97.023504
