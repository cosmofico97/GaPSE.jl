<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>GNCxLD TPCFs ¬∑ GaPSE.jl</title><meta name="title" content="GNCxLD TPCFs ¬∑ GaPSE.jl"/><meta property="og:title" content="GNCxLD TPCFs ¬∑ GaPSE.jl"/><meta property="twitter:title" content="GNCxLD TPCFs ¬∑ GaPSE.jl"/><meta name="description" content="Documentation for GaPSE.jl."/><meta property="og:description" content="Documentation for GaPSE.jl."/><meta property="twitter:description" content="Documentation for GaPSE.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">GaPSE.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Introduction</a></li><li><span class="tocitem">The basic structure</span><ul><li><a class="tocitem" href="../BackgroundData/">Background Data</a></li><li><a class="tocitem" href="../CosmoParams/">Cosmology Parameters</a></li><li><a class="tocitem" href="../Cosmology/">Cosmology Struct</a></li></ul></li><li><span class="tocitem">The window function F and its integration</span><ul><li><a class="tocitem" href="../WindowF/">Window F</a></li><li><a class="tocitem" href="../WindowFIntegrated/">Integrated Window F</a></li></ul></li><li><span class="tocitem">Calculating TPCFs multipoles</span><ul><li><input class="collapse-toggle" id="menuitem-4-1" type="checkbox"/><label class="tocitem" for="menuitem-4-1"><span class="docs-label">GNC</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../GNC_Correlations_1/">GNC TPCFs</a></li><li><a class="tocitem" href="../GNC_Correlations_2/">GNC TPCFs</a></li><li><a class="tocitem" href="../GNC_Correlations_3/">GNC TPCFs</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-2" type="checkbox"/><label class="tocitem" for="menuitem-4-2"><span class="docs-label">LD</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../LD_Correlations_1/">LD TPCFs</a></li><li><a class="tocitem" href="../LD_Correlations_2/">LD TPCFs</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-3" type="checkbox" checked/><label class="tocitem" for="menuitem-4-3"><span class="docs-label">GNCxLD</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../GNCxLD_Correlations_1/">GNCxLD TPCFs</a></li><li class="is-active"><a class="tocitem" href>GNCxLD TPCFs</a><ul class="internal"><li><a class="tocitem" href="#Two-Point-Cross-Correlation-Functions-integrands"><span>Two-Point Cross-Correlation Functions integrands</span></a></li><li><a class="tocitem" href="#Two-Point-Cross-Correlation-Function-multipoles"><span>Two-Point Cross-Correlation Function multipoles</span></a></li><li><a class="tocitem" href="#Two-Point-Cross-Correlation-Function-Sum-multipoles"><span>Two-Point Cross-Correlation Function Sum multipoles</span></a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-4" type="checkbox"/><label class="tocitem" for="menuitem-4-4"><span class="docs-label">LDxGNC</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../LDxGNC_Correlations_1/">LDxGNC TPCFs</a></li><li><a class="tocitem" href="../LDxGNC_Correlations_2/">LDxGNC TPCFs</a></li></ul></li></ul></li><li><a class="tocitem" href="../PlaneParallelApprox/">Calculating TPCFs with the PP Approximation</a></li><li><a class="tocitem" href="../PowerSpectra/">Calculating Power Spectra</a></li><li><a class="tocitem" href="../PowerSpectraGenWin/">Power Spectra for a generic window</a></li><li><a class="tocitem" href="../PNG/">implication on PNG</a></li><li><span class="tocitem">Utilities</span><ul><li><a class="tocitem" href="../Dicts/">Dictionaries and names</a></li><li><a class="tocitem" href="../MathUtils/">Mathematical Utilities</a></li><li><a class="tocitem" href="../CosmoUtils/">Cosmology Utilities</a></li><li><a class="tocitem" href="../IPSTools/">Input Power Spectrum Tools</a></li><li><a class="tocitem" href="../OtherUtils/">Other Utilities</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Calculating TPCFs multipoles</a></li><li><a class="is-disabled">GNCxLD</a></li><li class="is-active"><a href>GNCxLD TPCFs</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>GNCxLD TPCFs</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/foglienimatteo/GaPSE.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands">ÔÇõ</span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/foglienimatteo/GaPSE.jl/blob/main/docs/src/GNCxLD_Correlations_2.md" title="Edit source on GitHub"><span class="docs-icon fa-solid">ÔÅÑ</span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="GNCxLD-TPCFs"><a class="docs-heading-anchor" href="#GNCxLD-TPCFs">GNCxLD TPCFs</a><a id="GNCxLD-TPCFs-1"></a><a class="docs-heading-anchor-permalink" href="#GNCxLD-TPCFs" title="Permalink"></a></h1><h2 id="Two-Point-Cross-Correlation-Functions-integrands"><a class="docs-heading-anchor" href="#Two-Point-Cross-Correlation-Functions-integrands">Two-Point Cross-Correlation Functions integrands</a><a id="Two-Point-Cross-Correlation-Functions-integrands-1"></a><a class="docs-heading-anchor-permalink" href="#Two-Point-Cross-Correlation-Functions-integrands" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GaPSE.integrand_Œæ_GNCxLD_IntegratedGP_Lensing" href="#GaPSE.integrand_Œæ_GNCxLD_IntegratedGP_Lensing"><code>GaPSE.integrand_Œæ_GNCxLD_IntegratedGP_Lensing</code></a> ‚Äî <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">integrand_Œæ_GNCxLD_IntegratedGP_Lensing(
	IP1::Point, IP2::Point, P1::Point, P2::Point, y, cosmo::Cosmology; 
	b1=nothing, b2=nothing, s_b1=nothing, s_b2=nothing,
	ùëì_evo1=nothing, ùëì_evo2=nothing, s_lim=nothing ) ::Float64

integrand_Œæ_GNCxLD_IntegratedGP_Lensing(
	œá1::Float64, œá2::Float64, s1::Float64, s2::Float64, 
	y, cosmo::Cosmology; kwargs... ) ::Float64</code></pre><p>Return the integrand of the Two-Point Correlation Function (TPCF) given by the cross correlation  between the Integrated Gravitational Potential (GP) effect arising from the  Galaxy Number Counts (GNC) and the Lensing one arising from the Luminosity Distance (LD) perturbations.</p><p>In the first method, you should pass the two extreme <code>Point</code>s (<code>P1</code> and <code>P2</code>) and the  two intermediate integrand <code>Point</code>s (<code>IP1</code> and <code>IP2</code>) where to  evaluate the function. In the second method (that internally recalls the first), you must provide the three corresponding comoving distances <code>s1</code>, <code>s2</code>, <code>œá1</code>, <code>œá2</code>. We remember that all the distances are measured in <span>$h_0^{-1}\mathrm{Mpc}$</span>.</p><p>The analytical expression of this integrand is the following:</p><p class="math-container">\[\begin{split}
    f^{\int\!\phi \, \kappa} (\chi_1, \chi_2, s_1 , s_2, y ) = 
    \mathfrak{J}_{\alpha}^{\int\!\phi \, \kappa} 
    \left[ 
        \mathfrak{J}_{31}^{\int\!\phi \, \kappa} I_1^3 ( \Delta \chi ) +
        \mathfrak{J}_{22}^{\int\!\phi \, \kappa} I_2^2 ( \Delta \chi ) 
     \right] \,
\end{split}\]</p><p>with</p><p class="math-container">\[\begin{split}
    \mathfrak{J}_{\alpha}^{\int\!\phi \, \kappa} &amp;=
    - \frac{
        9 \chi_1 \mathcal{H}_0^4 \Omega_{\mathrm{M}0}^2 D(\chi_1) D(\chi_2) 
    }{
        a(\chi_1)  a(\chi_2) s_1  s_2
    }
    (\chi_2 - s_2)
    \left[
        \mathcal{H}(\chi_1) \mathcal{R}_1 s_1 (f(\chi_1) - 1) - 5 s_{\mathrm{b}, 1}  + 2
    \right]
    \, , \\
    %%%%%%%%%%%%%
    \mathfrak{J}_{31}^{\int\!\phi \, \kappa} &amp;=  y \Delta\chi^2
    \, , \\
    %%%%%%%%%%%%%
    \mathfrak{J}_{22}^{\int\!\phi \, \kappa} &amp;= 
    \frac{1}{2} (y^2 - 1) \chi_1 \chi_2 
    \,  ,
\end{split}\]</p><p>where:</p><ul><li><p><span>$s_1$</span> and <span>$s_2$</span> are comoving distances;</p></li><li><p><span>$D_1 = D(s_1)$</span>, ... is the linear growth factor (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$a_1 = a(s_1)$</span>, ... is the scale factor (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$f_1 = f(s_1)$</span>, ... is the linear growth rate (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$\mathcal{H}_1 = \mathcal{H}(s_1)$</span>, ... is the comoving  Hubble distances (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$y = \cos{\theta} = \hat{\mathbf{s}}_1 \cdot \hat{\mathbf{s}}_2$</span>;</p></li><li><p><span>$\mathcal{R}_1 = \mathcal{R}(s_1)$</span>, ... is  computed by <code>func_‚Ñõ_GNC</code> in <code>cosmo::Cosmology</code> (and evaluated in <span>$s_1$</span> ); the definition of <span>$\mathcal{R}(s)$</span> is the following:</p><p class="math-container">\[\mathcal{R}(s) = 5 s_{\mathrm{b}}(s) + \frac{2 - 5 s_{\mathrm{b}}(s)}{\mathcal{H}(s) \, s} +  
\frac{\dot{\mathcal{H}}(s)}{\mathcal{H}(s)^2} - \mathit{f}_{\mathrm{evo}} \quad ;\]</p></li><li><p><span>$\mathfrak{R}_1 = \mathfrak{R}(s_1)$</span>, ... is  computed by <code>func_‚Ñõ_LD</code> in <code>cosmo::Cosmology</code> (and evaluated in <span>$s_1$</span> ); the definition of <span>$\mathcal{R}(s)$</span> is the following:</p><p class="math-container">\[\mathfrak{R}(s) = 1 - \frac{1}{\mathcal{H}(s) s} ;\]</p></li><li><p><span>$b_1$</span>, <span>$s_{\mathrm{b}, 1}$</span>, <span>$\mathit{f}_{\mathrm{evo}, 1}$</span>  (and <span>$b_2$</span>, <span>$s_{\mathrm{b}, 2}$</span>, <span>$\mathit{f}_{\mathrm{evo}, 2}$</span>) :  galaxy bias, magnification bias (i.e. the slope of the luminosity function at the luminosity threshold),  and evolution bias for the first (second) effect;</p></li><li><p><span>$\Omega_{\mathrm{M}0} = \Omega_{\mathrm{cdm}} + \Omega_{\mathrm{b}}$</span> is the sum of  cold-dark-matter and barionic density parameters (again, stored in <code>cosmo</code>);</p></li><li><p><span>$I_\ell^n$</span> and <span>$\sigma_i$</span> are defined as</p><p class="math-container">\[I_\ell^n(s) = \int_0^{+\infty} \frac{\mathrm{d}q}{2\pi^2} 
\, q^2 \, P(q) \, \frac{j_\ell(qs)}{(qs)^n} \quad , 
\quad \sigma_i = \int_0^{+\infty} \frac{\mathrm{d}q}{2\pi^2} 
\, q^{2-i} \, P(q)\]</p><p>with <span>$P(q)$</span> as the matter Power Spectrum at <span>$z=0$</span> (stored in <code>cosmo</code>)  and <span>$j_\ell$</span> as spherical Bessel function of order <span>$\ell$</span>;</p></li><li><p><span>$\tilde{I}_0^4$</span> is defined as</p><p class="math-container">\[\tilde{I}_0^4 = \int_0^{+\infty} \frac{\mathrm{d}q}{2\pi^2} 
\, q^2 \, P(q) \, \frac{j_0(qs) - 1}{(qs)^4}\]</p><p>with <span>$P(q)$</span> as the matter Power Spectrum at <span>$z=0$</span> (stored in <code>cosmo</code>)  and <span>$j_\ell$</span> as spherical Bessel function of order <span>$\ell$</span>;</p></li><li><p><span>$\mathcal{H}_0$</span>, <span>$f_0$</span> and so on are evaluated at the observer position (i.e. at present day);</p></li><li><p><span>$\Delta\chi_1 := \sqrt{\chi_1^2 + s_2^2-2\,\chi_1\,s_2\,y}$</span> and  <span>$\Delta\chi_2 := \sqrt{s_1^2 + \chi_2^2-2\,s_1\,\chi_2\,y}$</span>;</p></li><li><p><span>$s=\sqrt{s_1^2 + s_2^2 - 2 \, s_1 \, s_2 \, y}$</span> and  <span>$\Delta\chi := \sqrt{\chi_1^2 + \chi_2^2-2\,\chi_1\,\chi_2\,y}$</span>.</p></li></ul><p>This function is used inside <code>Œæ_GNCxLD_IntegratedGP_Lensing</code> with the trapz() from the  <a href="https://github.com/francescoalemanno/Trapz.jl">Trapz</a> Julia package.</p><p><strong>Inputs</strong></p><ul><li><p><code>IP1::Point</code>, <code>IP2::Point</code>, <code>P1::Point</code>, <code>P2::Point</code> or <code>œá1</code>,<code>œá2</code>,<code>s1</code>,<code>s2</code>: <code>Point</code>/comoving  distances where the TPCF has to be calculated; they contain all the  data of interest needed for this calculus (comoving distance, growth factor and so on).</p></li><li><p><code>y</code>: the cosine of the angle between the two points <code>P1</code> and <code>P2</code> wrt the observer</p></li><li><p><code>cosmo::Cosmology</code>: cosmology to be used in this computation; it contains all the splines used for the conversion <code>s</code> -&gt; <code>Point</code>, and all the cosmological parameters <span>$b$</span>, ...</p></li></ul><p><strong>Keyword Arguments</strong></p><ul><li><p><code>b1=nothing</code>, <code>s_b1=nothing</code>, <code>ùëì_evo1=nothing</code> and <code>b2=nothing</code>, <code>s_b2=nothing</code>, <code>ùëì_evo2=nothing</code>: galaxy, magnification and evolutionary biases respectively for the first and the second effect  computed in this TPCF:</p><ul><li>if not set (i.e. if you leave the default value <code>nothing</code>) the values stored in the input <code>cosmo</code> will be considered;</li><li>if you set one or more values, they will override the <code>cosmo</code> ones in this computation;</li><li>the two sets of values should be different only if you are interested in studing two galaxy species;</li><li>only the required parameters for the chosen TPCF will be used, depending on its analytical expression; all the others will have no effect, we still inserted them for pragmatical code compatibilities. </li></ul></li><li><p><code>s_lim=nothing</code> : parameter used in order to avoid the divergence of the <span>$\mathcal{R}$</span> and  <span>$\mathfrak{R}$</span> denominators: when <span>$0 \leq s \leq s_\mathrm{lim}$</span> the returned values are</p><p class="math-container">\[\forall \, s \in [ 0, s_\mathrm{lim} ] \; : \quad 
    \mathfrak{R}(s) = 1 - \frac{1}{\mathcal{H}_0 \, s_\mathrm{lim}} \; , \quad
    \mathcal{R}(s) = 5 s_{\mathrm{b}} + 
        \frac{2 - 5 s_{\mathrm{b}}}{\mathcal{H}_0 \, s_\mathrm{lim}} +  
        \frac{\dot{\mathcal{H}}}{\mathcal{H}_0^2} - \mathit{f}_{\mathrm{evo}} \; .\]</p><p>If <code>nothing</code>, the fault value stored in <code>cosmo</code> will be considered.</p></li></ul><p>See also: <a href="../Cosmology/#GaPSE.Point"><code>Point</code></a>, <a href="../Cosmology/#GaPSE.Cosmology"><code>Cosmology</code></a>, <a href="#GaPSE.Œæ_GNCxLD_multipole"><code>Œæ_GNCxLD_multipole</code></a>,  <a href="#GaPSE.map_Œæ_GNCxLD_multipole"><code>map_Œæ_GNCxLD_multipole</code></a>, <a href="#GaPSE.print_map_Œæ_GNCxLD_multipole"><code>print_map_Œæ_GNCxLD_multipole</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/foglienimatteo/GaPSE.jl/blob/e601437c432ee08c2009b9fd4aee18390ba3e877/src/GNCxLD_CrossCorrelations/GNCxLD_IntegratedGPLensing.jl#L69-L233">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GaPSE.integrand_Œæ_GNCxLD_IntegratedGP_IntegratedGP" href="#GaPSE.integrand_Œæ_GNCxLD_IntegratedGP_IntegratedGP"><code>GaPSE.integrand_Œæ_GNCxLD_IntegratedGP_IntegratedGP</code></a> ‚Äî <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">integrand_Œæ_GNCxLD_IntegratedGP_IntegratedGP(IP1::Point, IP2::Point,
    P1::Point, P2::Point, y, cosmo::Cosmology;
    b1=nothing, b2=nothing, s_b1=nothing, s_b2=nothing,
    ùëì_evo1=nothing, ùëì_evo2=nothing, s_lim=nothing ) ::Float64

integrand_Œæ_GNCxLD_IntegratedGP_IntegratedGP(
    œá1::Float64, œá2::Float64, s1::Float64, s2::Float64, 
    y, cosmo::Cosmology; kwargs... ) ::Float64</code></pre><p>Return the integrand of the Two-Point Correlation Function (TPCF) given by the cross correlation  between the Integrated Gravitational Potential (GP) effect arising from the  Galaxy Number Counts (GNC) and the Integrated GP one arising from the Luminosity Distance (LD) perturbations.</p><p>In the first method, you should pass the two extreme <code>Point</code>s (<code>P1</code> and <code>P2</code>) and the  two intermediate integrand <code>Point</code>s (<code>IP1</code> and <code>IP2</code>) where to  evaluate the function. In the second method (that internally recalls the first), you must provide the three corresponding comoving distances <code>s1</code>, <code>s2</code>, <code>œá1</code>, <code>œá2</code>. We remember that all the distances are measured in <span>$h_0^{-1}\mathrm{Mpc}$</span>.</p><p>The analytical expression of this integrand is the following:</p><p class="math-container">\[\begin{split}
    f^{\int\!\phi \, \int \!\phi }(\chi_1, \chi_2, s_1 , s_2, y ) =  
    \mathfrak{J}^{\int \!\phi \int \!\phi}_{40} 
    \tilde{I}_0^4 ( \Delta\chi) \, ,
\end{split}\]</p><p>with</p><p class="math-container">\[\begin{split}
    \mathfrak{J}^{\int \!\phi\int \!\phi}_{40} =
    - \frac{
        9 \Delta\chi ^4 \mathcal{H}_0^4 \Omega_{\mathrm{M}0}^2 D(\chi_1) D(\chi_2)
    }{
        a(\chi_1) a(\chi_2) s_1 s_2
    }
    &amp;\left[
        s_1 (f(\chi_1) - 1) \mathcal{H}(\chi_1) \mathcal{R}_1 - 5 s_{\mathrm{b}, 1}  + 2
    \right] \times
    \nonumber \\
    &amp;\left[
        s_2 (f(\chi_2) - 1) \mathcal{H}(\chi_2) \mathfrak{R}_2 - 1
    \right]
    \, ,
\end{split}\]</p><p>where:</p><ul><li><p><span>$s_1$</span> and <span>$s_2$</span> are comoving distances;</p></li><li><p><span>$D_1 = D(s_1)$</span>, ... is the linear growth factor (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$a_1 = a(s_1)$</span>, ... is the scale factor (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$f_1 = f(s_1)$</span>, ... is the linear growth rate (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$\mathcal{H}_1 = \mathcal{H}(s_1)$</span>, ... is the comoving  Hubble distances (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$y = \cos{\theta} = \hat{\mathbf{s}}_1 \cdot \hat{\mathbf{s}}_2$</span>;</p></li><li><p><span>$\mathcal{R}_1 = \mathcal{R}(s_1)$</span>, ... is  computed by <code>func_‚Ñõ_GNC</code> in <code>cosmo::Cosmology</code> (and evaluated in <span>$s_1$</span> ); the definition of <span>$\mathcal{R}(s)$</span> is the following:</p><p class="math-container">\[\mathcal{R}(s) = 5 s_{\mathrm{b}}(s) + \frac{2 - 5 s_{\mathrm{b}}(s)}{\mathcal{H}(s) \, s} +  
\frac{\dot{\mathcal{H}}(s)}{\mathcal{H}(s)^2} - \mathit{f}_{\mathrm{evo}} \quad ;\]</p></li><li><p><span>$\mathfrak{R}_1 = \mathfrak{R}(s_1)$</span>, ... is  computed by <code>func_‚Ñõ_LD</code> in <code>cosmo::Cosmology</code> (and evaluated in <span>$s_1$</span> ); the definition of <span>$\mathcal{R}(s)$</span> is the following:</p><p class="math-container">\[\mathfrak{R}(s) = 1 - \frac{1}{\mathcal{H}(s) s} ;\]</p></li><li><p><span>$b_1$</span>, <span>$s_{\mathrm{b}, 1}$</span>, <span>$\mathit{f}_{\mathrm{evo}, 1}$</span>  (and <span>$b_2$</span>, <span>$s_{\mathrm{b}, 2}$</span>, <span>$\mathit{f}_{\mathrm{evo}, 2}$</span>) :  galaxy bias, magnification bias (i.e. the slope of the luminosity function at the luminosity threshold),  and evolution bias for the first (second) effect;</p></li><li><p><span>$\Omega_{\mathrm{M}0} = \Omega_{\mathrm{cdm}} + \Omega_{\mathrm{b}}$</span> is the sum of  cold-dark-matter and barionic density parameters (again, stored in <code>cosmo</code>);</p></li><li><p><span>$I_\ell^n$</span> and <span>$\sigma_i$</span> are defined as</p><p class="math-container">\[I_\ell^n(s) = \int_0^{+\infty} \frac{\mathrm{d}q}{2\pi^2} 
\, q^2 \, P(q) \, \frac{j_\ell(qs)}{(qs)^n} \quad , 
\quad \sigma_i = \int_0^{+\infty} \frac{\mathrm{d}q}{2\pi^2} 
\, q^{2-i} \, P(q)\]</p><p>with <span>$P(q)$</span> as the matter Power Spectrum at <span>$z=0$</span> (stored in <code>cosmo</code>)  and <span>$j_\ell$</span> as spherical Bessel function of order <span>$\ell$</span>;</p></li><li><p><span>$\tilde{I}_0^4$</span> is defined as</p><p class="math-container">\[\tilde{I}_0^4 = \int_0^{+\infty} \frac{\mathrm{d}q}{2\pi^2} 
\, q^2 \, P(q) \, \frac{j_0(qs) - 1}{(qs)^4}\]</p><p>with <span>$P(q)$</span> as the matter Power Spectrum at <span>$z=0$</span> (stored in <code>cosmo</code>)  and <span>$j_\ell$</span> as spherical Bessel function of order <span>$\ell$</span>;</p></li><li><p><span>$\mathcal{H}_0$</span>, <span>$f_0$</span> and so on are evaluated at the observer position (i.e. at present day);</p></li><li><p><span>$\Delta\chi_1 := \sqrt{\chi_1^2 + s_2^2-2\,\chi_1\,s_2\,y}$</span> and  <span>$\Delta\chi_2 := \sqrt{s_1^2 + \chi_2^2-2\,s_1\,\chi_2\,y}$</span>;</p></li><li><p><span>$s=\sqrt{s_1^2 + s_2^2 - 2 \, s_1 \, s_2 \, y}$</span> and  <span>$\Delta\chi := \sqrt{\chi_1^2 + \chi_2^2-2\,\chi_1\,\chi_2\,y}$</span>.</p></li></ul><p>This function is used inside <code>Œæ_GNCxLD_IntegratedGP_IntegratedGP</code> with the trapz() from the  <a href="https://github.com/francescoalemanno/Trapz.jl">Trapz</a> Julia package.</p><p><strong>Inputs</strong></p><ul><li><p><code>IP1::Point</code>, <code>IP2::Point</code>, <code>P1::Point</code>, <code>P2::Point</code> or <code>œá1</code>,<code>œá2</code>,<code>s1</code>,<code>s2</code>: <code>Point</code>/comoving  distances where the TPCF has to be calculated; they contain all the  data of interest needed for this calculus (comoving distance, growth factor and so on).</p></li><li><p><code>y</code>: the cosine of the angle between the two points <code>P1</code> and <code>P2</code> wrt the observer</p></li><li><p><code>cosmo::Cosmology</code>: cosmology to be used in this computation; it contains all the splines used for the conversion <code>s</code> -&gt; <code>Point</code>, and all the cosmological parameters <span>$b$</span>, ...</p></li></ul><p><strong>Keyword Arguments</strong></p><ul><li><p><code>b1=nothing</code>, <code>s_b1=nothing</code>, <code>ùëì_evo1=nothing</code> and <code>b2=nothing</code>, <code>s_b2=nothing</code>, <code>ùëì_evo2=nothing</code>: galaxy, magnification and evolutionary biases respectively for the first and the second effect  computed in this TPCF:</p><ul><li>if not set (i.e. if you leave the default value <code>nothing</code>) the values stored in the input <code>cosmo</code> will be considered;</li><li>if you set one or more values, they will override the <code>cosmo</code> ones in this computation;</li><li>the two sets of values should be different only if you are interested in studing two galaxy species;</li><li>only the required parameters for the chosen TPCF will be used, depending on its analytical expression; all the others will have no effect, we still inserted them for pragmatical code compatibilities. </li></ul></li><li><p><code>s_lim=nothing</code> : parameter used in order to avoid the divergence of the <span>$\mathcal{R}$</span> and  <span>$\mathfrak{R}$</span> denominators: when <span>$0 \leq s \leq s_\mathrm{lim}$</span> the returned values are</p><p class="math-container">\[\forall \, s \in [ 0, s_\mathrm{lim} ] \; : \quad 
    \mathfrak{R}(s) = 1 - \frac{1}{\mathcal{H}_0 \, s_\mathrm{lim}} \; , \quad
    \mathcal{R}(s) = 5 s_{\mathrm{b}} + 
        \frac{2 - 5 s_{\mathrm{b}}}{\mathcal{H}_0 \, s_\mathrm{lim}} +  
        \frac{\dot{\mathcal{H}}}{\mathcal{H}_0^2} - \mathit{f}_{\mathrm{evo}} \; .\]</p><p>If <code>nothing</code>, the fault value stored in <code>cosmo</code> will be considered.</p></li></ul><p>See also: <a href="../Cosmology/#GaPSE.Point"><code>Point</code></a>, <a href="../Cosmology/#GaPSE.Cosmology"><code>Cosmology</code></a>, <a href="#GaPSE.Œæ_GNCxLD_multipole"><code>Œæ_GNCxLD_multipole</code></a>,  <a href="#GaPSE.map_Œæ_GNCxLD_multipole"><code>map_Œæ_GNCxLD_multipole</code></a>, <a href="#GaPSE.print_map_Œæ_GNCxLD_multipole"><code>print_map_Œæ_GNCxLD_multipole</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/foglienimatteo/GaPSE.jl/blob/e601437c432ee08c2009b9fd4aee18390ba3e877/src/GNCxLD_CrossCorrelations/GNCxLD_IntegratedGPIntegratedGP.jl#L61-L216">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GaPSE.integrand_Œæ_GNCxLD_LocalGP_IntegratedGP" href="#GaPSE.integrand_Œæ_GNCxLD_LocalGP_IntegratedGP"><code>GaPSE.integrand_Œæ_GNCxLD_LocalGP_IntegratedGP</code></a> ‚Äî <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">integrand_Œæ_GNCxLD_LocalGP_IntegratedGP(
	IP::Point, P1::Point, P2::Point, y, cosmo::Cosmology;
	b1=nothing, b2=nothing, s_b1=nothing, s_b2=nothing,
	ùëì_evo1=nothing, ùëì_evo2=nothing, s_lim=nothing ) ::Float64

integrand_Œæ_GNCxLD_LocalGP_IntegratedGP(
	œá2::Float64, s1::Float64, s2::Float64,
	y, cosmo::Cosmology; kwargs... ) ::Float64</code></pre><p>Return the integrand of the Two-Point Correlation Function (TPCF) given by the cross correlation between the  Local Gravitational Potential (GP) effect arising from the Galaxy Number Counts (GNC) and the  Integrated GP one arising from the Luminosity Distance (LD) perturbations.</p><p>In the first method, you should pass the two extreme <code>Point</code>s (<code>P1</code> and <code>P2</code>) and the  intermediate integrand <code>Point</code> (<code>IP</code>) where to  evaluate the function. In the second method (that internally recalls the first), you must provide the three corresponding comoving distances <code>s1</code>, <code>s2</code>, <code>œá2</code>. We remember that all the distances are measured in <span>$h_0^{-1}\mathrm{Mpc}$</span>.</p><p>The analytical expression of this integrand is the following:</p><p class="math-container">\[\begin{split}
    f^{\phi \int\!\phi} (\chi_2, s_1 , s_2, y ) = 
    D_1 \,
    \mathfrak{J}^{\phi \int\!\phi}_{40} I_0^4 ( \Delta\chi_2 )  
    \,  ,
\end{split}\]</p><p>with</p><p class="math-container">\[\begin{split}
    \mathfrak{J}^{\phi \int\!\phi}_{40} &amp;=
    - \frac{
        3 \Delta\chi_2^4 \mathcal{H}_0^2 \Omega_{\mathrm{M}0} D(\chi_2) 
    }{
        2 s_2 a(\chi_2) a_1
    } \left[
        s_2 \mathcal{H}(\chi_2) \mathfrak{R}_2 ( f(\chi_2) - 1 ) - 1
    \right] 
    \times\\
    &amp;\qquad\qquad\qquad
    \left[
        2 a_1 f_1 \mathcal{H}_1^2 (\mathit{f}_{\mathrm{evo}, 1} - 3) +
        3 \mathcal{H}_0^2 \Omega_{\mathrm{M}0} (f_1 + \mathcal{R}_1 + 5 s_{\mathrm{b}, 1}  - 2)
    \right]
    \, ,
\end{split}\]</p><p>where:</p><ul><li><p><span>$s_1$</span> and <span>$s_2$</span> are comoving distances;</p></li><li><p><span>$D_1 = D(s_1)$</span>, ... is the linear growth factor (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$a_1 = a(s_1)$</span>, ... is the scale factor (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$f_1 = f(s_1)$</span>, ... is the linear growth rate (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$\mathcal{H}_1 = \mathcal{H}(s_1)$</span>, ... is the comoving  Hubble distances (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$y = \cos{\theta} = \hat{\mathbf{s}}_1 \cdot \hat{\mathbf{s}}_2$</span>;</p></li><li><p><span>$\mathcal{R}_1 = \mathcal{R}(s_1)$</span>, ... is  computed by <code>func_‚Ñõ_GNC</code> in <code>cosmo::Cosmology</code> (and evaluated in <span>$s_1$</span> ); the definition of <span>$\mathcal{R}(s)$</span> is the following:</p><p class="math-container">\[\mathcal{R}(s) = 5 s_{\mathrm{b}}(s) + \frac{2 - 5 s_{\mathrm{b}}(s)}{\mathcal{H}(s) \, s} +  
\frac{\dot{\mathcal{H}}(s)}{\mathcal{H}(s)^2} - \mathit{f}_{\mathrm{evo}} \quad ;\]</p></li><li><p><span>$\mathfrak{R}_1 = \mathfrak{R}(s_1)$</span>, ... is  computed by <code>func_‚Ñõ_LD</code> in <code>cosmo::Cosmology</code> (and evaluated in <span>$s_1$</span> ); the definition of <span>$\mathcal{R}(s)$</span> is the following:</p><p class="math-container">\[\mathfrak{R}(s) = 1 - \frac{1}{\mathcal{H}(s) s} ;\]</p></li><li><p><span>$b_1$</span>, <span>$s_{\mathrm{b}, 1}$</span>, <span>$\mathit{f}_{\mathrm{evo}, 1}$</span>  (and <span>$b_2$</span>, <span>$s_{\mathrm{b}, 2}$</span>, <span>$\mathit{f}_{\mathrm{evo}, 2}$</span>) :  galaxy bias, magnification bias (i.e. the slope of the luminosity function at the luminosity threshold),  and evolution bias for the first (second) effect;</p></li><li><p><span>$\Omega_{\mathrm{M}0} = \Omega_{\mathrm{cdm}} + \Omega_{\mathrm{b}}$</span> is the sum of  cold-dark-matter and barionic density parameters (again, stored in <code>cosmo</code>);</p></li><li><p><span>$I_\ell^n$</span> and <span>$\sigma_i$</span> are defined as</p><p class="math-container">\[I_\ell^n(s) = \int_0^{+\infty} \frac{\mathrm{d}q}{2\pi^2} 
\, q^2 \, P(q) \, \frac{j_\ell(qs)}{(qs)^n} \quad , 
\quad \sigma_i = \int_0^{+\infty} \frac{\mathrm{d}q}{2\pi^2} 
\, q^{2-i} \, P(q)\]</p><p>with <span>$P(q)$</span> as the matter Power Spectrum at <span>$z=0$</span> (stored in <code>cosmo</code>)  and <span>$j_\ell$</span> as spherical Bessel function of order <span>$\ell$</span>;</p></li><li><p><span>$\tilde{I}_0^4$</span> is defined as</p><p class="math-container">\[\tilde{I}_0^4 = \int_0^{+\infty} \frac{\mathrm{d}q}{2\pi^2} 
\, q^2 \, P(q) \, \frac{j_0(qs) - 1}{(qs)^4}\]</p><p>with <span>$P(q)$</span> as the matter Power Spectrum at <span>$z=0$</span> (stored in <code>cosmo</code>)  and <span>$j_\ell$</span> as spherical Bessel function of order <span>$\ell$</span>;</p></li><li><p><span>$\mathcal{H}_0$</span>, <span>$f_0$</span> and so on are evaluated at the observer position (i.e. at present day);</p></li><li><p><span>$\Delta\chi_1 := \sqrt{\chi_1^2 + s_2^2-2\,\chi_1\,s_2\,y}$</span> and  <span>$\Delta\chi_2 := \sqrt{s_1^2 + \chi_2^2-2\,s_1\,\chi_2\,y}$</span>;</p></li><li><p><span>$s=\sqrt{s_1^2 + s_2^2 - 2 \, s_1 \, s_2 \, y}$</span> and  <span>$\Delta\chi := \sqrt{\chi_1^2 + \chi_2^2-2\,\chi_1\,\chi_2\,y}$</span>.</p></li></ul><p>This function is used inside <code>Œæ_GNCxLD_LocalGP_IntegratedGP</code> with the trapz() from the  <a href="https://github.com/francescoalemanno/Trapz.jl">Trapz</a> Julia package.</p><p><strong>Inputs</strong></p><ul><li><p><code>IP::Point</code>, <code>P1::Point</code>, <code>P2::Point</code> or <code>œá2</code>,<code>s1</code>,<code>s2</code>: <code>Point</code>/comoving  distances where the TPCF has to be calculated; they contain all the  data of interest needed for this calculus (comoving distance, growth factor and so on).</p></li><li><p><code>y</code>: the cosine of the angle between the two points <code>P1</code> and <code>P2</code> wrt the observer</p></li><li><p><code>cosmo::Cosmology</code>: cosmology to be used in this computation; it contains all the splines used for the conversion <code>s</code> -&gt; <code>Point</code>, and all the cosmological parameters <span>$b$</span>, ...</p></li></ul><p><strong>Keyword Arguments</strong></p><ul><li><p><code>b1=nothing</code>, <code>s_b1=nothing</code>, <code>ùëì_evo1=nothing</code> and <code>b2=nothing</code>, <code>s_b2=nothing</code>, <code>ùëì_evo2=nothing</code>: galaxy, magnification and evolutionary biases respectively for the first and the second effect  computed in this TPCF:</p><ul><li>if not set (i.e. if you leave the default value <code>nothing</code>) the values stored in the input <code>cosmo</code> will be considered;</li><li>if you set one or more values, they will override the <code>cosmo</code> ones in this computation;</li><li>the two sets of values should be different only if you are interested in studing two galaxy species;</li><li>only the required parameters for the chosen TPCF will be used, depending on its analytical expression; all the others will have no effect, we still inserted them for pragmatical code compatibilities. </li></ul></li><li><p><code>s_lim=nothing</code> : parameter used in order to avoid the divergence of the <span>$\mathcal{R}$</span> and  <span>$\mathfrak{R}$</span> denominators: when <span>$0 \leq s \leq s_\mathrm{lim}$</span> the returned values are</p><p class="math-container">\[\forall \, s \in [ 0, s_\mathrm{lim} ] \; : \quad 
    \mathfrak{R}(s) = 1 - \frac{1}{\mathcal{H}_0 \, s_\mathrm{lim}} \; , \quad
    \mathcal{R}(s) = 5 s_{\mathrm{b}} + 
        \frac{2 - 5 s_{\mathrm{b}}}{\mathcal{H}_0 \, s_\mathrm{lim}} +  
        \frac{\dot{\mathcal{H}}}{\mathcal{H}_0^2} - \mathit{f}_{\mathrm{evo}} \; .\]</p><p>If <code>nothing</code>, the fault value stored in <code>cosmo</code> will be considered.</p></li></ul><p>See also: <a href="../Cosmology/#GaPSE.Point"><code>Point</code></a>, <a href="../Cosmology/#GaPSE.Cosmology"><code>Cosmology</code></a>, <a href="#GaPSE.Œæ_GNCxLD_multipole"><code>Œæ_GNCxLD_multipole</code></a>,  <a href="#GaPSE.map_Œæ_GNCxLD_multipole"><code>map_Œæ_GNCxLD_multipole</code></a>, <a href="#GaPSE.print_map_Œæ_GNCxLD_multipole"><code>print_map_Œæ_GNCxLD_multipole</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/foglienimatteo/GaPSE.jl/blob/e601437c432ee08c2009b9fd4aee18390ba3e877/src/GNCxLD_CrossCorrelations/GNCxLD_LocalGPIntegratedGP.jl#L60-L218">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GaPSE.integrand_Œæ_GNCxLD_IntegratedGP_Doppler" href="#GaPSE.integrand_Œæ_GNCxLD_IntegratedGP_Doppler"><code>GaPSE.integrand_Œæ_GNCxLD_IntegratedGP_Doppler</code></a> ‚Äî <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">integrand_Œæ_GNCxLD_IntegratedGP_Doppler(
	IP::Point, P1::Point, P2::Point, y, cosmo::Cosmology;
    b1=nothing, b2=nothing, s_b1=nothing, s_b2=nothing,
    ùëì_evo1=nothing, ùëì_evo2=nothing, s_lim=nothing ) ::Float64

integrand_Œæ_GNCxLD_IntegratedGP_Doppler(
    œá1::Float64, s1::Float64, s2::Float64,
    y, cosmo::Cosmology; kwargs... ) ::Float64</code></pre><p>Return the integrand of the Two-Point Correlation Function (TPCF) given by the cross correlation  between the Integrated Gravitational Potential (GP) effect arising from the  Galaxy Number Counts (GNC) and the Doppler one arising from the Luminosity Distance (LD) perturbations.</p><p>In the first method, you should pass the two extreme <code>Point</code>s (<code>P1</code> and <code>P2</code>) and the  intermediate integrand <code>Point</code> (<code>IP</code>) where to  evaluate the function. In the second method (that internally recalls the first), you must provide the three corresponding comoving distances <code>s1</code>, <code>s2</code>, <code>œá2</code>. We remember that all the distances are measured in <span>$h_0^{-1}\mathrm{Mpc}$</span>.</p><p>The analytical expression of this integrand is the following:</p><p class="math-container">\[\begin{split}
    f^{\int\!\phi \, v_{\parallel}} (\chi_1, s_1, s_2, y) =
    D_2 \mathfrak{J}^{\int\!\phi \, v_{\parallel}}_{31} \,I_1^3(\Delta\chi_1) \,
\end{split}\]</p><p>with</p><p class="math-container">\[\begin{split}
    \mathfrak{J}^{\int\!\phi \, v_{\parallel}}_{31} =
    - 3 f_2 \mathcal{H}_2 \mathfrak{R}_2  \mathcal{H}_0^2 \Omega_{\mathrm{M}0}
    \frac{
        D(\chi_1)(s_2 - \chi_1 y)
    }{
        a(\chi_1) s_1
    } \Delta\chi_1^2 \left[
    s_1 \mathcal{R}_1 \mathcal{H}(\chi_1)(f_1 - 1) - 5 s_{\mathrm{b}, 1} + 2
    \right] \, ,
\end{split}\]</p><p>where:</p><ul><li><p><span>$s_1$</span> and <span>$s_2$</span> are comoving distances;</p></li><li><p><span>$D_1 = D(s_1)$</span>, ... is the linear growth factor (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$a_1 = a(s_1)$</span>, ... is the scale factor (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$f_1 = f(s_1)$</span>, ... is the linear growth rate (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$\mathcal{H}_1 = \mathcal{H}(s_1)$</span>, ... is the comoving  Hubble distances (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$y = \cos{\theta} = \hat{\mathbf{s}}_1 \cdot \hat{\mathbf{s}}_2$</span>;</p></li><li><p><span>$\mathcal{R}_1 = \mathcal{R}(s_1)$</span>, ... is  computed by <code>func_‚Ñõ_GNC</code> in <code>cosmo::Cosmology</code> (and evaluated in <span>$s_1$</span> ); the definition of <span>$\mathcal{R}(s)$</span> is the following:</p><p class="math-container">\[\mathcal{R}(s) = 5 s_{\mathrm{b}}(s) + \frac{2 - 5 s_{\mathrm{b}}(s)}{\mathcal{H}(s) \, s} +  
\frac{\dot{\mathcal{H}}(s)}{\mathcal{H}(s)^2} - \mathit{f}_{\mathrm{evo}} \quad ;\]</p></li><li><p><span>$\mathfrak{R}_1 = \mathfrak{R}(s_1)$</span>, ... is  computed by <code>func_‚Ñõ_LD</code> in <code>cosmo::Cosmology</code> (and evaluated in <span>$s_1$</span> ); the definition of <span>$\mathcal{R}(s)$</span> is the following:</p><p class="math-container">\[\mathfrak{R}(s) = 1 - \frac{1}{\mathcal{H}(s) s} ;\]</p></li><li><p><span>$b_1$</span>, <span>$s_{\mathrm{b}, 1}$</span>, <span>$\mathit{f}_{\mathrm{evo}, 1}$</span>  (and <span>$b_2$</span>, <span>$s_{\mathrm{b}, 2}$</span>, <span>$\mathit{f}_{\mathrm{evo}, 2}$</span>) :  galaxy bias, magnification bias (i.e. the slope of the luminosity function at the luminosity threshold),  and evolution bias for the first (second) effect;</p></li><li><p><span>$\Omega_{\mathrm{M}0} = \Omega_{\mathrm{cdm}} + \Omega_{\mathrm{b}}$</span> is the sum of  cold-dark-matter and barionic density parameters (again, stored in <code>cosmo</code>);</p></li><li><p><span>$I_\ell^n$</span> and <span>$\sigma_i$</span> are defined as</p><p class="math-container">\[I_\ell^n(s) = \int_0^{+\infty} \frac{\mathrm{d}q}{2\pi^2} 
\, q^2 \, P(q) \, \frac{j_\ell(qs)}{(qs)^n} \quad , 
\quad \sigma_i = \int_0^{+\infty} \frac{\mathrm{d}q}{2\pi^2} 
\, q^{2-i} \, P(q)\]</p><p>with <span>$P(q)$</span> as the matter Power Spectrum at <span>$z=0$</span> (stored in <code>cosmo</code>)  and <span>$j_\ell$</span> as spherical Bessel function of order <span>$\ell$</span>;</p></li><li><p><span>$\tilde{I}_0^4$</span> is defined as</p><p class="math-container">\[\tilde{I}_0^4 = \int_0^{+\infty} \frac{\mathrm{d}q}{2\pi^2} 
\, q^2 \, P(q) \, \frac{j_0(qs) - 1}{(qs)^4}\]</p><p>with <span>$P(q)$</span> as the matter Power Spectrum at <span>$z=0$</span> (stored in <code>cosmo</code>)  and <span>$j_\ell$</span> as spherical Bessel function of order <span>$\ell$</span>;</p></li><li><p><span>$\mathcal{H}_0$</span>, <span>$f_0$</span> and so on are evaluated at the observer position (i.e. at present day);</p></li><li><p><span>$\Delta\chi_1 := \sqrt{\chi_1^2 + s_2^2-2\,\chi_1\,s_2\,y}$</span> and  <span>$\Delta\chi_2 := \sqrt{s_1^2 + \chi_2^2-2\,s_1\,\chi_2\,y}$</span>;</p></li><li><p><span>$s=\sqrt{s_1^2 + s_2^2 - 2 \, s_1 \, s_2 \, y}$</span> and  <span>$\Delta\chi := \sqrt{\chi_1^2 + \chi_2^2-2\,\chi_1\,\chi_2\,y}$</span>.</p></li></ul><p>This function is used inside <code>Œæ_GNCxLD_IntegratedGP_Doppler</code> with the trapz() from the  <a href="https://github.com/francescoalemanno/Trapz.jl">Trapz</a> Julia package.</p><p><strong>Inputs</strong></p><ul><li><p><code>IP::Point</code>, <code>P1::Point</code>, <code>P2::Point</code> or <code>œá1</code>,<code>s1</code>,<code>s2</code>: <code>Point</code>/comoving  distances where the TPCF has to be calculated; they contain all the  data of interest needed for this calculus (comoving distance, growth factor and so on).</p></li><li><p><code>y</code>: the cosine of the angle between the two points <code>P1</code> and <code>P2</code> wrt the observer</p></li><li><p><code>cosmo::Cosmology</code>: cosmology to be used in this computation; it contains all the splines used for the conversion <code>s</code> -&gt; <code>Point</code>, and all the cosmological parameters <span>$b$</span>, ...</p></li></ul><p><strong>Keyword Arguments</strong></p><ul><li><p><code>b1=nothing</code>, <code>s_b1=nothing</code>, <code>ùëì_evo1=nothing</code> and <code>b2=nothing</code>, <code>s_b2=nothing</code>, <code>ùëì_evo2=nothing</code>: galaxy, magnification and evolutionary biases respectively for the first and the second effect  computed in this TPCF:</p><ul><li>if not set (i.e. if you leave the default value <code>nothing</code>) the values stored in the input <code>cosmo</code> will be considered;</li><li>if you set one or more values, they will override the <code>cosmo</code> ones in this computation;</li><li>the two sets of values should be different only if you are interested in studing two galaxy species;</li><li>only the required parameters for the chosen TPCF will be used, depending on its analytical expression; all the others will have no effect, we still inserted them for pragmatical code compatibilities. </li></ul></li><li><p><code>s_lim=nothing</code> : parameter used in order to avoid the divergence of the <span>$\mathcal{R}$</span> and  <span>$\mathfrak{R}$</span> denominators: when <span>$0 \leq s \leq s_\mathrm{lim}$</span> the returned values are</p><p class="math-container">\[\forall \, s \in [ 0, s_\mathrm{lim} ] \; : \quad 
    \mathfrak{R}(s) = 1 - \frac{1}{\mathcal{H}_0 \, s_\mathrm{lim}} \; , \quad
    \mathcal{R}(s) = 5 s_{\mathrm{b}} + 
        \frac{2 - 5 s_{\mathrm{b}}}{\mathcal{H}_0 \, s_\mathrm{lim}} +  
        \frac{\dot{\mathcal{H}}}{\mathcal{H}_0^2} - \mathit{f}_{\mathrm{evo}} \; .\]</p><p>If <code>nothing</code>, the fault value stored in <code>cosmo</code> will be considered.</p></li></ul><p>See also: <a href="../Cosmology/#GaPSE.Point"><code>Point</code></a>, <a href="../Cosmology/#GaPSE.Cosmology"><code>Cosmology</code></a>, <a href="#GaPSE.Œæ_GNCxLD_multipole"><code>Œæ_GNCxLD_multipole</code></a>,  <a href="#GaPSE.map_Œæ_GNCxLD_multipole"><code>map_Œæ_GNCxLD_multipole</code></a>, <a href="#GaPSE.print_map_Œæ_GNCxLD_multipole"><code>print_map_Œæ_GNCxLD_multipole</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/foglienimatteo/GaPSE.jl/blob/e601437c432ee08c2009b9fd4aee18390ba3e877/src/GNCxLD_CrossCorrelations/GNCxLD_IntegratedGPDoppler.jl#L62-L213">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GaPSE.integrand_Œæ_GNCxLD_Newtonian_Lensing" href="#GaPSE.integrand_Œæ_GNCxLD_Newtonian_Lensing"><code>GaPSE.integrand_Œæ_GNCxLD_Newtonian_Lensing</code></a> ‚Äî <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">integrand_Œæ_GNCxLD_Newtonian_Lensing(
    IP::Point, P1::Point, P2::Point, y, cosmo::Cosmology;
    b1=nothing, b2=nothing, s_b1=nothing, s_b2=nothing,
    ùëì_evo1=nothing, ùëì_evo2=nothing, s_lim=nothing ) ::Float64

integrand_Œæ_GNCxLD_Newtonian_Lensing(
    œá2::Float64, s1::Float64, s2::Float64,
    y, cosmo::Cosmology; kwargs... ) ::Float64</code></pre><p>Return the integrand of the Two-Point Correlation Function (TPCF) given by the cross correlation  between the Newtonian effect arising from the Galaxy Number Counts (GNC) and the Lensing  one arising from the Luminosity Distance (LD) perturbations.</p><p>In the first method, you should pass the two extreme <code>Point</code>s (<code>P1</code> and <code>P2</code>) and the  intermediate integrand <code>Point</code> (<code>IP</code>) where to  evaluate the function. In the second method (that internally recalls the first), you must provide the three corresponding comoving distances <code>s1</code>, <code>s2</code>, <code>œá2</code>. We remember that all the distances are measured in <span>$h_0^{-1}\mathrm{Mpc}$</span>.</p><p>The analytical expression of this integrand is the following:</p><p class="math-container">\[\begin{split}
    f^{\delta \kappa} (\chi_2, s_1 , s_2, y ) =
    D_1  \; 
    \mathfrak{J}^{\delta \kappa}_{\alpha}
    \left[ 
        \mathfrak{J}^{\delta \kappa}_{00} I_0^0 ( \Delta\chi_2 ) + 
        \mathfrak{J}^{\delta \kappa}_{02} I_2^0 ( \Delta \chi_2 ) + 
        \mathfrak{J}^{\delta \kappa}_{00} I_4^0 ( \Delta \chi_2 ) 
    \right] \, ,
\end{split}\]</p><p>with</p><p class="math-container">\[\begin{split}
    \mathfrak{J}^{\delta \kappa}_{\alpha} &amp;=
    - \frac{
        \mathcal{H}_0 ^2 \Omega_{\mathrm{M}0} D(\chi_2)
    }{
        a(\chi_2 ) s_2
    } 
    (\chi_2 - s_2 )
    \, , \\
    %%%%%%%%%%%%%%%%%%%%%%%%
    \mathfrak{J}^{\delta \kappa}_{00} &amp;=
        \frac{1}{5}
        \left[
            (3 y^2 - 1) \chi_2 f_1 - y s_1(3 f_1 + 5 b_1) 
        \right] 
    \, , \\
    %%%%%%%%%%%%%%%%%%%%%%%%
    \mathfrak{J}^{\delta \kappa}_{02} &amp;=
        \frac{1}{14 \Delta\chi_2^2} 
        \left\{
            4 f_1 (3 y^2 - 1) \chi_2^3 - 
            2 y 
            \left[
                (3 y^2 + 8) f_1 + 7 b_1
            \right] s_1 \chi_2^2 +
            \right. \nonumber \\
            &amp;\left.\qquad \qquad\qquad
            \left[
                (9 y^2 + 11) f_1 - 7 (y^2 + 3) b_1
            \right] s_1^2 \chi_2 -
            2 y \left[7 b_1 + 3 f_1 \right] s_1^3
        \right\} 
    \, , \\
    %%%%%%%%%%%%%%%%%%%%%%%%
    \mathfrak{J}^{\delta \kappa}_{04} &amp;=
    \frac{f_1}{70 \Delta\chi_2^4 }
    \left\{
        (6 y^2 - 2) \chi_2^5 +
        6 y (y^2 - 3) s_1 \chi_2^4 -
        (y^4 + 12 y^2 - 21) s_1^2 \chi_2^3 +
        \right.\nonumber \\
        &amp;\left.\qquad\qquad\qquad
        2 y (y^2 + 3) s_1^3 \chi_2^2 -
        12 \chi_2 s_1^4 + 
        4 y s_1 ^5
    \right\} 
    \, ,
\end{split}\]</p><p>where:</p><ul><li><p><span>$s_1$</span> and <span>$s_2$</span> are comoving distances;</p></li><li><p><span>$D_1 = D(s_1)$</span>, ... is the linear growth factor (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$a_1 = a(s_1)$</span>, ... is the scale factor (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$f_1 = f(s_1)$</span>, ... is the linear growth rate (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$\mathcal{H}_1 = \mathcal{H}(s_1)$</span>, ... is the comoving  Hubble distances (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$y = \cos{\theta} = \hat{\mathbf{s}}_1 \cdot \hat{\mathbf{s}}_2$</span>;</p></li><li><p><span>$\mathcal{R}_1 = \mathcal{R}(s_1)$</span>, ... is  computed by <code>func_‚Ñõ_GNC</code> in <code>cosmo::Cosmology</code> (and evaluated in <span>$s_1$</span> ); the definition of <span>$\mathcal{R}(s)$</span> is the following:</p><p class="math-container">\[\mathcal{R}(s) = 5 s_{\mathrm{b}}(s) + \frac{2 - 5 s_{\mathrm{b}}(s)}{\mathcal{H}(s) \, s} +  
\frac{\dot{\mathcal{H}}(s)}{\mathcal{H}(s)^2} - \mathit{f}_{\mathrm{evo}} \quad ;\]</p></li><li><p><span>$\mathfrak{R}_1 = \mathfrak{R}(s_1)$</span>, ... is  computed by <code>func_‚Ñõ_LD</code> in <code>cosmo::Cosmology</code> (and evaluated in <span>$s_1$</span> ); the definition of <span>$\mathcal{R}(s)$</span> is the following:</p><p class="math-container">\[\mathfrak{R}(s) = 1 - \frac{1}{\mathcal{H}(s) s} ;\]</p></li><li><p><span>$b_1$</span>, <span>$s_{\mathrm{b}, 1}$</span>, <span>$\mathit{f}_{\mathrm{evo}, 1}$</span>  (and <span>$b_2$</span>, <span>$s_{\mathrm{b}, 2}$</span>, <span>$\mathit{f}_{\mathrm{evo}, 2}$</span>) :  galaxy bias, magnification bias (i.e. the slope of the luminosity function at the luminosity threshold),  and evolution bias for the first (second) effect;</p></li><li><p><span>$\Omega_{\mathrm{M}0} = \Omega_{\mathrm{cdm}} + \Omega_{\mathrm{b}}$</span> is the sum of  cold-dark-matter and barionic density parameters (again, stored in <code>cosmo</code>);</p></li><li><p><span>$I_\ell^n$</span> and <span>$\sigma_i$</span> are defined as</p><p class="math-container">\[I_\ell^n(s) = \int_0^{+\infty} \frac{\mathrm{d}q}{2\pi^2} 
\, q^2 \, P(q) \, \frac{j_\ell(qs)}{(qs)^n} \quad , 
\quad \sigma_i = \int_0^{+\infty} \frac{\mathrm{d}q}{2\pi^2} 
\, q^{2-i} \, P(q)\]</p><p>with <span>$P(q)$</span> as the matter Power Spectrum at <span>$z=0$</span> (stored in <code>cosmo</code>)  and <span>$j_\ell$</span> as spherical Bessel function of order <span>$\ell$</span>;</p></li><li><p><span>$\tilde{I}_0^4$</span> is defined as</p><p class="math-container">\[\tilde{I}_0^4 = \int_0^{+\infty} \frac{\mathrm{d}q}{2\pi^2} 
\, q^2 \, P(q) \, \frac{j_0(qs) - 1}{(qs)^4}\]</p><p>with <span>$P(q)$</span> as the matter Power Spectrum at <span>$z=0$</span> (stored in <code>cosmo</code>)  and <span>$j_\ell$</span> as spherical Bessel function of order <span>$\ell$</span>;</p></li><li><p><span>$\mathcal{H}_0$</span>, <span>$f_0$</span> and so on are evaluated at the observer position (i.e. at present day);</p></li><li><p><span>$\Delta\chi_1 := \sqrt{\chi_1^2 + s_2^2-2\,\chi_1\,s_2\,y}$</span> and  <span>$\Delta\chi_2 := \sqrt{s_1^2 + \chi_2^2-2\,s_1\,\chi_2\,y}$</span>;</p></li><li><p><span>$s=\sqrt{s_1^2 + s_2^2 - 2 \, s_1 \, s_2 \, y}$</span> and  <span>$\Delta\chi := \sqrt{\chi_1^2 + \chi_2^2-2\,\chi_1\,\chi_2\,y}$</span>.</p></li></ul><p>This function is used inside <code>Œæ_GNCxLD_Newtonian_Lensing</code> with the trapz() from the  <a href="https://github.com/francescoalemanno/Trapz.jl">Trapz</a> Julia package.</p><p><strong>Inputs</strong></p><ul><li><p><code>IP::Point</code>, <code>P1::Point</code>, <code>P2::Point</code> or <code>œá2</code>,<code>s1</code>,<code>s2</code>: <code>Point</code>/comoving  distances where the TPCF has to be calculated; they contain all the  data of interest needed for this calculus (comoving distance, growth factor and so on).</p></li><li><p><code>y</code>: the cosine of the angle between the two points <code>P1</code> and <code>P2</code> wrt the observer</p></li><li><p><code>cosmo::Cosmology</code>: cosmology to be used in this computation; it contains all the splines used for the conversion <code>s</code> -&gt; <code>Point</code>, and all the cosmological parameters <span>$b$</span>, ...</p></li></ul><p><strong>Keyword Arguments</strong></p><ul><li><p><code>b1=nothing</code>, <code>s_b1=nothing</code>, <code>ùëì_evo1=nothing</code> and <code>b2=nothing</code>, <code>s_b2=nothing</code>, <code>ùëì_evo2=nothing</code>: galaxy, magnification and evolutionary biases respectively for the first and the second effect  computed in this TPCF:</p><ul><li>if not set (i.e. if you leave the default value <code>nothing</code>) the values stored in the input <code>cosmo</code> will be considered;</li><li>if you set one or more values, they will override the <code>cosmo</code> ones in this computation;</li><li>the two sets of values should be different only if you are interested in studing two galaxy species;</li><li>only the required parameters for the chosen TPCF will be used, depending on its analytical expression; all the others will have no effect, we still inserted them for pragmatical code compatibilities. </li></ul></li><li><p><code>s_lim=nothing</code> : parameter used in order to avoid the divergence of the <span>$\mathcal{R}$</span> and  <span>$\mathfrak{R}$</span> denominators: when <span>$0 \leq s \leq s_\mathrm{lim}$</span> the returned values are</p><p class="math-container">\[\forall \, s \in [ 0, s_\mathrm{lim} ] \; : \quad 
    \mathfrak{R}(s) = 1 - \frac{1}{\mathcal{H}_0 \, s_\mathrm{lim}} \; , \quad
    \mathcal{R}(s) = 5 s_{\mathrm{b}} + 
        \frac{2 - 5 s_{\mathrm{b}}}{\mathcal{H}_0 \, s_\mathrm{lim}} +  
        \frac{\dot{\mathcal{H}}}{\mathcal{H}_0^2} - \mathit{f}_{\mathrm{evo}} \; .\]</p><p>If <code>nothing</code>, the fault value stored in <code>cosmo</code> will be considered.</p></li></ul><p>See also: <a href="../Cosmology/#GaPSE.Point"><code>Point</code></a>, <a href="../Cosmology/#GaPSE.Cosmology"><code>Cosmology</code></a>, <a href="#GaPSE.Œæ_GNCxLD_multipole"><code>Œæ_GNCxLD_multipole</code></a>,  <a href="#GaPSE.map_Œæ_GNCxLD_multipole"><code>map_Œæ_GNCxLD_multipole</code></a>, <a href="#GaPSE.print_map_Œæ_GNCxLD_multipole"><code>print_map_Œæ_GNCxLD_multipole</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/foglienimatteo/GaPSE.jl/blob/e601437c432ee08c2009b9fd4aee18390ba3e877/src/GNCxLD_CrossCorrelations/GNCxLD_NewtonianLensing.jl#L75-L267">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GaPSE.integrand_Œæ_GNCxLD_Lensing_IntegratedGP" href="#GaPSE.integrand_Œæ_GNCxLD_Lensing_IntegratedGP"><code>GaPSE.integrand_Œæ_GNCxLD_Lensing_IntegratedGP</code></a> ‚Äî <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">integrand_Œæ_GNCxLD_Lensing_IntegratedGP(
    IP1::Point, IP2::Point, P1::Point, P2::Point, y, cosmo::Cosmology;
    b1=nothing, b2=nothing, s_b1=nothing, s_b2=nothing,
    ùëì_evo1=nothing, ùëì_evo2=nothing, s_lim=nothing ) ::Float64

integrand_Œæ_GNCxLD_Lensing_IntegratedGP(
    œá1::Float64, œá2::Float64,
    s1::Float64, s2::Float64,
    y, cosmo::Cosmology;
    kwargs... ) ::Float64</code></pre><p>Return the integrand of the Two-Point Correlation Function (TPCF) given by the cross correlation  between the Lensing effect arising from the  Galaxy Number Counts (GNC) and the Integrated Gravitational Potential (GP) one arising from the Luminosity Distance (LD) perturbations.</p><p>In the first method, you should pass the two extreme <code>Point</code>s (<code>P1</code> and <code>P2</code>) and the  two intermediate integrand <code>Point</code>s (<code>IP1</code> and <code>IP2</code>) where to  evaluate the function. In the second method (that internally recalls the first), you must provide the three corresponding comoving distances <code>s1</code>, <code>s2</code>, <code>œá1</code>, <code>œá2</code>. We remember that all the distances are measured in <span>$h_0^{-1}\mathrm{Mpc}$</span>.</p><p>The analytical expression of this integrand is the following:</p><p class="math-container">\[\begin{split}
    f^{\kappa\int\!\phi} (\chi_1, \chi_2, s_1, s_2, y) = 
    \mathfrak{J}^{\kappa\int\!\phi}_{\alpha}
    \left[ 
        \mathfrak{J}^{\kappa\int\!\phi}_{31} I_1^3(\Delta\chi) + 
        \mathfrak{J}^{\kappa\int\!\phi}_{22} I_2^2(\Delta\chi) 
     \right] \,  ,
\end{split}\]</p><p>with</p><p class="math-container">\[\begin{split}
    \mathfrak{J}^{\kappa\int\!\phi}_{\alpha} &amp; =
    \frac{9}{2} \mathcal{H}_0^4 \Omega_{\mathrm{M}0}^2 
    \frac{
        D(\chi_1) D(\chi_2) \chi_2 (s_1 - \chi_1)
        }{
        s_1 s_2 a(\chi_1) a(\chi_2)
    } (5 s_{\mathrm{b}, 1}  - 2 )
    \left[
        s_2 \mathfrak{R}_2 \mathcal{H}(\chi_2) (f(\chi_2) - 1) - 1
    \right]
    \, , \\
    %%%%%%%%%%%%%%%%%%%%%%%%
    \mathfrak{J}^{\kappa\int\!\phi}_{31} &amp; = -2 y \Delta\chi^2
    \, , \\
    %%%%%%%%%%%%%%%%%%%%%%%%
    \mathfrak{J}^{\kappa\int\!\phi}_{22} &amp; = \chi_1 \chi_2(1 - y^2) 
    \,  ,
\end{split}\]</p><p>where:</p><ul><li><p><span>$s_1$</span> and <span>$s_2$</span> are comoving distances;</p></li><li><p><span>$D_1 = D(s_1)$</span>, ... is the linear growth factor (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$a_1 = a(s_1)$</span>, ... is the scale factor (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$f_1 = f(s_1)$</span>, ... is the linear growth rate (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$\mathcal{H}_1 = \mathcal{H}(s_1)$</span>, ... is the comoving  Hubble distances (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$y = \cos{\theta} = \hat{\mathbf{s}}_1 \cdot \hat{\mathbf{s}}_2$</span>;</p></li><li><p><span>$\mathcal{R}_1 = \mathcal{R}(s_1)$</span>, ... is  computed by <code>func_‚Ñõ_GNC</code> in <code>cosmo::Cosmology</code> (and evaluated in <span>$s_1$</span> ); the definition of <span>$\mathcal{R}(s)$</span> is the following:</p><p class="math-container">\[\mathcal{R}(s) = 5 s_{\mathrm{b}}(s) + \frac{2 - 5 s_{\mathrm{b}}(s)}{\mathcal{H}(s) \, s} +  
\frac{\dot{\mathcal{H}}(s)}{\mathcal{H}(s)^2} - \mathit{f}_{\mathrm{evo}} \quad ;\]</p></li><li><p><span>$\mathfrak{R}_1 = \mathfrak{R}(s_1)$</span>, ... is  computed by <code>func_‚Ñõ_LD</code> in <code>cosmo::Cosmology</code> (and evaluated in <span>$s_1$</span> ); the definition of <span>$\mathcal{R}(s)$</span> is the following:</p><p class="math-container">\[\mathfrak{R}(s) = 1 - \frac{1}{\mathcal{H}(s) s} ;\]</p></li><li><p><span>$b_1$</span>, <span>$s_{\mathrm{b}, 1}$</span>, <span>$\mathit{f}_{\mathrm{evo}, 1}$</span>  (and <span>$b_2$</span>, <span>$s_{\mathrm{b}, 2}$</span>, <span>$\mathit{f}_{\mathrm{evo}, 2}$</span>) :  galaxy bias, magnification bias (i.e. the slope of the luminosity function at the luminosity threshold),  and evolution bias for the first (second) effect;</p></li><li><p><span>$\Omega_{\mathrm{M}0} = \Omega_{\mathrm{cdm}} + \Omega_{\mathrm{b}}$</span> is the sum of  cold-dark-matter and barionic density parameters (again, stored in <code>cosmo</code>);</p></li><li><p><span>$I_\ell^n$</span> and <span>$\sigma_i$</span> are defined as</p><p class="math-container">\[I_\ell^n(s) = \int_0^{+\infty} \frac{\mathrm{d}q}{2\pi^2} 
\, q^2 \, P(q) \, \frac{j_\ell(qs)}{(qs)^n} \quad , 
\quad \sigma_i = \int_0^{+\infty} \frac{\mathrm{d}q}{2\pi^2} 
\, q^{2-i} \, P(q)\]</p><p>with <span>$P(q)$</span> as the matter Power Spectrum at <span>$z=0$</span> (stored in <code>cosmo</code>)  and <span>$j_\ell$</span> as spherical Bessel function of order <span>$\ell$</span>;</p></li><li><p><span>$\tilde{I}_0^4$</span> is defined as</p><p class="math-container">\[\tilde{I}_0^4 = \int_0^{+\infty} \frac{\mathrm{d}q}{2\pi^2} 
\, q^2 \, P(q) \, \frac{j_0(qs) - 1}{(qs)^4}\]</p><p>with <span>$P(q)$</span> as the matter Power Spectrum at <span>$z=0$</span> (stored in <code>cosmo</code>)  and <span>$j_\ell$</span> as spherical Bessel function of order <span>$\ell$</span>;</p></li><li><p><span>$\mathcal{H}_0$</span>, <span>$f_0$</span> and so on are evaluated at the observer position (i.e. at present day);</p></li><li><p><span>$\Delta\chi_1 := \sqrt{\chi_1^2 + s_2^2-2\,\chi_1\,s_2\,y}$</span> and  <span>$\Delta\chi_2 := \sqrt{s_1^2 + \chi_2^2-2\,s_1\,\chi_2\,y}$</span>;</p></li><li><p><span>$s=\sqrt{s_1^2 + s_2^2 - 2 \, s_1 \, s_2 \, y}$</span> and  <span>$\Delta\chi := \sqrt{\chi_1^2 + \chi_2^2-2\,\chi_1\,\chi_2\,y}$</span>.</p></li></ul><p>This function is used inside <code>Œæ_GNCxLD_Lensing_IntegratedGP</code> with the trapz() from the  <a href="https://github.com/francescoalemanno/Trapz.jl">Trapz</a> Julia package.</p><p><strong>Inputs</strong></p><ul><li><p><code>IP1::Point</code>, <code>IP2::Point</code>, <code>P1::Point</code>, <code>P2::Point</code> or <code>œá1</code>,<code>œá2</code>,<code>s1</code>,<code>s2</code>: <code>Point</code>/comoving  distances where the TPCF has to be calculated; they contain all the  data of interest needed for this calculus (comoving distance, growth factor and so on).</p></li><li><p><code>y</code>: the cosine of the angle between the two points <code>P1</code> and <code>P2</code> wrt the observer</p></li><li><p><code>cosmo::Cosmology</code>: cosmology to be used in this computation; it contains all the splines used for the conversion <code>s</code> -&gt; <code>Point</code>, and all the cosmological parameters <span>$b$</span>, ...</p></li></ul><p><strong>Keyword Arguments</strong></p><ul><li><p><code>b1=nothing</code>, <code>s_b1=nothing</code>, <code>ùëì_evo1=nothing</code> and <code>b2=nothing</code>, <code>s_b2=nothing</code>, <code>ùëì_evo2=nothing</code>: galaxy, magnification and evolutionary biases respectively for the first and the second effect  computed in this TPCF:</p><ul><li>if not set (i.e. if you leave the default value <code>nothing</code>) the values stored in the input <code>cosmo</code> will be considered;</li><li>if you set one or more values, they will override the <code>cosmo</code> ones in this computation;</li><li>the two sets of values should be different only if you are interested in studing two galaxy species;</li><li>only the required parameters for the chosen TPCF will be used, depending on its analytical expression; all the others will have no effect, we still inserted them for pragmatical code compatibilities. </li></ul></li><li><p><code>s_lim=nothing</code> : parameter used in order to avoid the divergence of the <span>$\mathcal{R}$</span> and  <span>$\mathfrak{R}$</span> denominators: when <span>$0 \leq s \leq s_\mathrm{lim}$</span> the returned values are</p><p class="math-container">\[\forall \, s \in [ 0, s_\mathrm{lim} ] \; : \quad 
    \mathfrak{R}(s) = 1 - \frac{1}{\mathcal{H}_0 \, s_\mathrm{lim}} \; , \quad
    \mathcal{R}(s) = 5 s_{\mathrm{b}} + 
        \frac{2 - 5 s_{\mathrm{b}}}{\mathcal{H}_0 \, s_\mathrm{lim}} +  
        \frac{\dot{\mathcal{H}}}{\mathcal{H}_0^2} - \mathit{f}_{\mathrm{evo}} \; .\]</p><p>If <code>nothing</code>, the fault value stored in <code>cosmo</code> will be considered.</p></li></ul><p>See also: <a href="../Cosmology/#GaPSE.Point"><code>Point</code></a>, <a href="../Cosmology/#GaPSE.Cosmology"><code>Cosmology</code></a>, <a href="#GaPSE.Œæ_GNCxLD_multipole"><code>Œæ_GNCxLD_multipole</code></a>,  <a href="#GaPSE.map_Œæ_GNCxLD_multipole"><code>map_Œæ_GNCxLD_multipole</code></a>, <a href="#GaPSE.print_map_Œæ_GNCxLD_multipole"><code>print_map_Œæ_GNCxLD_multipole</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/foglienimatteo/GaPSE.jl/blob/e601437c432ee08c2009b9fd4aee18390ba3e877/src/GNCxLD_CrossCorrelations/GNCxLD_LensingIntegratedGP.jl#L65-L228">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GaPSE.integrand_Œæ_GNCxLD_Doppler_IntegratedGP" href="#GaPSE.integrand_Œæ_GNCxLD_Doppler_IntegratedGP"><code>GaPSE.integrand_Œæ_GNCxLD_Doppler_IntegratedGP</code></a> ‚Äî <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">integrand_Œæ_GNCxLD_Doppler_IntegratedGP(
    IP::Point, P1::Point, P2::Point, y, cosmo::Cosmology; 
    b1=nothing, b2=nothing, s_b1=nothing, s_b2=nothing,
    ùëì_evo1=nothing, ùëì_evo2=nothing, s_lim=nothing ) ::Float64

integrand_Œæ_GNCxLD_Doppler_IntegratedGP(
    œá2::Float64, s1::Float64, s2::Float64,
    y, cosmo::Cosmology; kwargs... ) ::Float64</code></pre><p>Return the integrand of the Two-Point Correlation Function (TPCF) given by the cross correlation  between the Doppler effect arising from the Galaxy Number Counts (GNC) and the Integrated  Gravitational Potential (GP) one arising from the Luminosity Distance (LD) perturbations.</p><p>In the first method, you should pass the two extreme <code>Point</code>s (<code>P1</code> and <code>P2</code>) and the  intermediate integrand <code>Point</code> (<code>IP</code>) where to  evaluate the function. In the second method (that internally recalls the first), you must provide the three corresponding comoving distances <code>s1</code>, <code>s2</code>, <code>œá2</code>. We remember that all the distances are measured in <span>$h_0^{-1}\mathrm{Mpc}$</span>.</p><p>The analytical expression of this integrand is the following:</p><p class="math-container">\[\begin{split}
    f^{v_{\parallel} \int\!\phi} (\chi_2, s_1, s_2, y) =
    D_1 \mathfrak{J}^{v_{\parallel} \int\!\phi}_{31} \,I_1^3(\Delta\chi_2) \, ,
\end{split}\]</p><p>with</p><p class="math-container">\[\begin{split}
    \mathfrak{J}^{v_{\parallel} \int\!\phi}_{31} =
    3 f_1 \mathcal{H}_1 \mathcal{R}_1 \mathcal{H}_0^2 \Omega_{\mathrm{M}0}
    \frac{
        D(\chi_2)(\chi_2 y - s_1)
    }{
        a(\chi_2) s_2
    } \Delta\chi_2^2 \left[
    s_2 \mathfrak{R}_2 \mathcal{H}(\chi_2)(f_2 -1) - 1 
    \right] \, ,
\end{split}\]</p><p>where:</p><ul><li><p><span>$s_1$</span> and <span>$s_2$</span> are comoving distances;</p></li><li><p><span>$D_1 = D(s_1)$</span>, ... is the linear growth factor (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$a_1 = a(s_1)$</span>, ... is the scale factor (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$f_1 = f(s_1)$</span>, ... is the linear growth rate (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$\mathcal{H}_1 = \mathcal{H}(s_1)$</span>, ... is the comoving  Hubble distances (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$y = \cos{\theta} = \hat{\mathbf{s}}_1 \cdot \hat{\mathbf{s}}_2$</span>;</p></li><li><p><span>$\mathcal{R}_1 = \mathcal{R}(s_1)$</span>, ... is  computed by <code>func_‚Ñõ_GNC</code> in <code>cosmo::Cosmology</code> (and evaluated in <span>$s_1$</span> ); the definition of <span>$\mathcal{R}(s)$</span> is the following:</p><p class="math-container">\[\mathcal{R}(s) = 5 s_{\mathrm{b}}(s) + \frac{2 - 5 s_{\mathrm{b}}(s)}{\mathcal{H}(s) \, s} +  
\frac{\dot{\mathcal{H}}(s)}{\mathcal{H}(s)^2} - \mathit{f}_{\mathrm{evo}} \quad ;\]</p></li><li><p><span>$\mathfrak{R}_1 = \mathfrak{R}(s_1)$</span>, ... is  computed by <code>func_‚Ñõ_LD</code> in <code>cosmo::Cosmology</code> (and evaluated in <span>$s_1$</span> ); the definition of <span>$\mathcal{R}(s)$</span> is the following:</p><p class="math-container">\[\mathfrak{R}(s) = 1 - \frac{1}{\mathcal{H}(s) s} ;\]</p></li><li><p><span>$b_1$</span>, <span>$s_{\mathrm{b}, 1}$</span>, <span>$\mathit{f}_{\mathrm{evo}, 1}$</span>  (and <span>$b_2$</span>, <span>$s_{\mathrm{b}, 2}$</span>, <span>$\mathit{f}_{\mathrm{evo}, 2}$</span>) :  galaxy bias, magnification bias (i.e. the slope of the luminosity function at the luminosity threshold),  and evolution bias for the first (second) effect;</p></li><li><p><span>$\Omega_{\mathrm{M}0} = \Omega_{\mathrm{cdm}} + \Omega_{\mathrm{b}}$</span> is the sum of  cold-dark-matter and barionic density parameters (again, stored in <code>cosmo</code>);</p></li><li><p><span>$I_\ell^n$</span> and <span>$\sigma_i$</span> are defined as</p><p class="math-container">\[I_\ell^n(s) = \int_0^{+\infty} \frac{\mathrm{d}q}{2\pi^2} 
\, q^2 \, P(q) \, \frac{j_\ell(qs)}{(qs)^n} \quad , 
\quad \sigma_i = \int_0^{+\infty} \frac{\mathrm{d}q}{2\pi^2} 
\, q^{2-i} \, P(q)\]</p><p>with <span>$P(q)$</span> as the matter Power Spectrum at <span>$z=0$</span> (stored in <code>cosmo</code>)  and <span>$j_\ell$</span> as spherical Bessel function of order <span>$\ell$</span>;</p></li><li><p><span>$\tilde{I}_0^4$</span> is defined as</p><p class="math-container">\[\tilde{I}_0^4 = \int_0^{+\infty} \frac{\mathrm{d}q}{2\pi^2} 
\, q^2 \, P(q) \, \frac{j_0(qs) - 1}{(qs)^4}\]</p><p>with <span>$P(q)$</span> as the matter Power Spectrum at <span>$z=0$</span> (stored in <code>cosmo</code>)  and <span>$j_\ell$</span> as spherical Bessel function of order <span>$\ell$</span>;</p></li><li><p><span>$\mathcal{H}_0$</span>, <span>$f_0$</span> and so on are evaluated at the observer position (i.e. at present day);</p></li><li><p><span>$\Delta\chi_1 := \sqrt{\chi_1^2 + s_2^2-2\,\chi_1\,s_2\,y}$</span> and  <span>$\Delta\chi_2 := \sqrt{s_1^2 + \chi_2^2-2\,s_1\,\chi_2\,y}$</span>;</p></li><li><p><span>$s=\sqrt{s_1^2 + s_2^2 - 2 \, s_1 \, s_2 \, y}$</span> and  <span>$\Delta\chi := \sqrt{\chi_1^2 + \chi_2^2-2\,\chi_1\,\chi_2\,y}$</span>.</p></li></ul><p>This function is used inside <code>Œæ_GNCxLD_Doppler_IntegratedGP</code> with the trapz() from the  <a href="https://github.com/francescoalemanno/Trapz.jl">Trapz</a> Julia package.</p><p><strong>Inputs</strong></p><ul><li><p><code>IP::Point</code>, <code>P1::Point</code>, <code>P2::Point</code> or <code>œá2</code>,<code>s1</code>,<code>s2</code>: <code>Point</code>/comoving  distances where the TPCF has to be calculated; they contain all the  data of interest needed for this calculus (comoving distance, growth factor and so on).</p></li><li><p><code>y</code>: the cosine of the angle between the two points <code>P1</code> and <code>P2</code> wrt the observer</p></li><li><p><code>cosmo::Cosmology</code>: cosmology to be used in this computation; it contains all the splines used for the conversion <code>s</code> -&gt; <code>Point</code>, and all the cosmological parameters <span>$b$</span>, ...</p></li></ul><p><strong>Keyword Arguments</strong></p><ul><li><p><code>b1=nothing</code>, <code>s_b1=nothing</code>, <code>ùëì_evo1=nothing</code> and <code>b2=nothing</code>, <code>s_b2=nothing</code>, <code>ùëì_evo2=nothing</code>: galaxy, magnification and evolutionary biases respectively for the first and the second effect  computed in this TPCF:</p><ul><li>if not set (i.e. if you leave the default value <code>nothing</code>) the values stored in the input <code>cosmo</code> will be considered;</li><li>if you set one or more values, they will override the <code>cosmo</code> ones in this computation;</li><li>the two sets of values should be different only if you are interested in studing two galaxy species;</li><li>only the required parameters for the chosen TPCF will be used, depending on its analytical expression; all the others will have no effect, we still inserted them for pragmatical code compatibilities. </li></ul></li><li><p><code>s_lim=nothing</code> : parameter used in order to avoid the divergence of the <span>$\mathcal{R}$</span> and  <span>$\mathfrak{R}$</span> denominators: when <span>$0 \leq s \leq s_\mathrm{lim}$</span> the returned values are</p><p class="math-container">\[\forall \, s \in [ 0, s_\mathrm{lim} ] \; : \quad 
    \mathfrak{R}(s) = 1 - \frac{1}{\mathcal{H}_0 \, s_\mathrm{lim}} \; , \quad
    \mathcal{R}(s) = 5 s_{\mathrm{b}} + 
        \frac{2 - 5 s_{\mathrm{b}}}{\mathcal{H}_0 \, s_\mathrm{lim}} +  
        \frac{\dot{\mathcal{H}}}{\mathcal{H}_0^2} - \mathit{f}_{\mathrm{evo}} \; .\]</p><p>If <code>nothing</code>, the fault value stored in <code>cosmo</code> will be considered.</p></li></ul><p>See also: <a href="../Cosmology/#GaPSE.Point"><code>Point</code></a>, <a href="../Cosmology/#GaPSE.Cosmology"><code>Cosmology</code></a>, <a href="#GaPSE.Œæ_GNCxLD_multipole"><code>Œæ_GNCxLD_multipole</code></a>,  <a href="#GaPSE.map_Œæ_GNCxLD_multipole"><code>map_Œæ_GNCxLD_multipole</code></a>, <a href="#GaPSE.print_map_Œæ_GNCxLD_multipole"><code>print_map_Œæ_GNCxLD_multipole</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/foglienimatteo/GaPSE.jl/blob/e601437c432ee08c2009b9fd4aee18390ba3e877/src/GNCxLD_CrossCorrelations/GNCxLD_DopplerIntegratedGP.jl#L64-L213">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GaPSE.integrand_Œæ_GNCxLD_IntegratedGP_LocalGP" href="#GaPSE.integrand_Œæ_GNCxLD_IntegratedGP_LocalGP"><code>GaPSE.integrand_Œæ_GNCxLD_IntegratedGP_LocalGP</code></a> ‚Äî <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">integrand_Œæ_GNCxLD_IntegratedGP_LocalGP(
    IP::Point, P1::Point, P2::Point, y, cosmo::Cosmology;
    b1=nothing, b2=nothing, s_b1=nothing, s_b2=nothing,
    ùëì_evo1=nothing, ùëì_evo2=nothing, s_lim=nothing ) ::Float64

integrand_Œæ_GNCxLD_IntegratedGP_LocalGP(
    œá1::Float64, s1::Float64, s2::Float64,
    y, cosmo::Cosmology; kwargs... ) ::Float64</code></pre><p>Return the integrand of the Two-Point Correlation Function (TPCF) given by the cross correlation  between the Integrated Gravitational Potential (GP) effect arising from the  Galaxy Number Counts (GNC) and the Local GP one arising from the Luminosity Distance (LD) perturbations.</p><p>In the first method, you should pass the two extreme <code>Point</code>s (<code>P1</code> and <code>P2</code>) and the  intermediate integrand <code>Point</code> (<code>IP</code>) where to  evaluate the function. In the second method (that internally recalls the first), you must provide the three corresponding comoving distances <code>s1</code>, <code>s2</code>, <code>œá2</code>. We remember that all the distances are measured in <span>$h_0^{-1}\mathrm{Mpc}$</span>.</p><p>The analytical expression of this integrand is the following:</p><p class="math-container">\[\begin{split}
    f^{\int\!\phi \, \phi} (\chi_1, s_1, s_2, y) = 
    D_2 \, 
    \mathfrak{J}^{\int\!\phi \, \phi}_{40} \tilde{I}^4_0(\Delta\chi_1)
    \, ,
\end{split}\]</p><p>with</p><p class="math-container">\[\begin{split}
    \mathfrak{J}^{\int\!\phi \, \phi}_{40} =
    - \frac{9 \mathcal{H}_0^4 \Omega_{\mathrm{M}0}^2 D(\chi_1) }{2 a_2 s_1 a(\chi_1)} 
    \Delta\chi_1^4 (1 + \mathfrak{R}_2)
    \left[
        s_1 \mathcal{H}(\chi_1) \mathcal{R}_1 (f(\chi_1) - 1) - 5 s_{\mathrm{b}, 1}  + 2
    \right] \, ,
\end{split}\]</p><p>where:</p><ul><li><p><span>$s_1$</span> and <span>$s_2$</span> are comoving distances;</p></li><li><p><span>$D_1 = D(s_1)$</span>, ... is the linear growth factor (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$a_1 = a(s_1)$</span>, ... is the scale factor (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$f_1 = f(s_1)$</span>, ... is the linear growth rate (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$\mathcal{H}_1 = \mathcal{H}(s_1)$</span>, ... is the comoving  Hubble distances (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$y = \cos{\theta} = \hat{\mathbf{s}}_1 \cdot \hat{\mathbf{s}}_2$</span>;</p></li><li><p><span>$\mathcal{R}_1 = \mathcal{R}(s_1)$</span>, ... is  computed by <code>func_‚Ñõ_GNC</code> in <code>cosmo::Cosmology</code> (and evaluated in <span>$s_1$</span> ); the definition of <span>$\mathcal{R}(s)$</span> is the following:</p><p class="math-container">\[\mathcal{R}(s) = 5 s_{\mathrm{b}}(s) + \frac{2 - 5 s_{\mathrm{b}}(s)}{\mathcal{H}(s) \, s} +  
\frac{\dot{\mathcal{H}}(s)}{\mathcal{H}(s)^2} - \mathit{f}_{\mathrm{evo}} \quad ;\]</p></li><li><p><span>$\mathfrak{R}_1 = \mathfrak{R}(s_1)$</span>, ... is  computed by <code>func_‚Ñõ_LD</code> in <code>cosmo::Cosmology</code> (and evaluated in <span>$s_1$</span> ); the definition of <span>$\mathcal{R}(s)$</span> is the following:</p><p class="math-container">\[\mathfrak{R}(s) = 1 - \frac{1}{\mathcal{H}(s) s} ;\]</p></li><li><p><span>$b_1$</span>, <span>$s_{\mathrm{b}, 1}$</span>, <span>$\mathit{f}_{\mathrm{evo}, 1}$</span>  (and <span>$b_2$</span>, <span>$s_{\mathrm{b}, 2}$</span>, <span>$\mathit{f}_{\mathrm{evo}, 2}$</span>) :  galaxy bias, magnification bias (i.e. the slope of the luminosity function at the luminosity threshold),  and evolution bias for the first (second) effect;</p></li><li><p><span>$\Omega_{\mathrm{M}0} = \Omega_{\mathrm{cdm}} + \Omega_{\mathrm{b}}$</span> is the sum of  cold-dark-matter and barionic density parameters (again, stored in <code>cosmo</code>);</p></li><li><p><span>$I_\ell^n$</span> and <span>$\sigma_i$</span> are defined as</p><p class="math-container">\[I_\ell^n(s) = \int_0^{+\infty} \frac{\mathrm{d}q}{2\pi^2} 
\, q^2 \, P(q) \, \frac{j_\ell(qs)}{(qs)^n} \quad , 
\quad \sigma_i = \int_0^{+\infty} \frac{\mathrm{d}q}{2\pi^2} 
\, q^{2-i} \, P(q)\]</p><p>with <span>$P(q)$</span> as the matter Power Spectrum at <span>$z=0$</span> (stored in <code>cosmo</code>)  and <span>$j_\ell$</span> as spherical Bessel function of order <span>$\ell$</span>;</p></li><li><p><span>$\tilde{I}_0^4$</span> is defined as</p><p class="math-container">\[\tilde{I}_0^4 = \int_0^{+\infty} \frac{\mathrm{d}q}{2\pi^2} 
\, q^2 \, P(q) \, \frac{j_0(qs) - 1}{(qs)^4}\]</p><p>with <span>$P(q)$</span> as the matter Power Spectrum at <span>$z=0$</span> (stored in <code>cosmo</code>)  and <span>$j_\ell$</span> as spherical Bessel function of order <span>$\ell$</span>;</p></li><li><p><span>$\mathcal{H}_0$</span>, <span>$f_0$</span> and so on are evaluated at the observer position (i.e. at present day);</p></li><li><p><span>$\Delta\chi_1 := \sqrt{\chi_1^2 + s_2^2-2\,\chi_1\,s_2\,y}$</span> and  <span>$\Delta\chi_2 := \sqrt{s_1^2 + \chi_2^2-2\,s_1\,\chi_2\,y}$</span>;</p></li><li><p><span>$s=\sqrt{s_1^2 + s_2^2 - 2 \, s_1 \, s_2 \, y}$</span> and  <span>$\Delta\chi := \sqrt{\chi_1^2 + \chi_2^2-2\,\chi_1\,\chi_2\,y}$</span>.</p></li></ul><p>This function is used inside <code>Œæ_GNCxLD_IntegratedGP_LocalGP</code> with the trapz() from the  <a href="https://github.com/francescoalemanno/Trapz.jl">Trapz</a> Julia package.</p><p><strong>Inputs</strong></p><ul><li><p><code>IP::Point</code>, <code>P1::Point</code>, <code>P2::Point</code> or <code>œá1</code>,<code>s1</code>,<code>s2</code>: <code>Point</code>/comoving  distances where the TPCF has to be calculated; they contain all the  data of interest needed for this calculus (comoving distance, growth factor and so on).</p></li><li><p><code>y</code>: the cosine of the angle between the two points <code>P1</code> and <code>P2</code> wrt the observer</p></li><li><p><code>cosmo::Cosmology</code>: cosmology to be used in this computation; it contains all the splines used for the conversion <code>s</code> -&gt; <code>Point</code>, and all the cosmological parameters <span>$b$</span>, ...</p></li></ul><p><strong>Keyword Arguments</strong></p><ul><li><p><code>b1=nothing</code>, <code>s_b1=nothing</code>, <code>ùëì_evo1=nothing</code> and <code>b2=nothing</code>, <code>s_b2=nothing</code>, <code>ùëì_evo2=nothing</code>: galaxy, magnification and evolutionary biases respectively for the first and the second effect  computed in this TPCF:</p><ul><li>if not set (i.e. if you leave the default value <code>nothing</code>) the values stored in the input <code>cosmo</code> will be considered;</li><li>if you set one or more values, they will override the <code>cosmo</code> ones in this computation;</li><li>the two sets of values should be different only if you are interested in studing two galaxy species;</li><li>only the required parameters for the chosen TPCF will be used, depending on its analytical expression; all the others will have no effect, we still inserted them for pragmatical code compatibilities. </li></ul></li><li><p><code>s_lim=nothing</code> : parameter used in order to avoid the divergence of the <span>$\mathcal{R}$</span> and  <span>$\mathfrak{R}$</span> denominators: when <span>$0 \leq s \leq s_\mathrm{lim}$</span> the returned values are</p><p class="math-container">\[\forall \, s \in [ 0, s_\mathrm{lim} ] \; : \quad 
    \mathfrak{R}(s) = 1 - \frac{1}{\mathcal{H}_0 \, s_\mathrm{lim}} \; , \quad
    \mathcal{R}(s) = 5 s_{\mathrm{b}} + 
        \frac{2 - 5 s_{\mathrm{b}}}{\mathcal{H}_0 \, s_\mathrm{lim}} +  
        \frac{\dot{\mathcal{H}}}{\mathcal{H}_0^2} - \mathit{f}_{\mathrm{evo}} \; .\]</p><p>If <code>nothing</code>, the fault value stored in <code>cosmo</code> will be considered.</p></li></ul><p>See also: <a href="../Cosmology/#GaPSE.Point"><code>Point</code></a>, <a href="../Cosmology/#GaPSE.Cosmology"><code>Cosmology</code></a>, <a href="#GaPSE.Œæ_GNCxLD_multipole"><code>Œæ_GNCxLD_multipole</code></a>,  <a href="#GaPSE.map_Œæ_GNCxLD_multipole"><code>map_Œæ_GNCxLD_multipole</code></a>, <a href="#GaPSE.print_map_Œæ_GNCxLD_multipole"><code>print_map_Œæ_GNCxLD_multipole</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/foglienimatteo/GaPSE.jl/blob/e601437c432ee08c2009b9fd4aee18390ba3e877/src/GNCxLD_CrossCorrelations/GNCxLD_IntegratedGPLocalGP.jl#L61-L211">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GaPSE.integrand_Œæ_GNCxLD_LocalGP_Lensing" href="#GaPSE.integrand_Œæ_GNCxLD_LocalGP_Lensing"><code>GaPSE.integrand_Œæ_GNCxLD_LocalGP_Lensing</code></a> ‚Äî <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">integrand_Œæ_GNCxLD_LocalGP_Lensing(
	IP::Point, P1::Point, P2::Point, y, cosmo::Cosmology; 
	b1=nothing, b2=nothing, s_b1=nothing, s_b2=nothing,
	ùëì_evo1=nothing, ùëì_evo2=nothing, s_lim=nothing ) ::Float64

integrand_Œæ_GNCxLD_LocalGP_Lensing(
	œá2::Float64, s1::Float64, s2::Float64,
	y, cosmo::Cosmology; kwargs... ) ::Float64</code></pre><p>Return the integrand of the Two-Point Correlation Function (TPCF) given by the cross correlation between the  Local Gravitational Potential (GP) effect arising from the Galaxy Number Counts (GNC) and the  Lensing one arising from the Luminosity Distance (LD) perturbations.</p><p>In the first method, you should pass the two extreme <code>Point</code>s (<code>P1</code> and <code>P2</code>) and the  intermediate integrand <code>Point</code> (<code>IP</code>) where to  evaluate the function. In the second method (that internally recalls the first), you must provide the three corresponding comoving distances <code>s1</code>, <code>s2</code>, <code>œá2</code>. We remember that all the distances are measured in <span>$h_0^{-1}\mathrm{Mpc}$</span>.</p><p>The analytical expression of this integrand is the following:</p><p class="math-container">\[\begin{split}
    f^{\phi \kappa} (\chi_2, s_1 , s_2, y ) &amp;= 
    D_1 \, 
    \mathfrak{J}^{\phi \kappa}_{\alpha}\left[ 
        \mathfrak{J}^{\phi \kappa}_{20} I_0^2 ( \Delta \chi_2 ) +
        \right.\nonumber \\
        &amp;\left.\qquad
        \mathfrak{J}^{\phi \kappa}_{\beta}
        \left(
            \frac{1}{60} I_0^0 ( \Delta \chi_2 ) +
            \frac{1}{42} I_2^0 ( \Delta \chi_2 ) +
            \frac{1}{140} I_4^0 ( \Delta \chi_2 ) 
        \right)
    \right] \,  ,
\end{split}\]</p><p>with</p><p class="math-container">\[\begin{split}
    \mathfrak{J}^{\phi \kappa}_{\alpha}  &amp;= 
    - \frac{\mathcal{H}_0^2 \Omega_{\mathrm{M}0} s_1 D(\chi_2)}{ a_1 s_2 a(\chi_2)}
    (\chi_2 - s_2) 
    \times\\
    &amp;\qquad\qquad
    \left[
       2 f_1 a_1 \mathcal{H}_1^2 (\mathit{f}_{\mathrm{evo}, 1} - 3) + 
       3 \mathcal{H}_0^2 \Omega_{\mathrm{M}0} (f_1 + \mathcal{R}_1 + 5 s_{\mathrm{b}, 1}  - 2)
    \right] \nonumber
    \, , \\
    %%%%%%%%%%%%%%%%%%%
    \mathfrak{J}^{\phi \kappa}_{\beta} &amp;=
    2 y \chi_2^2 - \chi_2 s_1 (y^2 + 3) + 2 y s_1^2
    \, ,\\
    %%%%%%%%%%%%%%%%%%%
    \mathfrak{J}^{\phi \kappa}_{20} &amp;= \frac{1}{2} y \Delta\chi_2^2\, ,
\end{split}\]</p><p>where:</p><ul><li><p><span>$s_1$</span> and <span>$s_2$</span> are comoving distances;</p></li><li><p><span>$D_1 = D(s_1)$</span>, ... is the linear growth factor (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$a_1 = a(s_1)$</span>, ... is the scale factor (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$f_1 = f(s_1)$</span>, ... is the linear growth rate (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$\mathcal{H}_1 = \mathcal{H}(s_1)$</span>, ... is the comoving  Hubble distances (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$y = \cos{\theta} = \hat{\mathbf{s}}_1 \cdot \hat{\mathbf{s}}_2$</span>;</p></li><li><p><span>$\mathcal{R}_1 = \mathcal{R}(s_1)$</span>, ... is  computed by <code>func_‚Ñõ_GNC</code> in <code>cosmo::Cosmology</code> (and evaluated in <span>$s_1$</span> ); the definition of <span>$\mathcal{R}(s)$</span> is the following:</p><p class="math-container">\[\mathcal{R}(s) = 5 s_{\mathrm{b}}(s) + \frac{2 - 5 s_{\mathrm{b}}(s)}{\mathcal{H}(s) \, s} +  
\frac{\dot{\mathcal{H}}(s)}{\mathcal{H}(s)^2} - \mathit{f}_{\mathrm{evo}} \quad ;\]</p></li><li><p><span>$\mathfrak{R}_1 = \mathfrak{R}(s_1)$</span>, ... is  computed by <code>func_‚Ñõ_LD</code> in <code>cosmo::Cosmology</code> (and evaluated in <span>$s_1$</span> ); the definition of <span>$\mathcal{R}(s)$</span> is the following:</p><p class="math-container">\[\mathfrak{R}(s) = 1 - \frac{1}{\mathcal{H}(s) s} ;\]</p></li><li><p><span>$b_1$</span>, <span>$s_{\mathrm{b}, 1}$</span>, <span>$\mathit{f}_{\mathrm{evo}, 1}$</span>  (and <span>$b_2$</span>, <span>$s_{\mathrm{b}, 2}$</span>, <span>$\mathit{f}_{\mathrm{evo}, 2}$</span>) :  galaxy bias, magnification bias (i.e. the slope of the luminosity function at the luminosity threshold),  and evolution bias for the first (second) effect;</p></li><li><p><span>$\Omega_{\mathrm{M}0} = \Omega_{\mathrm{cdm}} + \Omega_{\mathrm{b}}$</span> is the sum of  cold-dark-matter and barionic density parameters (again, stored in <code>cosmo</code>);</p></li><li><p><span>$I_\ell^n$</span> and <span>$\sigma_i$</span> are defined as</p><p class="math-container">\[I_\ell^n(s) = \int_0^{+\infty} \frac{\mathrm{d}q}{2\pi^2} 
\, q^2 \, P(q) \, \frac{j_\ell(qs)}{(qs)^n} \quad , 
\quad \sigma_i = \int_0^{+\infty} \frac{\mathrm{d}q}{2\pi^2} 
\, q^{2-i} \, P(q)\]</p><p>with <span>$P(q)$</span> as the matter Power Spectrum at <span>$z=0$</span> (stored in <code>cosmo</code>)  and <span>$j_\ell$</span> as spherical Bessel function of order <span>$\ell$</span>;</p></li><li><p><span>$\tilde{I}_0^4$</span> is defined as</p><p class="math-container">\[\tilde{I}_0^4 = \int_0^{+\infty} \frac{\mathrm{d}q}{2\pi^2} 
\, q^2 \, P(q) \, \frac{j_0(qs) - 1}{(qs)^4}\]</p><p>with <span>$P(q)$</span> as the matter Power Spectrum at <span>$z=0$</span> (stored in <code>cosmo</code>)  and <span>$j_\ell$</span> as spherical Bessel function of order <span>$\ell$</span>;</p></li><li><p><span>$\mathcal{H}_0$</span>, <span>$f_0$</span> and so on are evaluated at the observer position (i.e. at present day);</p></li><li><p><span>$\Delta\chi_1 := \sqrt{\chi_1^2 + s_2^2-2\,\chi_1\,s_2\,y}$</span> and  <span>$\Delta\chi_2 := \sqrt{s_1^2 + \chi_2^2-2\,s_1\,\chi_2\,y}$</span>;</p></li><li><p><span>$s=\sqrt{s_1^2 + s_2^2 - 2 \, s_1 \, s_2 \, y}$</span> and  <span>$\Delta\chi := \sqrt{\chi_1^2 + \chi_2^2-2\,\chi_1\,\chi_2\,y}$</span>.</p></li></ul><p>This function is used inside <code>Œæ_GNCxLD_Lensing_IntegratedGP</code> with the trapz() from the  <a href="https://github.com/francescoalemanno/Trapz.jl">Trapz</a> Julia package.</p><p><strong>Inputs</strong></p><ul><li><p><code>IP::Point</code>, <code>P1::Point</code>, <code>P2::Point</code> or <code>œá2</code>,<code>s1</code>,<code>s2</code>: <code>Point</code>/comoving  distances where the TPCF has to be calculated; they contain all the  data of interest needed for this calculus (comoving distance, growth factor and so on).</p></li><li><p><code>y</code>: the cosine of the angle between the two points <code>P1</code> and <code>P2</code> wrt the observer</p></li><li><p><code>cosmo::Cosmology</code>: cosmology to be used in this computation; it contains all the splines used for the conversion <code>s</code> -&gt; <code>Point</code>, and all the cosmological parameters <span>$b$</span>, ...</p></li></ul><p><strong>Keyword Arguments</strong></p><ul><li><p><code>b1=nothing</code>, <code>s_b1=nothing</code>, <code>ùëì_evo1=nothing</code> and <code>b2=nothing</code>, <code>s_b2=nothing</code>, <code>ùëì_evo2=nothing</code>: galaxy, magnification and evolutionary biases respectively for the first and the second effect  computed in this TPCF:</p><ul><li>if not set (i.e. if you leave the default value <code>nothing</code>) the values stored in the input <code>cosmo</code> will be considered;</li><li>if you set one or more values, they will override the <code>cosmo</code> ones in this computation;</li><li>the two sets of values should be different only if you are interested in studing two galaxy species;</li><li>only the required parameters for the chosen TPCF will be used, depending on its analytical expression; all the others will have no effect, we still inserted them for pragmatical code compatibilities. </li></ul></li><li><p><code>s_lim=nothing</code> : parameter used in order to avoid the divergence of the <span>$\mathcal{R}$</span> and  <span>$\mathfrak{R}$</span> denominators: when <span>$0 \leq s \leq s_\mathrm{lim}$</span> the returned values are</p><p class="math-container">\[\forall \, s \in [ 0, s_\mathrm{lim} ] \; : \quad 
    \mathfrak{R}(s) = 1 - \frac{1}{\mathcal{H}_0 \, s_\mathrm{lim}} \; , \quad
    \mathcal{R}(s) = 5 s_{\mathrm{b}} + 
        \frac{2 - 5 s_{\mathrm{b}}}{\mathcal{H}_0 \, s_\mathrm{lim}} +  
        \frac{\dot{\mathcal{H}}}{\mathcal{H}_0^2} - \mathit{f}_{\mathrm{evo}} \; .\]</p><p>If <code>nothing</code>, the fault value stored in <code>cosmo</code> will be considered.</p></li></ul><p>See also: <a href="../Cosmology/#GaPSE.Point"><code>Point</code></a>, <a href="../Cosmology/#GaPSE.Cosmology"><code>Cosmology</code></a>, <a href="#GaPSE.Œæ_GNCxLD_multipole"><code>Œæ_GNCxLD_multipole</code></a>,  <a href="#GaPSE.map_Œæ_GNCxLD_multipole"><code>map_Œæ_GNCxLD_multipole</code></a>, <a href="#GaPSE.print_map_Œæ_GNCxLD_multipole"><code>print_map_Œæ_GNCxLD_multipole</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/foglienimatteo/GaPSE.jl/blob/e601437c432ee08c2009b9fd4aee18390ba3e877/src/GNCxLD_CrossCorrelations/GNCxLD_LocalGPLensing.jl#L71-L239">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GaPSE.integrand_Œæ_GNCxLD_Doppler_Lensing" href="#GaPSE.integrand_Œæ_GNCxLD_Doppler_Lensing"><code>GaPSE.integrand_Œæ_GNCxLD_Doppler_Lensing</code></a> ‚Äî <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">integrand_Œæ_GNCxLD_Doppler_Lensing(
    IP::Point, P1::Point, P2::Point, y, cosmo::Cosmology;
    b1=nothing, b2=nothing, s_b1=nothing, s_b2=nothing,
    ùëì_evo1=nothing, ùëì_evo2=nothing, s_lim=nothing ) ::Float64

integrand_Œæ_GNCxLD_Doppler_Lensing(
    œá2::Float64, s1::Float64, s2::Float64,
    y, cosmo::Cosmology; kwargs... ) ::Float64</code></pre><p>Return the integrand of the Two-Point Correlation Function (TPCF) given by the cross correlation  between the Doppler effect arising from the Galaxy Number Counts (GNC) and the Lensing one arising from the Luminosity Distance (LD) perturbations.</p><p>In the first method, you should pass the two extreme <code>Point</code>s (<code>P1</code> and <code>P2</code>) and the  intermediate integrand <code>Point</code> (<code>IP</code>) where to  evaluate the function. In the second method (that internally recalls the first), you must provide the three corresponding comoving distances <code>s1</code>, <code>s2</code>, <code>œá2</code>. We remember that all the distances are measured in <span>$h_0^{-1}\mathrm{Mpc}$</span>.</p><p>The analytical expression of this integrand is the following:</p><p class="math-container">\[\begin{split}
    f^{v_{\parallel}\kappa} (\chi_2, s_1, s_2, y) =
    D_1 
    \mathfrak{J}^{\kappa v_{\parallel}}_{\alpha} \times \\
    &amp;\left[
        \mathfrak{J}^{\kappa v_{\parallel}}_{00} I_0^0(\Delta\chi_2) + 
        \mathfrak{J}^{\kappa v_{\parallel}}_{02} I_2^0(\Delta\chi_2) + 
        \mathfrak{J}^{\kappa v_{\parallel}}_{04} I_4^0(\Delta\chi_2) + 
        \mathfrak{J}^{\kappa v_{\parallel}}_{20} I_0^2(\Delta\chi_2)
    \right]
\end{split}\]</p><p>with</p><p class="math-container">\[\begin{split}
        \mathfrak{J}^{\kappa v_{\parallel}}_{\alpha} &amp;= 
    - \mathcal{H}_0^2 \Omega_{\mathrm{M}0} f_1 \mathcal{H}_1 \mathcal{R}_1 
    \frac{D(\chi_2) (\chi_2 - s_2)}{a(\chi_2) s_2}
    \, , \\
    %%%%%%%%%%%%%%%%%%%%%%%%
    \mathfrak{J}^{\kappa v_{\parallel}}_{00} &amp; = 
    \frac{1}{15}
    \left[
        \chi_2^2 y + \chi_2(4 y^2 - 3) s_1 - 2 y s_1^2
    \right]
    \, , \\
    %%%%%%%%%%%%%%%%%%%%%%%%
    \mathfrak{J}^{\kappa v_{\parallel}}_{02} &amp; = 
    \frac{1}{42 \Delta\chi_2^2}
    \left[
        4 \chi_2^4 y + 4 \chi_2^3 (2 y^2 - 3) s_1 +
        \chi_2^2 y (11 - 23 y^2) s_1^2 +
        \right.\\
        &amp;\left.\qquad\qquad\qquad
        \chi_2 (23 y^2 - 3) s_1^3 - 8 y s_1^4
    \right] \nonumber
    \, , \\
    %%%%%%%%%%%%%%%%%%%%%%%%
    \mathfrak{J}^{\kappa v_{\parallel}}_{04} &amp; = 
    \frac{1}{70 \Delta\chi_2^2} 
    \left[
        2\chi_2^4 y + 2 \chi_2^3 (2 y^2 - 3) s_1 -
        \chi_2^2 y (y^2 + 5) s_1^2 + 
        \right.\\
        &amp;\left.\qquad\qquad\qquad
        \chi_2 (y^2 + 9) s_1^3 - 4 y s_1^4
    \right] \nonumber
    \, , \\
    %%%%%%%%%%%%%%%%%%%%%%%%
    \mathfrak{J}^{\kappa v_{\parallel}}_{20} &amp; = y \Delta\chi_2^2 
    \, ,
\end{split}\]</p><p>where:</p><ul><li><p><span>$s_1$</span> and <span>$s_2$</span> are comoving distances;</p></li><li><p><span>$D_1 = D(s_1)$</span>, ... is the linear growth factor (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$a_1 = a(s_1)$</span>, ... is the scale factor (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$f_1 = f(s_1)$</span>, ... is the linear growth rate (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$\mathcal{H}_1 = \mathcal{H}(s_1)$</span>, ... is the comoving  Hubble distances (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$y = \cos{\theta} = \hat{\mathbf{s}}_1 \cdot \hat{\mathbf{s}}_2$</span>;</p></li><li><p><span>$\mathcal{R}_1 = \mathcal{R}(s_1)$</span>, ... is  computed by <code>func_‚Ñõ_GNC</code> in <code>cosmo::Cosmology</code> (and evaluated in <span>$s_1$</span> ); the definition of <span>$\mathcal{R}(s)$</span> is the following:</p><p class="math-container">\[\mathcal{R}(s) = 5 s_{\mathrm{b}}(s) + \frac{2 - 5 s_{\mathrm{b}}(s)}{\mathcal{H}(s) \, s} +  
\frac{\dot{\mathcal{H}}(s)}{\mathcal{H}(s)^2} - \mathit{f}_{\mathrm{evo}} \quad ;\]</p></li><li><p><span>$\mathfrak{R}_1 = \mathfrak{R}(s_1)$</span>, ... is  computed by <code>func_‚Ñõ_LD</code> in <code>cosmo::Cosmology</code> (and evaluated in <span>$s_1$</span> ); the definition of <span>$\mathcal{R}(s)$</span> is the following:</p><p class="math-container">\[\mathfrak{R}(s) = 1 - \frac{1}{\mathcal{H}(s) s} ;\]</p></li><li><p><span>$b_1$</span>, <span>$s_{\mathrm{b}, 1}$</span>, <span>$\mathit{f}_{\mathrm{evo}, 1}$</span>  (and <span>$b_2$</span>, <span>$s_{\mathrm{b}, 2}$</span>, <span>$\mathit{f}_{\mathrm{evo}, 2}$</span>) :  galaxy bias, magnification bias (i.e. the slope of the luminosity function at the luminosity threshold),  and evolution bias for the first (second) effect;</p></li><li><p><span>$\Omega_{\mathrm{M}0} = \Omega_{\mathrm{cdm}} + \Omega_{\mathrm{b}}$</span> is the sum of  cold-dark-matter and barionic density parameters (again, stored in <code>cosmo</code>);</p></li><li><p><span>$I_\ell^n$</span> and <span>$\sigma_i$</span> are defined as</p><p class="math-container">\[I_\ell^n(s) = \int_0^{+\infty} \frac{\mathrm{d}q}{2\pi^2} 
\, q^2 \, P(q) \, \frac{j_\ell(qs)}{(qs)^n} \quad , 
\quad \sigma_i = \int_0^{+\infty} \frac{\mathrm{d}q}{2\pi^2} 
\, q^{2-i} \, P(q)\]</p><p>with <span>$P(q)$</span> as the matter Power Spectrum at <span>$z=0$</span> (stored in <code>cosmo</code>)  and <span>$j_\ell$</span> as spherical Bessel function of order <span>$\ell$</span>;</p></li><li><p><span>$\tilde{I}_0^4$</span> is defined as</p><p class="math-container">\[\tilde{I}_0^4 = \int_0^{+\infty} \frac{\mathrm{d}q}{2\pi^2} 
\, q^2 \, P(q) \, \frac{j_0(qs) - 1}{(qs)^4}\]</p><p>with <span>$P(q)$</span> as the matter Power Spectrum at <span>$z=0$</span> (stored in <code>cosmo</code>)  and <span>$j_\ell$</span> as spherical Bessel function of order <span>$\ell$</span>;</p></li><li><p><span>$\mathcal{H}_0$</span>, <span>$f_0$</span> and so on are evaluated at the observer position (i.e. at present day);</p></li><li><p><span>$\Delta\chi_1 := \sqrt{\chi_1^2 + s_2^2-2\,\chi_1\,s_2\,y}$</span> and  <span>$\Delta\chi_2 := \sqrt{s_1^2 + \chi_2^2-2\,s_1\,\chi_2\,y}$</span>;</p></li><li><p><span>$s=\sqrt{s_1^2 + s_2^2 - 2 \, s_1 \, s_2 \, y}$</span> and  <span>$\Delta\chi := \sqrt{\chi_1^2 + \chi_2^2-2\,\chi_1\,\chi_2\,y}$</span>.</p></li></ul><p>This function is used inside <code>Œæ_GNCxLD_Doppler_Lensing</code> with the trapz() from the  <a href="https://github.com/francescoalemanno/Trapz.jl">Trapz</a> Julia package.</p><p><strong>Inputs</strong></p><ul><li><p><code>IP::Point</code>, <code>P1::Point</code>, <code>P2::Point</code> or <code>œá2</code>,<code>s1</code>,<code>s2</code>: <code>Point</code>/comoving  distances where the TPCF has to be calculated; they contain all the  data of interest needed for this calculus (comoving distance, growth factor and so on).</p></li><li><p><code>y</code>: the cosine of the angle between the two points <code>P1</code> and <code>P2</code> wrt the observer</p></li><li><p><code>cosmo::Cosmology</code>: cosmology to be used in this computation; it contains all the splines used for the conversion <code>s</code> -&gt; <code>Point</code>, and all the cosmological parameters <span>$b$</span>, ...</p></li></ul><p><strong>Keyword Arguments</strong></p><ul><li><p><code>b1=nothing</code>, <code>s_b1=nothing</code>, <code>ùëì_evo1=nothing</code> and <code>b2=nothing</code>, <code>s_b2=nothing</code>, <code>ùëì_evo2=nothing</code>: galaxy, magnification and evolutionary biases respectively for the first and the second effect  computed in this TPCF:</p><ul><li>if not set (i.e. if you leave the default value <code>nothing</code>) the values stored in the input <code>cosmo</code> will be considered;</li><li>if you set one or more values, they will override the <code>cosmo</code> ones in this computation;</li><li>the two sets of values should be different only if you are interested in studing two galaxy species;</li><li>only the required parameters for the chosen TPCF will be used, depending on its analytical expression; all the others will have no effect, we still inserted them for pragmatical code compatibilities. </li></ul></li><li><p><code>s_lim=nothing</code> : parameter used in order to avoid the divergence of the <span>$\mathcal{R}$</span> and  <span>$\mathfrak{R}$</span> denominators: when <span>$0 \leq s \leq s_\mathrm{lim}$</span> the returned values are</p><p class="math-container">\[\forall \, s \in [ 0, s_\mathrm{lim} ] \; : \quad 
    \mathfrak{R}(s) = 1 - \frac{1}{\mathcal{H}_0 \, s_\mathrm{lim}} \; , \quad
    \mathcal{R}(s) = 5 s_{\mathrm{b}} + 
        \frac{2 - 5 s_{\mathrm{b}}}{\mathcal{H}_0 \, s_\mathrm{lim}} +  
        \frac{\dot{\mathcal{H}}}{\mathcal{H}_0^2} - \mathit{f}_{\mathrm{evo}} \; .\]</p><p>If <code>nothing</code>, the fault value stored in <code>cosmo</code> will be considered.</p></li></ul><p>See also: <a href="../Cosmology/#GaPSE.Point"><code>Point</code></a>, <a href="../Cosmology/#GaPSE.Cosmology"><code>Cosmology</code></a>, <a href="#GaPSE.Œæ_GNCxLD_multipole"><code>Œæ_GNCxLD_multipole</code></a>,  <a href="#GaPSE.map_Œæ_GNCxLD_multipole"><code>map_Œæ_GNCxLD_multipole</code></a>, <a href="#GaPSE.print_map_Œæ_GNCxLD_multipole"><code>print_map_Œæ_GNCxLD_multipole</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/foglienimatteo/GaPSE.jl/blob/e601437c432ee08c2009b9fd4aee18390ba3e877/src/GNCxLD_CrossCorrelations/GNCxLD_DopplerLensing.jl#L92-L276">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GaPSE.integrand_Œæ_GNCxLD_Lensing_Lensing" href="#GaPSE.integrand_Œæ_GNCxLD_Lensing_Lensing"><code>GaPSE.integrand_Œæ_GNCxLD_Lensing_Lensing</code></a> ‚Äî <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">integrand_Œæ_GNCxLD_Lensing_Lensing(
    IP1::Point, IP2::Point, P1::Point, P2::Point, y, cosmo::Cosmology;
    b1=nothing, b2=nothing, s_b1=nothing, s_b2=nothing,
    ùëì_evo1=nothing, ùëì_evo2=nothing, s_lim=nothing ) ::Float64

integrand_Œæ_GNCxLD_Lensing_Lensing(
    œá1::Float64, œá2::Float64,
    s1::Float64, s2::Float64,
    y, cosmo::Cosmology; kwargs... ) ::Float64</code></pre><p>Return the integrand of the Two-Point Correlation Function (TPCF) given by the cross correlation  between the Lensing effect arising from the  Galaxy Number Counts (GNC) and the Lensing one arising from the Luminosity Distance (LD) perturbations.</p><p>In the first method, you should pass the two extreme <code>Point</code>s (<code>P1</code> and <code>P2</code>) and the  two intermediate integrand <code>Point</code>s (<code>IP1</code> and <code>IP2</code>) where to  evaluate the function. In the second method (that internally recalls the first), you must provide the three corresponding comoving distances <code>s1</code>, <code>s2</code>, <code>œá1</code>, <code>œá2</code>. We remember that all the distances are measured in <span>$h_0^{-1}\mathrm{Mpc}$</span>.</p><p>The analytical expression of this integrand is the following:</p><p class="math-container">\[\begin{split}
    f^{\kappa\kappa} (\chi_1, \chi_2, s_1, s_2, y) =  
    \mathfrak{J}^{\kappa\kappa}_{\alpha}
    &amp;\left[
        \mathfrak{J}^{\kappa\kappa}_{00} I_0^0(\Delta\chi) + 
        \mathfrak{J}^{\kappa\kappa}_{02} I_2^0(\Delta\chi) +
        \right.\\
        &amp;\left.
        \mathfrak{J}^{\kappa\kappa}_{31} I_1^3(\Delta\chi) +
        \mathfrak{J}^{\kappa\kappa}_{22} I_2^2(\Delta\chi)
    \right] \nonumber \, ,
\end{split}\]</p><p>with</p><p class="math-container">\[\begin{split}
    \mathfrak{J}^{\kappa\kappa}_{\alpha} &amp; = 
    - \frac{
        \mathcal{H}_0^4 \Omega_{\mathrm{M}0}^2 D(\chi_1) D(\chi_2) 
    }{
        s_1 s_2 a(\chi_1) a(\chi_2)}
    (\chi_1 - s_1)(\chi_2 - s_2)
    (5  s_{\mathrm{b}, 2}  - 1)
    \, , \\
    %%%%&amp;%%%%%%%%%%%%%
    \mathfrak{J}^{\kappa\kappa}_{00} &amp; = 
    -\frac{ 3 \chi_1^2 \chi_2^2}{4 \Delta\chi^4} (y^2 - 1)
    \left[
        8 y (\chi_1^2 + \chi_2^2) - 9\chi_1\chi_2y^2 - 
        7\chi_1\chi_2
    \right] 
    \, , \\
    %%%%&amp;%%%%%%%%%%%%%
    \mathfrak{J}^{\kappa\kappa}_{02} &amp; = 
    -\frac{ 3 \chi_1^2 \chi_2^2}{2 \Delta\chi^4}(y^2 - 1)
    \left[
        4 y (\chi_1^2 + \chi_2^2) - 3 \chi_1 \chi_2 y^2 -
        5 \chi_1 \chi_2
    \right] 
    \, , \\
    %%%%%%%%%%%%%%%%%%
    \mathfrak{J}^{\kappa\kappa}_{31} &amp; = 9 y \Delta\chi^2 
    \, , \\
    %%%%%%%%%%%%%%%%%%
    \mathfrak{J}^{\kappa\kappa}_{22} &amp; = 
    \frac{9 \chi_1 \chi_2}{4 \Delta\chi^4}
    \left[
        2(\chi_1^4 + \chi_2^4)(7 y^2 - 3) - 
        16 y \chi_1 \chi_2 (\chi_1^2 + \chi_2^2)(y^2 + 1) + 
        \right.\\
        &amp;\left.\qquad\qquad\qquad
        \chi_1^2 \chi_2^2 (11y^4 + 14y^2 + 23) 
    \right] 
    \, ,
\end{split}\]</p><p>where:</p><ul><li><p><span>$s_1$</span> and <span>$s_2$</span> are comoving distances;</p></li><li><p><span>$D_1 = D(s_1)$</span>, ... is the linear growth factor (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$a_1 = a(s_1)$</span>, ... is the scale factor (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$f_1 = f(s_1)$</span>, ... is the linear growth rate (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$\mathcal{H}_1 = \mathcal{H}(s_1)$</span>, ... is the comoving  Hubble distances (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$y = \cos{\theta} = \hat{\mathbf{s}}_1 \cdot \hat{\mathbf{s}}_2$</span>;</p></li><li><p><span>$\mathcal{R}_1 = \mathcal{R}(s_1)$</span>, ... is  computed by <code>func_‚Ñõ_GNC</code> in <code>cosmo::Cosmology</code> (and evaluated in <span>$s_1$</span> ); the definition of <span>$\mathcal{R}(s)$</span> is the following:</p><p class="math-container">\[\mathcal{R}(s) = 5 s_{\mathrm{b}}(s) + \frac{2 - 5 s_{\mathrm{b}}(s)}{\mathcal{H}(s) \, s} +  
\frac{\dot{\mathcal{H}}(s)}{\mathcal{H}(s)^2} - \mathit{f}_{\mathrm{evo}} \quad ;\]</p></li><li><p><span>$\mathfrak{R}_1 = \mathfrak{R}(s_1)$</span>, ... is  computed by <code>func_‚Ñõ_LD</code> in <code>cosmo::Cosmology</code> (and evaluated in <span>$s_1$</span> ); the definition of <span>$\mathcal{R}(s)$</span> is the following:</p><p class="math-container">\[\mathfrak{R}(s) = 1 - \frac{1}{\mathcal{H}(s) s} ;\]</p></li><li><p><span>$b_1$</span>, <span>$s_{\mathrm{b}, 1}$</span>, <span>$\mathit{f}_{\mathrm{evo}, 1}$</span>  (and <span>$b_2$</span>, <span>$s_{\mathrm{b}, 2}$</span>, <span>$\mathit{f}_{\mathrm{evo}, 2}$</span>) :  galaxy bias, magnification bias (i.e. the slope of the luminosity function at the luminosity threshold),  and evolution bias for the first (second) effect;</p></li><li><p><span>$\Omega_{\mathrm{M}0} = \Omega_{\mathrm{cdm}} + \Omega_{\mathrm{b}}$</span> is the sum of  cold-dark-matter and barionic density parameters (again, stored in <code>cosmo</code>);</p></li><li><p><span>$I_\ell^n$</span> and <span>$\sigma_i$</span> are defined as</p><p class="math-container">\[I_\ell^n(s) = \int_0^{+\infty} \frac{\mathrm{d}q}{2\pi^2} 
\, q^2 \, P(q) \, \frac{j_\ell(qs)}{(qs)^n} \quad , 
\quad \sigma_i = \int_0^{+\infty} \frac{\mathrm{d}q}{2\pi^2} 
\, q^{2-i} \, P(q)\]</p><p>with <span>$P(q)$</span> as the matter Power Spectrum at <span>$z=0$</span> (stored in <code>cosmo</code>)  and <span>$j_\ell$</span> as spherical Bessel function of order <span>$\ell$</span>;</p></li><li><p><span>$\tilde{I}_0^4$</span> is defined as</p><p class="math-container">\[\tilde{I}_0^4 = \int_0^{+\infty} \frac{\mathrm{d}q}{2\pi^2} 
\, q^2 \, P(q) \, \frac{j_0(qs) - 1}{(qs)^4}\]</p><p>with <span>$P(q)$</span> as the matter Power Spectrum at <span>$z=0$</span> (stored in <code>cosmo</code>)  and <span>$j_\ell$</span> as spherical Bessel function of order <span>$\ell$</span>;</p></li><li><p><span>$\mathcal{H}_0$</span>, <span>$f_0$</span> and so on are evaluated at the observer position (i.e. at present day);</p></li><li><p><span>$\Delta\chi_1 := \sqrt{\chi_1^2 + s_2^2-2\,\chi_1\,s_2\,y}$</span> and  <span>$\Delta\chi_2 := \sqrt{s_1^2 + \chi_2^2-2\,s_1\,\chi_2\,y}$</span>;</p></li><li><p><span>$s=\sqrt{s_1^2 + s_2^2 - 2 \, s_1 \, s_2 \, y}$</span> and  <span>$\Delta\chi := \sqrt{\chi_1^2 + \chi_2^2-2\,\chi_1\,\chi_2\,y}$</span>.</p></li></ul><p>This function is used inside <code>Œæ_GNCxLD_Lensing_Lensing</code> with the trapz() from the  <a href="https://github.com/francescoalemanno/Trapz.jl">Trapz</a> Julia package.</p><p><strong>Inputs</strong></p><ul><li><p><code>IP1::Point</code>, <code>IP2::Point</code>, <code>P1::Point</code>, <code>P2::Point</code> or <code>œá1</code>,<code>œá2</code>,<code>s1</code>,<code>s2</code>: <code>Point</code>/comoving  distances where the TPCF has to be calculated; they contain all the  data of interest needed for this calculus (comoving distance, growth factor and so on).</p></li><li><p><code>y</code>: the cosine of the angle between the two points <code>P1</code> and <code>P2</code> wrt the observer</p></li><li><p><code>cosmo::Cosmology</code>: cosmology to be used in this computation; it contains all the splines used for the conversion <code>s</code> -&gt; <code>Point</code>, and all the cosmological parameters <span>$b$</span>, ...</p></li></ul><p><strong>Keyword Arguments</strong></p><ul><li><p><code>b1=nothing</code>, <code>s_b1=nothing</code>, <code>ùëì_evo1=nothing</code> and <code>b2=nothing</code>, <code>s_b2=nothing</code>, <code>ùëì_evo2=nothing</code>: galaxy, magnification and evolutionary biases respectively for the first and the second effect  computed in this TPCF:</p><ul><li>if not set (i.e. if you leave the default value <code>nothing</code>) the values stored in the input <code>cosmo</code> will be considered;</li><li>if you set one or more values, they will override the <code>cosmo</code> ones in this computation;</li><li>the two sets of values should be different only if you are interested in studing two galaxy species;</li><li>only the required parameters for the chosen TPCF will be used, depending on its analytical expression; all the others will have no effect, we still inserted them for pragmatical code compatibilities. </li></ul></li><li><p><code>s_lim=nothing</code> : parameter used in order to avoid the divergence of the <span>$\mathcal{R}$</span> and  <span>$\mathfrak{R}$</span> denominators: when <span>$0 \leq s \leq s_\mathrm{lim}$</span> the returned values are</p><p class="math-container">\[\forall \, s \in [ 0, s_\mathrm{lim} ] \; : \quad 
    \mathfrak{R}(s) = 1 - \frac{1}{\mathcal{H}_0 \, s_\mathrm{lim}} \; , \quad
    \mathcal{R}(s) = 5 s_{\mathrm{b}} + 
        \frac{2 - 5 s_{\mathrm{b}}}{\mathcal{H}_0 \, s_\mathrm{lim}} +  
        \frac{\dot{\mathcal{H}}}{\mathcal{H}_0^2} - \mathit{f}_{\mathrm{evo}} \; .\]</p><p>If <code>nothing</code>, the fault value stored in <code>cosmo</code> will be considered.</p></li></ul><p>See also: <a href="../Cosmology/#GaPSE.Point"><code>Point</code></a>, <a href="../Cosmology/#GaPSE.Cosmology"><code>Cosmology</code></a>, <a href="#GaPSE.Œæ_GNCxLD_multipole"><code>Œæ_GNCxLD_multipole</code></a>,  <a href="#GaPSE.map_Œæ_GNCxLD_multipole"><code>map_Œæ_GNCxLD_multipole</code></a>, <a href="#GaPSE.print_map_Œæ_GNCxLD_multipole"><code>print_map_Œæ_GNCxLD_multipole</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/foglienimatteo/GaPSE.jl/blob/e601437c432ee08c2009b9fd4aee18390ba3e877/src/GNCxLD_CrossCorrelations/GNCxLD_LensingLensing.jl#L73-L260">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GaPSE.integrand_Œæ_GNCxLD_Lensing_Doppler" href="#GaPSE.integrand_Œæ_GNCxLD_Lensing_Doppler"><code>GaPSE.integrand_Œæ_GNCxLD_Lensing_Doppler</code></a> ‚Äî <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">integrand_Œæ_GNCxLD_Lensing_Doppler(
    IP::Point, P1::Point, P2::Point, y, cosmo::Cosmology;
    b1=nothing, b2=nothing, s_b1=nothing, s_b2=nothing,
    ùëì_evo1=nothing, ùëì_evo2=nothing, s_lim=nothing ) ::Float64

integrand_Œæ_GNCxLD_Lensing_Doppler(
    œá1::Float64, s1::Float64, s2::Float64, y, cosmo::Cosmology;
    kwargs... ) ::Float64</code></pre><p>Return the Two-Point Correlation Function (TPCF) given by the cross correlation  between the Lensing effect arising from the  Galaxy Number Counts (GNC) and the Doppler one arising from the Luminosity Distance (LD) perturbations.</p><p>In the first method, you should pass the two extreme <code>Point</code>s (<code>P1</code> and <code>P2</code>) and the  intermediate integrand <code>Point</code> (<code>IP</code>) where to  evaluate the function. In the second method (that internally recalls the first), you must provide the three corresponding comoving distances <code>s1</code>, <code>s2</code>, <code>œá2</code>. We remember that all the distances are measured in <span>$h_0^{-1}\mathrm{Mpc}$</span>.</p><p>The analytical expression of this TPCF is the following:</p><p class="math-container">\[\begin{split}
    f^{\kappa v_{\parallel}} (\chi_1, s_1, s_2, y) = 
    D_2 \,
    \mathfrak{J}^{\kappa v_{\parallel}}_{\alpha} \times \\
    &amp;\left[
        \mathfrak{J}^{\kappa v_{\parallel}}_{00} I_0^0(\Delta\chi_1) + 
        \mathfrak{J}^{\kappa v_{\parallel}}_{02} I_2^0(\Delta\chi_1) + 
        \mathfrak{J}^{\kappa v_{\parallel}}_{04} I_4^0(\Delta\chi_1) + 
        \mathfrak{J}^{\kappa v_{\parallel}}_{20} I_0^2(\Delta\chi_1)
    \right],
\end{split}\]</p><p>with</p><p class="math-container">\[\begin{split}
        \mathfrak{J}^{\kappa v_{\parallel}}_{\alpha} &amp;= 
    - \mathcal{H}_0^2 \Omega_{\mathrm{M}0} f_2 \mathcal{H}_2 \mathfrak{R}_2 
    \frac{D(\chi_1) (\chi_1 - s_1)}{a(\chi_1) s_1}
    (5 s_{\mathrm{b}, 1}  - 2 )
    \, , \\
    %%%%%%%%%%%%%%%%%%%%%%%%
    \mathfrak{J}^{\kappa v_{\parallel}}_{00} &amp; = 
    \frac{1}{15}
    \left[
        \chi_1^2 y + \chi_1(4 y^2 - 3) s_2 - 2 y s_2^2
    \right]
    \, , \\
    %%%%%%%%%%%%%%%%%%%%%%%%
    \mathfrak{J}^{\kappa v_{\parallel}}_{02} &amp; = 
    \frac{1}{42 \Delta\chi_1^2}
    \left[
        4 \chi_1^4 y + 4 \chi_1^3 (2 y^2 - 3) s_2 +
        \chi_1^2 y (11 - 23 y^2) s_2^2 +
        \right.\\
        &amp;\left.\qquad\qquad\qquad
        \chi_1 (23 y^2 - 3) s_2^3 - 8 y s_2^4
    \right] \nonumber
    \, , \\
    %%%%%%%%%%%%%%%%%%%%%%%%
    \mathfrak{J}^{\kappa v_{\parallel}}_{04} &amp; = 
    \frac{1}{70 \Delta\chi_1^2} 
    \left[
        2\chi_1^4 y + 2 \chi_1^3 (2 y^2 - 3) s_2 -
        \chi_1^2 y (y^2 + 5) s_2^2 + 
        \right.\\
        &amp;\left.\qquad\qquad\qquad
        \chi_1(y^2 + 9) s_2^3 - 4 y s_2^4
    \right] \nonumber
    \, , \\
    %%%%%%%%%%%%%%%%%%%%%%%%
    \mathfrak{J}^{\kappa v_{\parallel}}_{20} &amp; = y \Delta\chi_1^2 
    \,,
\end{split}\]</p><p>where:</p><ul><li><p><span>$s_1$</span> and <span>$s_2$</span> are comoving distances;</p></li><li><p><span>$D_1 = D(s_1)$</span>, ... is the linear growth factor (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$a_1 = a(s_1)$</span>, ... is the scale factor (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$f_1 = f(s_1)$</span>, ... is the linear growth rate (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$\mathcal{H}_1 = \mathcal{H}(s_1)$</span>, ... is the comoving  Hubble distances (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$y = \cos{\theta} = \hat{\mathbf{s}}_1 \cdot \hat{\mathbf{s}}_2$</span>;</p></li><li><p><span>$\mathcal{R}_1 = \mathcal{R}(s_1)$</span>, ... is  computed by <code>func_‚Ñõ_GNC</code> in <code>cosmo::Cosmology</code> (and evaluated in <span>$s_1$</span> ); the definition of <span>$\mathcal{R}(s)$</span> is the following:</p><p class="math-container">\[\mathcal{R}(s) = 5 s_{\mathrm{b}}(s) + \frac{2 - 5 s_{\mathrm{b}}(s)}{\mathcal{H}(s) \, s} +  
\frac{\dot{\mathcal{H}}(s)}{\mathcal{H}(s)^2} - \mathit{f}_{\mathrm{evo}} \quad ;\]</p></li><li><p><span>$\mathfrak{R}_1 = \mathfrak{R}(s_1)$</span>, ... is  computed by <code>func_‚Ñõ_LD</code> in <code>cosmo::Cosmology</code> (and evaluated in <span>$s_1$</span> ); the definition of <span>$\mathcal{R}(s)$</span> is the following:</p><p class="math-container">\[\mathfrak{R}(s) = 1 - \frac{1}{\mathcal{H}(s) s} ;\]</p></li><li><p><span>$b_1$</span>, <span>$s_{\mathrm{b}, 1}$</span>, <span>$\mathit{f}_{\mathrm{evo}, 1}$</span>  (and <span>$b_2$</span>, <span>$s_{\mathrm{b}, 2}$</span>, <span>$\mathit{f}_{\mathrm{evo}, 2}$</span>) :  galaxy bias, magnification bias (i.e. the slope of the luminosity function at the luminosity threshold),  and evolution bias for the first (second) effect;</p></li><li><p><span>$\Omega_{\mathrm{M}0} = \Omega_{\mathrm{cdm}} + \Omega_{\mathrm{b}}$</span> is the sum of  cold-dark-matter and barionic density parameters (again, stored in <code>cosmo</code>);</p></li><li><p><span>$I_\ell^n$</span> and <span>$\sigma_i$</span> are defined as</p><p class="math-container">\[I_\ell^n(s) = \int_0^{+\infty} \frac{\mathrm{d}q}{2\pi^2} 
\, q^2 \, P(q) \, \frac{j_\ell(qs)}{(qs)^n} \quad , 
\quad \sigma_i = \int_0^{+\infty} \frac{\mathrm{d}q}{2\pi^2} 
\, q^{2-i} \, P(q)\]</p><p>with <span>$P(q)$</span> as the matter Power Spectrum at <span>$z=0$</span> (stored in <code>cosmo</code>)  and <span>$j_\ell$</span> as spherical Bessel function of order <span>$\ell$</span>;</p></li><li><p><span>$\tilde{I}_0^4$</span> is defined as</p><p class="math-container">\[\tilde{I}_0^4 = \int_0^{+\infty} \frac{\mathrm{d}q}{2\pi^2} 
\, q^2 \, P(q) \, \frac{j_0(qs) - 1}{(qs)^4}\]</p><p>with <span>$P(q)$</span> as the matter Power Spectrum at <span>$z=0$</span> (stored in <code>cosmo</code>)  and <span>$j_\ell$</span> as spherical Bessel function of order <span>$\ell$</span>;</p></li><li><p><span>$\mathcal{H}_0$</span>, <span>$f_0$</span> and so on are evaluated at the observer position (i.e. at present day);</p></li><li><p><span>$\Delta\chi_1 := \sqrt{\chi_1^2 + s_2^2-2\,\chi_1\,s_2\,y}$</span> and  <span>$\Delta\chi_2 := \sqrt{s_1^2 + \chi_2^2-2\,s_1\,\chi_2\,y}$</span>;</p></li><li><p><span>$s=\sqrt{s_1^2 + s_2^2 - 2 \, s_1 \, s_2 \, y}$</span> and  <span>$\Delta\chi := \sqrt{\chi_1^2 + \chi_2^2-2\,\chi_1\,\chi_2\,y}$</span>.</p></li></ul><p>This function is used inside <code>Œæ_GNCxLD_Lensing_Doppler</code> with the trapz() from the  <a href="https://github.com/francescoalemanno/Trapz.jl">Trapz</a> Julia package.</p><p><strong>Inputs</strong></p><ul><li><p><code>IP::Point</code>, <code>P1::Point</code>, <code>P2::Point</code> or <code>œá1</code>,<code>s1</code>,<code>s2</code>: <code>Point</code>/comoving  distances where the TPCF has to be calculated; they contain all the  data of interest needed for this calculus (comoving distance, growth factor and so on).</p></li><li><p><code>y</code>: the cosine of the angle between the two points <code>P1</code> and <code>P2</code> wrt the observer</p></li><li><p><code>cosmo::Cosmology</code>: cosmology to be used in this computation; it contains all the splines used for the conversion <code>s</code> -&gt; <code>Point</code>, and all the cosmological parameters <span>$b$</span>, ...</p></li></ul><p><strong>Keyword Arguments</strong></p><ul><li><p><code>b1=nothing</code>, <code>s_b1=nothing</code>, <code>ùëì_evo1=nothing</code> and <code>b2=nothing</code>, <code>s_b2=nothing</code>, <code>ùëì_evo2=nothing</code>: galaxy, magnification and evolutionary biases respectively for the first and the second effect  computed in this TPCF:</p><ul><li>if not set (i.e. if you leave the default value <code>nothing</code>) the values stored in the input <code>cosmo</code> will be considered;</li><li>if you set one or more values, they will override the <code>cosmo</code> ones in this computation;</li><li>the two sets of values should be different only if you are interested in studing two galaxy species;</li><li>only the required parameters for the chosen TPCF will be used, depending on its analytical expression; all the others will have no effect, we still inserted them for pragmatical code compatibilities. </li></ul></li><li><p><code>s_lim=nothing</code> : parameter used in order to avoid the divergence of the <span>$\mathcal{R}$</span> and  <span>$\mathfrak{R}$</span> denominators: when <span>$0 \leq s \leq s_\mathrm{lim}$</span> the returned values are</p><p class="math-container">\[\forall \, s \in [ 0, s_\mathrm{lim} ] \; : \quad 
    \mathfrak{R}(s) = 1 - \frac{1}{\mathcal{H}_0 \, s_\mathrm{lim}} \; , \quad
    \mathcal{R}(s) = 5 s_{\mathrm{b}} + 
        \frac{2 - 5 s_{\mathrm{b}}}{\mathcal{H}_0 \, s_\mathrm{lim}} +  
        \frac{\dot{\mathcal{H}}}{\mathcal{H}_0^2} - \mathit{f}_{\mathrm{evo}} \; .\]</p><p>If <code>nothing</code>, the fault value stored in <code>cosmo</code> will be considered.</p></li></ul><p>See also: <a href="../Cosmology/#GaPSE.Point"><code>Point</code></a>, <a href="../Cosmology/#GaPSE.Cosmology"><code>Cosmology</code></a>, <a href="#GaPSE.Œæ_GNCxLD_multipole"><code>Œæ_GNCxLD_multipole</code></a>,  <a href="#GaPSE.map_Œæ_GNCxLD_multipole"><code>map_Œæ_GNCxLD_multipole</code></a>, <a href="#GaPSE.print_map_Œæ_GNCxLD_multipole"><code>print_map_Œæ_GNCxLD_multipole</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/foglienimatteo/GaPSE.jl/blob/e601437c432ee08c2009b9fd4aee18390ba3e877/src/GNCxLD_CrossCorrelations/GNCxLD_LensingDoppler.jl#L88-L274">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GaPSE.integrand_Œæ_GNCxLD_Newtonian_IntegratedGP" href="#GaPSE.integrand_Œæ_GNCxLD_Newtonian_IntegratedGP"><code>GaPSE.integrand_Œæ_GNCxLD_Newtonian_IntegratedGP</code></a> ‚Äî <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">integrand_Œæ_GNCxLD_Newtonian_IntegratedGP(
    IP::Point, P1::Point, P2::Point, y, cosmo::Cosmology;
    b1=nothing, b2=nothing, s_b1=nothing, s_b2=nothing,
    ùëì_evo1=nothing, ùëì_evo2=nothing, s_lim=nothing ) ::Float64

integrand_Œæ_GNCxLD_Newtonian_IntegratedGP(
    œá2::Float64, s1::Float64, s2::Float64,
    y, cosmo::Cosmology; kwargs... ) ::Float64</code></pre><p>Return the integrand of the Two-Point Correlation Function (TPCF) given by the cross correlation  between the Newtonian effect arising from the Galaxy Number Counts (GNC) and the Integrated  Gravitational Potential (GP) one arising from the Luminosity Distance (LD) perturbations.</p><p>In the first method, you should pass the two extreme <code>Point</code>s (<code>P1</code> and <code>P2</code>) and the  intermediate integrand <code>Point</code> (<code>IP</code>) where to  evaluate the function. In the second method (that internally recalls the first), you must provide the three corresponding comoving distances <code>s1</code>, <code>s2</code>, <code>œá2</code>. We remember that all the distances are measured in <span>$h_0^{-1}\mathrm{Mpc}$</span>.</p><p>The analytical expression of this integrand is the following:</p><p class="math-container">\[\begin{split}
    f^{\delta \int\!\phi}(\chi_2, s_1 , s_2, y ) =
    D_1 \;  
    &amp;\mathfrak{J}^{\delta \int\!\phi}_{\alpha}
    \left[ 
      \mathfrak{J}^{\delta \int\!\phi}_{20} I_0^2 ( \Delta\chi_2 ) +
        \right.  \\
        &amp; \left. 
      \mathfrak{J}^{\delta \int\!\phi}_{\beta}
            \left(
                \frac{1}{15} I_0^0 ( \Delta\chi_2 ) + 
                \frac{1}{21} I_2^0 ( \Delta\chi_2 ) +
                \frac{1}{35} I_4^0 ( \Delta\chi_2 )
            \right) 
    \right] \,,
\end{split}\]</p><p>with</p><p class="math-container">\[\begin{split}
  \mathfrak{J}^{\delta \int\!\phi}_{\alpha} &amp;=
    - \frac{\mathcal{H}_0^2 \Omega_{\mathrm{M}0} D(\chi_2)}{3 a(\chi_2) s_2} 
    \left[ 
        s_2 \mathfrak{R}_2 \mathcal{H}(\chi_2) ( f(\chi_2) - 1) - 1
    \right] 
    \, , \\
    %%%%%%%%%%%%%%%%%%%%%
  \mathfrak{J}^{\delta \int\!\phi}_{\beta} &amp;=
    f_1 \left[ 
        (3 y^2 - 1) \chi_2^2 - 4 y s_1 \chi_2 + 2 s_1^2
    \right] 
    \, , \\
    %%%%%%%%%%%%%%%%%%%%%
  \mathfrak{J}^{\delta \int\!\phi}_{20} &amp;=
    - \Delta\chi_2^2 ( 3 b_1 + f_1)
    \, ,
\end{split}\]</p><p>where:</p><ul><li><p><span>$s_1$</span> and <span>$s_2$</span> are comoving distances;</p></li><li><p><span>$D_1 = D(s_1)$</span>, ... is the linear growth factor (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$a_1 = a(s_1)$</span>, ... is the scale factor (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$f_1 = f(s_1)$</span>, ... is the linear growth rate (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$\mathcal{H}_1 = \mathcal{H}(s_1)$</span>, ... is the comoving  Hubble distances (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$y = \cos{\theta} = \hat{\mathbf{s}}_1 \cdot \hat{\mathbf{s}}_2$</span>;</p></li><li><p><span>$\mathcal{R}_1 = \mathcal{R}(s_1)$</span>, ... is  computed by <code>func_‚Ñõ_GNC</code> in <code>cosmo::Cosmology</code> (and evaluated in <span>$s_1$</span> ); the definition of <span>$\mathcal{R}(s)$</span> is the following:</p><p class="math-container">\[\mathcal{R}(s) = 5 s_{\mathrm{b}}(s) + \frac{2 - 5 s_{\mathrm{b}}(s)}{\mathcal{H}(s) \, s} +  
\frac{\dot{\mathcal{H}}(s)}{\mathcal{H}(s)^2} - \mathit{f}_{\mathrm{evo}} \quad ;\]</p></li><li><p><span>$\mathfrak{R}_1 = \mathfrak{R}(s_1)$</span>, ... is  computed by <code>func_‚Ñõ_LD</code> in <code>cosmo::Cosmology</code> (and evaluated in <span>$s_1$</span> ); the definition of <span>$\mathcal{R}(s)$</span> is the following:</p><p class="math-container">\[\mathfrak{R}(s) = 1 - \frac{1}{\mathcal{H}(s) s} ;\]</p></li><li><p><span>$b_1$</span>, <span>$s_{\mathrm{b}, 1}$</span>, <span>$\mathit{f}_{\mathrm{evo}, 1}$</span>  (and <span>$b_2$</span>, <span>$s_{\mathrm{b}, 2}$</span>, <span>$\mathit{f}_{\mathrm{evo}, 2}$</span>) :  galaxy bias, magnification bias (i.e. the slope of the luminosity function at the luminosity threshold),  and evolution bias for the first (second) effect;</p></li><li><p><span>$\Omega_{\mathrm{M}0} = \Omega_{\mathrm{cdm}} + \Omega_{\mathrm{b}}$</span> is the sum of  cold-dark-matter and barionic density parameters (again, stored in <code>cosmo</code>);</p></li><li><p><span>$I_\ell^n$</span> and <span>$\sigma_i$</span> are defined as</p><p class="math-container">\[I_\ell^n(s) = \int_0^{+\infty} \frac{\mathrm{d}q}{2\pi^2} 
\, q^2 \, P(q) \, \frac{j_\ell(qs)}{(qs)^n} \quad , 
\quad \sigma_i = \int_0^{+\infty} \frac{\mathrm{d}q}{2\pi^2} 
\, q^{2-i} \, P(q)\]</p><p>with <span>$P(q)$</span> as the matter Power Spectrum at <span>$z=0$</span> (stored in <code>cosmo</code>)  and <span>$j_\ell$</span> as spherical Bessel function of order <span>$\ell$</span>;</p></li><li><p><span>$\tilde{I}_0^4$</span> is defined as</p><p class="math-container">\[\tilde{I}_0^4 = \int_0^{+\infty} \frac{\mathrm{d}q}{2\pi^2} 
\, q^2 \, P(q) \, \frac{j_0(qs) - 1}{(qs)^4}\]</p><p>with <span>$P(q)$</span> as the matter Power Spectrum at <span>$z=0$</span> (stored in <code>cosmo</code>)  and <span>$j_\ell$</span> as spherical Bessel function of order <span>$\ell$</span>;</p></li><li><p><span>$\mathcal{H}_0$</span>, <span>$f_0$</span> and so on are evaluated at the observer position (i.e. at present day);</p></li><li><p><span>$\Delta\chi_1 := \sqrt{\chi_1^2 + s_2^2-2\,\chi_1\,s_2\,y}$</span> and  <span>$\Delta\chi_2 := \sqrt{s_1^2 + \chi_2^2-2\,s_1\,\chi_2\,y}$</span>;</p></li><li><p><span>$s=\sqrt{s_1^2 + s_2^2 - 2 \, s_1 \, s_2 \, y}$</span> and  <span>$\Delta\chi := \sqrt{\chi_1^2 + \chi_2^2-2\,\chi_1\,\chi_2\,y}$</span>.</p></li></ul><p>This function is used inside <code>Œæ_GNCxLD_Newtonian_IntegratedGP</code> with the trapz() from the  <a href="https://github.com/francescoalemanno/Trapz.jl">Trapz</a> Julia package.</p><p><strong>Inputs</strong></p><ul><li><p><code>IP::Point</code>, <code>P1::Point</code>, <code>P2::Point</code> or <code>œá2</code>,<code>s1</code>,<code>s2</code>: <code>Point</code>/comoving  distances where the TPCF has to be calculated; they contain all the  data of interest needed for this calculus (comoving distance, growth factor and so on).</p></li><li><p><code>y</code>: the cosine of the angle between the two points <code>P1</code> and <code>P2</code> wrt the observer</p></li><li><p><code>cosmo::Cosmology</code>: cosmology to be used in this computation; it contains all the splines used for the conversion <code>s</code> -&gt; <code>Point</code>, and all the cosmological parameters <span>$b$</span>, ...</p></li></ul><p><strong>Keyword Arguments</strong></p><ul><li><p><code>b1=nothing</code>, <code>s_b1=nothing</code>, <code>ùëì_evo1=nothing</code> and <code>b2=nothing</code>, <code>s_b2=nothing</code>, <code>ùëì_evo2=nothing</code>: galaxy, magnification and evolutionary biases respectively for the first and the second effect  computed in this TPCF:</p><ul><li>if not set (i.e. if you leave the default value <code>nothing</code>) the values stored in the input <code>cosmo</code> will be considered;</li><li>if you set one or more values, they will override the <code>cosmo</code> ones in this computation;</li><li>the two sets of values should be different only if you are interested in studing two galaxy species;</li><li>only the required parameters for the chosen TPCF will be used, depending on its analytical expression; all the others will have no effect, we still inserted them for pragmatical code compatibilities. </li></ul></li><li><p><code>s_lim=nothing</code> : parameter used in order to avoid the divergence of the <span>$\mathcal{R}$</span> and  <span>$\mathfrak{R}$</span> denominators: when <span>$0 \leq s \leq s_\mathrm{lim}$</span> the returned values are</p><p class="math-container">\[\forall \, s \in [ 0, s_\mathrm{lim} ] \; : \quad 
    \mathfrak{R}(s) = 1 - \frac{1}{\mathcal{H}_0 \, s_\mathrm{lim}} \; , \quad
    \mathcal{R}(s) = 5 s_{\mathrm{b}} + 
        \frac{2 - 5 s_{\mathrm{b}}}{\mathcal{H}_0 \, s_\mathrm{lim}} +  
        \frac{\dot{\mathcal{H}}}{\mathcal{H}_0^2} - \mathit{f}_{\mathrm{evo}} \; .\]</p><p>If <code>nothing</code>, the fault value stored in <code>cosmo</code> will be considered.</p></li></ul><p>See also: <a href="../Cosmology/#GaPSE.Point"><code>Point</code></a>, <a href="../Cosmology/#GaPSE.Cosmology"><code>Cosmology</code></a>, <a href="#GaPSE.Œæ_GNCxLD_multipole"><code>Œæ_GNCxLD_multipole</code></a>,  <a href="#GaPSE.map_Œæ_GNCxLD_multipole"><code>map_Œæ_GNCxLD_multipole</code></a>, <a href="#GaPSE.print_map_Œæ_GNCxLD_multipole"><code>print_map_Œæ_GNCxLD_multipole</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/foglienimatteo/GaPSE.jl/blob/e601437c432ee08c2009b9fd4aee18390ba3e877/src/GNCxLD_CrossCorrelations/GNCxLD_NewtonianIntegratedGP.jl#L65-L233">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GaPSE.integrand_Œæ_GNCxLD_Lensing_LocalGP" href="#GaPSE.integrand_Œæ_GNCxLD_Lensing_LocalGP"><code>GaPSE.integrand_Œæ_GNCxLD_Lensing_LocalGP</code></a> ‚Äî <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">integrand_Œæ_GNCxLD_Lensing_LocalGP(
	IP::Point, P1::Point, P2::Point, y, cosmo::Cosmology;
	b1=nothing, b2=nothing, s_b1=nothing, s_b2=nothing,
	ùëì_evo1=nothing, ùëì_evo2=nothing, s_lim=nothing ) ::Float64

integrand_Œæ_GNCxLD_Lensing_LocalGP(
	œá1::Float64, s1::Float64, s2::Float64, 
	y, cosmo::Cosmology; kwargs... ) ::Float64</code></pre><p>Return the integrand of the Two-Point Correlation Function (TPCF) given by the cross correlation  between the Lensing effect arising from the  Galaxy Number Counts (GNC) and the Local Gravitational Potential (GP) one arising from the Luminosity Distance (LD) perturbations.</p><p>In the first method, you should pass the two extreme <code>Point</code>s (<code>P1</code> and <code>P2</code>) and the  intermediate integrand <code>Point</code> (<code>IP</code>) where to  evaluate the function. In the second method (that internally recalls the first), you must provide the three corresponding comoving distances <code>s1</code>, <code>s2</code>, <code>œá2</code>. We remember that all the distances are measured in <span>$h_0^{-1}\mathrm{Mpc}$</span>.</p><p>The analytical expression of this integrand is the following:</p><p class="math-container">\[\begin{split}
    f^{\kappa \phi} (\chi_1, s_1, s_2, y) = 
    D_2 
    \mathfrak{J}^{\kappa \phi}_{\alpha} \left[
        \mathfrak{J}^{\kappa \phi}_{31} I_1^3(\Delta\chi_1) +  
        \mathfrak{J}^{\kappa \phi}_{22} I_2^2(\Delta\chi_1)
    \right] \nonumber \, ,
\end{split}\]</p><p>with</p><p class="math-container">\[\begin{split}
    \mathfrak{J}^{\kappa \phi}_{\alpha} &amp;=
    - \frac{
        9 \mathcal{H}_0^4 \Omega_{\mathrm{M}0}^2 s_2 D(\chi_1)(s_1 - \chi_1)
    }{
        4 a_2 s_1a(\chi_1)
    } 
    (1 + \mathfrak{R}_2)
    (5 s_{\mathrm{b}, 1} - 2)
    \, , \\
    %%%%%%%%%%%%%%%%%%%%%%%%
    \mathfrak{J}^{\kappa \phi}_{31} &amp; = -2 y \Delta\chi_1^2 
    \, , \\
    %%%%%%%%%%%%%%%%%%%%%%%%
    \mathfrak{J}^{\kappa \phi}_{22} &amp; = \chi_1 s_2 (1 - y^2) 
    \,,
\end{split}\]</p><p>where:</p><ul><li><p><span>$s_1$</span> and <span>$s_2$</span> are comoving distances;</p></li><li><p><span>$D_1 = D(s_1)$</span>, ... is the linear growth factor (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$a_1 = a(s_1)$</span>, ... is the scale factor (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$f_1 = f(s_1)$</span>, ... is the linear growth rate (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$\mathcal{H}_1 = \mathcal{H}(s_1)$</span>, ... is the comoving  Hubble distances (evaluated in <span>$s_1$</span>);</p></li><li><p><span>$y = \cos{\theta} = \hat{\mathbf{s}}_1 \cdot \hat{\mathbf{s}}_2$</span>;</p></li><li><p><span>$\mathcal{R}_1 = \mathcal{R}(s_1)$</span>, ... is  computed by <code>func_‚Ñõ_GNC</code> in <code>cosmo::Cosmology</code> (and evaluated in <span>$s_1$</span> ); the definition of <span>$\mathcal{R}(s)$</span> is the following:</p><p class="math-container">\[\mathcal{R}(s) = 5 s_{\mathrm{b}}(s) + \frac{2 - 5 s_{\mathrm{b}}(s)}{\mathcal{H}(s) \, s} +  
\frac{\dot{\mathcal{H}}(s)}{\mathcal{H}(s)^2} - \mathit{f}_{\mathrm{evo}} \quad ;\]</p></li><li><p><span>$\mathfrak{R}_1 = \mathfrak{R}(s_1)$</span>, ... is  computed by <code>func_‚Ñõ_LD</code> in <code>cosmo::Cosmology</code> (and evaluated in <span>$s_1$</span> ); the definition of <span>$\mathcal{R}(s)$</span> is the following:</p><p class="math-container">\[\mathfrak{R}(s) = 1 - \frac{1}{\mathcal{H}(s) s} ;\]</p></li><li><p><span>$b_1$</span>, <span>$s_{\mathrm{b}, 1}$</span>, <span>$\mathit{f}_{\mathrm{evo}, 1}$</span>  (and <span>$b_2$</span>, <span>$s_{\mathrm{b}, 2}$</span>, <span>$\mathit{f}_{\mathrm{evo}, 2}$</span>) :  galaxy bias, magnification bias (i.e. the slope of the luminosity function at the luminosity threshold),  and evolution bias for the first (second) effect;</p></li><li><p><span>$\Omega_{\mathrm{M}0} = \Omega_{\mathrm{cdm}} + \Omega_{\mathrm{b}}$</span> is the sum of  cold-dark-matter and barionic density parameters (again, stored in <code>cosmo</code>);</p></li><li><p><span>$I_\ell^n$</span> and <span>$\sigma_i$</span> are defined as</p><p class="math-container">\[I_\ell^n(s) = \int_0^{+\infty} \frac{\mathrm{d}q}{2\pi^2} 
\, q^2 \, P(q) \, \frac{j_\ell(qs)}{(qs)^n} \quad , 
\quad \sigma_i = \int_0^{+\infty} \frac{\mathrm{d}q}{2\pi^2} 
\, q^{2-i} \, P(q)\]</p><p>with <span>$P(q)$</span> as the matter Power Spectrum at <span>$z=0$</span> (stored in <code>cosmo</code>)  and <span>$j_\ell$</span> as spherical Bessel function of order <span>$\ell$</span>;</p></li><li><p><span>$\tilde{I}_0^4$</span> is defined as</p><p class="math-container">\[\tilde{I}_0^4 = \int_0^{+\infty} \frac{\mathrm{d}q}{2\pi^2} 
\, q^2 \, P(q) \, \frac{j_0(qs) - 1}{(qs)^4}\]</p><p>with <span>$P(q)$</span> as the matter Power Spectrum at <span>$z=0$</span> (stored in <code>cosmo</code>)  and <span>$j_\ell$</span> as spherical Bessel function of order <span>$\ell$</span>;</p></li><li><p><span>$\mathcal{H}_0$</span>, <span>$f_0$</span> and so on are evaluated at the observer position (i.e. at present day);</p></li><li><p><span>$\Delta\chi_1 := \sqrt{\chi_1^2 + s_2^2-2\,\chi_1\,s_2\,y}$</span> and  <span>$\Delta\chi_2 := \sqrt{s_1^2 + \chi_2^2-2\,s_1\,\chi_2\,y}$</span>;</p></li><li><p><span>$s=\sqrt{s_1^2 + s_2^2 - 2 \, s_1 \, s_2 \, y}$</span> and  <span>$\Delta\chi := \sqrt{\chi_1^2 + \chi_2^2-2\,\chi_1\,\chi_2\,y}$</span>.</p></li></ul><p>This function is used inside <code>Œæ_GNCxLD_Lensing_LocalGP</code> with the trapz() from the  <a href="https://github.com/francescoalemanno/Trapz.jl">Trapz</a> Julia package.</p><p><strong>Inputs</strong></p><ul><li><p><code>IP::Point</code>, <code>P1::Point</code>, <code>P2::Point</code> or <code>œá1</code>,<code>s1</code>,<code>s2</code>: <code>Point</code>/comoving  distances where the TPCF has to be calculated; they contain all the  data of interest needed for this calculus (comoving distance, growth factor and so on).</p></li><li><p><code>y</code>: the cosine of the angle between the two points <code>P1</code> and <code>P2</code> wrt the observer</p></li><li><p><code>cosmo::Cosmology</code>: cosmology to be used in this computation; it contains all the splines used for the conversion <code>s</code> -&gt; <code>Point</code>, and all the cosmological parameters <span>$b$</span>, ...</p></li></ul><p><strong>Keyword Arguments</strong></p><ul><li><p><code>b1=nothing</code>, <code>s_b1=nothing</code>, <code>ùëì_evo1=nothing</code> and <code>b2=nothing</code>, <code>s_b2=nothing</code>, <code>ùëì_evo2=nothing</code>: galaxy, magnification and evolutionary biases respectively for the first and the second effect  computed in this TPCF:</p><ul><li>if not set (i.e. if you leave the default value <code>nothing</code>) the values stored in the input <code>cosmo</code> will be considered;</li><li>if you set one or more values, they will override the <code>cosmo</code> ones in this computation;</li><li>the two sets of values should be different only if you are interested in studing two galaxy species;</li><li>only the required parameters for the chosen TPCF will be used, depending on its analytical expression; all the others will have no effect, we still inserted them for pragmatical code compatibilities. </li></ul></li><li><p><code>s_lim=nothing</code> : parameter used in order to avoid the divergence of the <span>$\mathcal{R}$</span> and  <span>$\mathfrak{R}$</span> denominators: when <span>$0 \leq s \leq s_\mathrm{lim}$</span> the returned values are</p><p class="math-container">\[\forall \, s \in [ 0, s_\mathrm{lim} ] \; : \quad 
    \mathfrak{R}(s) = 1 - \frac{1}{\mathcal{H}_0 \, s_\mathrm{lim}} \; , \quad
    \mathcal{R}(s) = 5 s_{\mathrm{b}} + 
        \frac{2 - 5 s_{\mathrm{b}}}{\mathcal{H}_0 \, s_\mathrm{lim}} +  
        \frac{\dot{\mathcal{H}}}{\mathcal{H}_0^2} - \mathit{f}_{\mathrm{evo}} \; .\]</p><p>If <code>nothing</code>, the fault value stored in <code>cosmo</code> will be considered.</p></li></ul><p>See also: <a href="../Cosmology/#GaPSE.Point"><code>Point</code></a>, <a href="../Cosmology/#GaPSE.Cosmology"><code>Cosmology</code></a>, <a href="#GaPSE.Œæ_GNCxLD_multipole"><code>Œæ_GNCxLD_multipole</code></a>,  <a href="#GaPSE.map_Œæ_GNCxLD_multipole"><code>map_Œæ_GNCxLD_multipole</code></a>, <a href="#GaPSE.print_map_Œæ_GNCxLD_multipole"><code>print_map_Œæ_GNCxLD_multipole</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/foglienimatteo/GaPSE.jl/blob/e601437c432ee08c2009b9fd4aee18390ba3e877/src/GNCxLD_CrossCorrelations/GNCxLD_LensingLocalGP.jl#L67-L228">source</a></section></article><h2 id="Two-Point-Cross-Correlation-Function-multipoles"><a class="docs-heading-anchor" href="#Two-Point-Cross-Correlation-Function-multipoles">Two-Point Cross-Correlation Function multipoles</a><a id="Two-Point-Cross-Correlation-Function-multipoles-1"></a><a class="docs-heading-anchor-permalink" href="#Two-Point-Cross-Correlation-Function-multipoles" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GaPSE.integrand_Œæ_GNCxLD_multipole" href="#GaPSE.integrand_Œæ_GNCxLD_multipole"><code>GaPSE.integrand_Œæ_GNCxLD_multipole</code></a> ‚Äî <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">integrand_Œæ_GNCxLD_multipole(s1, s, Œº, effect::Function, cosmo::Cosmology;
    L::Int = 0, use_windows::Bool = true, kwargs...)

integrand_Œæ_GNCxLD_multipole(s1, s, Œº, effect::String, cosmo::Cosmology; kwargs...)</code></pre><p>Return the integrand on <span>$\mu = \hat{\mathbf{s}}_1 \cdot \hat{\mathbf{s}}$</span>  of the chosen two-point cross correlation between a Galaxy Number Counts (GNC) effect and a perturbation of the Luminosity Distance (LD)  term, i.e. the following function <span>$f(s_1, s, \mu)$</span>:</p><p class="math-container">\[     f_L(s_1, s, \mu) = \xi \left(s_1, s_2, y\right) 
          \, \mathcal{L}_L(\mu) \, \times 
     \begin{cases} 
          \frac{1}{\mathcal{N}}\mathcal{F}(s, \mu) \quad \mathrm{use\_windows == true} \\
          1 \quad\quad \mathrm{use\_windows == false}
     \end{cases}\]</p><p>where:</p><ul><li><span>$s_2 = s_2(s_1, s, \mu) = \sqrt{s_1^2 + s^2 + 2 \, s_1 \, s \, \mu}$</span> </li><li><span>$y = \cos{\theta} = \hat{\mathbf{s}}_1 \cdot \hat{\mathbf{s}}_2 = \frac{\mu \, s + s_1}{s_2(s_1, s, \mu)}$</span></li><li><span>$\xi$</span> is the corresponding GNCxLD TPCF effect</li><li><span>$\mathcal{L}_L(\mu)$</span> is the Legendre polynomial of order <span>$L$</span></li><li><span>$\mathcal{F}(s, \mu)$</span> is the integrated window function stored in <code>cosmo::Cosmology</code> (check the documentation of <code>WindowFIntegrated</code>)</li><li><span>$\mathcal{N}$</span> is the integrated window function norm (check the documentation of <code>WindowFIntegrated</code>)</li></ul><p>In the former method you have to pass as an input the GNCxLD <code>effect</code> function you want  to integrate, while in the (recommended) latter one it&#39;s necessary to specify the name of the GNCxLD TPCF term among the following:</p><p><code>newton_doppler , newton_lensing , newton_localgp , newton_integratedgp , doppler_doppler , doppler_lensing , doppler_localgp , doppler_integratedgp , lensing_doppler , lensing_lensing , lensing_localgp , lensing_integratedgp , localgp_doppler , localgp_lensing , localgp_localgp , localgp_integratedgp , integratedgp_doppler , integratedgp_lensing , integratedgp_localgp , integratedgp_integratedgp ,</code></p><p>to which correspond the following functions, respectively:</p><p><code>Œæ_GNCxLD_Newtonian_Doppler , Œæ_GNCxLD_Newtonian_Lensing , Œæ_GNCxLD_Newtonian_LocalGP , Œæ_GNCxLD_Newtonian_IntegratedGP , Œæ_GNCxLD_Doppler_Doppler , Œæ_GNCxLD_Doppler_Lensing , Œæ_GNCxLD_Doppler_LocalGP , Œæ_GNCxLD_Doppler_IntegratedGP , Œæ_GNCxLD_Lensing_Doppler , Œæ_GNCxLD_Lensing_Lensing , Œæ_GNCxLD_Lensing_LocalGP , Œæ_GNCxLD_Lensing_IntegratedGP , Œæ_GNCxLD_LocalGP_Doppler , Œæ_GNCxLD_LocalGP_Lensing , Œæ_GNCxLD_LocalGP_LocalGP , Œæ_GNCxLD_LocalGP_IntegratedGP , Œæ_GNCxLD_IntegratedGP_Doppler , Œæ_GNCxLD_IntegratedGP_Lensing , Œæ_GNCxLD_IntegratedGP_LocalGP , Œæ_GNCxLD_IntegratedGP_IntegratedGP ,</code></p><p>Internally, the second method recall the first, so all the keyword arguments are in common.</p><p>Note that these is an internal conversion of coordiate sistems from <code>(s1, s, Œº)</code> to <code>(s1, s2, y)</code> thorugh the functions <code>y</code> and <code>s2</code>. The inverse relations are:</p><ul><li><span>$s = s(s_1, s_2, y) = \sqrt{s_1^2 + s_2^2 - 2 \, s_1 \, s_2 \, y}$</span></li><li><span>$\mu = \cos{\theta} = \hat{\mathbf{s}}_1 \cdot \hat{\mathbf{s}} = \frac{y \, s_2 - s_1}{s(s_1, s_2, y)}$</span>.</li></ul><p><strong>Inputs</strong></p><ul><li><p><code>s1</code>: the comoving distance where must be evaluated the integral</p></li><li><p><code>s</code>: the comoving distance from <code>s1</code> where must be evaluated the integral</p></li><li><p><code>Œº</code>: the cosine between <code>s1</code> and <code>s</code> where must be evaluated the integral</p></li><li><p><code>effect::Function</code> or <code>effect::String</code> : name/function you want to consider, among the ones inside <code>GaPSE.GR_EFFECTS_GNCxLD</code>/<code>GaPSE.VEC_Œæs_GNCxLD</code> respectively.</p></li><li><p><code>cosmo::Cosmology</code>: cosmology to be used in this computation</p></li></ul><p><strong>Optional arguments</strong></p><ul><li><p><code>L::Int = 0</code>: order of the Legendre polynomial to be used</p></li><li><p><code>use_windows::Bool = false</code>: tells if the integrand must consider the two  window function <span>$\phi$</span> and <span>$\mathcal{F}$</span></p></li><li><p><code>kwargs...</code> : other keyword arguments that will be passed to the selected  GR TPCF effect (<code>Œæ_GNCxLD_Doppler</code>, <code>Œæ_GNCxLD_Lensing</code>, ...)</p></li></ul><p>See also: <a href="#GaPSE.Œæ_GNCxLD_multipole"><code>Œæ_GNCxLD_multipole</code></a>, <a href="#GaPSE.map_Œæ_GNCxLD_multipole"><code>map_Œæ_GNCxLD_multipole</code></a>, <a href="#GaPSE.print_map_Œæ_GNCxLD_multipole"><code>print_map_Œæ_GNCxLD_multipole</code></a>, <a href="../WindowFIntegrated/#GaPSE.WindowFIntegrated"><code>WindowFIntegrated</code></a>, <a href="../CosmoUtils/#GaPSE.œï"><code>œï</code></a>, <a href="../Cosmology/#GaPSE.Cosmology"><code>Cosmology</code></a>,  <a href="../CosmoUtils/#GaPSE.y"><code>y</code></a>, <a href="../CosmoUtils/#GaPSE.s2"><code>s2</code></a>, <a href="../Dicts/#GaPSE.GR_EFFECTS_GNCxLD"><code>GR_EFFECTS_GNCxLD</code></a>, <a href="../Dicts/#GaPSE.VEC_Œæs_GNCxLD"><code>GaPSE.VEC_Œæs_GNCxLD</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/foglienimatteo/GaPSE.jl/blob/e601437c432ee08c2009b9fd4aee18390ba3e877/src/GNCxLD_XiMultipoles.jl#L64-L139">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GaPSE.Œæ_GNCxLD_multipole" href="#GaPSE.Œæ_GNCxLD_multipole"><code>GaPSE.Œæ_GNCxLD_multipole</code></a> ‚Äî <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">Œæ_GNCxLD_multipole(
    s1, s, effect::Function, cosmo::Cosmology;
    L::Int = 0, alg::Symbol = :lobatto, 
    use_windows::Bool = true, 
    N_lob::Int = 100, N_trap::Int = 200, 
    atol_quad::Float64 = 0.0, rtol_quad::Float64 = 1e-2,
    enhancer::Float64 = 1e6, 
    kwargs...) ::Float64

Œæ_GNCxLD_multipole(s1, s, effect::String, cosmo::Cosmology; 
    kwargs...) ::Float64</code></pre><p>Evaluate the multipole of order <code>L</code> of the chosen two-point cross correlation  between a Galaxy Number Counts (GNC) effect and a perturbation of the Luminosity Distance (LD)  term i.e. the following function <span>$\xi_L(s_1, s)$</span>:</p><p class="math-container">\[    \xi_L(s_1, s) = \frac{2 L + 1}{2} \int_{-1}^{+1} \mathrm{d}\mu \; 
        \xi (s_1, s_2, \cos{\theta}) \, \mathcal{L}_L(\mu) \,  \times
    \begin{cases} 
        \frac{1}{\mathcal{N}}\mathcal{F}(s, \mu) \quad \mathrm{use\_windows == true} \\
        1 \quad\quad \mathrm{use\_windows == false}
    \end{cases}\]</p><p>where:</p><ul><li><span>$s_2 = s_2(s_1, s, \mu) = \sqrt{s_1^2 + s^2 + 2 \, s_1 \, s \, \mu}$</span> </li><li><span>$y = \cos{\theta} = \hat{\mathbf{s}}_1 \cdot \hat{\mathbf{s}}_2 = \frac{\mu \, s + s_1}{s_2(s_1, s, \mu)}$</span></li><li><span>$\xi$</span> is the corresponding GNCxLD TPCF effect</li><li><span>$\mathcal{L}_L(\mu)$</span> is the Legendre polynomial of order <span>$L$</span></li><li><span>$\mathcal{F}(s, \mu)$</span> is the integrated window function stored in <code>cosmo::Cosmology</code> (check the documentation of <code>WindowFIntegrated</code>)</li><li><span>$\mathcal{N}$</span> is the integrated window function norm (check the documentation of <code>WindowFIntegrated</code>) </li></ul><p>In the former method you have to pass as an input the GNCxLD <code>effect</code> function you want  to integrate, while in the (recommended) latter one it&#39;s necessary to specify the name of the GNCxLD TPCF term among the following:</p><p><code>newton_doppler , newton_lensing , newton_localgp , newton_integratedgp , doppler_doppler , doppler_lensing , doppler_localgp , doppler_integratedgp , lensing_doppler , lensing_lensing , lensing_localgp , lensing_integratedgp , localgp_doppler , localgp_lensing , localgp_localgp , localgp_integratedgp , integratedgp_doppler , integratedgp_lensing , integratedgp_localgp , integratedgp_integratedgp ,</code></p><p>to which correspond the following functions:</p><p><code>Œæ_GNCxLD_Newtonian_Doppler , Œæ_GNCxLD_Newtonian_Lensing , Œæ_GNCxLD_Newtonian_LocalGP , Œæ_GNCxLD_Newtonian_IntegratedGP , Œæ_GNCxLD_Doppler_Doppler , Œæ_GNCxLD_Doppler_Lensing , Œæ_GNCxLD_Doppler_LocalGP , Œæ_GNCxLD_Doppler_IntegratedGP , Œæ_GNCxLD_Lensing_Doppler , Œæ_GNCxLD_Lensing_Lensing , Œæ_GNCxLD_Lensing_LocalGP , Œæ_GNCxLD_Lensing_IntegratedGP , Œæ_GNCxLD_LocalGP_Doppler , Œæ_GNCxLD_LocalGP_Lensing , Œæ_GNCxLD_LocalGP_LocalGP , Œæ_GNCxLD_LocalGP_IntegratedGP , Œæ_GNCxLD_IntegratedGP_Doppler , Œæ_GNCxLD_IntegratedGP_Lensing , Œæ_GNCxLD_IntegratedGP_LocalGP , Œæ_GNCxLD_IntegratedGP_IntegratedGP ,</code></p><p>Internally, the second method recall the first, so all the keyword arguments are in common.</p><p>Note that these is an internal conversion of coordiate sistems from <code>(s1, s, Œº)</code> to <code>(s1, s2, y)</code> thorugh the functions <code>y</code> and <code>s2</code>. The inverse relations are:</p><ul><li><span>$s = s(s_1, s_2, y) = \sqrt{s_1^2 + s_2^2 - 2 \, s_1 \, s_2 \, y}$</span></li><li><span>$\mu = \cos{\theta} = \hat{\mathbf{s}}_1 \cdot \hat{\mathbf{s}} = \frac{y \, s_2 - s_1}{s(s_1, s_2, y)}$</span>.</li></ul><p><strong>Inputs</strong></p><ul><li><p><code>s1</code>: the comoving distance where must be evaluated the integral</p></li><li><p><code>s</code>: the comoving distance from <code>s1</code> where must be evaluated the integral</p></li><li><p><code>effect::Function</code> or <code>effect::String</code> : name/function you want to consider, among the ones inside <code>GaPSE.GR_EFFECTS_GNCxLD</code>/<code>GaPSE.VEC_Œæs_GNCxLD</code> respectively.</p></li><li><p><code>cosmo::Cosmology</code>: cosmology to be used in this computation</p></li></ul><p><strong>Optional arguments</strong></p><ul><li><p><code>L::Int = 0</code>: order of the Legendre polynomial to be used</p></li><li><p><code>alg::Symbol = :trap</code> : algorithm to be used for the integration; the valid options  are (other values will lead to <code>AssertionError</code>):</p><ul><li><code>:quad</code> -&gt; the integration over <span>$\mu$</span> will be preformed through the Julia function <code>quadgk</code> </li></ul><p>from the <a href="https://github.com/JuliaMath/QuadGK.jl"><code>QuadGK.jl</code></a> Julia package, that uses an adaptive  Gauss-Kronrod quadrature.</p><ul><li><code>:trap</code> -&gt; the integration over <span>$\mu$</span> will be preformed through the Julia function <code>trapz</code> </li></ul><p>from the <a href="https://github.com/francescoalemanno/Trapz.jl"><code>Trapz.jl</code></a> Julia package, that uses the simple trapezoidal rulae.</p><ul><li><code>:lobatto</code> -&gt; the integration over <span>$\mu$</span> will be preformed through the Julia function <code>gausslobatto</code> </li></ul><p>from the <a href="https://github.com/JuliaApproximation/FastGaussQuadrature.jl"><code>FastGaussQuadrature.jl</code></a> Julia package,  that uses the Gauss-Lobatto quadrature.  WE RECOMMEND TO USE <code>:quad</code> FOR MONOPOLES AND <code>:lobatto</code> FOR HIGHER ORDER MULTIPOLES!</p></li><li><p><code>use_windows::Bool = false</code>: tells if the integrand must consider the two  window function <span>$\phi$</span> and <span>$\mathcal{F}$</span></p></li><li><p><code>N_lob::Int = 100</code> : number of points to be used in the sampling made by the function <code>trapz</code>. Note that these options will have an effect only if you se <code>alg = :quad</code>.</p></li><li><p><code>N_trap::Int = 200</code> : number of points to be used in the sampling made by the function <code>trapz</code>. Note that these options will have an effect only if you se <code>alg = :quad</code>.</p></li><li><p><code>atol_quad::Float64 = 0.0</code> and <code>rtol_quad::Float64 = 1e-2</code>: absolute and relative tolerance to be passed to the function <code>quadgk</code>; it&#39;s recommended not to set <code>rtol_quad &lt; 1e-2</code>  because the time for evaluation increase quickly. Note that these options will have an effect only if you se <code>alg = :quad</code>.</p></li><li><p><code>enhancer::Float64 = 1e6</code>: just a float number used in order to deal better with small numbers;  the returned value is NOT modified by this value, because after a multiplication the internal result is divided by <code>enhancer</code>.</p></li><li><p><code>kwargs...</code> : other keyword arguments that will be passed to the selected  GNCxLD TPCF effect (<code>Œæ_GNCxLD_Doppler</code>, <code>Œæ_GNCxLD_Lensing</code>, ...)</p></li></ul><p>See also: <a href="#GaPSE.integrand_Œæ_GNCxLD_multipole"><code>integrand_Œæ_GNCxLD_multipole</code></a>,  <a href="#GaPSE.map_Œæ_GNCxLD_multipole"><code>map_Œæ_GNCxLD_multipole</code></a>, <a href="#GaPSE.print_map_Œæ_GNCxLD_multipole"><code>print_map_Œæ_GNCxLD_multipole</code></a> <a href="../WindowFIntegrated/#GaPSE.WindowFIntegrated"><code>WindowFIntegrated</code></a>, <a href="../Cosmology/#GaPSE.Cosmology"><code>Cosmology</code></a>,  <a href="../CosmoUtils/#GaPSE.y"><code>y</code></a>, <a href="../CosmoUtils/#GaPSE.s2"><code>s2</code></a>, <a href="../Dicts/#GaPSE.GR_EFFECTS_GNCxLD"><code>GR_EFFECTS_GNCxLD</code></a>, <a href="../Dicts/#GaPSE.VEC_Œæs_GNCxLD"><code>VEC_Œæs_GNCxLD</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/foglienimatteo/GaPSE.jl/blob/e601437c432ee08c2009b9fd4aee18390ba3e877/src/GNCxLD_XiMultipoles.jl#L211-L317">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GaPSE.map_Œæ_GNCxLD_multipole" href="#GaPSE.map_Œæ_GNCxLD_multipole"><code>GaPSE.map_Œæ_GNCxLD_multipole</code></a> ‚Äî <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">map_Œæ_GNCxLD_multipole(cosmo::Cosmology,
    effect::Union{String,Function}, ss = nothing;
    s1 = nothing, L::Int = 0, alg::Symbol = :lobatto,
    N_lob::Int = 100, N_trap::Int = 50,
    atol_quad::Float64 = 0.0, rtol_quad::Float64 = 1e-2,
    enhancer::Float64=1e6, N_log::Int = 1000, 
    pr::Bool = true,
    kwargs...) ::Tuple{Vector{Float64}, Vector{Float64}}</code></pre><p>Evaluate the multipole of order <code>L</code> of the chosen two-point cross correlation  between a Galaxy Number Counts (GNC) effect and a perturbation of the Luminosity Distance (LD)  term for all the comoving distance  values stored inside <code>ss</code>. If <code>ss = nothing</code>, it is set <code>ss = 10 .^ range(0, log10(2 * cosmo.s_max), length=N_log)</code>. If <code>s1 = nothing</code>, it is set <code>s1 = cosmo.s_eff</code>.</p><p>The function evaluated is then the following <span>$\xi_L(s_1, s)$</span>:</p><p class="math-container">\[    \xi_L(s_1, s) = \frac{2 L + 1}{2} \int_{-1}^{+1} \mathrm{d}\mu \; 
        \xi (s_1, s_2, \cos{\theta}) \, \mathcal{L}_L(\mu) \,  \times
    \begin{cases} 
        \frac{1}{\mathcal{N}}\mathcal{F}(s, \mu) \quad \mathrm{use\_windows == true} \\
        1 \quad\quad \mathrm{use\_windows == false}
    \end{cases}\]</p><p>where:</p><ul><li><span>$s_2 = s_2(s_1, s, \mu) = \sqrt{s_1^2 + s^2 + 2 \, s_1 \, s \, \mu}$</span> </li><li><span>$y = \cos{\theta} = \hat{\mathbf{s}}_1 \cdot \hat{\mathbf{s}}_2 = \frac{\mu \, s + s_1}{s_2(s_1, s, \mu)}$</span></li><li><span>$\xi$</span> is the corresponding GNCxLD TPCF effect</li><li><span>$\mathcal{L}_L(\mu)$</span> is the Legendre polynomial of order <span>$L$</span></li><li><span>$\mathcal{F}(s, \mu)$</span> is the integrated window function stored in <code>cosmo::Cosmology</code> (check the documentation of <code>WindowFIntegrated</code>)</li><li><span>$\mathcal{N}$</span> is the integrated window function norm (check the documentation of <code>WindowFIntegrated</code>) </li></ul><p>Note that these is an internal conversion of coordiate sistems from <code>(s1, s, Œº)</code> to <code>(s1, s2, y)</code> thorugh the functions <code>y</code> and <code>s2</code>. The inverse relations are:</p><ul><li><span>$s = s(s_1, s_2, y) = \sqrt{s_1^2 + s_2^2 - 2 \, s_1 \, s_2 \, y}$</span></li><li><span>$\mu = \cos{\theta} = \hat{\mathbf{s}}_1 \cdot \hat{\mathbf{s}} = \frac{y \, s_2 - s_1}{s(s_1, s_2, y)}$</span>.</li></ul><p><strong>Inputs</strong></p><ul><li><p><code>cosmo::Cosmology</code> : cosmology to be used in this computation</p></li><li><p><code>effect::Union{String,Function}</code> : the GR effect TPCF you want to consider; you may specify the name of the effect as one of the following strings (recommended):</p><p><code>newton_doppler , newton_lensing , newton_localgp , newton_integratedgp , doppler_doppler , doppler_lensing , doppler_localgp , doppler_integratedgp , lensing_doppler , lensing_lensing , lensing_localgp , lensing_integratedgp , localgp_doppler , localgp_lensing , localgp_localgp , localgp_integratedgp , integratedgp_doppler , integratedgp_lensing , integratedgp_localgp , integratedgp_integratedgp ,</code></p><p>or directly the name of the function among the following: </p><p><code>Œæ_GNCxLD_Newtonian_Doppler , Œæ_GNCxLD_Newtonian_Lensing , Œæ_GNCxLD_Newtonian_LocalGP , Œæ_GNCxLD_Newtonian_IntegratedGP , Œæ_GNCxLD_Doppler_Doppler , Œæ_GNCxLD_Doppler_Lensing , Œæ_GNCxLD_Doppler_LocalGP , Œæ_GNCxLD_Doppler_IntegratedGP , Œæ_GNCxLD_Lensing_Doppler , Œæ_GNCxLD_Lensing_Lensing , Œæ_GNCxLD_Lensing_LocalGP , Œæ_GNCxLD_Lensing_IntegratedGP , Œæ_GNCxLD_LocalGP_Doppler , Œæ_GNCxLD_LocalGP_Lensing , Œæ_GNCxLD_LocalGP_LocalGP , Œæ_GNCxLD_LocalGP_IntegratedGP , Œæ_GNCxLD_IntegratedGP_Doppler , Œæ_GNCxLD_IntegratedGP_Lensing , Œæ_GNCxLD_IntegratedGP_LocalGP , Œæ_GNCxLD_IntegratedGP_IntegratedGP ,</code></p></li><li><p><code>ss</code> : vector/range of <code>s</code> values where the function must be evaluated; if <code>ss = nothing</code>,  it is set <code>ss = 10 .^ range(0, log10(2 * cosmo.s_max), length=N_log)</code>. This is why it is returned  also the vector of the &quot;input&quot; values.</p></li></ul><p><strong>Optional arguments</strong></p><ul><li><p><code>s1 = nothing</code> : comoving distance from the observer where the TPCF should be evaluated; if <code>s1 = nothing</code>, it is automatically set <code>s1 = cosmo.s_eff</code> from the given input <code>cosmo::Cosmology</code>.</p></li><li><p><code>L::Int = 0</code>: order of the Legendre polynomial to be used</p></li><li><p><code>alg::Symbol = :trap</code> : algorithm to be used for the integration; the valid options  are (other values will lead to <code>AssertionError</code>):</p><ul><li><code>:quad</code> -&gt; the integration over <span>$\mu$</span> will be preformed through the Julia function <code>quadgk</code>  from the <a href="https://github.com/JuliaMath/QuadGK.jl"><code>QuadGK.jl</code></a> Julia package, that uses an adaptive  Gauss-Kronrod quadrature.</li><li><code>:trap</code> -&gt; the integration over <span>$\mu$</span> will be preformed through the Julia function <code>trapz</code>  from the <a href="https://github.com/francescoalemanno/Trapz.jl"><code>Trapz.jl</code></a> Julia package, that uses the simple trapezoidal rulae.</li><li><code>:lobatto</code> -&gt; the integration over <span>$\mu$</span> will be preformed through the Julia function <code>gausslobatto</code>  from the <a href="https://github.com/JuliaApproximation/FastGaussQuadrature.jl"><code>FastGaussQuadrature.jl</code></a> Julia package,  that uses the Gauss-Lobatto quadrature.  WE RECOMMEND TO USE <code>:quad</code> FOR MONOPOLES AND <code>:lobatto</code> FOR HIGHER ORDER MULTIPOLES!</li></ul></li><li><p><code>use_windows::Bool = false</code>: tells if the integrand must consider the two  window function <span>$\phi$</span> and <span>$\mathcal{F}$</span></p></li><li><p><code>N_lob::Int = 100</code> : number of points to be used in the sampling made by the function <code>trapz</code>. Note that these options will have an effect only if you se <code>alg = :quad</code>.</p></li><li><p><code>N_trap::Int = 200</code> : number of points to be used in the sampling made by the function <code>trapz</code>. Note that these options will have an effect only if you se <code>alg = :quad</code>.</p></li><li><p><code>atol_quad::Float64 = 0.0</code> and <code>rtol_quad::Float64 = 1e-2</code>: absolute and relative tolerance to be passed to the function <code>quadgk</code>; it&#39;s recommended not to set <code>rtol_quad &lt; 1e-2</code>  because the time for evaluation increase quickly. Note that these options will have an effect only if you se <code>alg = :quad</code>.</p></li><li><p><code>enhancer::Float64 = 1e6</code>: just a float number used in order to deal better with small numbers;  the returned value is NOT modified by this value, because after a multiplication the internal result is divided by <code>enhancer</code>.</p></li><li><p><code>N_log::Int = 1000</code> : number of points to be used in the default logaritmically-spaced  range for <code>ss</code>, i.e. <code>range(0, log10(2 * cosmo.s_max), length=N_log)</code>; it is ignored if <code>ss ‚â† nothing</code> </p></li><li><p><code>pr::Bool = true</code> : do you want the progress bar showed on screen, in order to  check the time needed for the computation? (<code>true</code> recommended)</p></li><li><p><code>kwargs...</code> : other keyword arguments that will be passed to the selected  GNCxLD TPCF effect (<code>Œæ_GNCxLD_Doppler</code>, <code>Œæ_GNCxLD_Lensing</code>, ...)</p></li></ul><p><strong>Returns</strong></p><p>A <code>Tuple{Vector{Float64}, Vector{Float64}}</code>, which has as first element the <code>ss</code> vector and as second one the corresponding Œæ value evaluated.</p><p>See also: <a href="#GaPSE.integrand_Œæ_GNCxLD_multipole"><code>integrand_Œæ_GNCxLD_multipole</code></a>, <a href="#GaPSE.Œæ_GNCxLD_multipole"><code>Œæ_GNCxLD_multipole</code></a>, <a href="#GaPSE.print_map_Œæ_GNCxLD_multipole"><code>print_map_Œæ_GNCxLD_multipole</code></a>, <a href="../WindowFIntegrated/#GaPSE.WindowFIntegrated"><code>WindowFIntegrated</code></a>, <a href="../Cosmology/#GaPSE.Cosmology"><code>Cosmology</code></a>,  <a href="../CosmoUtils/#GaPSE.y"><code>y</code></a>, <a href="../CosmoUtils/#GaPSE.s2"><code>s2</code></a>, <a href="../Dicts/#GaPSE.GR_EFFECTS_GNCxLD"><code>GR_EFFECTS_GNCxLD</code></a>, <a href="../Dicts/#GaPSE.VEC_Œæs_GNCxLD"><code>GaPSE.VEC_Œæs_GNCxLD</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/foglienimatteo/GaPSE.jl/blob/e601437c432ee08c2009b9fd4aee18390ba3e877/src/GNCxLD_XiMultipoles.jl#L324-L440">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GaPSE.print_map_Œæ_GNCxLD_multipole" href="#GaPSE.print_map_Œæ_GNCxLD_multipole"><code>GaPSE.print_map_Œæ_GNCxLD_multipole</code></a> ‚Äî <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">print_map_Œæ_GNCxLD_multipole(
    cosmo::Cosmology, out::String,
    effect::Union{String,Function},
    ss = nothing;
    s1 = nothing, L::Int = 0, alg::Symbol = :lobatto,
    N_lob::Int = 100, N_trap::Int = 50,
    atol_quad::Float64 = 0.0, rtol_quad::Float64 = 1e-2,
    enhancer::Float64=1e6, N_log::Int = 1000, 
    pr::Bool = true,
    kwargs...)</code></pre><p>Evaluate the multipole of order <code>L</code> of the of the chosen two-point cross correlation  between a Galaxy Number Counts (GNC) effect and a perturbation of the Luminosity Distance (LD)  term for all the  comoving distance  values stored inside <code>ss</code>, and print the results (with all the options used)  in a file named <code>out</code>. If <code>ss = nothing</code>, it is set <code>ss = 10 .^ range(0, log10(2 * cosmo.s_max), length=N_log)</code>. If <code>s1 = nothing</code>, it is set <code>s1 = cosmo.s_eff</code>.</p><p>The function evaluated is then the following <span>$\xi_L(s_1, s)$</span>:</p><p class="math-container">\[    \xi_L(s_1, s) = \frac{2 L + 1}{2} \int_{-1}^{+1} \mathrm{d}\mu \; 
        \xi (s_1, s_2, \cos{\theta}) \, \mathcal{L}_L(\mu) \,  \times
    \begin{cases} 
        \frac{1}{\mathcal{N}}\mathcal{F}(s, \mu) \quad \mathrm{use\_windows == true} \\
        1 \quad\quad \mathrm{use\_windows == false}
    \end{cases}\]</p><p>where:</p><ul><li><span>$s_2 = s_2(s_1, s, \mu) = \sqrt{s_1^2 + s^2 + 2 \, s_1 \, s \, \mu}$</span> </li><li><span>$y = \cos{\theta} = \hat{\mathbf{s}}_1 \cdot \hat{\mathbf{s}}_2 = \frac{\mu \, s + s_1}{s_2(s_1, s, \mu)}$</span></li><li><span>$\xi$</span> is the corresponding GNCxLD TPCF effect</li><li><span>$\mathcal{L}_L(\mu)$</span> is the Legendre polynomial of order <span>$L$</span></li><li><span>$\mathcal{F}(s, \mu)$</span> is the integrated window function stored in <code>cosmo::Cosmology</code> (check the documentation of <code>WindowFIntegrated</code>)</li><li><span>$\mathcal{N}$</span> is the integrated window function norm (check the documentation of <code>WindowFIntegrated</code>) </li></ul><p>Note that these is an internal conversion of coordiate sistems from <code>(s1, s, Œº)</code> to <code>(s1, s2, y)</code> thorugh the functions <code>y</code> and <code>s2</code>. The inverse relations are:</p><ul><li><span>$s = s(s_1, s_2, y) = \sqrt{s_1^2 + s_2^2 - 2 \, s_1 \, s_2 \, y}$</span></li><li><span>$\mu = \cos{\theta} = \hat{\mathbf{s}}_1 \cdot \hat{\mathbf{s}} = \frac{y \, s_2 - s_1}{s(s_1, s_2, y)}$</span>.</li></ul><p><strong>Inputs</strong></p><ul><li><p><code>cosmo::Cosmology</code> : cosmology to be used in this computation</p></li><li><p><code>effect::Union{String,Function}</code> : the GR effect TPCF you want to consider; you may specify the name of the effect as one of the following strings (recommended):</p><p><code>newton_doppler , newton_lensing , newton_localgp , newton_integratedgp , doppler_doppler , doppler_lensing , doppler_localgp , doppler_integratedgp , lensing_doppler , lensing_lensing , lensing_localgp , lensing_integratedgp , localgp_doppler , localgp_lensing , localgp_localgp , localgp_integratedgp , integratedgp_doppler , integratedgp_lensing , integratedgp_localgp , integratedgp_integratedgp ,</code></p><p>or directly the name of the function among the following: </p><p><code>Œæ_GNCxLD_Newtonian_Doppler , Œæ_GNCxLD_Newtonian_Lensing , Œæ_GNCxLD_Newtonian_LocalGP , Œæ_GNCxLD_Newtonian_IntegratedGP , Œæ_GNCxLD_Doppler_Doppler , Œæ_GNCxLD_Doppler_Lensing , Œæ_GNCxLD_Doppler_LocalGP , Œæ_GNCxLD_Doppler_IntegratedGP , Œæ_GNCxLD_Lensing_Doppler , Œæ_GNCxLD_Lensing_Lensing , Œæ_GNCxLD_Lensing_LocalGP , Œæ_GNCxLD_Lensing_IntegratedGP , Œæ_GNCxLD_LocalGP_Doppler , Œæ_GNCxLD_LocalGP_Lensing , Œæ_GNCxLD_LocalGP_LocalGP , Œæ_GNCxLD_LocalGP_IntegratedGP , Œæ_GNCxLD_IntegratedGP_Doppler , Œæ_GNCxLD_IntegratedGP_Lensing , Œæ_GNCxLD_IntegratedGP_LocalGP , Œæ_GNCxLD_IntegratedGP_IntegratedGP ,</code></p></li><li><p><code>out::String</code> : name of the file where the results must be stored.</p></li><li><p><code>ss</code> : vector/range of <code>s</code> values where the function must be evaluated; if <code>ss = nothing</code>,  it is set <code>ss = 10 .^ range(0, log10(2 * cosmo.s_max), length=N_log)</code>.</p></li></ul><p><strong>Optional arguments</strong></p><p>This function recall internally <code>map_Œæ_GNCxLD_multipole</code>, so the kwargs are the same; we report them for comfortness:</p><ul><li><p><code>s1 = nothing</code> : comoving distance from the observer where the TPCF should be evaluated; if <code>s1 = nothing</code>, it is automatically set <code>s1 = cosmo.s_eff</code> from the given input <code>cosmo::Cosmology</code>.</p></li><li><p><code>L::Int = 0</code>: order of the Legendre polynomial to be used</p></li><li><p><code>alg::Symbol = :trap</code> : algorithm to be used for the integration; the valid options  are (other values will lead to <code>AssertionError</code>):</p><ul><li><code>:quad</code> -&gt; the integration over <span>$\mu$</span> will be preformed through the Julia function <code>quadgk</code>  from the <a href="https://github.com/JuliaMath/QuadGK.jl"><code>QuadGK.jl</code></a> Julia package, that uses an adaptive  Gauss-Kronrod quadrature.</li><li><code>:trap</code> -&gt; the integration over <span>$\mu$</span> will be preformed through the Julia function <code>trapz</code>  from the <a href="https://github.com/francescoalemanno/Trapz.jl"><code>Trapz.jl</code></a> Julia package, that uses the simple trapezoidal rulae.</li><li><code>:lobatto</code> -&gt; the integration over <span>$\mu$</span> will be preformed through the Julia function <code>gausslobatto</code>  from the <a href="https://github.com/JuliaApproximation/FastGaussQuadrature.jl"><code>FastGaussQuadrature.jl</code></a> Julia package,  that uses the Gauss-Lobatto quadrature.  WE RECOMMEND TO USE <code>:quad</code> FOR MONOPOLES AND <code>:lobatto</code> FOR HIGHER ORDER MULTIPOLES!</li></ul></li><li><p><code>use_windows::Bool = false</code>: tells if the integrand must consider the two  window function <span>$\phi$</span> and <span>$\mathcal{F}$</span></p></li><li><p><code>N_lob::Int = 100</code> : number of points to be used in the sampling made by the function <code>trapz</code>. Note that these options will have an effect only if you se <code>alg = :quad</code>.</p></li><li><p><code>N_trap::Int = 200</code> : number of points to be used in the sampling made by the function <code>trapz</code>. Note that these options will have an effect only if you se <code>alg = :quad</code>.</p></li><li><p><code>atol_quad::Float64 = 0.0</code> and <code>rtol_quad::Float64 = 1e-2</code>: absolute and relative tolerance to be passed to the function <code>quadgk</code>; it&#39;s recommended not to set <code>rtol_quad &lt; 1e-2</code>  because the time for evaluation increase quickly. Note that these options will have an effect only if you se <code>alg = :quad</code>.</p></li><li><p><code>enhancer::Float64 = 1e6</code>: just a float number used in order to deal better with small numbers;  the returned value is NOT modified by this value, because after a multiplication the internal result is divided by <code>enhancer</code>.</p></li><li><p><code>N_log::Int = 1000</code> : number of points to be used in the default logaritmically-spaced  range for <code>ss</code>, i.e. <code>range(0, log10(2 * cosmo.s_max), length=N_log)</code>; it is ignored if <code>ss ‚â† nothing</code> </p></li><li><p><code>pr::Bool = true</code> : do you want the progress bar showed on screen, in order to  check the time needed for the computation? (<code>true</code> recommended)</p></li><li><p><code>kwargs...</code> : other keyword arguments that will be passed to the selected  GNCxLD TPCF effect (<code>Œæ_GNCxLD_Doppler</code>, <code>Œæ_GNCxLD_Lensing</code>, ...)</p></li></ul><p>See also: <a href="#GaPSE.integrand_Œæ_GNCxLD_multipole"><code>integrand_Œæ_GNCxLD_multipole</code></a>, <a href="#GaPSE.Œæ_GNCxLD_multipole"><code>Œæ_GNCxLD_multipole</code></a>, <a href="#GaPSE.print_map_Œæ_GNCxLD_multipole"><code>print_map_Œæ_GNCxLD_multipole</code></a>, <a href="../WindowFIntegrated/#GaPSE.WindowFIntegrated"><code>WindowFIntegrated</code></a>, <a href="../Cosmology/#GaPSE.Cosmology"><code>Cosmology</code></a>,  <a href="../CosmoUtils/#GaPSE.y"><code>y</code></a>, <a href="../CosmoUtils/#GaPSE.s2"><code>s2</code></a>, <a href="../Dicts/#GaPSE.GR_EFFECTS_GNCxLD"><code>GR_EFFECTS_GNCxLD</code></a>, <a href="../Dicts/#GaPSE.VEC_Œæs_GNCxLD"><code>GaPSE.VEC_Œæs_GNCxLD</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/foglienimatteo/GaPSE.jl/blob/e601437c432ee08c2009b9fd4aee18390ba3e877/src/GNCxLD_XiMultipoles.jl#L533-L650">source</a></section></article><h2 id="Two-Point-Cross-Correlation-Function-Sum-multipoles"><a class="docs-heading-anchor" href="#Two-Point-Cross-Correlation-Function-Sum-multipoles">Two-Point Cross-Correlation Function Sum multipoles</a><a id="Two-Point-Cross-Correlation-Function-Sum-multipoles-1"></a><a class="docs-heading-anchor-permalink" href="#Two-Point-Cross-Correlation-Function-Sum-multipoles" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GaPSE.sum_Œæ_GNCxLD_multipole" href="#GaPSE.sum_Œæ_GNCxLD_multipole"><code>GaPSE.sum_Œæ_GNCxLD_multipole</code></a> ‚Äî <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">sum_Œæ_GNCxLD_multipole(s1, s, cosmo::Cosmology;
    s1 = nothing, L::Int = 0, alg::Symbol = :lobatto,
    N_lob::Int = 100, N_trap::Int = 50,
    atol_quad::Float64 = 0.0, rtol_quad::Float64 = 1e-2,
    enhancer::Float64=1e6, N_log::Int = 1000, 
    pr::Bool = true,
    kwargs...) ::Tuple{Float64, Vector{Float64}}</code></pre><p>Evaluate the multipole of order <code>L</code> of all the two-point cross correlation multipole between  the Galaxy Number Counts (GNC) and the perturbations of the Luminosity Distance (LD)   and their sum in the comoving distance <code>s1</code> and a comoving distance <code>s</code> from it  for the input <code>cosmo::Cosmology</code>. We remember that all the distances are measured in <span>$h_0^{-1}\mathrm{Mpc}$</span>.</p><p>This function makes a for-loop on the <code>GaPSE.GR_EFFECTS_GNCxLD</code> strings, calling  <code>Œæ_GNCxLD_multipole</code> for each of them. To each string corresponds pretty intuitively one of the  20 GNCxLD effects. They are currently, in order:</p><p><code>newton_doppler , newton_lensing , newton_localgp , newton_integratedgp , doppler_doppler , doppler_lensing , doppler_localgp , doppler_integratedgp , lensing_doppler , lensing_lensing , lensing_localgp , lensing_integratedgp , localgp_doppler , localgp_lensing , localgp_localgp , localgp_integratedgp , integratedgp_doppler , integratedgp_lensing , integratedgp_localgp , integratedgp_integratedgp ,</code></p><p><strong>Inputs</strong></p><ul><li><p><code>s1</code>: the comoving distance where must be evaluated the integral</p></li><li><p><code>s</code>: the comoving distance from <code>s1</code> where must be evaluated the integral</p></li><li><p><code>cosmo::Cosmology</code>: cosmology to be used in this computation</p></li></ul><p><strong>Optional arguments</strong></p><p>This function recall internally <code>Œæ_GNCxLD_multipole</code>, so the kwargs are the same; we report them for comfortness:</p><ul><li><p><code>L::Int = 0</code>: order of the Legendre polynomial to be used</p></li><li><p><code>alg::Symbol = :trap</code> : algorithm to be used for the integration; the valid options  are (other values will lead to <code>AssertionError</code>):</p><ul><li><code>:quad</code> -&gt; the integration over <span>$\mu$</span> will be preformed through the Julia function <code>quadgk</code>  from the <a href="https://github.com/JuliaMath/QuadGK.jl"><code>QuadGK.jl</code></a> Julia package, that uses an adaptive  Gauss-Kronrod quadrature.</li><li><code>:trap</code> -&gt; the integration over <span>$\mu$</span> will be preformed through the Julia function <code>trapz</code>  from the <a href="https://github.com/francescoalemanno/Trapz.jl"><code>Trapz.jl</code></a> Julia package, that uses the simple trapezoidal rulae.</li><li><code>:lobatto</code> -&gt; the integration over <span>$\mu$</span> will be preformed through the Julia function <code>gausslobatto</code>  from the <a href="https://github.com/JuliaApproximation/FastGaussQuadrature.jl"><code>FastGaussQuadrature.jl</code></a> Julia package,  that uses the Gauss-Lobatto quadrature.  WE RECOMMEND TO USE <code>:quad</code> FOR MONOPOLES AND <code>:lobatto</code> FOR HIGHER ORDER MULTIPOLES!</li></ul></li><li><p><code>use_windows::Bool = false</code>: tells if the integrand must consider the two  window function <span>$\phi$</span> and <span>$\mathcal{F}$</span></p></li><li><p><code>N_lob::Int = 100</code> : number of points to be used in the sampling made by the function <code>trapz</code>. Note that these options will have an effect only if you se <code>alg = :quad</code>.</p></li><li><p><code>N_trap::Int = 200</code> : number of points to be used in the sampling made by the function <code>trapz</code>. Note that these options will have an effect only if you se <code>alg = :quad</code>.</p></li><li><p><code>atol_quad::Float64 = 0.0</code> and <code>rtol_quad::Float64 = 1e-2</code>: absolute and relative tolerance to be passed to the function <code>quadgk</code>; it&#39;s recommended not to set <code>rtol_quad &lt; 1e-2</code>  because the time for evaluation increase quickly. Note that these options will have an effect only if you se <code>alg = :quad</code>.</p></li><li><p><code>enhancer::Float64 = 1e6</code>: just a float number used in order to deal better with small numbers;  the returned value is NOT modified by this value, because after a multiplication the internal result is divided by <code>enhancer</code>.</p></li><li><p><code>kwargs...</code> : other keyword arguments that will be passed to ALL the  GNCxLD TPCF effect (<code>Œæ_GNCxLD_Doppler</code>, <code>Œæ_GNCxLD_Lensing</code>, ...); if one of them has that keyword argument, it will use the given value, otherwise it will be unaffected.</p></li></ul><p><strong>Returns</strong></p><p>A tuple containing:</p><ul><li>the sum of all the Œæ multipoles as first element</li><li>a <code>Vector{Float64}</code> with all the values of each Œæ; they are ordered following <code>GR_EFFECTS_GNCxLD</code></li></ul><p>See also: <a href="#GaPSE.integrand_Œæ_GNCxLD_multipole"><code>integrand_Œæ_GNCxLD_multipole</code></a>, <a href="#GaPSE.Œæ_GNCxLD_multipole"><code>Œæ_GNCxLD_multipole</code></a>, <a href="#GaPSE.map_sum_Œæ_GNCxLD_multipole"><code>map_sum_Œæ_GNCxLD_multipole</code></a>, <a href="#GaPSE.print_map_sum_Œæ_GNCxLD_multipole"><code>print_map_sum_Œæ_GNCxLD_multipole</code></a>, <a href="../Cosmology/#GaPSE.Cosmology"><code>Cosmology</code></a>, <a href="../Dicts/#GaPSE.GR_EFFECTS_GNCxLD"><code>GR_EFFECTS_GNCxLD</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/foglienimatteo/GaPSE.jl/blob/e601437c432ee08c2009b9fd4aee18390ba3e877/src/GNCxLD_SumXiMultipoles.jl#L22-L104">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GaPSE.map_sum_Œæ_GNCxLD_multipole" href="#GaPSE.map_sum_Œæ_GNCxLD_multipole"><code>GaPSE.map_sum_Œæ_GNCxLD_multipole</code></a> ‚Äî <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">map_sum_Œæ_GNCxLD_multipole(
    effect::Union{String,Function}, ss = nothing;
    s1 = nothing, L::Int = 0, alg::Symbol = :lobatto,
    N_lob::Int = 100, N_trap::Int = 50,
    atol_quad::Float64 = 0.0, rtol_quad::Float64 = 1e-2,
    enhancer::Float64=1e6, N_log::Int = 1000, 
    pr::Bool = true,
    kwargs...) ::Tuple{Vector{Float64}, Vector{Float64}, Vector{Vector{Float64}}}</code></pre><p>Evaluate the multipole of order <code>L</code> of all the two-point cross correlation multipole between  the Galaxy Number Counts (GNC) and the perturbations of the Luminosity Distance (LD) and their sum in the comoving distance <code>s1</code>,  for all the comoving distances stored inside <code>ss</code> (representing  the comoving distance from <code>s1</code>) for the input <code>cosmo::Cosmology</code>. If <code>ss = nothing</code>, it is set <code>ss = 10 .^ range(0, log10(2 * cosmo.s_max), length=N_log)</code>. If <code>s1 = nothing</code>, it is set <code>s1 = cosmo.s_eff</code>. We remember that all the distances are measured in <span>$h_0^{-1}\mathrm{Mpc}$</span>.</p><p>This function makes a for-loop on the <code>GaPSE.GR_EFFECTS_GNCxLD</code> strings, calling  <code>map_Œæ_GNCxLD_multipole</code> for each of them. To each string corresponds pretty intuitively one of the  20 GNCxLD effects. They are currently, in order:</p><p><code>newton_doppler , newton_lensing , newton_localgp , newton_integratedgp , doppler_doppler , doppler_lensing , doppler_localgp , doppler_integratedgp , lensing_doppler , lensing_lensing , lensing_localgp , lensing_integratedgp , localgp_doppler , localgp_lensing , localgp_localgp , localgp_integratedgp , integratedgp_doppler , integratedgp_lensing , integratedgp_localgp , integratedgp_integratedgp ,</code></p><p><strong>Inputs</strong></p><ul><li><p><code>cosmo::Cosmology</code> : cosmology to be used in this computation</p></li><li><p><code>ss</code> : vector/range of <code>s</code> values where the function must be evaluated; if <code>ss = nothing</code>,  it is set <code>ss = 10 .^ range(0, log10(2 * cosmo.s_max), length=N_log)</code>. This is why it is returned  also the vector of the &quot;input&quot; values.</p></li></ul><p><strong>Optional arguments</strong></p><p>This function recall internally <code>map_Œæ_GNCxLD_multipole</code>, so the kwargs are the same; we report them for comfortness:</p><ul><li><p><code>s1 = nothing</code> : comoving distance from the observer where the TPCF should be evaluated; if <code>s1 = nothing</code>, it is automatically set <code>s1 = cosmo.s_eff</code> from the given input <code>cosmo::Cosmology</code>.</p></li><li><p><code>L::Int = 0</code>: order of the Legendre polynomial to be used</p></li><li><p><code>alg::Symbol = :trap</code> : algorithm to be used for the integration; the valid options  are (other values will lead to <code>AssertionError</code>):</p><ul><li><code>:quad</code> -&gt; the integration over <span>$\mu$</span> will be preformed through the Julia function <code>quadgk</code>  from the <a href="https://github.com/JuliaMath/QuadGK.jl"><code>QuadGK.jl</code></a> Julia package, that uses an adaptive  Gauss-Kronrod quadrature.</li><li><code>:trap</code> -&gt; the integration over <span>$\mu$</span> will be preformed through the Julia function <code>trapz</code>  from the <a href="https://github.com/francescoalemanno/Trapz.jl"><code>Trapz.jl</code></a> Julia package, that uses the simple trapezoidal rulae.</li><li><code>:lobatto</code> -&gt; the integration over <span>$\mu$</span> will be preformed through the Julia function <code>gausslobatto</code>  from the <a href="https://github.com/JuliaApproximation/FastGaussQuadrature.jl"><code>FastGaussQuadrature.jl</code></a> Julia package,  that uses the Gauss-Lobatto quadrature.  WE RECOMMEND TO USE <code>:quad</code> FOR MONOPOLES AND <code>:lobatto</code> FOR HIGHER ORDER MULTIPOLES!</li></ul></li><li><p><code>use_windows::Bool = false</code>: tells if the integrand must consider the two  window function <span>$\phi$</span> and <span>$\mathcal{F}$</span></p></li></ul><ul><li><p><code>N_lob::Int = 100</code> : number of points to be used in the sampling made by the function <code>trapz</code>. Note that these options will have an effect only if you se <code>alg = :quad</code>.</p></li><li><p><code>N_trap::Int = 200</code> : number of points to be used in the sampling made by the function <code>trapz</code>. Note that these options will have an effect only if you se <code>alg = :quad</code>.</p></li><li><p><code>atol_quad::Float64 = 0.0</code> and <code>rtol_quad::Float64 = 1e-2</code>: absolute and relative tolerance to be passed to the function <code>quadgk</code>; it&#39;s recommended not to set <code>rtol_quad &lt; 1e-2</code>  because the time for evaluation increase quickly. Note that these options will have an effect only if you se <code>alg = :quad</code>.</p></li><li><p><code>enhancer::Float64 = 1e6</code>: just a float number used in order to deal better with small numbers;  the returned value is NOT modified by this value, because after a multiplication the internal result is divided by <code>enhancer</code>.</p></li><li><p><code>N_log::Int = 1000</code> : number of points to be used in the default logaritmically-spaced  range for <code>ss</code>, i.e. <code>range(0, log10(2 * cosmo.s_max), length=N_log)</code>; it is ignored if <code>ss ‚â† nothing</code> </p></li><li><p><code>pr::Bool = true</code> : do you want the progress bar showed on screen, in order to  check the time needed for the computation? (<code>true</code> recommended)</p></li><li><p><code>kwargs...</code> : other keyword arguments that will be passed to ALL the  GNCxLD TPCF effect (<code>Œæ_GNCxLD_Doppler</code>, <code>Œæ_GNCxLD_Lensing</code>, ...); if one of them has that keyword argument, it will use the given value, otherwise it will be unaffected.</p></li></ul><p><strong>Returns</strong></p><p>A tuple containing:</p><ul><li>as first element, the vector <code>ss</code> itself;</li><li>as second one, the  <code>Vector{Float64}</code> of the sum of all the Œæ multipoles;</li><li>as third one, a <code>Vector{Vector{Float64}}</code> with all the values of each Œæ; they are ordered following <code>GR_EFFECTS_GNCxLD</code></li></ul><p>See also: <a href="#GaPSE.map_Œæ_GNCxLD_multipole"><code>map_Œæ_GNCxLD_multipole</code></a>, <a href="#GaPSE.sum_Œæ_GNCxLD_multipole"><code>sum_Œæ_GNCxLD_multipole</code></a>, <a href="#GaPSE.print_map_sum_Œæ_GNCxLD_multipole"><code>print_map_sum_Œæ_GNCxLD_multipole</code></a>, <a href="../Cosmology/#GaPSE.Cosmology"><code>Cosmology</code></a>, <a href="../Dicts/#GaPSE.GR_EFFECTS_GNCxLD"><code>GR_EFFECTS_GNCxLD</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/foglienimatteo/GaPSE.jl/blob/e601437c432ee08c2009b9fd4aee18390ba3e877/src/GNCxLD_SumXiMultipoles.jl#L118-L214">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GaPSE.print_map_sum_Œæ_GNCxLD_multipole" href="#GaPSE.print_map_sum_Œæ_GNCxLD_multipole"><code>GaPSE.print_map_sum_Œæ_GNCxLD_multipole</code></a> ‚Äî <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">print_map_sum_Œæ_GNCxLD_multipole(
    cosmo::Cosmology, out::String, ss = nothing;
    s1 = nothing, L::Int = 0, alg::Symbol = :lobatto,
    N_lob::Int = 100, N_trap::Int = 50,
    atol_quad::Float64 = 0.0, rtol_quad::Float64 = 1e-2,
    enhancer::Float64=1e6, N_log::Int = 1000, 
    pr::Bool = true,
    single::Bool = true,
    kwargs...)</code></pre><p>Evaluate the multipole of order <code>L</code> of all the two-point cross correlation multipole between  the Galaxy Number Counts (GNC) and the perturbations of the Luminosity Distance (LD) and their sum in the comoving distance <code>s1</code>,  for all the comoving distances stored inside <code>ss</code> (representing  the comoving distance from <code>s1</code>) for the input <code>cosmo::Cosmology</code>; finally, it saves the results inside the file <code>out</code>. If <code>ss = nothing</code>, it is set <code>ss = 10 .^ range(0, log10(2 * cosmo.s_max), length=N_log)</code>. If <code>s1 = nothing</code>, it is set <code>s1 = cosmo.s_eff</code>. We remember that all the distances are measured in <span>$h_0^{-1}\mathrm{Mpc}$</span>.</p><p>This function makes a for-loop on the <code>GaPSE.GR_EFFECTS_GNCxLD</code> strings, calling  <code>map_Œæ_GNCxLD_multipole</code> for each of them. To each string corresponds pretty intuitively one of the  20 GNCxLD effects. They are currently, in order:</p><p><code>newton_doppler , newton_lensing , newton_localgp , newton_integratedgp , doppler_doppler , doppler_lensing , doppler_localgp , doppler_integratedgp , lensing_doppler , lensing_lensing , lensing_localgp , lensing_integratedgp , localgp_doppler , localgp_lensing , localgp_localgp , localgp_integratedgp , integratedgp_doppler , integratedgp_lensing , integratedgp_localgp , integratedgp_integratedgp ,</code></p><p><strong>Inputs</strong></p><ul><li><p><code>cosmo::Cosmology</code> : cosmology to be used in this computation</p></li><li><p><code>out::String</code> : name of the file where the results must be stored.</p></li><li><p><code>ss</code> : vector/range of <code>s</code> values where the function must be evaluated; if <code>ss = nothing</code>,  it is set <code>ss = 10 .^ range(0, log10(2 * cosmo.s_max), length=N_log)</code>.</p></li></ul><p><strong>Optional arguments</strong></p><p>This function recall internally <code>map_Œæ_GNCxLD_multipole</code>, so the kwargs are the same; we report them for comfortness:</p><ul><li><p><code>s1 = nothing</code> : comoving distance from the observer where the TPCF should be evaluated; if <code>s1 = nothing</code>, it is automatically set <code>s1 = cosmo.s_eff</code> from the given input <code>cosmo::Cosmology</code>.</p></li><li><p><code>L::Int = 0</code>: order of the Legendre polynomial to be used</p></li><li><p><code>alg::Symbol = :trap</code> : algorithm to be used for the integration; the valid options  are (other values will lead to <code>AssertionError</code>):</p><ul><li><code>:quad</code> -&gt; the integration over <span>$\mu$</span> will be preformed through the Julia function <code>quadgk</code>  from the <a href="https://github.com/JuliaMath/QuadGK.jl"><code>QuadGK.jl</code></a> Julia package, that uses an adaptive  Gauss-Kronrod quadrature.</li><li><code>:trap</code> -&gt; the integration over <span>$\mu$</span> will be preformed through the Julia function <code>trapz</code>  from the <a href="https://github.com/francescoalemanno/Trapz.jl"><code>Trapz.jl</code></a> Julia package, that uses the simple trapezoidal rulae.</li><li><code>:lobatto</code> -&gt; the integration over <span>$\mu$</span> will be preformed through the Julia function <code>gausslobatto</code>  from the <a href="https://github.com/JuliaApproximation/FastGaussQuadrature.jl"><code>FastGaussQuadrature.jl</code></a> Julia package,  that uses the Gauss-Lobatto quadrature.  WE RECOMMEND TO USE <code>:quad</code> FOR MONOPOLES AND <code>:lobatto</code> FOR HIGHER ORDER MULTIPOLES!</li></ul></li><li><p><code>use_windows::Bool = false</code>: tells if the integrand must consider the two  window function <span>$\phi$</span> and <span>$\mathcal{F}$</span></p></li></ul><ul><li><p><code>N_lob::Int = 100</code> : number of points to be used in the sampling made by the function <code>trapz</code>. Note that these options will have an effect only if you se <code>alg = :quad</code>.</p></li><li><p><code>N_trap::Int = 200</code> : number of points to be used in the sampling made by the function <code>trapz</code>. Note that these options will have an effect only if you se <code>alg = :quad</code>.</p></li><li><p><code>atol_quad::Float64 = 0.0</code> and <code>rtol_quad::Float64 = 1e-2</code>: absolute and relative tolerance to be passed to the function <code>quadgk</code>; it&#39;s recommended not to set <code>rtol_quad &lt; 1e-2</code>  because the time for evaluation increase quickly. Note that these options will have an effect only if you se <code>alg = :quad</code>.</p></li><li><p><code>enhancer::Float64 = 1e6</code>: just a float number used in order to deal better with small numbers;  the returned value is NOT modified by this value, because after a multiplication the internal result is divided by <code>enhancer</code>.</p></li><li><p><code>N_log::Int = 1000</code> : number of points to be used in the default logaritmically-spaced  range for <code>ss</code>, i.e. <code>range(0, log10(2 * cosmo.s_max), length=N_log)</code>; it is ignored if <code>ss ‚â† nothing</code> </p></li><li><p><code>pr::Bool = true</code> : do you want the progress bar showed on screen, in order to  check the time needed for the computation? (<code>true</code> recommended)</p></li><li><p><code>single::Bool = true</code> : if <code>true</code>, all the CFs are printed inside the file of the sum, in a  table with 18 columns (first one for <code>ss</code>, second for their sum an the next 20 for each effect). Otherwise, a new directory &quot;all<em>standalones</em>CFs&quot; is created (in the same path given in <code>out</code>) and  they are separately saved in files there placed.</p></li><li><p><code>kwargs...</code> : other keyword arguments that will be passed to ALL the  GNCxLD TPCF effect (<code>Œæ_GNCxLD_Doppler</code>, <code>Œæ_GNCxLD_Lensing</code>, ...); if one of them has that keyword argument, it will use the given value, otherwise it will be unaffected.</p></li></ul><p>See also: <a href="#GaPSE.map_Œæ_GNCxLD_multipole"><code>map_Œæ_GNCxLD_multipole</code></a>, <a href="#GaPSE.sum_Œæ_GNCxLD_multipole"><code>sum_Œæ_GNCxLD_multipole</code></a>, <a href="#GaPSE.map_sum_Œæ_GNCxLD_multipole"><code>map_sum_Œæ_GNCxLD_multipole</code></a>, <a href="../Cosmology/#GaPSE.Cosmology"><code>Cosmology</code></a>, <a href="../Dicts/#GaPSE.GR_EFFECTS_GNCxLD"><code>GR_EFFECTS_GNCxLD</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/foglienimatteo/GaPSE.jl/blob/e601437c432ee08c2009b9fd4aee18390ba3e877/src/GNCxLD_SumXiMultipoles.jl#L241-L337">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../GNCxLD_Correlations_1/">¬´ GNCxLD TPCFs</a><a class="docs-footer-nextpage" href="../LDxGNC_Correlations_1/">LDxGNC TPCFs ¬ª</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="auto">Automatic (OS)</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.2.1 on <span class="colophon-date" title="Friday 23 February 2024 12:23">Friday 23 February 2024</span>. Using Julia version 1.9.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
